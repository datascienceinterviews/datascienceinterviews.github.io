<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="100+ SQL interview questions for cracking Data Science and Analytics interviews"><meta name=author content="Kuldeep Singh Sidhu"><link href=../AB-testing/ rel=prev><link href=../Python/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.50"><title>SQL Interview Questions for Data Science - Data Science Interview preparation</title><link rel=stylesheet href=../../assets/stylesheets/main.a40c8224.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-EVGNTG49J7"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-EVGNTG49J7",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-EVGNTG49J7",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#sql-interview-questions-for-data-science class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <!-- Add announcement here, including arbitrary HTML --> <style>
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
      20%, 40%, 60%, 80% { transform: translateX(2px); }
    }
    @keyframes glow {
      0%, 100% { text-shadow: 0 0 5px rgba(255, 165, 0, 0.5); }
      50% { text-shadow: 0 0 20px rgba(255, 165, 0, 0.8), 0 0 30px rgba(255, 140, 0, 0.6); }
    }
    .shake-text {
      display: inline-block;
      animation: shake 3s ease-in-out infinite;
    }
    .glow-link {
      animation: glow 2s ease-in-out infinite;
      font-weight: bold;
    }
  </style> <span class=shake-text>üöÄ <a href=/flashcards class=glow-link>Flashcards</a> feature is live!</span> <meta name=google-adsense-account content=ca-pub-4988388949365963> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4988388949365963" crossorigin=anonymous></script> </div> </aside> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Data Science Interview preparation" class="md-header__button md-logo" aria-label="Data Science Interview preparation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M9.4 86.6c-12.5-12.5-12.5-32.7 0-45.2s32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L178.7 256zM256 416h288c17.7 0 32 14.3 32 32s-14.3 32-32 32H256c-17.7 0-32-14.3-32-32s14.3-32 32-32"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Data Science Interview preparation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> SQL Interview Questions for Data Science </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=deep-purple data-md-color-accent=purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=deep-purple data-md-color-accent=purple aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/singhsidhukuldeep/singhsidhukuldeep.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> singhsidhukuldeep/singhsidhukuldeep.github.io </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Data Science Interview preparation" class="md-nav__button md-logo" aria-label="Data Science Interview preparation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M9.4 86.6c-12.5-12.5-12.5-32.7 0-45.2s32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L178.7 256zM256 416h288c17.7 0 32 14.3 32 32s-14.3 32-32 32H256c-17.7 0-32-14.3-32-32s14.3-32 32-32"/></svg> </a> Data Science Interview preparation </label> <div class=md-nav__source> <a href=https://github.com/singhsidhukuldeep/singhsidhukuldeep.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> singhsidhukuldeep/singhsidhukuldeep.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> üè° Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> üë®üèø‚Äçüè´ Interview Questions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> üë®üèø‚Äçüè´ Interview Questions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../flashcards/ class=md-nav__link> <span class=md-ellipsis> üìá Flashcards </span> </a> </li> <li class=md-nav__item> <a href=../data-structures-algorithms/ class=md-nav__link> <span class=md-ellipsis> DSA (Data Structures & Algorithms) </span> </a> </li> <li class=md-nav__item> <a href=../Machine-Learning/ class=md-nav__link> <span class=md-ellipsis> Machine Learning </span> </a> </li> <li class=md-nav__item> <a href=../System-design/ class=md-nav__link> <span class=md-ellipsis> System Design </span> </a> </li> <li class=md-nav__item> <a href=../Natural-Language-Processing/ class=md-nav__link> <span class=md-ellipsis> Natural Language Processing (NLP) </span> </a> </li> <li class=md-nav__item> <a href=../Probability/ class=md-nav__link> <span class=md-ellipsis> Probability </span> </a> </li> <li class=md-nav__item> <a href=../AB-testing/ class=md-nav__link> <span class=md-ellipsis> A/B Testing </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> SQL </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> SQL </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#premium-interview-questions class=md-nav__link> <span class=md-ellipsis> Premium Interview Questions </span> </a> <nav class=md-nav aria-label="Premium Interview Questions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-the-difference-between-where-and-having-clauses-google-amazon-meta-interview-question class=md-nav__link> <span class=md-ellipsis> What is the Difference Between WHERE and HAVING Clauses? - Google, Amazon, Meta Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-different-types-of-joins-with-examples-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Different Types of JOINs with Examples - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-are-window-functions-explain-with-examples-google-meta-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> What Are Window Functions? Explain with Examples - Google, Meta, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#write-a-query-to-find-duplicate-records-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> Write a Query to Find Duplicate Records - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-union-vs-union-all-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> Explain UNION vs UNION ALL - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-a-common-table-expression-cte-google-meta-interview-question class=md-nav__link> <span class=md-ellipsis> What is a Common Table Expression (CTE)? - Google, Meta Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#write-a-query-to-calculate-running-totalcumulative-sum-netflix-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Write a Query to Calculate Running Total/Cumulative Sum - Netflix, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-the-difference-between-delete-truncate-and-drop-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> Explain the Difference Between DELETE, TRUNCATE, and DROP - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-are-indexes-when-should-you-use-them-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What Are Indexes? When Should You Use Them? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#write-a-query-to-find-the-second-highest-salary-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> Write a Query to Find the Second Highest Salary - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-acid-properties-in-databases-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain ACID Properties in Databases - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-database-normalization-explain-normal-forms-amazon-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> What is Database Normalization? Explain Normal Forms - Amazon, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#write-a-query-to-pivotunpivot-data-google-meta-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Write a Query to Pivot/Unpivot Data - Google, Meta, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-query-optimization-and-execution-plans-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Query Optimization and Execution Plans - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-are-subqueries-correlated-vs-non-correlated-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What Are Subqueries? Correlated vs Non-Correlated - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-case-statements-in-sql-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> Explain CASE Statements in SQL - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-work-with-dates-in-sql-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Work with Dates in SQL? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-handle-null-values-in-sql-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Handle NULL Values in SQL? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-group-by-and-aggregation-best-practices-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain GROUP BY and Aggregation Best Practices - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-are-stored-procedures-and-functions-oracle-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> What Are Stored Procedures and Functions? - Oracle, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-are-views-when-should-you-use-them-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> What Are Views? When Should You Use Them? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-are-triggers-in-sql-oracle-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> What Are Triggers in SQL? - Oracle, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-transactions-and-isolation-levels-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Transactions and Isolation Levels - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-handle-locking-in-sql-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Handle Locking in SQL? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-database-partitioning-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is Database Partitioning? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-database-constraints-and-their-uses-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Database Constraints and Their Uses - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-design-a-database-schema-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Design a Database Schema? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-optimize-slow-queries-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Optimize Slow Queries? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-the-difference-between-union-intersect-and-except-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is the Difference Between UNION, INTERSECT, and EXCEPT? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-in-vs-exists-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> When to Use IN vs EXISTS? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-write-a-pivot-query-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Write a Pivot Query? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-does-the-merge-statement-work-amazon-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> How Does the MERGE Statement Work? - Amazon, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-write-recursive-ctes-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Write Recursive CTEs? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-a-lateral-join-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is a Lateral Join? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-query-json-data-in-sql-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Query JSON Data in SQL? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-full-text-search-in-sql-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is Full-Text Search in SQL? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-use-regular-expressions-in-sql-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Use Regular Expressions in SQL? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-are-sequences-in-sql-amazon-oracle-interview-question class=md-nav__link> <span class=md-ellipsis> What Are Sequences in SQL? - Amazon, Oracle Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-create-and-use-temporary-tables-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Create and Use Temporary Tables? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-perform-a-safe-update-with-join-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Perform a Safe UPDATE with JOIN? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-the-difference-between-having-and-where-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> What is the Difference Between HAVING and WHERE? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-handle-duplicate-detection-and-removal-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Handle Duplicate Detection and Removal? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-database-normalization-explain-1nf-2nf-3nf-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is Database Normalization? Explain 1NF, 2NF, 3NF - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-calculate-running-totals-and-moving-averages-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Calculate Running Totals and Moving Averages? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-find-gaps-in-sequential-data-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Find Gaps in Sequential Data? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-write-efficient-pagination-queries-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Write Efficient Pagination Queries? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-data-warehouse-star-schema-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> What is Data Warehouse Star Schema? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-optimize-count-on-large-tables-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Optimize COUNT(*) on Large Tables? - Amazon, Google Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#quick-reference-100-interview-questions class=md-nav__link> <span class=md-ellipsis> Quick Reference: 100+ Interview Questions </span> </a> </li> <li class=md-nav__item> <a href=#code-examples class=md-nav__link> <span class=md-ellipsis> Code Examples </span> </a> <nav class=md-nav aria-label="Code Examples"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-nth-highest-salary-using-dense_rank class=md-nav__link> <span class=md-ellipsis> 1. Nth Highest Salary using DENSE_RANK() </span> </a> </li> <li class=md-nav__item> <a href=#2-recursive-cte-employee-hierarchy class=md-nav__link> <span class=md-ellipsis> 2. Recursive CTE: Employee Hierarchy </span> </a> </li> <li class=md-nav__item> <a href=#3-running-total-and-moving-average class=md-nav__link> <span class=md-ellipsis> 3. Running Total and Moving Average </span> </a> </li> <li class=md-nav__item> <a href=#4-pivot-data-case-when-aggregation class=md-nav__link> <span class=md-ellipsis> 4. Pivot Data (CASE WHEN Aggregation) </span> </a> </li> <li class=md-nav__item> <a href=#5-gap-analysis-identifying-missing-sequences class=md-nav__link> <span class=md-ellipsis> 5. Gap Analysis (Identifying Missing Sequences) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#additional-resources class=md-nav__link> <span class=md-ellipsis> Additional Resources </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-google-interviews class=md-nav__link> <span class=md-ellipsis> Questions asked in Google interviews </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-amazon-interviews class=md-nav__link> <span class=md-ellipsis> Questions asked in Amazon interviews </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-microsoft-interviews class=md-nav__link> <span class=md-ellipsis> Questions asked in Microsoft interviews </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-meta-interviews class=md-nav__link> <span class=md-ellipsis> Questions asked in Meta interviews </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-netflix-interviews class=md-nav__link> <span class=md-ellipsis> Questions asked in Netflix interviews </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-apple-interviews class=md-nav__link> <span class=md-ellipsis> Questions asked in Apple interviews </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-linkedin-interviews class=md-nav__link> <span class=md-ellipsis> Questions asked in LinkedIn interviews </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Python/ class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=../Pandas/ class=md-nav__link> <span class=md-ellipsis> Pandas </span> </a> </li> <li class=md-nav__item> <a href=../NumPy/ class=md-nav__link> <span class=md-ellipsis> NumPy </span> </a> </li> <li class=md-nav__item> <a href=../Scikit-Learn/ class=md-nav__link> <span class=md-ellipsis> Scikit-Learn </span> </a> </li> <li class=md-nav__item> <a href=../LangChain/ class=md-nav__link> <span class=md-ellipsis> LangChain </span> </a> </li> <li class=md-nav__item> <a href=../LangGraph/ class=md-nav__link> <span class=md-ellipsis> LangGraph </span> </a> </li> <li class=md-nav__item> <a href=../Interview-Question-Resources/ class=md-nav__link> <span class=md-ellipsis> Interview Question Resources </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> üìù Cheat Sheets </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> üìù Cheat Sheets </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Cheat-Sheets/Django/ class=md-nav__link> <span class=md-ellipsis> Django </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Flask/ class=md-nav__link> <span class=md-ellipsis> Flask </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Hypothesis-Tests/ class=md-nav__link> <span class=md-ellipsis> Hypothesis Tests </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Keras/ class=md-nav__link> <span class=md-ellipsis> Keras </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/NumPy/ class=md-nav__link> <span class=md-ellipsis> NumPy </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Pandas/ class=md-nav__link> <span class=md-ellipsis> Pandas </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/PySpark/ class=md-nav__link> <span class=md-ellipsis> PySpark </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/PyTorch/ class=md-nav__link> <span class=md-ellipsis> PyTorch </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Python/ class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/RegEx/ class=md-nav__link> <span class=md-ellipsis> Regular Expressions (RegEx) </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Sk-learn/ class=md-nav__link> <span class=md-ellipsis> Scikit Learn </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/SQL/ class=md-nav__link> <span class=md-ellipsis> SQL </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/tensorflow/ class=md-nav__link> <span class=md-ellipsis> TensorFlow </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> ‚Äçüéì ML Topics </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> ‚Äçüéì ML Topics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Machine-Learning/ARIMA/ class=md-nav__link> <span class=md-ellipsis> ARIMA </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Activation%20functions/ class=md-nav__link> <span class=md-ellipsis> Activation functions </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Collaborative%20Filtering/ class=md-nav__link> <span class=md-ellipsis> Collaborative Filtering </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Confusion%20Matrix/ class=md-nav__link> <span class=md-ellipsis> Confusion Matrix </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/DBSCAN/ class=md-nav__link> <span class=md-ellipsis> DBSCAN </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Decision%20Trees/ class=md-nav__link> <span class=md-ellipsis> Decision Trees </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Gradient%20Boosting/ class=md-nav__link> <span class=md-ellipsis> Gradient Boosting </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/K-means%20clustering/ class=md-nav__link> <span class=md-ellipsis> K-means clustering </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Linear%20Regression/ class=md-nav__link> <span class=md-ellipsis> Linear Regression </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Logistic%20Regression/ class=md-nav__link> <span class=md-ellipsis> Logistic Regression </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Loss%20Function%20MAE%2C%20RMSE/ class=md-nav__link> <span class=md-ellipsis> Loss Function MAE, RMSE </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Neural%20Networks/ class=md-nav__link> <span class=md-ellipsis> Neural Networks </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Normal%20Distribution/ class=md-nav__link> <span class=md-ellipsis> Normal Distribution </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Normalization%20Regularisation/ class=md-nav__link> <span class=md-ellipsis> Normalization Regularisation </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Overfitting%2C%20Underfitting/ class=md-nav__link> <span class=md-ellipsis> Overfitting, Underfitting </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/PCA/ class=md-nav__link> <span class=md-ellipsis> PCA </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Random%20Forest/ class=md-nav__link> <span class=md-ellipsis> Random Forest </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Support%20Vector%20Machines/ class=md-nav__link> <span class=md-ellipsis> Support Vector Machines </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Unbalanced%2C%20Skewed%20data/ class=md-nav__link> <span class=md-ellipsis> Unbalanced, Skewed data </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/kNN/ class=md-nav__link> <span class=md-ellipsis> kNN </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> üë®üèæ‚Äçüíª Online Resources </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> üë®üèæ‚Äçüíª Online Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Online-Material/Online-Material-for-Learning/ class=md-nav__link> <span class=md-ellipsis> Online Study Material </span> </a> </li> <li class=md-nav__item> <a href=../../Online-Material/popular-resources/ class=md-nav__link> <span class=md-ellipsis> Popular Blogs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../projects/ class=md-nav__link> <span class=md-ellipsis> üì≥ Projects </span> </a> </li> <li class=md-nav__item> <a href=../../Contribute/ class=md-nav__link> <span class=md-ellipsis> ü§ù Contribute </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#premium-interview-questions class=md-nav__link> <span class=md-ellipsis> Premium Interview Questions </span> </a> <nav class=md-nav aria-label="Premium Interview Questions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-the-difference-between-where-and-having-clauses-google-amazon-meta-interview-question class=md-nav__link> <span class=md-ellipsis> What is the Difference Between WHERE and HAVING Clauses? - Google, Amazon, Meta Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-different-types-of-joins-with-examples-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Different Types of JOINs with Examples - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-are-window-functions-explain-with-examples-google-meta-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> What Are Window Functions? Explain with Examples - Google, Meta, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#write-a-query-to-find-duplicate-records-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> Write a Query to Find Duplicate Records - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-union-vs-union-all-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> Explain UNION vs UNION ALL - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-a-common-table-expression-cte-google-meta-interview-question class=md-nav__link> <span class=md-ellipsis> What is a Common Table Expression (CTE)? - Google, Meta Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#write-a-query-to-calculate-running-totalcumulative-sum-netflix-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Write a Query to Calculate Running Total/Cumulative Sum - Netflix, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-the-difference-between-delete-truncate-and-drop-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> Explain the Difference Between DELETE, TRUNCATE, and DROP - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-are-indexes-when-should-you-use-them-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What Are Indexes? When Should You Use Them? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#write-a-query-to-find-the-second-highest-salary-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> Write a Query to Find the Second Highest Salary - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-acid-properties-in-databases-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain ACID Properties in Databases - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-database-normalization-explain-normal-forms-amazon-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> What is Database Normalization? Explain Normal Forms - Amazon, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#write-a-query-to-pivotunpivot-data-google-meta-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Write a Query to Pivot/Unpivot Data - Google, Meta, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-query-optimization-and-execution-plans-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Query Optimization and Execution Plans - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-are-subqueries-correlated-vs-non-correlated-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What Are Subqueries? Correlated vs Non-Correlated - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-case-statements-in-sql-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> Explain CASE Statements in SQL - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-work-with-dates-in-sql-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Work with Dates in SQL? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-handle-null-values-in-sql-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Handle NULL Values in SQL? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-group-by-and-aggregation-best-practices-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain GROUP BY and Aggregation Best Practices - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-are-stored-procedures-and-functions-oracle-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> What Are Stored Procedures and Functions? - Oracle, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-are-views-when-should-you-use-them-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> What Are Views? When Should You Use Them? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-are-triggers-in-sql-oracle-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> What Are Triggers in SQL? - Oracle, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-transactions-and-isolation-levels-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Transactions and Isolation Levels - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-handle-locking-in-sql-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Handle Locking in SQL? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-database-partitioning-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is Database Partitioning? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-database-constraints-and-their-uses-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Database Constraints and Their Uses - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-design-a-database-schema-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Design a Database Schema? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-optimize-slow-queries-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Optimize Slow Queries? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-the-difference-between-union-intersect-and-except-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is the Difference Between UNION, INTERSECT, and EXCEPT? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-in-vs-exists-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> When to Use IN vs EXISTS? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-write-a-pivot-query-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Write a Pivot Query? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-does-the-merge-statement-work-amazon-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> How Does the MERGE Statement Work? - Amazon, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-write-recursive-ctes-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Write Recursive CTEs? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-a-lateral-join-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is a Lateral Join? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-query-json-data-in-sql-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Query JSON Data in SQL? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-full-text-search-in-sql-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is Full-Text Search in SQL? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-use-regular-expressions-in-sql-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Use Regular Expressions in SQL? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-are-sequences-in-sql-amazon-oracle-interview-question class=md-nav__link> <span class=md-ellipsis> What Are Sequences in SQL? - Amazon, Oracle Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-create-and-use-temporary-tables-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Create and Use Temporary Tables? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-perform-a-safe-update-with-join-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Perform a Safe UPDATE with JOIN? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-the-difference-between-having-and-where-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> What is the Difference Between HAVING and WHERE? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-handle-duplicate-detection-and-removal-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Handle Duplicate Detection and Removal? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-database-normalization-explain-1nf-2nf-3nf-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is Database Normalization? Explain 1NF, 2NF, 3NF - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-calculate-running-totals-and-moving-averages-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Calculate Running Totals and Moving Averages? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-find-gaps-in-sequential-data-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Find Gaps in Sequential Data? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-write-efficient-pagination-queries-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Write Efficient Pagination Queries? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-data-warehouse-star-schema-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> What is Data Warehouse Star Schema? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-do-you-optimize-count-on-large-tables-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Optimize COUNT(*) on Large Tables? - Amazon, Google Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#quick-reference-100-interview-questions class=md-nav__link> <span class=md-ellipsis> Quick Reference: 100+ Interview Questions </span> </a> </li> <li class=md-nav__item> <a href=#code-examples class=md-nav__link> <span class=md-ellipsis> Code Examples </span> </a> <nav class=md-nav aria-label="Code Examples"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-nth-highest-salary-using-dense_rank class=md-nav__link> <span class=md-ellipsis> 1. Nth Highest Salary using DENSE_RANK() </span> </a> </li> <li class=md-nav__item> <a href=#2-recursive-cte-employee-hierarchy class=md-nav__link> <span class=md-ellipsis> 2. Recursive CTE: Employee Hierarchy </span> </a> </li> <li class=md-nav__item> <a href=#3-running-total-and-moving-average class=md-nav__link> <span class=md-ellipsis> 3. Running Total and Moving Average </span> </a> </li> <li class=md-nav__item> <a href=#4-pivot-data-case-when-aggregation class=md-nav__link> <span class=md-ellipsis> 4. Pivot Data (CASE WHEN Aggregation) </span> </a> </li> <li class=md-nav__item> <a href=#5-gap-analysis-identifying-missing-sequences class=md-nav__link> <span class=md-ellipsis> 5. Gap Analysis (Identifying Missing Sequences) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#additional-resources class=md-nav__link> <span class=md-ellipsis> Additional Resources </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-google-interviews class=md-nav__link> <span class=md-ellipsis> Questions asked in Google interviews </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-amazon-interviews class=md-nav__link> <span class=md-ellipsis> Questions asked in Amazon interviews </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-microsoft-interviews class=md-nav__link> <span class=md-ellipsis> Questions asked in Microsoft interviews </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-meta-interviews class=md-nav__link> <span class=md-ellipsis> Questions asked in Meta interviews </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-netflix-interviews class=md-nav__link> <span class=md-ellipsis> Questions asked in Netflix interviews </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-apple-interviews class=md-nav__link> <span class=md-ellipsis> Questions asked in Apple interviews </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-linkedin-interviews class=md-nav__link> <span class=md-ellipsis> Questions asked in LinkedIn interviews </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/singhsidhukuldeep/singhsidhukuldeep.github.io/edit/master/docs/Interview-Questions/SQL-Interview-Questions.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/singhsidhukuldeep/singhsidhukuldeep.github.io/raw/master/docs/Interview-Questions/SQL-Interview-Questions.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1 id=sql-interview-questions-for-data-science>SQL Interview Questions for Data Science</h1> <p>This comprehensive guide contains <strong>100+ SQL interview questions</strong> commonly asked at top tech companies like Google, Amazon, Meta, Microsoft, and Netflix. Each premium question includes detailed explanations, query examples, and interviewer insights.</p> <hr> <h2 id=premium-interview-questions>Premium Interview Questions</h2> <p>Master these frequently asked SQL questions with detailed explanations, query examples, and insights into what interviewers really look for.</p> <hr> <h3 id=what-is-the-difference-between-where-and-having-clauses-google-amazon-meta-interview-question>What is the Difference Between WHERE and HAVING Clauses? - Google, Amazon, Meta Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Filtering</code>, <code>Aggregation</code>, <code>SQL Basics</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>The Core Difference:</strong></p> <table> <thead> <tr> <th>Clause</th> <th>Filters</th> <th>When Applied</th> <th>Works With</th> </tr> </thead> <tbody> <tr> <td>WHERE</td> <td>Individual rows</td> <td>Before grouping</td> <td>All columns</td> </tr> <tr> <td>HAVING</td> <td>Groups/aggregates</td> <td>After GROUP BY</td> <td>Aggregate functions</td> </tr> </tbody> </table> <p><strong>Execution Order:</strong></p> <div class=highlight><pre><span></span><code><span class=k>FROM</span><span class=w> </span><span class=err>‚Üí</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=err>‚Üí</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=err>‚Üí</span><span class=w> </span><span class=k>HAVING</span><span class=w> </span><span class=err>‚Üí</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=err>‚Üí</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span>
</code></pre></div> <p><strong>Example Comparison:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Find departments with more than 5 employees earning &gt; $50K</span>

<span class=c1>-- WHERE filters rows BEFORE grouping</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>department</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>emp_count</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>50000</span><span class=w>      </span><span class=c1>-- Filters individual rows first</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>department</span>
<span class=k>HAVING</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>5</span><span class=p>;</span><span class=w>       </span><span class=c1>-- Filters groups after</span>

<span class=c1>-- What actually happens:</span>
<span class=c1>-- 1. FROM: Select all rows from employees</span>
<span class=c1>-- 2. WHERE: Keep only rows where salary &gt; 50000</span>
<span class=c1>-- 3. GROUP BY: Group remaining rows by department</span>
<span class=c1>-- 4. HAVING: Keep only groups with count &gt; 5</span>
<span class=c1>-- 5. SELECT: Return department and count</span>
</code></pre></div> <p><strong>Common Pattern: Filtering with Aggregates</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- ‚ùå WRONG: Can&#39;t use aggregate in WHERE</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>customer_id</span><span class=p>,</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>order_total</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total_spent</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=k>WHERE</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>order_total</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1000</span><span class=w>  </span><span class=c1>-- ERROR!</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>customer_id</span><span class=p>;</span>

<span class=c1>-- ‚úÖ CORRECT: Use HAVING for aggregates</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>customer_id</span><span class=p>,</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>order_total</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total_spent</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>customer_id</span>
<span class=k>HAVING</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>order_total</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1000</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Works!</span>
</code></pre></div> <p><strong>Performance Tip:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- ‚úÖ More efficient: Filter with WHERE when possible</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>category</span><span class=p>,</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>price</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>avg_price</span>
<span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>active</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w>              </span><span class=c1>-- Filter early (uses index)</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>category</span>
<span class=k>HAVING</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>price</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>100</span><span class=p>;</span><span class=w>      </span><span class=c1>-- Filter aggregated result</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Understanding of SQL execution order.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Draws the execution order diagram</li> <li>Knows WHERE filters rows, HAVING filters groups</li> <li>Explains why aggregates can't be in WHERE</li> <li>Mentions performance: "WHERE is more efficient when applicable"</li> </ul> </div> </details> <hr> <h3 id=explain-different-types-of-joins-with-examples-google-amazon-interview-question>Explain Different Types of JOINs with Examples - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>JOINs</code>, <code>SQL Fundamentals</code>, <code>Data Modeling</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>JOIN Types Overview:</strong></p> <table> <thead> <tr> <th>JOIN Type</th> <th>Returns</th> <th>NULL Behavior</th> </tr> </thead> <tbody> <tr> <td>INNER</td> <td>Matching rows only</td> <td>Excludes NULLs</td> </tr> <tr> <td>LEFT</td> <td>All left + matching right</td> <td>Right columns NULL if no match</td> </tr> <tr> <td>RIGHT</td> <td>All right + matching left</td> <td>Left columns NULL if no match</td> </tr> <tr> <td>FULL OUTER</td> <td>All rows from both</td> <td>NULLs for non-matches</td> </tr> <tr> <td>CROSS</td> <td>Cartesian product</td> <td>Every combination</td> </tr> </tbody> </table> <p><strong>Visual Representation:</strong></p> <div class=highlight><pre><span></span><code>Tables:
employees (id, name, dept_id)    departments (id, name)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1   ‚îÇ Alice ‚îÇ 10      ‚îÇ        ‚îÇ 10 ‚îÇ Engineering‚îÇ
‚îÇ 2   ‚îÇ Bob   ‚îÇ 20      ‚îÇ        ‚îÇ 20 ‚îÇ Marketing  ‚îÇ
‚îÇ 3   ‚îÇ Carol ‚îÇ NULL    ‚îÇ        ‚îÇ 30 ‚îÇ HR         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1>-- INNER JOIN: Only matching rows (Alice, Bob)</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>department</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e</span>
<span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>departments</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>dept_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>id</span><span class=p>;</span>
<span class=c1>-- Result: Alice-Engineering, Bob-Marketing</span>

<span class=c1>-- LEFT JOIN: All employees + matching departments</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>department</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e</span>
<span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>departments</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>dept_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>id</span><span class=p>;</span>
<span class=c1>-- Result: Alice-Engineering, Bob-Marketing, Carol-NULL</span>

<span class=c1>-- RIGHT JOIN: All departments + matching employees</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>department</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e</span>
<span class=k>RIGHT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>departments</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>dept_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>id</span><span class=p>;</span>
<span class=c1>-- Result: Alice-Engineering, Bob-Marketing, NULL-HR</span>

<span class=c1>-- FULL OUTER JOIN: All from both (MySQL uses UNION)</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>department</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e</span>
<span class=k>FULL</span><span class=w> </span><span class=k>OUTER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>departments</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>dept_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>id</span><span class=p>;</span>
<span class=c1>-- Result: All 4 combinations including NULLs</span>

<span class=c1>-- CROSS JOIN: Cartesian product</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>name</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e</span>
<span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>departments</span><span class=w> </span><span class=n>d</span><span class=p>;</span>
<span class=c1>-- Result: 3 √ó 3 = 9 rows (every combination)</span>
</code></pre></div> <p><strong>Self JOIN Example:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Find employees and their managers</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>e</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>employee</span><span class=p>,</span>
<span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>manager</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e</span>
<span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>manager_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>m</span><span class=p>.</span><span class=n>id</span><span class=p>;</span>
</code></pre></div> <p><strong>Anti-JOIN Pattern (Find missing):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Find employees without departments</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>name</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e</span>
<span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>departments</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>dept_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>id</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Anti-join pattern</span>

<span class=c1>-- Alternative using NOT EXISTS</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>name</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e</span>
<span class=k>WHERE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>departments</span><span class=w> </span><span class=n>d</span><span class=w> </span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>dept_id</span>
<span class=p>);</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Fundamental SQL understanding and problem-solving.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Can draw Venn diagrams for each JOIN type</li> <li>Knows LEFT vs RIGHT is just table order</li> <li>Shows anti-join pattern for "find missing" problems</li> <li>Mentions execution plans: "JOINs on indexed columns are efficient"</li> </ul> </div> </details> <hr> <h3 id=what-are-window-functions-explain-with-examples-google-meta-netflix-interview-question>What Are Window Functions? Explain with Examples - Google, Meta, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Window Functions</code>, <code>Analytics</code>, <code>Advanced SQL</code> | <strong>Asked by:</strong> Google, Meta, Netflix, Amazon, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>What Are Window Functions?</strong></p> <p>Window functions perform calculations across a set of rows related to the current row, without collapsing them (unlike GROUP BY).</p> <p><strong>Syntax:</strong></p> <div class=highlight><pre><span></span><code><span class=n>function_name</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>partition_columns</span>
<span class=w>    </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>order_columns</span>
<span class=w>    </span><span class=k>ROWS</span><span class=o>/</span><span class=n>RANGE</span><span class=w> </span><span class=n>frame_specification</span>
<span class=p>)</span>
</code></pre></div> <p><strong>Common Window Functions:</strong></p> <table> <thead> <tr> <th>Function</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td>ROW_NUMBER()</td> <td>Sequential numbering</td> </tr> <tr> <td>RANK()</td> <td>Ranking with gaps</td> </tr> <tr> <td>DENSE_RANK()</td> <td>Ranking without gaps</td> </tr> <tr> <td>LAG()/LEAD()</td> <td>Access previous/next rows</td> </tr> <tr> <td>SUM()/AVG() OVER</td> <td>Running totals/averages</td> </tr> <tr> <td>FIRST_VALUE()/LAST_VALUE()</td> <td>First/last in window</td> </tr> <tr> <td>NTILE(n)</td> <td>Divide into n buckets</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><span class=c1>-- Sample: sales data</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=nb>date</span><span class=p>,</span>
<span class=w>    </span><span class=n>product</span><span class=p>,</span>
<span class=w>    </span><span class=n>amount</span><span class=p>,</span>

<span class=w>    </span><span class=c1>-- Running total</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>running_total</span><span class=p>,</span>

<span class=w>    </span><span class=c1>-- Running total per product</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>product</span><span class=w> </span>
<span class=w>        </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>product_running_total</span><span class=p>,</span>

<span class=w>    </span><span class=c1>-- Rank within each product</span>
<span class=w>    </span><span class=n>RANK</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>product</span><span class=w> </span>
<span class=w>        </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>DESC</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>rank_in_product</span><span class=p>,</span>

<span class=w>    </span><span class=c1>-- Previous day&#39;s amount</span>
<span class=w>    </span><span class=n>LAG</span><span class=p>(</span><span class=n>amount</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>prev_day</span><span class=p>,</span>

<span class=w>    </span><span class=c1>-- Difference from previous</span>
<span class=w>    </span><span class=n>amount</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>LAG</span><span class=p>(</span><span class=n>amount</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>day_diff</span><span class=p>,</span>

<span class=w>    </span><span class=c1>-- Moving average (3-day)</span>
<span class=w>    </span><span class=k>AVG</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span>
<span class=w>        </span><span class=k>ROWS</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=n>PRECEDING</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>CURRENT</span><span class=w> </span><span class=k>ROW</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>moving_avg_3d</span>

<span class=k>FROM</span><span class=w> </span><span class=n>sales</span><span class=p>;</span>
</code></pre></div> <p><strong>Practical Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- 1. Top N per group (Top 3 products per category)</span>
<span class=k>WITH</span><span class=w> </span><span class=n>ranked</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=n>category</span><span class=p>,</span>
<span class=w>        </span><span class=n>product_name</span><span class=p>,</span>
<span class=w>        </span><span class=n>revenue</span><span class=p>,</span>
<span class=w>        </span><span class=n>ROW_NUMBER</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>            </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>category</span><span class=w> </span>
<span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>revenue</span><span class=w> </span><span class=k>DESC</span>
<span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>rn</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>ranked</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>rn</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>3</span><span class=p>;</span>

<span class=c1>-- 2. Calculate Month-over-Month growth</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=k>month</span><span class=p>,</span>
<span class=w>    </span><span class=n>revenue</span><span class=p>,</span>
<span class=w>    </span><span class=n>LAG</span><span class=p>(</span><span class=n>revenue</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>month</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>prev_month</span><span class=p>,</span>
<span class=w>    </span><span class=n>ROUND</span><span class=p>(</span>
<span class=w>        </span><span class=p>(</span><span class=n>revenue</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>LAG</span><span class=p>(</span><span class=n>revenue</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>month</span><span class=p>))</span><span class=w> </span>
<span class=w>        </span><span class=o>/</span><span class=w> </span><span class=n>LAG</span><span class=p>(</span><span class=n>revenue</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>month</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>100</span><span class=p>,</span><span class=w> </span>
<span class=w>    </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>mom_growth_pct</span>
<span class=k>FROM</span><span class=w> </span><span class=n>monthly_sales</span><span class=p>;</span>

<span class=c1>-- 3. Percentile/Quartile analysis</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>customer_id</span><span class=p>,</span>
<span class=w>    </span><span class=n>total_spent</span><span class=p>,</span>
<span class=w>    </span><span class=n>NTILE</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>total_spent</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>spending_quartile</span>
<span class=k>FROM</span><span class=w> </span><span class=n>customer_totals</span><span class=p>;</span>

<span class=c1>-- 4. Identify consecutive sequences</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=nb>date</span><span class=p>,</span>
<span class=w>    </span><span class=n>event</span><span class=p>,</span>
<span class=w>    </span><span class=nb>date</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>ROW_NUMBER</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span><span class=p>)::</span><span class=nb>int</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>grp</span>
<span class=k>FROM</span><span class=w> </span><span class=n>events</span>
<span class=c1>-- Same &#39;grp&#39; value = consecutive dates</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Advanced SQL skills crucial for analytics roles.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows difference: ROW_NUMBER vs RANK vs DENSE_RANK</li> <li>Can explain PARTITION BY vs GROUP BY</li> <li>Uses LAG/LEAD for time-series analysis</li> <li>Mentions frame specifications: ROWS vs RANGE</li> </ul> </div> </details> <hr> <h3 id=write-a-query-to-find-duplicate-records-amazon-google-interview-question>Write a Query to Find Duplicate Records - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Data Quality</code>, <code>Aggregation</code>, <code>Common Patterns</code> | <strong>Asked by:</strong> Amazon, Google, Meta, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>Multiple Approaches:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Sample table with duplicates</span>
<span class=c1>-- users: id, email, name, created_at</span>

<span class=c1>-- Method 1: GROUP BY + HAVING (Most common)</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>email</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=k>count</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>email</span>
<span class=k>HAVING</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>

<span class=c1>-- Method 2: Get all duplicate rows with details</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>email</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>email</span>
<span class=w>    </span><span class=k>HAVING</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span>
<span class=p>);</span>

<span class=c1>-- Method 3: Using ROW_NUMBER (Modern approach)</span>
<span class=k>WITH</span><span class=w> </span><span class=n>duplicates</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=o>*</span><span class=p>,</span>
<span class=w>        </span><span class=n>ROW_NUMBER</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>            </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>email</span><span class=w> </span>
<span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>created_at</span>
<span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>rn</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>duplicates</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>rn</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>  </span><span class=c1>-- All duplicates (not first)</span>

<span class=c1>-- Method 4: Self-JOIN (older but works everywhere)</span>
<span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>u1</span><span class=p>.</span><span class=o>*</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=n>u1</span>
<span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=n>u2</span><span class=w> </span>
<span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>u1</span><span class=p>.</span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>u2</span><span class=p>.</span><span class=n>email</span><span class=w> </span>
<span class=w>    </span><span class=k>AND</span><span class=w> </span><span class=n>u1</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>u2</span><span class=p>.</span><span class=n>id</span><span class=p>;</span>
</code></pre></div> <p><strong>Deleting Duplicates (Keep first/oldest):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Method 1: DELETE with ROW_NUMBER (PostgreSQL, SQL Server)</span>
<span class=k>WITH</span><span class=w> </span><span class=n>duplicates</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=n>id</span><span class=p>,</span>
<span class=w>        </span><span class=n>ROW_NUMBER</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>            </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>email</span><span class=w> </span>
<span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>created_at</span>
<span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>rn</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=p>)</span>
<span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>duplicates</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>rn</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span>
<span class=p>);</span>

<span class=c1>-- Method 2: DELETE with self-join (MySQL)</span>
<span class=k>DELETE</span><span class=w> </span><span class=n>u1</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=n>u1</span>
<span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=n>u2</span>
<span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>u1</span><span class=p>.</span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>u2</span><span class=p>.</span><span class=n>email</span>
<span class=w>    </span><span class=k>AND</span><span class=w> </span><span class=n>u1</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>u2</span><span class=p>.</span><span class=n>id</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Keep lower id</span>

<span class=c1>-- Method 3: Keep newest instead of oldest</span>
<span class=k>WITH</span><span class=w> </span><span class=n>duplicates</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=n>id</span><span class=p>,</span>
<span class=w>        </span><span class=n>ROW_NUMBER</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>            </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>email</span><span class=w> </span>
<span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=k>DESC</span><span class=w>  </span><span class=c1>-- DESC = keep newest</span>
<span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>rn</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=p>)</span>
<span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>duplicates</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>rn</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span>
<span class=p>);</span>
</code></pre></div> <p><strong>Multi-column Duplicates:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Duplicates based on multiple columns</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>first_name</span><span class=p>,</span><span class=w> </span><span class=n>last_name</span><span class=p>,</span><span class=w> </span><span class=n>email</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>first_name</span><span class=p>,</span><span class=w> </span><span class=n>last_name</span><span class=p>,</span><span class=w> </span><span class=n>email</span>
<span class=k>HAVING</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Practical SQL problem-solving.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Gives multiple approaches (GROUP BY, ROW_NUMBER, self-join)</li> <li>Knows how to DELETE duplicates while keeping one</li> <li>Asks clarifying questions: "Keep oldest or newest?"</li> <li>Mentions performance: "Add index on the grouping column"</li> </ul> </div> </details> <hr> <h3 id=explain-union-vs-union-all-most-tech-companies-interview-question>Explain UNION vs UNION ALL - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Set Operations</code>, <code>Performance</code>, <code>SQL Basics</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>The Core Difference:</strong></p> <table> <thead> <tr> <th>Operation</th> <th>Duplicates</th> <th>Performance</th> </tr> </thead> <tbody> <tr> <td>UNION</td> <td>Removes duplicates</td> <td>Slower (sorts/dedupes)</td> </tr> <tr> <td>UNION ALL</td> <td>Keeps all rows</td> <td>Faster (no dedup)</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><span class=c1>-- Table A: (1, 2, 3)</span>
<span class=c1>-- Table B: (2, 3, 4)</span>

<span class=c1>-- UNION: Removes duplicates</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table_a</span>
<span class=k>UNION</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table_b</span><span class=p>;</span>
<span class=c1>-- Result: 1, 2, 3, 4 (4 rows)</span>

<span class=c1>-- UNION ALL: Keeps everything</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table_a</span>
<span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table_b</span><span class=p>;</span>
<span class=c1>-- Result: 1, 2, 3, 2, 3, 4 (6 rows)</span>
</code></pre></div> <p><strong>When to Use Which:</strong></p> <table> <thead> <tr> <th>Scenario</th> <th>Use</th> </tr> </thead> <tbody> <tr> <td>Need unique results</td> <td>UNION</td> </tr> <tr> <td>Guaranteed no duplicates</td> <td>UNION ALL (faster)</td> </tr> <tr> <td>Counting all occurrences</td> <td>UNION ALL</td> </tr> <tr> <td>Combining partitioned data</td> <td>UNION ALL</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><span class=c1>-- Performance Example: Combining monthly data</span>

<span class=c1>-- ‚ùå Slow: UNION sorts and dedupes unnecessarily</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sales_jan</span>
<span class=k>UNION</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sales_feb</span>
<span class=k>UNION</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sales_mar</span><span class=p>;</span>

<span class=c1>-- ‚úÖ Fast: No duplicates between months anyway</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sales_jan</span>
<span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sales_feb</span>
<span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sales_mar</span><span class=p>;</span>
</code></pre></div> <p><strong>Requirements for UNION:</strong></p> <ol> <li>Same number of columns</li> <li>Compatible data types</li> <li>Column names from first query</li> </ol> <div class=highlight><pre><span></span><code><span class=c1>-- Column alignment matters</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>age</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w>  </span><span class=c1>-- 2 columns</span>
<span class=k>UNION</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>product_name</span><span class=p>,</span><span class=w> </span><span class=n>price</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=p>;</span><span class=w>  </span><span class=c1>-- 2 columns ‚úì</span>

<span class=c1>-- Types must be compatible</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w>      </span><span class=c1>-- int, varchar</span>
<span class=k>UNION</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>description</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>items</span><span class=p>;</span><span class=w> </span><span class=c1>-- int, varchar ‚úì</span>
</code></pre></div> <p><strong>Other Set Operations:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- INTERSECT: Common rows only</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>customers</span>
<span class=k>INTERSECT</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>newsletter_subscribers</span><span class=p>;</span>

<span class=c1>-- EXCEPT/MINUS: In first but not second</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>customers</span>
<span class=k>EXCEPT</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>unsubscribed</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Understanding of set operations and performance.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Immediately mentions performance difference</li> <li>Gives example: "Use UNION ALL for partitioned tables"</li> <li>Knows INTERSECT and EXCEPT as well</li> <li>Mentions: "UNION requires sorting, UNION ALL doesn't"</li> </ul> </div> </details> <hr> <h3 id=what-is-a-common-table-expression-cte-google-meta-interview-question>What is a Common Table Expression (CTE)? - Google, Meta Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>CTEs</code>, <code>Readability</code>, <code>Recursion</code> | <strong>Asked by:</strong> Google, Meta, Netflix, Amazon, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>What is a CTE?</strong></p> <p>A Common Table Expression (CTE) is a temporary named result set that exists only within the scope of a single query. It improves readability and enables recursive queries.</p> <p><strong>Basic Syntax:</strong></p> <div class=highlight><pre><span></span><code><span class=k>WITH</span><span class=w> </span><span class=n>cte_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=c1>-- CTE query</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=p>...</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>cte_name</span><span class=p>;</span>
</code></pre></div> <p><strong>Benefits:</strong></p> <table> <thead> <tr> <th>Benefit</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Readability</td> <td>Break complex queries into logical steps</td> </tr> <tr> <td>Reusability</td> <td>Reference same result multiple times</td> </tr> <tr> <td>Recursion</td> <td>Enable hierarchical queries</td> </tr> <tr> <td>Maintainability</td> <td>Easier to debug and modify</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><span class=c1>-- Example: Complex query made readable</span>

<span class=c1>-- Without CTE (hard to read)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>customer_id</span><span class=p>,</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>order_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span>
<span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>customer_id</span>
<span class=p>)</span><span class=w> </span><span class=n>customer_totals</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>total</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>total</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=k>SELECT</span><span class=w> </span><span class=n>customer_id</span><span class=p>,</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total</span>
<span class=w>        </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=w>        </span><span class=k>WHERE</span><span class=w> </span><span class=n>order_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span>
<span class=w>        </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>customer_id</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=n>all_totals</span>
<span class=p>);</span>

<span class=c1>-- With CTE (much clearer!)</span>
<span class=k>WITH</span><span class=w> </span><span class=n>customer_totals</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=n>customer_id</span><span class=p>,</span><span class=w> </span>
<span class=w>        </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>total</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>order_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span>
<span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>customer_id</span>
<span class=p>),</span>
<span class=n>avg_total</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>total</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>avg_val</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>customer_totals</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>ct</span><span class=p>.</span><span class=o>*</span>
<span class=k>FROM</span><span class=w> </span><span class=n>customer_totals</span><span class=w> </span><span class=n>ct</span><span class=p>,</span><span class=w> </span><span class=n>avg_total</span><span class=w> </span><span class=k>at</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>ct</span><span class=p>.</span><span class=n>total</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=k>at</span><span class=p>.</span><span class=n>avg_val</span><span class=p>;</span>
</code></pre></div> <p><strong>Recursive CTE (Hierarchical Data):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Employee hierarchy (org chart)</span>
<span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span><span class=w> </span><span class=n>org_chart</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=c1>-- Base case: CEO (no manager)</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>manager_id</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=k>level</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>manager_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span>

<span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>

<span class=w>    </span><span class=c1>-- Recursive case: employees with managers</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>manager_id</span><span class=p>,</span><span class=w> </span><span class=n>oc</span><span class=p>.</span><span class=k>level</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e</span>
<span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>org_chart</span><span class=w> </span><span class=n>oc</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>manager_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>oc</span><span class=p>.</span><span class=n>id</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>org_chart</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>level</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>;</span>

<span class=c1>-- Generate date series</span>
<span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span><span class=w> </span><span class=n>dates</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=nb>DATE</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nb>date</span>
<span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>&#39;1 day&#39;</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>dates</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=s1>&#39;2024-12-31&#39;</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dates</span><span class=p>;</span>
</code></pre></div> <p><strong>Multiple CTEs:</strong></p> <div class=highlight><pre><span></span><code><span class=k>WITH</span><span class=w> </span>
<span class=n>active_users</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>user_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>active</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>true</span>
<span class=p>),</span>
<span class=n>user_orders</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>user_id</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>order_count</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>user_id</span>
<span class=p>),</span>
<span class=n>user_metrics</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=n>au</span><span class=p>.</span><span class=n>user_id</span><span class=p>,</span>
<span class=w>        </span><span class=k>COALESCE</span><span class=p>(</span><span class=n>uo</span><span class=p>.</span><span class=n>order_count</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>orders</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>active_users</span><span class=w> </span><span class=n>au</span>
<span class=w>    </span><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>user_orders</span><span class=w> </span><span class=n>uo</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>au</span><span class=p>.</span><span class=n>user_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>uo</span><span class=p>.</span><span class=n>user_id</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>user_metrics</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>10</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Modern SQL skills and code organization.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses CTEs for readability, not just because they exist</li> <li>Knows recursive CTEs for hierarchies (org charts, trees)</li> <li>Mentions: "CTEs may be materialized or inline depending on DB"</li> <li>Compares to subqueries/temp tables when appropriate</li> </ul> </div> </details> <hr> <h3 id=write-a-query-to-calculate-running-totalcumulative-sum-netflix-amazon-interview-question>Write a Query to Calculate Running Total/Cumulative Sum - Netflix, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Window Functions</code>, <code>Running Total</code>, <code>Analytics</code> | <strong>Asked by:</strong> Netflix, Amazon, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Using Window Functions (Modern Approach):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Running total of daily sales</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=nb>date</span><span class=p>,</span>
<span class=w>    </span><span class=n>daily_revenue</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>daily_revenue</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>running_total</span>
<span class=k>FROM</span><span class=w> </span><span class=n>daily_sales</span><span class=p>;</span>

<span class=c1>-- Running total with partitions (per category)</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=nb>date</span><span class=p>,</span>
<span class=w>    </span><span class=n>category</span><span class=p>,</span>
<span class=w>    </span><span class=n>revenue</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>revenue</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>category</span><span class=w> </span>
<span class=w>        </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>category_running_total</span>
<span class=k>FROM</span><span class=w> </span><span class=n>sales</span><span class=p>;</span>

<span class=c1>-- Running total with explicit frame</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=nb>date</span><span class=p>,</span>
<span class=w>    </span><span class=n>amount</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span>
<span class=w>        </span><span class=k>ROWS</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=n>UNBOUNDED</span><span class=w> </span><span class=n>PRECEDING</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>CURRENT</span><span class=w> </span><span class=k>ROW</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>running_total</span>
<span class=k>FROM</span><span class=w> </span><span class=n>transactions</span><span class=p>;</span>
</code></pre></div> <p><strong>Other Running Calculations:</strong></p> <div class=highlight><pre><span></span><code><span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=nb>date</span><span class=p>,</span>
<span class=w>    </span><span class=n>amount</span><span class=p>,</span>

<span class=w>    </span><span class=c1>-- Running average</span>
<span class=w>    </span><span class=k>AVG</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>running_avg</span><span class=p>,</span>

<span class=w>    </span><span class=c1>-- Running count</span>
<span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>running_count</span><span class=p>,</span>

<span class=w>    </span><span class=c1>-- Running max</span>
<span class=w>    </span><span class=k>MAX</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>running_max</span><span class=p>,</span>

<span class=w>    </span><span class=c1>-- 7-day rolling sum</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span>
<span class=w>        </span><span class=k>ROWS</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>6</span><span class=w> </span><span class=n>PRECEDING</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>CURRENT</span><span class=w> </span><span class=k>ROW</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>rolling_7day_sum</span><span class=p>,</span>

<span class=w>    </span><span class=c1>-- Percentage of running total</span>
<span class=w>    </span><span class=n>amount</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>pct_of_total</span>

<span class=k>FROM</span><span class=w> </span><span class=n>daily_metrics</span><span class=p>;</span>
</code></pre></div> <p><strong>Self-JOIN Approach (Legacy/MySQL &lt; 8):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Running total without window functions</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>t1</span><span class=p>.</span><span class=nb>date</span><span class=p>,</span>
<span class=w>    </span><span class=n>t1</span><span class=p>.</span><span class=n>amount</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>t2</span><span class=p>.</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>running_total</span>
<span class=k>FROM</span><span class=w> </span><span class=n>transactions</span><span class=w> </span><span class=n>t1</span>
<span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>transactions</span><span class=w> </span><span class=n>t2</span><span class=w> </span>
<span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=nb>date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=nb>date</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=nb>date</span><span class=p>,</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=n>amount</span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=nb>date</span><span class=p>;</span>
</code></pre></div> <p><strong>Correlated Subquery (Another Legacy Option):</strong></p> <div class=highlight><pre><span></span><code><span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=nb>date</span><span class=p>,</span>
<span class=w>    </span><span class=n>amount</span><span class=p>,</span>
<span class=w>    </span><span class=p>(</span>
<span class=w>        </span><span class=k>SELECT</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span>
<span class=w>        </span><span class=k>FROM</span><span class=w> </span><span class=n>transactions</span><span class=w> </span><span class=n>t2</span>
<span class=w>        </span><span class=k>WHERE</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=nb>date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=nb>date</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>running_total</span>
<span class=k>FROM</span><span class=w> </span><span class=n>transactions</span><span class=w> </span><span class=n>t1</span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Analytics SQL skills.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses window functions as first choice</li> <li>Knows PARTITION BY for grouped running totals</li> <li>Can explain frame specifications (ROWS vs RANGE)</li> <li>Knows legacy approaches for older MySQL versions</li> </ul> </div> </details> <hr> <h3 id=explain-the-difference-between-delete-truncate-and-drop-most-tech-companies-interview-question>Explain the Difference Between DELETE, TRUNCATE, and DROP - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>DDL</code>, <code>DML</code>, <code>Data Management</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>Quick Comparison:</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>DELETE</th> <th>TRUNCATE</th> <th>DROP</th> </tr> </thead> <tbody> <tr> <td>Type</td> <td>DML</td> <td>DDL</td> <td>DDL</td> </tr> <tr> <td>Removes</td> <td>Rows (filtered)</td> <td>All rows</td> <td>Entire table</td> </tr> <tr> <td>WHERE clause</td> <td>Yes</td> <td>No</td> <td>No</td> </tr> <tr> <td>Rollback</td> <td>Yes</td> <td>No (usually)</td> <td>No</td> </tr> <tr> <td>Triggers</td> <td>Fires</td> <td>No</td> <td>No</td> </tr> <tr> <td>Speed</td> <td>Slowest</td> <td>Fast</td> <td>Fastest</td> </tr> <tr> <td>Space</td> <td>Keeps allocated</td> <td>Releases</td> <td>Releases all</td> </tr> <tr> <td>Identity/Auto-inc</td> <td>Continues</td> <td>Resets</td> <td>N/A</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><span class=c1>-- DELETE: Remove specific rows (logged, triggers fire)</span>
<span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;cancelled&#39;</span><span class=p>;</span>
<span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=p>;</span><span class=w>  </span><span class=c1>-- All rows, but can rollback</span>

<span class=c1>-- TRUNCATE: Remove all rows quickly (DDL, no triggers)</span>
<span class=k>TRUNCATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>temp_data</span><span class=p>;</span>
<span class=c1>-- Cannot use WHERE</span>
<span class=c1>-- Auto-increment resets to 1</span>

<span class=c1>-- DROP: Remove entire table structure</span>
<span class=k>DROP</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>old_logs</span><span class=p>;</span>
<span class=c1>-- Table definition, indexes, constraints all gone</span>
</code></pre></div> <p><strong>When to Use Each:</strong></p> <table> <thead> <tr> <th>Scenario</th> <th>Use</th> </tr> </thead> <tbody> <tr> <td>Remove specific rows</td> <td>DELETE</td> </tr> <tr> <td>Clear table for reload</td> <td>TRUNCATE</td> </tr> <tr> <td>Remove table entirely</td> <td>DROP</td> </tr> <tr> <td>Need to undo</td> <td>DELETE (in transaction)</td> </tr> <tr> <td>Fastest wipe</td> <td>TRUNCATE</td> </tr> <tr> <td>Keep table structure</td> <td>DELETE or TRUNCATE</td> </tr> </tbody> </table> <p><strong>Transaction Behavior:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- DELETE can be rolled back</span>
<span class=k>BEGIN</span><span class=w> </span><span class=k>TRANSACTION</span><span class=p>;</span>
<span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>important_data</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>123</span><span class=p>;</span>
<span class=c1>-- Oops! Wrong ID</span>
<span class=k>ROLLBACK</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Data restored</span>

<span class=c1>-- TRUNCATE typically cannot (varies by DB)</span>
<span class=k>BEGIN</span><span class=w> </span><span class=k>TRANSACTION</span><span class=p>;</span>
<span class=k>TRUNCATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>staging</span><span class=p>;</span>
<span class=k>COMMIT</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Can&#39;t undo in most databases</span>
</code></pre></div> <p><strong>Performance Difference:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- DELETE (10M rows) - SLOW</span>
<span class=c1>-- Writes to transaction log for each row</span>
<span class=c1>-- Fires triggers for each row</span>
<span class=c1>-- Acquires row-level locks</span>
<span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>huge_table</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Minutes to hours</span>

<span class=c1>-- TRUNCATE (10M rows) - FAST</span>
<span class=c1>-- Deallocates data pages directly</span>
<span class=c1>-- No per-row logging</span>
<span class=c1>-- Table-level lock only</span>
<span class=k>TRUNCATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>huge_table</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Seconds</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Understanding of SQL operations and their implications.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows DELETE is DML, TRUNCATE/DROP are DDL</li> <li>Mentions transaction log and performance</li> <li>Knows identity/auto-increment behavior</li> <li>Asks: "Do you need to keep the table structure?"</li> </ul> </div> </details> <hr> <h3 id=what-are-indexes-when-should-you-use-them-google-amazon-interview-question>What Are Indexes? When Should You Use Them? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Indexing</code>, <code>Performance</code>, <code>Database Design</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>What is an Index?</strong></p> <p>An index is a data structure (usually B-tree or Hash) that speeds up data retrieval at the cost of additional storage and slower writes.</p> <p><strong>Types of Indexes:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td>B-tree</td> <td>Range queries, sorting, equality</td> </tr> <tr> <td>Hash</td> <td>Exact match only (=)</td> </tr> <tr> <td>Clustered</td> <td>Physical row order (one per table)</td> </tr> <tr> <td>Non-clustered</td> <td>Pointer to rows (many per table)</td> </tr> <tr> <td>Composite</td> <td>Multiple columns</td> </tr> <tr> <td>Covering</td> <td>Includes all query columns</td> </tr> <tr> <td>Partial</td> <td>Subset of rows</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><span class=c1>-- Create basic index</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_email</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>users</span><span class=p>(</span><span class=n>email</span><span class=p>);</span>

<span class=c1>-- Composite index (order matters!)</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_status_date</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>status</span><span class=p>,</span><span class=w> </span><span class=n>order_date</span><span class=p>);</span>

<span class=c1>-- Unique index</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_unique_email</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>users</span><span class=p>(</span><span class=n>email</span><span class=p>);</span>

<span class=c1>-- Partial index (PostgreSQL)</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_active_users</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>users</span><span class=p>(</span><span class=n>email</span><span class=p>)</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>active</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>true</span><span class=p>;</span>

<span class=c1>-- Covering index (includes extra columns)</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_covering</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>customer_id</span><span class=p>)</span><span class=w> </span><span class=n>INCLUDE</span><span class=w> </span><span class=p>(</span><span class=n>order_date</span><span class=p>,</span><span class=w> </span><span class=n>total</span><span class=p>);</span>
</code></pre></div> <p><strong>When to Add Indexes:</strong></p> <table> <thead> <tr> <th>Add Index For</th> <th>Avoid Index For</th> </tr> </thead> <tbody> <tr> <td>Frequent WHERE clauses</td> <td>Frequently updated columns</td> </tr> <tr> <td>JOIN columns</td> <td>Low-cardinality columns</td> </tr> <tr> <td>ORDER BY columns</td> <td>Small tables</td> </tr> <tr> <td>Foreign keys</td> <td>Write-heavy tables</td> </tr> </tbody> </table> <p><strong>Query Analysis:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Check if index is used</span>
<span class=k>EXPLAIN</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;test@example.com&#39;</span><span class=p>;</span>

<span class=c1>-- Without index: Seq Scan (full table scan)</span>
<span class=c1>-- With index: Index Scan (fast lookup)</span>

<span class=c1>-- Check existing indexes</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>pg_indexes</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>tablename</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;users&#39;</span><span class=p>;</span>
</code></pre></div> <p><strong>Composite Index Column Order:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Index: (status, order_date)</span>

<span class=c1>-- ‚úÖ Uses index (left-most columns)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;shipped&#39;</span><span class=p>;</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;shipped&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>order_date</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>;</span>

<span class=c1>-- ‚ùå Doesn&#39;t use index (skips leftmost column)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>order_date</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>;</span>
</code></pre></div> <p><strong>Index Anti-patterns:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- ‚ùå Function on indexed column breaks index</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>email</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;test@example.com&#39;</span><span class=p>;</span>
<span class=c1>-- Fix: CREATE INDEX idx_email_lower ON users(LOWER(email));</span>

<span class=c1>-- ‚ùå Leading wildcard breaks index</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%phone&#39;</span><span class=p>;</span>
<span class=c1>-- ‚úÖ Trailing wildcard uses index</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;phone%&#39;</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Database performance understanding.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows trade-off: faster reads, slower writes</li> <li>Understands composite index column ordering</li> <li>Can read EXPLAIN output</li> <li>Mentions: "Indexes aren't free, they cost storage and write performance"</li> </ul> </div> </details> <hr> <h3 id=write-a-query-to-find-the-second-highest-salary-most-tech-companies-interview-question>Write a Query to Find the Second Highest Salary - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Subqueries</code>, <code>Ranking</code>, <code>Common Patterns</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>Multiple Approaches:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Method 1: LIMIT OFFSET (Simple)</span>
<span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>salary</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=k>DESC</span>
<span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>OFFSET</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>

<span class=c1>-- Method 2: Subquery with MAX</span>
<span class=k>SELECT</span><span class=w> </span><span class=k>MAX</span><span class=p>(</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>second_highest</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>MAX</span><span class=p>(</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=p>);</span>

<span class=c1>-- Method 3: DENSE_RANK (Handles ties correctly)</span>
<span class=k>WITH</span><span class=w> </span><span class=n>ranked</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=n>salary</span><span class=p>,</span>
<span class=w>        </span><span class=n>DENSE_RANK</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=k>DESC</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>rnk</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>salary</span>
<span class=k>FROM</span><span class=w> </span><span class=n>ranked</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>rnk</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>

<span class=c1>-- Method 4: NOT IN (Exclude max)</span>
<span class=k>SELECT</span><span class=w> </span><span class=k>MAX</span><span class=p>(</span><span class=n>salary</span><span class=p>)</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>MAX</span><span class=p>(</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=p>);</span>
</code></pre></div> <p><strong>Generalized: Nth Highest Salary:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Find Nth highest (parameter = N)</span>
<span class=k>WITH</span><span class=w> </span><span class=n>ranked</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=n>salary</span><span class=p>,</span>
<span class=w>        </span><span class=n>DENSE_RANK</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=k>DESC</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>rnk</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>salary</span>
<span class=k>FROM</span><span class=w> </span><span class=n>ranked</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>rnk</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>@</span><span class=n>N</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Replace @N with desired rank</span>

<span class=c1>-- Find 3rd highest</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>salary</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e1</span>
<span class=k>WHERE</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>salary</span><span class=p>)</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e2</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>e2</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>e1</span><span class=p>.</span><span class=n>salary</span>
<span class=p>);</span>
</code></pre></div> <p><strong>Handle NULL/Empty Cases:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Returns NULL if no second highest exists</span>
<span class=k>SELECT</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>salary</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=w>    </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=k>DESC</span>
<span class=w>    </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>OFFSET</span><span class=w> </span><span class=mi>1</span>
<span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>second_highest</span><span class=p>;</span>

<span class=c1>-- With COALESCE for default</span>
<span class=k>SELECT</span><span class=w> </span><span class=k>COALESCE</span><span class=p>(</span>
<span class=w>    </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>salary</span>
<span class=w>     </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=w>     </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=k>DESC</span>
<span class=w>     </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>OFFSET</span><span class=w> </span><span class=mi>1</span><span class=p>),</span>
<span class=w>    </span><span class=mi>0</span>
<span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>second_highest</span><span class=p>;</span>
</code></pre></div> <p><strong>Per-Department Second Highest:</strong></p> <div class=highlight><pre><span></span><code><span class=k>WITH</span><span class=w> </span><span class=n>ranked</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=n>department</span><span class=p>,</span>
<span class=w>        </span><span class=n>salary</span><span class=p>,</span>
<span class=w>        </span><span class=n>DENSE_RANK</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>            </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>department</span><span class=w> </span>
<span class=w>            </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=k>DESC</span>
<span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>rnk</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>department</span><span class=p>,</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>second_highest</span>
<span class=k>FROM</span><span class=w> </span><span class=n>ranked</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>rnk</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> SQL problem-solving and edge case handling.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Gives multiple solutions (OFFSET, subquery, window function)</li> <li>Uses DENSE_RANK for handling ties</li> <li>Handles NULL case when N rows don't exist</li> <li>Can generalize to Nth highest</li> </ul> </div> </details> <hr> <h3 id=explain-acid-properties-in-databases-google-amazon-interview-question>Explain ACID Properties in Databases - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Transactions</code>, <code>Database Theory</code>, <code>Reliability</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>ACID Properties:</strong></p> <table> <thead> <tr> <th>Property</th> <th>Meaning</th> <th>Ensures</th> </tr> </thead> <tbody> <tr> <td>**A**tomicity</td> <td>All or nothing</td> <td>Transaction completes fully or not at all</td> </tr> <tr> <td>**C**onsistency</td> <td>Valid state to valid state</td> <td>Database constraints maintained</td> </tr> <tr> <td>**I**solation</td> <td>Concurrent transactions independent</td> <td>No interference between transactions</td> </tr> <tr> <td>**D**urability</td> <td>Permanent once committed</td> <td>Data survives crashes</td> </tr> </tbody> </table> <p><strong>Atomicity Example:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Bank transfer must be atomic</span>
<span class=k>BEGIN</span><span class=w> </span><span class=k>TRANSACTION</span><span class=p>;</span>

<span class=k>UPDATE</span><span class=w> </span><span class=n>accounts</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=n>balance</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>balance</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Debit</span>
<span class=k>UPDATE</span><span class=w> </span><span class=n>accounts</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=n>balance</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>balance</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Credit</span>

<span class=c1>-- If either fails, ROLLBACK both</span>
<span class=k>COMMIT</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Both succeed or neither</span>

<span class=c1>-- If error occurs:</span>
<span class=k>ROLLBACK</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Undo partial changes</span>
</code></pre></div> <p><strong>Consistency Example:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Constraint: balance &gt;= 0</span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>accounts</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=n>positive_balance</span><span class=w> </span>
<span class=w>    </span><span class=k>CHECK</span><span class=w> </span><span class=p>(</span><span class=n>balance</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span><span class=p>);</span>

<span class=c1>-- This will fail (maintains consistency)</span>
<span class=k>UPDATE</span><span class=w> </span><span class=n>accounts</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=n>balance</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>balance</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1000</span><span class=w> </span>
<span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>balance</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>500</span><span class=p>;</span>
<span class=c1>-- Error: violates check constraint</span>
</code></pre></div> <p><strong>Isolation Levels:</strong></p> <table> <thead> <tr> <th>Level</th> <th>Dirty Read</th> <th>Non-repeatable</th> <th>Phantom</th> </tr> </thead> <tbody> <tr> <td>Read Uncommitted</td> <td>Yes</td> <td>Yes</td> <td>Yes</td> </tr> <tr> <td>Read Committed</td> <td>No</td> <td>Yes</td> <td>Yes</td> </tr> <tr> <td>Repeatable Read</td> <td>No</td> <td>No</td> <td>Yes</td> </tr> <tr> <td>Serializable</td> <td>No</td> <td>No</td> <td>No</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><span class=c1>-- Set isolation level</span>
<span class=k>SET</span><span class=w> </span><span class=k>TRANSACTION</span><span class=w> </span><span class=k>ISOLATION</span><span class=w> </span><span class=k>LEVEL</span><span class=w> </span><span class=k>READ</span><span class=w> </span><span class=k>COMMITTED</span><span class=p>;</span>

<span class=c1>-- Serializable (strictest)</span>
<span class=k>SET</span><span class=w> </span><span class=k>TRANSACTION</span><span class=w> </span><span class=k>ISOLATION</span><span class=w> </span><span class=k>LEVEL</span><span class=w> </span><span class=k>SERIALIZABLE</span><span class=p>;</span>
<span class=k>BEGIN</span><span class=p>;</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>accounts</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=c1>-- Another transaction cannot modify this row until COMMIT</span>
<span class=k>COMMIT</span><span class=p>;</span>
</code></pre></div> <p><strong>Durability Example:</strong></p> <div class=highlight><pre><span></span><code><span class=k>BEGIN</span><span class=w> </span><span class=k>TRANSACTION</span><span class=p>;</span>
<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span><span class=n>customer_id</span><span class=p>,</span><span class=w> </span><span class=n>total</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>500</span><span class=p>);</span>
<span class=k>COMMIT</span><span class=p>;</span>
<span class=c1>-- Power failure happens immediately after COMMIT</span>
<span class=c1>-- Data is STILL persisted (written to disk/WAL)</span>
</code></pre></div> <p><strong>Trade-offs:</strong></p> <table> <thead> <tr> <th>Property</th> <th>Cost</th> </tr> </thead> <tbody> <tr> <td>Atomicity</td> <td>Logging overhead</td> </tr> <tr> <td>Consistency</td> <td>Constraint checking overhead</td> </tr> <tr> <td>Isolation</td> <td>Lock contention, deadlocks</td> </tr> <tr> <td>Durability</td> <td>fsync/write performance</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Database fundamentals and trade-offs.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Gives real examples for each property</li> <li>Knows isolation levels and their trade-offs</li> <li>Mentions: "NoSQL often relaxes ACID for scalability"</li> <li>Can discuss CAP theorem connection</li> </ul> </div> </details> <hr> <h3 id=what-is-database-normalization-explain-normal-forms-amazon-microsoft-interview-question>What is Database Normalization? Explain Normal Forms - Amazon, Microsoft Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Database Design</code>, <code>Normalization</code>, <code>Data Modeling</code> | <strong>Asked by:</strong> Amazon, Microsoft, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>What is Normalization?</strong></p> <p>Normalization organizes database tables to reduce redundancy and improve data integrity by dividing data into related tables.</p> <p><strong>Normal Forms Summary:</strong></p> <table> <thead> <tr> <th>Form</th> <th>Rule</th> <th>Eliminates</th> </tr> </thead> <tbody> <tr> <td>1NF</td> <td>Atomic values, no repeating groups</td> <td>Multi-valued attributes</td> </tr> <tr> <td>2NF</td> <td>1NF + No partial dependencies</td> <td>Composite key issues</td> </tr> <tr> <td>3NF</td> <td>2NF + No transitive dependencies</td> <td>Non-key dependencies</td> </tr> <tr> <td>BCNF</td> <td>Every determinant is a candidate key</td> <td>More anomalies</td> </tr> </tbody> </table> <p><strong>1NF Example:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- ‚ùå Violates 1NF (repeating group)</span>
<span class=n>students</span>
<span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>phones</span><span class=w>                </span><span class=o>|</span>
<span class=o>|</span><span class=c1>----|-------|-----------------------|</span>
<span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>Alice</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>555</span><span class=o>-</span><span class=mi>1111</span><span class=p>,</span><span class=w> </span><span class=mi>555</span><span class=o>-</span><span class=mi>2222</span><span class=w>    </span><span class=o>|</span>

<span class=c1>-- ‚úÖ 1NF (atomic values)</span>
<span class=n>students</span><span class=w>             </span><span class=n>student_phones</span>
<span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>  </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=w> </span><span class=n>student_id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>phone</span><span class=w>    </span><span class=o>|</span>
<span class=o>|</span><span class=c1>----|-------|       |------------|----------|</span>
<span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>Alice</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>555</span><span class=o>-</span><span class=mi>1111</span><span class=w> </span><span class=o>|</span>
<span class=w>                     </span><span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>555</span><span class=o>-</span><span class=mi>2222</span><span class=w> </span><span class=o>|</span>
</code></pre></div> <p><strong>2NF Example:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- ‚ùå Violates 2NF (partial dependency on composite key)</span>
<span class=c1>-- Key: (student_id, course_id), but student_name depends only on student_id</span>
<span class=n>enrollments</span>
<span class=o>|</span><span class=w> </span><span class=n>student_id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>course_id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>student_name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>grade</span><span class=w> </span><span class=o>|</span>
<span class=o>|</span><span class=c1>------------|-----------|--------------|-------|</span>

<span class=c1>-- ‚úÖ 2NF (separate tables)</span>
<span class=n>students</span><span class=w>              </span><span class=n>enrollments</span>
<span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>  </span><span class=o>|</span><span class=w>        </span><span class=o>|</span><span class=w> </span><span class=n>student_id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>course_id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>grade</span><span class=w> </span><span class=o>|</span>
<span class=o>|</span><span class=c1>----|-------|        |------------|-----------|-------|</span>
<span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>Alice</span><span class=w> </span><span class=o>|</span><span class=w>        </span><span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>101</span><span class=w>       </span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w>     </span><span class=o>|</span>
</code></pre></div> <p><strong>3NF Example:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- ‚ùå Violates 3NF (transitive dependency)</span>
<span class=c1>-- zip ‚Üí city (non-key depends on non-key)</span>
<span class=n>employees</span>
<span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>zip</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>city</span><span class=w>    </span><span class=o>|</span>
<span class=o>|</span><span class=c1>----|-------|-------|---------|</span>
<span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>Alice</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>10001</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>New</span><span class=w> </span><span class=n>York</span><span class=o>|</span>

<span class=c1>-- ‚úÖ 3NF (remove transitive dependency)</span>
<span class=n>employees</span><span class=w>             </span><span class=n>zipcodes</span>
<span class=o>|</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>name</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>zip</span><span class=w>   </span><span class=o>|</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>zip</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>city</span><span class=w>     </span><span class=o>|</span>
<span class=o>|</span><span class=c1>----|-------|-------|  |-------|----------|</span>
<span class=o>|</span><span class=w> </span><span class=mi>1</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>Alice</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>10001</span><span class=w> </span><span class=o>|</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>10001</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>New</span><span class=w> </span><span class=n>York</span><span class=w> </span><span class=o>|</span>
</code></pre></div> <p><strong>When to Denormalize:</strong></p> <table> <thead> <tr> <th>Normalize</th> <th>Denormalize</th> </tr> </thead> <tbody> <tr> <td>OLTP (transactions)</td> <td>OLAP (analytics)</td> </tr> <tr> <td>High write volume</td> <td>High read volume</td> </tr> <tr> <td>Data integrity critical</td> <td>Query performance critical</td> </tr> <tr> <td>Storage is expensive</td> <td>Storage is cheap</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><span class=c1>-- Denormalized for reporting (star schema)</span>
<span class=n>sales_fact</span>
<span class=o>|</span><span class=w> </span><span class=n>sale_id</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>product_name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>category</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>customer_name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=o>|</span>
<span class=c1>-- Redundant but fast for aggregations</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Database design principles.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Explains each normal form with examples</li> <li>Knows when to denormalize (analytics, reporting)</li> <li>Mentions: "3NF is usually sufficient for OLTP"</li> <li>Discusses trade-offs: integrity vs performance</li> </ul> </div> </details> <hr> <h3 id=write-a-query-to-pivotunpivot-data-google-meta-netflix-interview-question>Write a Query to Pivot/Unpivot Data - Google, Meta, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Pivoting</code>, <code>Data Transformation</code>, <code>Advanced SQL</code> | <strong>Asked by:</strong> Google, Meta, Netflix, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>Pivot: Rows to Columns</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Original data</span>
<span class=c1>-- sales: product, quarter, amount</span>
<span class=c1>-- | Product | Q1    | Q2    | Q3    | Q4    |</span>

<span class=c1>-- Method 1: CASE + GROUP BY (Works everywhere)</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>product</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>quarter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Q1&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>Q1</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>quarter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Q2&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>Q2</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>quarter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Q3&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>Q3</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>quarter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Q4&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>Q4</span>
<span class=k>FROM</span><span class=w> </span><span class=n>sales</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>product</span><span class=p>;</span>

<span class=c1>-- Method 2: PIVOT (SQL Server)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span>
<span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>product</span><span class=p>,</span><span class=w> </span><span class=n>quarter</span><span class=p>,</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sales</span><span class=p>)</span><span class=w> </span><span class=n>src</span>
<span class=n>PIVOT</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span>
<span class=w>    </span><span class=k>FOR</span><span class=w> </span><span class=n>quarter</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>([</span><span class=n>Q1</span><span class=p>],</span><span class=w> </span><span class=p>[</span><span class=n>Q2</span><span class=p>],</span><span class=w> </span><span class=p>[</span><span class=n>Q3</span><span class=p>],</span><span class=w> </span><span class=p>[</span><span class=n>Q4</span><span class=p>])</span>
<span class=p>)</span><span class=w> </span><span class=n>pvt</span><span class=p>;</span>

<span class=c1>-- Method 3: crosstab (PostgreSQL)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span>
<span class=k>FROM</span><span class=w> </span><span class=n>crosstab</span><span class=p>(</span>
<span class=w>    </span><span class=s1>&#39;SELECT product, quarter, amount FROM sales ORDER BY 1,2&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=s1>&#39;SELECT DISTINCT quarter FROM sales ORDER BY 1&#39;</span>
<span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>ct</span><span class=p>(</span><span class=n>product</span><span class=w> </span><span class=nb>text</span><span class=p>,</span><span class=w> </span><span class=n>Q1</span><span class=w> </span><span class=nb>numeric</span><span class=p>,</span><span class=w> </span><span class=n>Q2</span><span class=w> </span><span class=nb>numeric</span><span class=p>,</span><span class=w> </span><span class=n>Q3</span><span class=w> </span><span class=nb>numeric</span><span class=p>,</span><span class=w> </span><span class=n>Q4</span><span class=w> </span><span class=nb>numeric</span><span class=p>);</span>
</code></pre></div> <p><strong>Unpivot: Columns to Rows</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Original: product | Q1 | Q2 | Q3 | Q4</span>
<span class=c1>-- Want: product | quarter | amount</span>

<span class=c1>-- Method 1: UNION ALL (Works everywhere)</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>product</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Q1&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>quarter</span><span class=p>,</span><span class=w> </span><span class=n>Q1</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>quarterly_sales</span>
<span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>product</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Q2&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>quarter</span><span class=p>,</span><span class=w> </span><span class=n>Q2</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>quarterly_sales</span>
<span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>product</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Q3&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>quarter</span><span class=p>,</span><span class=w> </span><span class=n>Q3</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>quarterly_sales</span>
<span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>product</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Q4&#39;</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>quarter</span><span class=p>,</span><span class=w> </span><span class=n>Q4</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>quarterly_sales</span><span class=p>;</span>

<span class=c1>-- Method 2: UNPIVOT (SQL Server)</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>product</span><span class=p>,</span><span class=w> </span><span class=n>quarter</span><span class=p>,</span><span class=w> </span><span class=n>amount</span>
<span class=k>FROM</span><span class=w> </span><span class=n>quarterly_sales</span>
<span class=n>UNPIVOT</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>amount</span><span class=w> </span><span class=k>FOR</span><span class=w> </span><span class=n>quarter</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=n>Q1</span><span class=p>,</span><span class=w> </span><span class=n>Q2</span><span class=p>,</span><span class=w> </span><span class=n>Q3</span><span class=p>,</span><span class=w> </span><span class=n>Q4</span><span class=p>)</span>
<span class=p>)</span><span class=w> </span><span class=n>unpvt</span><span class=p>;</span>

<span class=c1>-- Method 3: LATERAL + VALUES (PostgreSQL)</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>qs</span><span class=p>.</span><span class=n>product</span><span class=p>,</span><span class=w> </span><span class=n>t</span><span class=p>.</span><span class=n>quarter</span><span class=p>,</span><span class=w> </span><span class=n>t</span><span class=p>.</span><span class=n>amount</span>
<span class=k>FROM</span><span class=w> </span><span class=n>quarterly_sales</span><span class=w> </span><span class=n>qs</span>
<span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>LATERAL</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Q1&#39;</span><span class=p>,</span><span class=w> </span><span class=n>qs</span><span class=p>.</span><span class=n>Q1</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Q2&#39;</span><span class=p>,</span><span class=w> </span><span class=n>qs</span><span class=p>.</span><span class=n>Q2</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Q3&#39;</span><span class=p>,</span><span class=w> </span><span class=n>qs</span><span class=p>.</span><span class=n>Q3</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;Q4&#39;</span><span class=p>,</span><span class=w> </span><span class=n>qs</span><span class=p>.</span><span class=n>Q4</span><span class=p>)</span>
<span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>t</span><span class=p>(</span><span class=n>quarter</span><span class=p>,</span><span class=w> </span><span class=n>amount</span><span class=p>);</span>
</code></pre></div> <p><strong>Dynamic Pivot (Variable columns):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- PostgreSQL with dynamic SQL</span>
<span class=k>DO</span><span class=w> </span><span class=err>$$</span>
<span class=k>DECLARE</span>
<span class=w>    </span><span class=n>sql_query</span><span class=w> </span><span class=nb>text</span><span class=p>;</span>
<span class=w>    </span><span class=n>quarters</span><span class=w> </span><span class=nb>text</span><span class=p>;</span>
<span class=k>BEGIN</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>string_agg</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span>
<span class=w>        </span><span class=s1>&#39;SUM(CASE WHEN quarter = &#39;&#39;&#39;</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>quarter</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39;&#39;&#39; THEN amount END) as &#39;</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>quarter</span><span class=p>,</span>
<span class=w>        </span><span class=s1>&#39;, &#39;</span><span class=p>)</span>
<span class=w>    </span><span class=k>INTO</span><span class=w> </span><span class=n>quarters</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>sales</span><span class=p>;</span>

<span class=w>    </span><span class=n>sql_query</span><span class=w> </span><span class=p>:</span><span class=o>=</span><span class=w> </span><span class=s1>&#39;SELECT product, &#39;</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>quarters</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39; FROM sales GROUP BY product&#39;</span><span class=p>;</span>
<span class=w>    </span><span class=k>EXECUTE</span><span class=w> </span><span class=n>sql_query</span><span class=p>;</span>
<span class=k>END</span><span class=w> </span><span class=err>$$</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Advanced data transformation skills.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses CASE/GROUP BY as universal solution</li> <li>Knows DB-specific syntax (PIVOT, crosstab)</li> <li>Can handle dynamic column lists</li> <li>Mentions: "UNION ALL for unpivot works everywhere"</li> </ul> </div> </details> <hr> <h3 id=explain-query-optimization-and-execution-plans-google-amazon-interview-question>Explain Query Optimization and Execution Plans - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Performance</code>, <code>Query Optimization</code>, <code>EXPLAIN</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>Reading Execution Plans:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- PostgreSQL</span>
<span class=k>EXPLAIN</span><span class=w> </span><span class=k>ANALYZE</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;test@example.com&#39;</span><span class=p>;</span>

<span class=c1>-- MySQL</span>
<span class=k>EXPLAIN</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;test@example.com&#39;</span><span class=p>;</span>

<span class=c1>-- SQL Server</span>
<span class=k>SET</span><span class=w> </span><span class=n>SHOWPLAN_ALL</span><span class=w> </span><span class=k>ON</span><span class=p>;</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;test@example.com&#39;</span><span class=p>;</span>
</code></pre></div> <p><strong>Key Operations (Good vs Bad):</strong></p> <table> <thead> <tr> <th>Operation</th> <th>Good/Bad</th> <th>Meaning</th> </tr> </thead> <tbody> <tr> <td>Index Scan</td> <td>Good</td> <td>Using index</td> </tr> <tr> <td>Index Only Scan</td> <td>Best</td> <td>All data from index</td> </tr> <tr> <td>Seq Scan</td> <td>Bad*</td> <td>Full table scan</td> </tr> <tr> <td>Nested Loop</td> <td>Depends</td> <td>OK for small tables</td> </tr> <tr> <td>Hash Join</td> <td>Good</td> <td>Efficient for larger tables</td> </tr> <tr> <td>Sort</td> <td>Expensive</td> <td>Consider index</td> </tr> </tbody> </table> <p><strong>Common Optimization Techniques:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- 1. Add appropriate indexes</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_email</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>users</span><span class=p>(</span><span class=n>email</span><span class=p>);</span>

<span class=c1>-- 2. Avoid SELECT *</span>
<span class=c1>-- ‚ùå Bad</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=c1>-- ‚úÖ Good</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>

<span class=c1>-- 3. Avoid functions on indexed columns</span>
<span class=c1>-- ‚ùå Breaks index</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>YEAR</span><span class=p>(</span><span class=n>created_at</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2024</span><span class=p>;</span>
<span class=c1>-- ‚úÖ Uses index</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span>
<span class=k>WHERE</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=s1>&#39;2025-01-01&#39;</span><span class=p>;</span>

<span class=c1>-- 4. Use EXISTS instead of IN for large sets</span>
<span class=c1>-- ‚ùå Slower</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>active</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
<span class=c1>-- ‚úÖ Faster</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=n>o</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>customer_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>active</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>

<span class=c1>-- 5. Limit results early</span>
<span class=c1>-- ‚ùå Sort everything, then limit</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>huge_table</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=k>DESC</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>10</span><span class=p>;</span>
<span class=c1>-- Better with index on created_at</span>

<span class=c1>-- 6. Avoid OR on different columns</span>
<span class=c1>-- ‚ùå Can&#39;t use single index</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;a@b.com&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=n>phone</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;123&#39;</span><span class=p>;</span>
<span class=c1>-- ‚úÖ Use UNION</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;a@b.com&#39;</span>
<span class=k>UNION</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>phone</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;123&#39;</span><span class=p>;</span>
</code></pre></div> <p><strong>Execution Plan Metrics:</strong></p> <div class=highlight><pre><span></span><code><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYZE</span><span class=p>,</span><span class=w> </span><span class=n>BUFFERS</span><span class=p>,</span><span class=w> </span><span class=n>FORMAT</span><span class=w> </span><span class=nb>TEXT</span><span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>123</span><span class=p>;</span>

<span class=c1>-- Key metrics:</span>
<span class=c1>-- - actual time: execution time</span>
<span class=c1>-- - rows: rows processed</span>
<span class=c1>-- - loops: number of iterations</span>
<span class=c1>-- - buffers: memory/disk reads</span>
<span class=c1>-- - cost: estimated query cost</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Performance debugging skills.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Can read EXPLAIN output</li> <li>Knows when Seq Scan is actually OK (small tables)</li> <li>Gives specific optimizations (indexes, avoiding functions)</li> <li>Mentions: "Always test with production-like data volumes"</li> </ul> </div> </details> <hr> <h3 id=what-are-subqueries-correlated-vs-non-correlated-google-amazon-interview-question>What Are Subqueries? Correlated vs Non-Correlated - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Subqueries</code>, <code>Query Optimization</code>, <code>SQL Basics</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>What Are Subqueries?</strong></p> <p>A subquery is a query nested inside another query. They can appear in SELECT, FROM, WHERE, or HAVING clauses.</p> <p><strong>Non-Correlated Subquery:</strong></p> <p>Executed once, independently of the outer query.</p> <div class=highlight><pre><span></span><code><span class=c1>-- Find employees with salary above average</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>salary</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w>  </span><span class=c1>-- Runs once</span>
<span class=p>);</span>

<span class=c1>-- Find products in categories with high sales</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>product_name</span>
<span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>category_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>category_id</span><span class=w> </span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>categories</span><span class=w> </span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>total_sales</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1000000</span>
<span class=p>);</span>
</code></pre></div> <p><strong>Correlated Subquery:</strong></p> <p>References outer query, executed once per outer row (usually slower).</p> <div class=highlight><pre><span></span><code><span class=c1>-- Find employees earning above their department average</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>salary</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>department_id</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>salary</span><span class=p>)</span><span class=w> </span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>department_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>department_id</span><span class=w>  </span><span class=c1>-- References outer row</span>
<span class=p>);</span>

<span class=c1>-- Equivalent using window function (often faster)</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>salary</span><span class=p>,</span><span class=w> </span><span class=n>department_id</span>
<span class=k>FROM</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=p>,</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>department_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>dept_avg</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=p>)</span><span class=w> </span><span class=n>sub</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>dept_avg</span><span class=p>;</span>
</code></pre></div> <p><strong>Subqueries in Different Clauses:</strong></p> <table> <thead> <tr> <th>Clause</th> <th>Example Use</th> </tr> </thead> <tbody> <tr> <td>WHERE</td> <td>Filter based on subquery result</td> </tr> <tr> <td>FROM</td> <td>Derived table (inline view)</td> </tr> <tr> <td>SELECT</td> <td>Scalar subquery for computed column</td> </tr> <tr> <td>HAVING</td> <td>Filter groups based on subquery</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Query composition skills.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows correlated subqueries run per-row (performance impact)</li> <li>Can rewrite correlated subqueries as JOINs or window functions</li> <li>Uses EXISTS for existence checks (not IN for large sets)</li> <li>Mentions: "Non-correlated is like a constant, correlated is like a loop"</li> </ul> </div> </details> <hr> <h3 id=explain-case-statements-in-sql-most-tech-companies-interview-question>Explain CASE Statements in SQL - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Conditional Logic</code>, <code>CASE</code>, <code>SQL Basics</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>What is CASE?</strong></p> <p>CASE provides conditional logic in SQL, similar to if-else in programming.</p> <p><strong>Simple CASE:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Compare to specific values</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>order_id</span><span class=p>,</span>
<span class=w>    </span><span class=n>status</span><span class=p>,</span>
<span class=w>    </span><span class=k>CASE</span><span class=w> </span><span class=n>status</span>
<span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;pending&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Awaiting Processing&#39;</span>
<span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;shipped&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;On the Way&#39;</span>
<span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;delivered&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Complete&#39;</span>
<span class=w>        </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;Unknown&#39;</span>
<span class=w>    </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>status_description</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=p>;</span>
</code></pre></div> <p><strong>Searched CASE (more flexible):</strong></p> <div class=highlight><pre><span></span><code><span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>name</span><span class=p>,</span>
<span class=w>    </span><span class=n>salary</span><span class=p>,</span>
<span class=w>    </span><span class=k>CASE</span><span class=w> </span>
<span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>150000</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Executive&#39;</span>
<span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>100000</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Senior&#39;</span>
<span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>70000</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;Mid-Level&#39;</span>
<span class=w>        </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;Junior&#39;</span>
<span class=w>    </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>level</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=p>;</span>
</code></pre></div> <p><strong>CASE with Aggregation:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Pivot-like behavior</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>department</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>gender</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;M&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>male_count</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>gender</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;F&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>female_count</span><span class=p>,</span>
<span class=w>    </span><span class=k>AVG</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;active&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_active_salary</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>department</span><span class=p>;</span>

<span class=c1>-- Conditional aggregation for metrics</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>DATE_TRUNC</span><span class=p>(</span><span class=s1>&#39;month&#39;</span><span class=p>,</span><span class=w> </span><span class=n>order_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>month</span><span class=p>,</span>
<span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>total_orders</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;returned&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>returns</span><span class=p>,</span>
<span class=w>    </span><span class=n>ROUND</span><span class=p>(</span><span class=mi>100</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;returned&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>),</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>return_rate</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</code></pre></div> <p><strong>CASE in ORDER BY:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Custom sort order</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>tickets</span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span>
<span class=w>    </span><span class=k>CASE</span><span class=w> </span><span class=n>priority</span>
<span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;critical&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span>
<span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;high&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>2</span>
<span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;medium&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>3</span>
<span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=s1>&#39;low&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>4</span>
<span class=w>    </span><span class=k>END</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Conditional logic in SQL.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses CASE for pivot-like aggregations</li> <li>Knows CASE returns NULL if no ELSE and no match</li> <li>Uses in ORDER BY for custom sorting</li> <li>Combines with aggregation functions effectively</li> </ul> </div> </details> <hr> <h3 id=how-do-you-work-with-dates-in-sql-amazon-google-interview-question>How Do You Work with Dates in SQL? - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Date Functions</code>, <code>Temporal Data</code>, <code>Data Manipulation</code> | <strong>Asked by:</strong> Amazon, Google, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>Common Date Functions (PostgreSQL/Standard):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Current date/time</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=k>CURRENT_DATE</span><span class=p>,</span><span class=w>                    </span><span class=c1>-- 2024-12-10</span>
<span class=w>    </span><span class=k>CURRENT_TIMESTAMP</span><span class=p>,</span><span class=w>               </span><span class=c1>-- 2024-12-10 14:30:00</span>
<span class=w>    </span><span class=n>NOW</span><span class=p>();</span><span class=w>                           </span><span class=c1>-- Same as CURRENT_TIMESTAMP</span>

<span class=c1>-- Extract components</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=k>EXTRACT</span><span class=p>(</span><span class=k>YEAR</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>order_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>year</span><span class=p>,</span>
<span class=w>    </span><span class=k>EXTRACT</span><span class=p>(</span><span class=k>MONTH</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>order_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>month</span><span class=p>,</span>
<span class=w>    </span><span class=k>EXTRACT</span><span class=p>(</span><span class=n>DOW</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>order_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>day_of_week</span><span class=p>,</span><span class=w>  </span><span class=c1>-- 0=Sunday</span>
<span class=w>    </span><span class=n>DATE_PART</span><span class=p>(</span><span class=s1>&#39;quarter&#39;</span><span class=p>,</span><span class=w> </span><span class=n>order_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>quarter</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=p>;</span>

<span class=c1>-- Truncate to period</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>DATE_TRUNC</span><span class=p>(</span><span class=s1>&#39;month&#39;</span><span class=p>,</span><span class=w> </span><span class=n>order_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>month_start</span><span class=p>,</span>
<span class=w>    </span><span class=n>DATE_TRUNC</span><span class=p>(</span><span class=s1>&#39;week&#39;</span><span class=p>,</span><span class=w> </span><span class=n>order_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>week_start</span><span class=p>,</span>
<span class=w>    </span><span class=n>DATE_TRUNC</span><span class=p>(</span><span class=s1>&#39;hour&#39;</span><span class=p>,</span><span class=w> </span><span class=n>created_at</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>hour</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=p>;</span>

<span class=c1>-- Date arithmetic</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>order_date</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>&#39;7 days&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>one_week_later</span><span class=p>,</span>
<span class=w>    </span><span class=n>order_date</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>&#39;1 month&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>one_month_ago</span><span class=p>,</span>
<span class=w>    </span><span class=n>AGE</span><span class=p>(</span><span class=n>NOW</span><span class=p>(),</span><span class=w> </span><span class=n>order_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>time_since_order</span><span class=p>,</span>
<span class=w>    </span><span class=n>order_date</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>::</span><span class=nb>DATE</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_into_year</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=p>;</span>
</code></pre></div> <p><strong>MySQL Differences:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- MySQL specific</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>DATE_FORMAT</span><span class=p>(</span><span class=n>order_date</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;%Y-%m&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>month</span><span class=p>,</span>
<span class=w>    </span><span class=n>DATEDIFF</span><span class=p>(</span><span class=n>NOW</span><span class=p>(),</span><span class=w> </span><span class=n>order_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_ago</span><span class=p>,</span>
<span class=w>    </span><span class=n>DATE_ADD</span><span class=p>(</span><span class=n>order_date</span><span class=p>,</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=mi>7</span><span class=w> </span><span class=k>DAY</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>week_later</span><span class=p>,</span>
<span class=w>    </span><span class=k>YEAR</span><span class=p>(</span><span class=n>order_date</span><span class=p>),</span><span class=w> </span><span class=k>MONTH</span><span class=p>(</span><span class=n>order_date</span><span class=p>),</span><span class=w> </span><span class=k>DAY</span><span class=p>(</span><span class=n>order_date</span><span class=p>);</span>
</code></pre></div> <p><strong>Common Date Queries:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Last 30 days</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>order_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>&#39;30 days&#39;</span><span class=p>;</span>

<span class=c1>-- Same period last year (Year-over-Year)</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>DATE_TRUNC</span><span class=p>(</span><span class=s1>&#39;month&#39;</span><span class=p>,</span><span class=w> </span><span class=n>order_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>month</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>revenue</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>order_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>&#39;1 year&#39;</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>

<span class=c1>-- First day of month, last day of month</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>DATE_TRUNC</span><span class=p>(</span><span class=s1>&#39;month&#39;</span><span class=p>,</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>first_day</span><span class=p>,</span>
<span class=w>    </span><span class=p>(</span><span class=n>DATE_TRUNC</span><span class=p>(</span><span class=s1>&#39;month&#39;</span><span class=p>,</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>&#39;1 month&#39;</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>&#39;1 day&#39;</span><span class=p>)::</span><span class=nb>DATE</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>last_day</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Temporal data handling.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows DATE_TRUNC for period grouping</li> <li>Handles timezone awareness</li> <li>Uses INTERVAL for date arithmetic</li> <li>Knows differences between PostgreSQL and MySQL</li> </ul> </div> </details> <hr> <h3 id=how-do-you-handle-null-values-in-sql-most-tech-companies-interview-question>How Do You Handle NULL Values in SQL? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>NULL Handling</code>, <code>COALESCE</code>, <code>Data Quality</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>Understanding NULL:</strong></p> <p>NULL represents missing or unknown data. NULL is not equal to anything, including itself.</p> <div class=highlight><pre><span></span><code><span class=c1>-- NULL comparisons</span>
<span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span><span class=w>      </span><span class=c1>-- NULL (not TRUE or FALSE)</span>
<span class=k>SELECT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span><span class=w>   </span><span class=c1>-- NULL (not TRUE)</span>
<span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span><span class=w>     </span><span class=c1>-- FALSE</span>
<span class=k>SELECT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span><span class=w>  </span><span class=c1>-- TRUE</span>

<span class=c1>-- NULL in arithmetic</span>
<span class=k>SELECT</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span><span class=w>      </span><span class=c1>-- NULL (NULL propagates)</span>
<span class=k>SELECT</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span><span class=w>      </span><span class=c1>-- NULL</span>
</code></pre></div> <p><strong>Checking for NULL:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- IS NULL / IS NOT NULL</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span>

<span class=c1>-- Don&#39;t use = NULL (won&#39;t work)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Returns nothing!</span>
</code></pre></div> <p><strong>Handling NULL Values:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- COALESCE: Return first non-NULL</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>name</span><span class=p>,</span>
<span class=w>    </span><span class=k>COALESCE</span><span class=p>(</span><span class=n>phone</span><span class=p>,</span><span class=w> </span><span class=n>email</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;No contact&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>contact</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=p>;</span>

<span class=c1>-- NULLIF: Return NULL if values equal</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>revenue</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=k>NULLIF</span><span class=p>(</span><span class=n>costs</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>profit_margin</span><span class=w>  </span><span class=c1>-- Avoid division by zero</span>
<span class=k>FROM</span><span class=w> </span><span class=n>financials</span><span class=p>;</span>

<span class=c1>-- CASE for NULL</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>name</span><span class=p>,</span>
<span class=w>    </span><span class=k>CASE</span><span class=w> </span>
<span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>bonus</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>0</span>
<span class=w>        </span><span class=k>ELSE</span><span class=w> </span><span class=n>bonus</span>
<span class=w>    </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>bonus_amount</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=p>;</span>

<span class=c1>-- NVL (Oracle) / IFNULL (MySQL)</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>NVL</span><span class=p>(</span><span class=n>commission</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sales</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Oracle</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>IFNULL</span><span class=p>(</span><span class=n>commission</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>sales</span><span class=p>;</span><span class=w>  </span><span class=c1>-- MySQL</span>
</code></pre></div> <p><strong>NULL in Aggregations:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- COUNT ignores NULL</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>total_rows</span><span class=p>,</span><span class=w>       </span><span class=c1>-- Counts all rows</span>
<span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=n>email</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>with_email</span><span class=p>,</span><span class=w>   </span><span class=c1>-- Ignores NULL emails</span>
<span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>email</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>unique_emails</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=p>;</span>

<span class=c1>-- AVG, SUM ignore NULL</span>
<span class=k>SELECT</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=p>;</span><span class=w>  </span><span class=c1>-- NULLs excluded from calculation</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Data quality awareness.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows NULL != NULL (uses IS NULL)</li> <li>Uses COALESCE for defaults</li> <li>Uses NULLIF to prevent division by zero</li> <li>Understands NULL behavior in aggregations</li> </ul> </div> </details> <hr> <h3 id=explain-group-by-and-aggregation-best-practices-google-amazon-interview-question>Explain GROUP BY and Aggregation Best Practices - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Aggregation</code>, <code>GROUP BY</code>, <code>SQL Basics</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>GROUP BY Basics:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Basic grouping</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>department</span><span class=p>,</span>
<span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>employee_count</span><span class=p>,</span>
<span class=w>    </span><span class=k>AVG</span><span class=p>(</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_salary</span><span class=p>,</span>
<span class=w>    </span><span class=k>MAX</span><span class=p>(</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>max_salary</span><span class=p>,</span>
<span class=w>    </span><span class=k>MIN</span><span class=p>(</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>min_salary</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>total_payroll</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>department</span><span class=p>;</span>

<span class=c1>-- Multiple columns</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>department</span><span class=p>,</span>
<span class=w>    </span><span class=n>job_title</span><span class=p>,</span>
<span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>count</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>department</span><span class=p>,</span><span class=w> </span><span class=n>job_title</span><span class=p>;</span>

<span class=c1>-- With expressions</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>DATE_TRUNC</span><span class=p>(</span><span class=s1>&#39;month&#39;</span><span class=p>,</span><span class=w> </span><span class=n>order_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>month</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>revenue</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>DATE_TRUNC</span><span class=p>(</span><span class=s1>&#39;month&#39;</span><span class=p>,</span><span class=w> </span><span class=n>order_date</span><span class=p>);</span>
<span class=c1>-- Or use column alias position</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</code></pre></div> <p><strong>HAVING vs WHERE:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- WHERE filters rows BEFORE grouping</span>
<span class=c1>-- HAVING filters groups AFTER aggregation</span>

<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>department</span><span class=p>,</span>
<span class=w>    </span><span class=k>AVG</span><span class=p>(</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_salary</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;active&#39;</span><span class=w>         </span><span class=c1>-- Filter rows first</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>department</span>
<span class=k>HAVING</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>salary</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>75000</span><span class=p>;</span><span class=w>     </span><span class=c1>-- Filter aggregated results</span>
</code></pre></div> <p><strong>Advanced Aggregations:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Multiple aggregations with CASE</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>department</span><span class=p>,</span>
<span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;active&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>active_count</span><span class=p>,</span>
<span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;inactive&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>inactive_count</span><span class=p>,</span>
<span class=w>    </span><span class=n>ROUND</span><span class=p>(</span><span class=mi>100</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;active&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>),</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>active_pct</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>department</span><span class=p>;</span>

<span class=c1>-- ROLLUP for subtotals</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=k>COALESCE</span><span class=p>(</span><span class=n>region</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Total&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>region</span><span class=p>,</span>
<span class=w>    </span><span class=k>COALESCE</span><span class=p>(</span><span class=n>country</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Subtotal&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>country</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>sales</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>total_sales</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>ROLLUP</span><span class=p>(</span><span class=n>region</span><span class=p>,</span><span class=w> </span><span class=n>country</span><span class=p>);</span>

<span class=c1>-- GROUPING SETS for multiple groupings</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>region</span><span class=p>,</span><span class=w> </span><span class=n>product</span><span class=p>,</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>sales</span><span class=p>)</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>GROUPING</span><span class=w> </span><span class=k>SETS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=p>(</span><span class=n>region</span><span class=p>,</span><span class=w> </span><span class=n>product</span><span class=p>),</span>
<span class=w>    </span><span class=p>(</span><span class=n>region</span><span class=p>),</span>
<span class=w>    </span><span class=p>()</span><span class=w>  </span><span class=c1>-- Grand total</span>
<span class=p>);</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Data aggregation skills.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows HAVING filters after GROUP BY</li> <li>Uses positional GROUP BY (GROUP BY 1) appropriately</li> <li>Knows ROLLUP/CUBE for subtotals</li> <li>Combines CASE with aggregation</li> </ul> </div> </details> <hr> <h3 id=what-are-stored-procedures-and-functions-oracle-microsoft-interview-question>What Are Stored Procedures and Functions? - Oracle, Microsoft Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Stored Procedures</code>, <code>Functions</code>, <code>Database Programming</code> | <strong>Asked by:</strong> Oracle, Microsoft, IBM, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>Stored Procedure vs Function:</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>Stored Procedure</th> <th>Function</th> </tr> </thead> <tbody> <tr> <td>Returns</td> <td>Can return 0, 1, or multiple values</td> <td>Must return exactly 1 value</td> </tr> <tr> <td>Use in SQL</td> <td>Cannot use in SELECT</td> <td>Can use in SELECT</td> </tr> <tr> <td>Side effects</td> <td>Can modify data</td> <td>Usually read-only</td> </tr> <tr> <td>Call syntax</td> <td>CALL/EXECUTE</td> <td>Part of expression</td> </tr> </tbody> </table> <p><strong>Creating a Stored Procedure (PostgreSQL):</strong></p> <div class=highlight><pre><span></span><code><span class=k>CREATE</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>REPLACE</span><span class=w> </span><span class=k>PROCEDURE</span><span class=w> </span><span class=n>update_employee_salary</span><span class=p>(</span>
<span class=w>    </span><span class=n>emp_id</span><span class=w> </span><span class=nb>INTEGER</span><span class=p>,</span>
<span class=w>    </span><span class=n>new_salary</span><span class=w> </span><span class=nb>NUMERIC</span>
<span class=p>)</span>
<span class=k>LANGUAGE</span><span class=w> </span><span class=n>plpgsql</span>
<span class=k>AS</span><span class=w> </span><span class=err>$$</span>
<span class=k>BEGIN</span>
<span class=w>    </span><span class=k>UPDATE</span><span class=w> </span><span class=n>employees</span>
<span class=w>    </span><span class=k>SET</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>new_salary</span><span class=p>,</span>
<span class=w>        </span><span class=n>updated_at</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>NOW</span><span class=p>()</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>emp_id</span><span class=p>;</span>

<span class=w>    </span><span class=k>IF</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>FOUND</span><span class=w> </span><span class=k>THEN</span>
<span class=w>        </span><span class=n>RAISE</span><span class=w> </span><span class=k>EXCEPTION</span><span class=w> </span><span class=s1>&#39;Employee % not found&#39;</span><span class=p>,</span><span class=w> </span><span class=n>emp_id</span><span class=p>;</span>
<span class=w>    </span><span class=k>END</span><span class=w> </span><span class=k>IF</span><span class=p>;</span>
<span class=k>END</span><span class=p>;</span>
<span class=err>$$</span><span class=p>;</span>

<span class=c1>-- Call the procedure</span>
<span class=k>CALL</span><span class=w> </span><span class=n>update_employee_salary</span><span class=p>(</span><span class=mi>123</span><span class=p>,</span><span class=w> </span><span class=mi>75000</span><span class=p>);</span>
</code></pre></div> <p><strong>Creating a Function:</strong></p> <div class=highlight><pre><span></span><code><span class=k>CREATE</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>REPLACE</span><span class=w> </span><span class=k>FUNCTION</span><span class=w> </span><span class=n>calculate_bonus</span><span class=p>(</span>
<span class=w>    </span><span class=n>salary</span><span class=w> </span><span class=nb>NUMERIC</span><span class=p>,</span>
<span class=w>    </span><span class=n>performance_rating</span><span class=w> </span><span class=nb>INTEGER</span>
<span class=p>)</span>
<span class=k>RETURNS</span><span class=w> </span><span class=nb>NUMERIC</span>
<span class=k>LANGUAGE</span><span class=w> </span><span class=n>plpgsql</span>
<span class=k>AS</span><span class=w> </span><span class=err>$$</span>
<span class=k>BEGIN</span>
<span class=w>    </span><span class=k>RETURN</span><span class=w> </span><span class=k>CASE</span><span class=w> </span>
<span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>performance_rating</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>20</span>
<span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>performance_rating</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>15</span>
<span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>performance_rating</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>10</span>
<span class=w>        </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span>
<span class=w>    </span><span class=k>END</span><span class=p>;</span>
<span class=k>END</span><span class=p>;</span>
<span class=err>$$</span><span class=p>;</span>

<span class=c1>-- Use in query</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>name</span><span class=p>,</span>
<span class=w>    </span><span class=n>salary</span><span class=p>,</span>
<span class=w>    </span><span class=n>calculate_bonus</span><span class=p>(</span><span class=n>salary</span><span class=p>,</span><span class=w> </span><span class=n>performance_rating</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>bonus</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=p>;</span>
</code></pre></div> <p><strong>When to Use:</strong></p> <table> <thead> <tr> <th>Use Procedure</th> <th>Use Function</th> </tr> </thead> <tbody> <tr> <td>Data modification</td> <td>Calculations</td> </tr> <tr> <td>Complex transactions</td> <td>Value lookup</td> </tr> <tr> <td>Administrative tasks</td> <td>Use in SELECT</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Database programming knowledge.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows procedures can have side effects, functions shouldn't</li> <li>Mentions security: SECURITY DEFINER vs INVOKER</li> <li>Knows performance implications (network round trips)</li> <li>Mentions: "Functions in WHERE can prevent index usage"</li> </ul> </div> </details> <hr> <h3 id=what-are-views-when-should-you-use-them-most-tech-companies-interview-question>What Are Views? When Should You Use Them? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Views</code>, <code>Database Design</code>, <code>Abstraction</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>What is a View?</strong></p> <p>A view is a virtual table defined by a SQL query. It doesn't store data, just the query definition.</p> <p><strong>Creating Views:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Simple view</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>active_employees</span><span class=w> </span><span class=k>AS</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>email</span><span class=p>,</span><span class=w> </span><span class=n>department</span>
<span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;active&#39;</span><span class=p>;</span>

<span class=c1>-- Use like a table</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>active_employees</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>department</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Engineering&#39;</span><span class=p>;</span>

<span class=c1>-- Complex view with joins</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>order_summary</span><span class=w> </span><span class=k>AS</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>o</span><span class=p>.</span><span class=n>id</span><span class=p>,</span>
<span class=w>    </span><span class=n>o</span><span class=p>.</span><span class=n>order_date</span><span class=p>,</span>
<span class=w>    </span><span class=k>c</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>customer_name</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>oi</span><span class=p>.</span><span class=n>quantity</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>oi</span><span class=p>.</span><span class=n>unit_price</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>total_amount</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=n>o</span>
<span class=k>JOIN</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>id</span>
<span class=k>JOIN</span><span class=w> </span><span class=n>order_items</span><span class=w> </span><span class=n>oi</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>oi</span><span class=p>.</span><span class=n>order_id</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>order_date</span><span class=p>,</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>name</span><span class=p>;</span>
</code></pre></div> <p><strong>Materialized View (PostgreSQL):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Stores actual data, needs refresh</span>
<span class=k>CREATE</span><span class=w> </span><span class=n>MATERIALIZED</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>monthly_sales</span><span class=w> </span><span class=k>AS</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>DATE_TRUNC</span><span class=p>(</span><span class=s1>&#39;month&#39;</span><span class=p>,</span><span class=w> </span><span class=n>order_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>month</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>total_sales</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>

<span class=c1>-- Refresh data</span>
<span class=n>REFRESH</span><span class=w> </span><span class=n>MATERIALIZED</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>monthly_sales</span><span class=p>;</span>
<span class=n>REFRESH</span><span class=w> </span><span class=n>MATERIALIZED</span><span class=w> </span><span class=k>VIEW</span><span class=w> </span><span class=n>CONCURRENTLY</span><span class=w> </span><span class=n>monthly_sales</span><span class=p>;</span><span class=w>  </span><span class=c1>-- No blocking</span>
</code></pre></div> <p><strong>Benefits:</strong></p> <table> <thead> <tr> <th>Benefit</th> <th>Explanation</th> </tr> </thead> <tbody> <tr> <td>Abstraction</td> <td>Hide complex joins</td> </tr> <tr> <td>Security</td> <td>Expose subset of columns</td> </tr> <tr> <td>Simplicity</td> <td>Reusable query logic</td> </tr> <tr> <td>Backward compatibility</td> <td>Change underlying structure</td> </tr> </tbody> </table> <p><strong>Drawbacks:</strong></p> <table> <thead> <tr> <th>Drawback</th> <th>Explanation</th> </tr> </thead> <tbody> <tr> <td>Performance</td> <td>Views aren't always optimized</td> </tr> <tr> <td>Updates</td> <td>Complex views may not be updatable</td> </tr> <tr> <td>Maintenance</td> <td>Cascading dependencies</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Database design understanding.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows views are virtual (re-executed each time)</li> <li>Mentions materialized views for performance</li> <li>Uses views for security (column-level access)</li> <li>Knows updatable view requirements</li> </ul> </div> </details> <hr> <h3 id=what-are-triggers-in-sql-oracle-microsoft-interview-question>What Are Triggers in SQL? - Oracle, Microsoft Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Triggers</code>, <code>Automation</code>, <code>Database Programming</code> | <strong>Asked by:</strong> Oracle, Microsoft, IBM</p> <details class=success> <summary>View Answer</summary> <p><strong>What Are Triggers?</strong></p> <p>Triggers are special procedures that automatically execute in response to specific events on a table (INSERT, UPDATE, DELETE).</p> <p><strong>Creating Triggers (PostgreSQL):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Audit trigger</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>REPLACE</span><span class=w> </span><span class=k>FUNCTION</span><span class=w> </span><span class=n>audit_employee_changes</span><span class=p>()</span>
<span class=k>RETURNS</span><span class=w> </span><span class=k>TRIGGER</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=err>$$</span>
<span class=k>BEGIN</span>
<span class=w>    </span><span class=k>IF</span><span class=w> </span><span class=n>TG_OP</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;INSERT&#39;</span><span class=w> </span><span class=k>THEN</span>
<span class=w>        </span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>employee_audit</span><span class=w> </span><span class=p>(</span><span class=n>action</span><span class=p>,</span><span class=w> </span><span class=n>employee_id</span><span class=p>,</span><span class=w> </span><span class=n>new_data</span><span class=p>,</span><span class=w> </span><span class=n>changed_at</span><span class=p>)</span>
<span class=w>        </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;INSERT&#39;</span><span class=p>,</span><span class=w> </span><span class=k>NEW</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>row_to_json</span><span class=p>(</span><span class=k>NEW</span><span class=p>),</span><span class=w> </span><span class=n>NOW</span><span class=p>());</span>
<span class=w>    </span><span class=k>ELSIF</span><span class=w> </span><span class=n>TG_OP</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;UPDATE&#39;</span><span class=w> </span><span class=k>THEN</span>
<span class=w>        </span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>employee_audit</span><span class=w> </span><span class=p>(</span><span class=n>action</span><span class=p>,</span><span class=w> </span><span class=n>employee_id</span><span class=p>,</span><span class=w> </span><span class=n>old_data</span><span class=p>,</span><span class=w> </span><span class=n>new_data</span><span class=p>,</span><span class=w> </span><span class=n>changed_at</span><span class=p>)</span>
<span class=w>        </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;UPDATE&#39;</span><span class=p>,</span><span class=w> </span><span class=k>NEW</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>row_to_json</span><span class=p>(</span><span class=k>OLD</span><span class=p>),</span><span class=w> </span><span class=n>row_to_json</span><span class=p>(</span><span class=k>NEW</span><span class=p>),</span><span class=w> </span><span class=n>NOW</span><span class=p>());</span>
<span class=w>    </span><span class=k>ELSIF</span><span class=w> </span><span class=n>TG_OP</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;DELETE&#39;</span><span class=w> </span><span class=k>THEN</span>
<span class=w>        </span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>employee_audit</span><span class=w> </span><span class=p>(</span><span class=n>action</span><span class=p>,</span><span class=w> </span><span class=n>employee_id</span><span class=p>,</span><span class=w> </span><span class=n>old_data</span><span class=p>,</span><span class=w> </span><span class=n>changed_at</span><span class=p>)</span>
<span class=w>        </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;DELETE&#39;</span><span class=p>,</span><span class=w> </span><span class=k>OLD</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>row_to_json</span><span class=p>(</span><span class=k>OLD</span><span class=p>),</span><span class=w> </span><span class=n>NOW</span><span class=p>());</span>
<span class=w>    </span><span class=k>END</span><span class=w> </span><span class=k>IF</span><span class=p>;</span>
<span class=w>    </span><span class=k>RETURN</span><span class=w> </span><span class=k>NEW</span><span class=p>;</span>
<span class=k>END</span><span class=p>;</span>
<span class=err>$$</span><span class=w> </span><span class=k>LANGUAGE</span><span class=w> </span><span class=n>plpgsql</span><span class=p>;</span>

<span class=k>CREATE</span><span class=w> </span><span class=k>TRIGGER</span><span class=w> </span><span class=n>employee_audit_trigger</span>
<span class=k>AFTER</span><span class=w> </span><span class=k>INSERT</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>UPDATE</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>DELETE</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>employees</span>
<span class=k>FOR</span><span class=w> </span><span class=k>EACH</span><span class=w> </span><span class=k>ROW</span>
<span class=k>EXECUTE</span><span class=w> </span><span class=k>FUNCTION</span><span class=w> </span><span class=n>audit_employee_changes</span><span class=p>();</span>
</code></pre></div> <p><strong>Trigger Types:</strong></p> <table> <thead> <tr> <th>Type</th> <th>When</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td>BEFORE</td> <td>Before row change</td> <td>Validation, modification</td> </tr> <tr> <td>AFTER</td> <td>After row change</td> <td>Audit, notifications</td> </tr> <tr> <td>INSTEAD OF</td> <td>Replace operation</td> <td>Updatable views</td> </tr> <tr> <td>FOR EACH ROW</td> <td>Per row</td> <td>Most common</td> </tr> <tr> <td>FOR EACH STATEMENT</td> <td>Per statement</td> <td>Batch operations</td> </tr> </tbody> </table> <p><strong>Common Use Cases:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Auto-update timestamp</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TRIGGER</span><span class=w> </span><span class=n>update_timestamp</span>
<span class=k>BEFORE</span><span class=w> </span><span class=k>UPDATE</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span>
<span class=k>FOR</span><span class=w> </span><span class=k>EACH</span><span class=w> </span><span class=k>ROW</span>
<span class=k>EXECUTE</span><span class=w> </span><span class=k>FUNCTION</span><span class=w> </span><span class=n>update_modified_column</span><span class=p>();</span>

<span class=k>CREATE</span><span class=w> </span><span class=k>FUNCTION</span><span class=w> </span><span class=n>update_modified_column</span><span class=p>()</span>
<span class=k>RETURNS</span><span class=w> </span><span class=k>TRIGGER</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=err>$$</span>
<span class=k>BEGIN</span>
<span class=w>    </span><span class=k>NEW</span><span class=p>.</span><span class=n>updated_at</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>NOW</span><span class=p>();</span>
<span class=w>    </span><span class=k>RETURN</span><span class=w> </span><span class=k>NEW</span><span class=p>;</span>
<span class=k>END</span><span class=p>;</span>
<span class=err>$$</span><span class=w> </span><span class=k>LANGUAGE</span><span class=w> </span><span class=n>plpgsql</span><span class=p>;</span>
</code></pre></div> <p><strong>Cautions:</strong></p> <ul> <li>Triggers add hidden complexity</li> <li>Can cause performance issues</li> <li>Debugging is harder</li> <li>May conflict with ORMs</li> </ul> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Advanced database knowledge.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows BEFORE vs AFTER timing</li> <li>Mentions audit logging use case</li> <li>Warns about hidden complexity</li> <li>Knows NEW/OLD row references</li> </ul> </div> </details> <hr> <h3 id=explain-transactions-and-isolation-levels-google-amazon-interview-question>Explain Transactions and Isolation Levels - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Transactions</code>, <code>Isolation Levels</code>, <code>Concurrency</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Oracle</p> <details class=success> <summary>View Answer</summary> <p><strong>What Are Transactions?</strong></p> <p>A transaction is a sequence of operations treated as a single unit. All succeed together or all fail together.</p> <div class=highlight><pre><span></span><code><span class=k>BEGIN</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Start transaction</span>

<span class=k>UPDATE</span><span class=w> </span><span class=n>accounts</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=n>balance</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>balance</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=k>UPDATE</span><span class=w> </span><span class=n>accounts</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=n>balance</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>balance</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>

<span class=k>COMMIT</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Make permanent</span>
<span class=c1>-- or ROLLBACK; to undo</span>
</code></pre></div> <p><strong>Isolation Levels:</strong></p> <table> <thead> <tr> <th>Level</th> <th>Dirty Read</th> <th>Non-Repeatable Read</th> <th>Phantom Read</th> </tr> </thead> <tbody> <tr> <td>READ UNCOMMITTED</td> <td>‚úÖ Possible</td> <td>‚úÖ Possible</td> <td>‚úÖ Possible</td> </tr> <tr> <td>READ COMMITTED</td> <td>‚ùå Prevented</td> <td>‚úÖ Possible</td> <td>‚úÖ Possible</td> </tr> <tr> <td>REPEATABLE READ</td> <td>‚ùå Prevented</td> <td>‚ùå Prevented</td> <td>‚úÖ Possible</td> </tr> <tr> <td>SERIALIZABLE</td> <td>‚ùå Prevented</td> <td>‚ùå Prevented</td> <td>‚ùå Prevented</td> </tr> </tbody> </table> <p><strong>Setting Isolation Level:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Per session</span>
<span class=k>SET</span><span class=w> </span><span class=k>TRANSACTION</span><span class=w> </span><span class=k>ISOLATION</span><span class=w> </span><span class=k>LEVEL</span><span class=w> </span><span class=k>REPEATABLE</span><span class=w> </span><span class=k>READ</span><span class=p>;</span>

<span class=k>BEGIN</span><span class=p>;</span>
<span class=c1>-- Your queries here</span>
<span class=k>COMMIT</span><span class=p>;</span>
</code></pre></div> <p><strong>Concurrency Problems:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Dirty Read: Reading uncommitted changes</span>
<span class=c1>-- Session 1: UPDATE accounts SET balance = 0 WHERE id = 1;</span>
<span class=c1>-- Session 2: SELECT balance FROM accounts WHERE id = 1; -- Sees 0</span>
<span class=c1>-- Session 1: ROLLBACK;</span>
<span class=c1>-- Problem: Session 2 read invalid data</span>

<span class=c1>-- Non-Repeatable Read: Same query, different results</span>
<span class=c1>-- Session 1: SELECT balance FROM accounts WHERE id = 1; -- Returns 100</span>
<span class=c1>-- Session 2: UPDATE accounts SET balance = 50 WHERE id = 1; COMMIT;</span>
<span class=c1>-- Session 1: SELECT balance FROM accounts WHERE id = 1; -- Returns 50</span>

<span class=c1>-- Phantom Read: New rows appear</span>
<span class=c1>-- Session 1: SELECT COUNT(*) FROM orders WHERE status = &#39;pending&#39;; -- 10</span>
<span class=c1>-- Session 2: INSERT INTO orders (status) VALUES (&#39;pending&#39;); COMMIT;</span>
<span class=c1>-- Session 1: SELECT COUNT(*) FROM orders WHERE status = &#39;pending&#39;; -- 11</span>
</code></pre></div> <p><strong>Deadlock Prevention:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Lock ordering: Always acquire locks in same order</span>
<span class=c1>-- Timeout: SET lock_timeout = &#39;5s&#39;;</span>
<span class=c1>-- FOR UPDATE SKIP LOCKED: Skip locked rows</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>tasks</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;pending&#39;</span>
<span class=k>FOR</span><span class=w> </span><span class=k>UPDATE</span><span class=w> </span><span class=n>SKIP</span><span class=w> </span><span class=n>LOCKED</span>
<span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Concurrency understanding.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Explains all three anomalies with examples</li> <li>Knows default levels (PostgreSQL: READ COMMITTED)</li> <li>Mentions performance vs consistency trade-off</li> <li>Knows FOR UPDATE, SKIP LOCKED for concurrent processing</li> </ul> </div> </details> <hr> <h3 id=how-do-you-handle-locking-in-sql-google-amazon-interview-question>How Do You Handle Locking in SQL? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Locking</code>, <code>Concurrency</code>, <code>Performance</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Oracle</p> <details class=success> <summary>View Answer</summary> <p><strong>Types of Locks:</strong></p> <table> <thead> <tr> <th>Lock Type</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td>Shared (S)</td> <td>Read, allows other reads</td> </tr> <tr> <td>Exclusive (X)</td> <td>Write, blocks all access</td> </tr> <tr> <td>Row-level</td> <td>Lock specific rows</td> </tr> <tr> <td>Table-level</td> <td>Lock entire table</td> </tr> </tbody> </table> <p><strong>Explicit Locking:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Lock rows for update</span>
<span class=k>BEGIN</span><span class=p>;</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>inventory</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>product_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>123</span>
<span class=k>FOR</span><span class=w> </span><span class=k>UPDATE</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Exclusive lock on this row</span>

<span class=k>UPDATE</span><span class=w> </span><span class=n>inventory</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=n>quantity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>quantity</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>product_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>123</span><span class=p>;</span>
<span class=k>COMMIT</span><span class=p>;</span>

<span class=c1>-- Lock variants</span>
<span class=k>FOR</span><span class=w> </span><span class=k>UPDATE</span><span class=p>;</span><span class=w>              </span><span class=c1>-- Wait for lock</span>
<span class=k>FOR</span><span class=w> </span><span class=k>UPDATE</span><span class=w> </span><span class=n>NOWAIT</span><span class=p>;</span><span class=w>       </span><span class=c1>-- Error if locked</span>
<span class=k>FOR</span><span class=w> </span><span class=k>UPDATE</span><span class=w> </span><span class=n>SKIP</span><span class=w> </span><span class=n>LOCKED</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Skip locked rows</span>
<span class=k>FOR</span><span class=w> </span><span class=k>SHARE</span><span class=p>;</span><span class=w>               </span><span class=c1>-- Shared lock (allow reads)</span>
</code></pre></div> <p><strong>Optimistic vs Pessimistic Locking:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Pessimistic: Lock upfront</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FOR</span><span class=w> </span><span class=k>UPDATE</span><span class=p>;</span>
<span class=c1>-- Make changes</span>
<span class=k>UPDATE</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=n>quantity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>

<span class=c1>-- Optimistic: Check version on update</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>quantity</span><span class=p>,</span><span class=w> </span><span class=k>version</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=c1>-- Application makes changes</span>
<span class=k>UPDATE</span><span class=w> </span><span class=n>products</span><span class=w> </span>
<span class=k>SET</span><span class=w> </span><span class=n>quantity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>new_quantity</span><span class=p>,</span><span class=w> </span><span class=k>version</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>version</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>version</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>old_version</span><span class=p>;</span>
<span class=c1>-- If 0 rows affected, someone else modified it</span>
</code></pre></div> <p><strong>Deadlock:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Session 1:                    -- Session 2:</span>
<span class=k>BEGIN</span><span class=p>;</span><span class=w>                           </span><span class=k>BEGIN</span><span class=p>;</span>
<span class=k>UPDATE</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=n>x</span><span class=o>=</span><span class=mi>1</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=w>     </span><span class=k>UPDATE</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=n>y</span><span class=o>=</span><span class=mi>1</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span>
<span class=k>UPDATE</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=n>y</span><span class=o>=</span><span class=mi>1</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=w>     </span><span class=k>UPDATE</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=n>x</span><span class=o>=</span><span class=mi>1</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span>
<span class=c1>-- Waits for Session 2           -- Waits for Session 1</span>
<span class=c1>-- DEADLOCK!</span>

<span class=c1>-- Prevention: Lock in consistent order</span>
<span class=k>BEGIN</span><span class=p>;</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FOR</span><span class=w> </span><span class=k>UPDATE</span><span class=p>;</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FOR</span><span class=w> </span><span class=k>UPDATE</span><span class=p>;</span>
<span class=c1>-- Now safe to update both</span>
</code></pre></div> <p><strong>Advisory Locks (PostgreSQL):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Application-level locks</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>pg_advisory_lock</span><span class=p>(</span><span class=mi>12345</span><span class=p>);</span><span class=w>  </span><span class=c1>-- Acquire lock</span>
<span class=c1>-- Do work</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>pg_advisory_unlock</span><span class=p>(</span><span class=mi>12345</span><span class=p>);</span><span class=w>  </span><span class=c1>-- Release</span>

<span class=c1>-- Try without waiting</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>pg_try_advisory_lock</span><span class=p>(</span><span class=mi>12345</span><span class=p>);</span><span class=w>  </span><span class=c1>-- Returns t/f</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Concurrency control design.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows optimistic vs pessimistic locking trade-offs</li> <li>Uses SKIP LOCKED for worker queues</li> <li>Prevents deadlocks with ordering</li> <li>Chooses row-level locks when possible</li> </ul> </div> </details> <hr> <h3 id=what-is-database-partitioning-google-amazon-interview-question>What is Database Partitioning? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Partitioning</code>, <code>Scalability</code>, <code>Performance</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>What is Partitioning?</strong></p> <p>Partitioning divides large tables into smaller, more manageable pieces while appearing as a single table.</p> <p><strong>Types of Partitioning:</strong></p> <table> <thead> <tr> <th>Type</th> <th>How It Works</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td>Range</td> <td>By range of values</td> <td>Time-series data</td> </tr> <tr> <td>List</td> <td>By explicit values</td> <td>Categories, regions</td> </tr> <tr> <td>Hash</td> <td>By hash of column</td> <td>Even distribution</td> </tr> <tr> <td>Composite</td> <td>Combination</td> <td>Complex requirements</td> </tr> </tbody> </table> <p><strong>Range Partitioning (PostgreSQL):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Create partitioned table</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>SERIAL</span><span class=p>,</span>
<span class=w>    </span><span class=n>order_date</span><span class=w> </span><span class=nb>DATE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span>
<span class=w>    </span><span class=n>customer_id</span><span class=w> </span><span class=nb>INTEGER</span><span class=p>,</span>
<span class=w>    </span><span class=n>amount</span><span class=w> </span><span class=nb>NUMERIC</span>
<span class=p>)</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>RANGE</span><span class=w> </span><span class=p>(</span><span class=n>order_date</span><span class=p>);</span>

<span class=c1>-- Create partitions</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders_2024_q1</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=k>OF</span><span class=w> </span><span class=n>orders</span>
<span class=w>    </span><span class=k>FOR</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>)</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;2024-04-01&#39;</span><span class=p>);</span>

<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders_2024_q2</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=k>OF</span><span class=w> </span><span class=n>orders</span>
<span class=w>    </span><span class=k>FOR</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;2024-04-01&#39;</span><span class=p>)</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;2024-07-01&#39;</span><span class=p>);</span>

<span class=c1>-- Query scans only relevant partitions</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span>
<span class=k>WHERE</span><span class=w> </span><span class=n>order_date</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=s1>&#39;2024-02-01&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=s1>&#39;2024-02-28&#39;</span><span class=p>;</span>
<span class=c1>-- Only scans orders_2024_q1</span>
</code></pre></div> <p><strong>List Partitioning:</strong></p> <div class=highlight><pre><span></span><code><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>SERIAL</span><span class=p>,</span>
<span class=w>    </span><span class=n>name</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span>
<span class=w>    </span><span class=n>region</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span>
<span class=p>)</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>LIST</span><span class=w> </span><span class=p>(</span><span class=n>region</span><span class=p>);</span>

<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>customers_us</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=k>OF</span><span class=w> </span><span class=n>customers</span>
<span class=w>    </span><span class=k>FOR</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;us-east&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;us-west&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;us-central&#39;</span><span class=p>);</span>

<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>customers_eu</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=k>OF</span><span class=w> </span><span class=n>customers</span>
<span class=w>    </span><span class=k>FOR</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;eu-west&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;eu-north&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;eu-central&#39;</span><span class=p>);</span>
</code></pre></div> <p><strong>Benefits:</strong></p> <table> <thead> <tr> <th>Benefit</th> <th>Explanation</th> </tr> </thead> <tbody> <tr> <td>Query Performance</td> <td>Partition pruning</td> </tr> <tr> <td>Maintenance</td> <td>Archives, bulk deletes</td> </tr> <tr> <td>Parallel Processing</td> <td>Partition-wise joins</td> </tr> <tr> <td>Storage</td> <td>Different tablespaces</td> </tr> </tbody> </table> <p><strong>Partition Maintenance:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Drop old partition (instant delete)</span>
<span class=k>DROP</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders_2020_q1</span><span class=p>;</span>

<span class=c1>-- Add new partition</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders_2025_q1</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=k>OF</span><span class=w> </span><span class=n>orders</span>
<span class=w>    </span><span class=k>FOR</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;2025-01-01&#39;</span><span class=p>)</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;2025-04-01&#39;</span><span class=p>);</span>

<span class=c1>-- Detach for archive</span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=n>DETACH</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=n>orders_2023_q1</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Scalability knowledge.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows partition pruning for query performance</li> <li>Uses range for time-series, hash for even distribution</li> <li>Mentions partition key must be in all queries</li> <li>Knows: "Dropping partition is instant vs DELETE"</li> </ul> </div> </details> <hr> <h3 id=explain-database-constraints-and-their-uses-most-tech-companies-interview-question>Explain Database Constraints and Their Uses - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Constraints</code>, <code>Data Integrity</code>, <code>Database Design</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>Types of Constraints:</strong></p> <table> <thead> <tr> <th>Constraint</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td>PRIMARY KEY</td> <td>Unique identifier, not null</td> </tr> <tr> <td>FOREIGN KEY</td> <td>Referential integrity</td> </tr> <tr> <td>UNIQUE</td> <td>No duplicate values</td> </tr> <tr> <td>NOT NULL</td> <td>Value required</td> </tr> <tr> <td>CHECK</td> <td>Custom validation</td> </tr> <tr> <td>DEFAULT</td> <td>Default value</td> </tr> </tbody> </table> <p><strong>Creating Constraints:</strong></p> <div class=highlight><pre><span></span><code><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>SERIAL</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span>
<span class=w>    </span><span class=n>customer_id</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>customers</span><span class=p>(</span><span class=n>id</span><span class=p>),</span>
<span class=w>    </span><span class=n>order_date</span><span class=w> </span><span class=nb>DATE</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=p>,</span>
<span class=w>    </span><span class=n>status</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>CHECK</span><span class=w> </span><span class=p>(</span><span class=n>status</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;pending&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;shipped&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;delivered&#39;</span><span class=p>)),</span>
<span class=w>    </span><span class=n>total_amount</span><span class=w> </span><span class=nb>NUMERIC</span><span class=w> </span><span class=k>CHECK</span><span class=w> </span><span class=p>(</span><span class=n>total_amount</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span><span class=p>),</span>
<span class=w>    </span><span class=n>email</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>UNIQUE</span>
<span class=p>);</span>

<span class=c1>-- Add constraint to existing table</span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=n>positive_amount</span><span class=w> </span><span class=k>CHECK</span><span class=w> </span><span class=p>(</span><span class=n>total_amount</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span><span class=p>);</span>

<span class=c1>-- Named constraints for better error messages</span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders</span><span class=w> </span>
<span class=k>ADD</span><span class=w> </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=n>fk_orders_customer</span><span class=w> </span>
<span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=n>customer_id</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>customers</span><span class=p>(</span><span class=n>id</span><span class=p>)</span>
<span class=k>ON</span><span class=w> </span><span class=k>DELETE</span><span class=w> </span><span class=k>RESTRICT</span>
<span class=k>ON</span><span class=w> </span><span class=k>UPDATE</span><span class=w> </span><span class=k>CASCADE</span><span class=p>;</span>
</code></pre></div> <p><strong>Foreign Key Actions:</strong></p> <table> <thead> <tr> <th>Action</th> <th>On Delete</th> <th>On Update</th> </tr> </thead> <tbody> <tr> <td>CASCADE</td> <td>Delete child rows</td> <td>Update child rows</td> </tr> <tr> <td>RESTRICT</td> <td>Prevent if children exist</td> <td>Prevent if children exist</td> </tr> <tr> <td>SET NULL</td> <td>Set FK to NULL</td> <td>Set FK to NULL</td> </tr> <tr> <td>SET DEFAULT</td> <td>Set FK to default</td> <td>Set FK to default</td> </tr> <tr> <td>NO ACTION</td> <td>Same as RESTRICT</td> <td>Same as RESTRICT</td> </tr> </tbody> </table> <p><strong>Deferred Constraints:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Check at transaction end, not per statement</span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders_items</span>
<span class=k>ADD</span><span class=w> </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=n>fk_order</span>
<span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=n>order_id</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>id</span><span class=p>)</span>
<span class=k>DEFERRABLE</span><span class=w> </span><span class=k>INITIALLY</span><span class=w> </span><span class=k>DEFERRED</span><span class=p>;</span>

<span class=k>BEGIN</span><span class=p>;</span>
<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>order_items</span><span class=w> </span><span class=p>(</span><span class=n>order_id</span><span class=p>,</span><span class=w> </span><span class=n>product_id</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>999</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>);</span><span class=w>  </span><span class=c1>-- Order 999 doesn&#39;t exist yet</span>
<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>customer_id</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>999</span><span class=p>,</span><span class=w> </span><span class=mi>123</span><span class=p>);</span><span class=w>  </span><span class=c1>-- Now it does</span>
<span class=k>COMMIT</span><span class=p>;</span><span class=w>  </span><span class=c1>-- FK check happens here</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Data integrity knowledge.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses CHECK constraints for business rules</li> <li>Knows FK actions (CASCADE, RESTRICT)</li> <li>Mentions performance impact of FKs</li> <li>Uses DEFERRABLE for complex inserts</li> </ul> </div> </details> <hr> <h3 id=how-do-you-design-a-database-schema-amazon-google-interview-question>How Do You Design a Database Schema? - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Database Design</code>, <code>Schema</code>, <code>Normalization</code> | <strong>Asked by:</strong> Amazon, Google, Meta, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>Design Process:</strong></p> <ol> <li><strong>Identify Entities</strong>: Users, Orders, Products</li> <li><strong>Define Relationships</strong>: One-to-many, many-to-many</li> <li><strong>Choose Keys</strong>: Natural vs surrogate</li> <li><strong>Apply Normalization</strong>: Eliminate redundancy</li> <li><strong>Consider Denormalization</strong>: For read performance</li> </ol> <p><strong>Example: E-Commerce Schema:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Core entities</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>SERIAL</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span>
<span class=w>    </span><span class=n>email</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span>
<span class=w>    </span><span class=n>name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span>
<span class=w>    </span><span class=n>created_at</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>NOW</span><span class=p>()</span>
<span class=p>);</span>

<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>SERIAL</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span>
<span class=w>    </span><span class=n>name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span>
<span class=w>    </span><span class=n>price</span><span class=w> </span><span class=nb>NUMERIC</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>CHECK</span><span class=w> </span><span class=p>(</span><span class=n>price</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span><span class=p>),</span>
<span class=w>    </span><span class=n>stock_quantity</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=mi>0</span>
<span class=p>);</span>

<span class=c1>-- One-to-many: User has many orders</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>SERIAL</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span>
<span class=w>    </span><span class=n>user_id</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>users</span><span class=p>(</span><span class=n>id</span><span class=p>),</span>
<span class=w>    </span><span class=n>status</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;pending&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=n>total_amount</span><span class=w> </span><span class=nb>NUMERIC</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>),</span>
<span class=w>    </span><span class=n>created_at</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>NOW</span><span class=p>()</span>
<span class=p>);</span>

<span class=c1>-- Many-to-many: Order contains many products</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>order_items</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>order_id</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>id</span><span class=p>),</span>
<span class=w>    </span><span class=n>product_id</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>products</span><span class=p>(</span><span class=n>id</span><span class=p>),</span>
<span class=w>    </span><span class=n>quantity</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>CHECK</span><span class=w> </span><span class=p>(</span><span class=n>quantity</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>),</span>
<span class=w>    </span><span class=n>unit_price</span><span class=w> </span><span class=nb>NUMERIC</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span>
<span class=w>    </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=n>order_id</span><span class=p>,</span><span class=w> </span><span class=n>product_id</span><span class=p>)</span>
<span class=p>);</span>

<span class=c1>-- Self-referencing: Categories hierarchy</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>categories</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>SERIAL</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span>
<span class=w>    </span><span class=n>name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span>
<span class=w>    </span><span class=n>parent_id</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>categories</span><span class=p>(</span><span class=n>id</span><span class=p>)</span>
<span class=p>);</span>
</code></pre></div> <p><strong>Normalization Forms:</strong></p> <table> <thead> <tr> <th>Form</th> <th>Rule</th> </tr> </thead> <tbody> <tr> <td>1NF</td> <td>Atomic values, no repeating groups</td> </tr> <tr> <td>2NF</td> <td>1NF + No partial dependencies</td> </tr> <tr> <td>3NF</td> <td>2NF + No transitive dependencies</td> </tr> <tr> <td>BCNF</td> <td>Every determinant is a candidate key</td> </tr> </tbody> </table> <p><strong>Denormalization Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Store calculated total (update via trigger)</span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>item_count</span><span class=w> </span><span class=nb>INTEGER</span><span class=p>;</span>

<span class=c1>-- Store user name in orders for faster reads</span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>user_name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>100</span><span class=p>);</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Design thinking.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Starts with entities and relationships</li> <li>Knows when to denormalize</li> <li>Uses appropriate data types</li> <li>Considers indexing strategy upfront</li> </ul> </div> </details> <hr> <h3 id=how-do-you-optimize-slow-queries-google-amazon-netflix-interview-question>How Do You Optimize Slow Queries? - Google, Amazon, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Performance</code>, <code>Query Optimization</code>, <code>Indexing</code> | <strong>Asked by:</strong> Google, Amazon, Netflix, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Optimization Workflow:</strong></p> <ol> <li><strong>Identify slow queries</strong> (logs, monitoring)</li> <li><strong>Analyze with EXPLAIN</strong></li> <li><strong>Check indexes</strong></li> <li><strong>Optimize query structure</strong></li> <li><strong>Consider schema changes</strong></li> </ol> <p><strong>EXPLAIN Analysis:</strong></p> <div class=highlight><pre><span></span><code><span class=k>EXPLAIN</span><span class=w> </span><span class=k>ANALYZE</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=o>*</span><span class=p>,</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>name</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=n>o</span>
<span class=k>JOIN</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>id</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;pending&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>created_at</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>;</span>

<span class=c1>-- Look for:</span>
<span class=c1>-- Seq Scan (table scan) ‚Üí Add index</span>
<span class=c1>-- High rows vs actual rows ‚Üí Stale statistics</span>
<span class=c1>-- Nested Loop with many rows ‚Üí Consider different join</span>
</code></pre></div> <p><strong>Index Optimization:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Single column for equality</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_orders_status</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>status</span><span class=p>);</span>

<span class=c1>-- Composite for multiple conditions</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_orders_status_date</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>status</span><span class=p>,</span><span class=w> </span><span class=n>created_at</span><span class=p>);</span>

<span class=c1>-- Covering index (avoids table lookup)</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_orders_covering</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>status</span><span class=p>,</span><span class=w> </span><span class=n>created_at</span><span class=p>)</span><span class=w> </span>
<span class=n>INCLUDE</span><span class=w> </span><span class=p>(</span><span class=n>total_amount</span><span class=p>);</span>

<span class=c1>-- Partial index (smaller, faster)</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_orders_pending</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>created_at</span><span class=p>)</span><span class=w> </span>
<span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;pending&#39;</span><span class=p>;</span>
</code></pre></div> <p><strong>Query Rewrites:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- ‚ùå Function on indexed column (can&#39;t use index)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>YEAR</span><span class=p>(</span><span class=n>created_at</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2024</span><span class=p>;</span>

<span class=c1>-- ‚úÖ Range condition (uses index)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span>
<span class=k>WHERE</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=s1>&#39;2025-01-01&#39;</span><span class=p>;</span>

<span class=c1>-- ‚ùå OR can prevent index use</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;pending&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>123</span><span class=p>;</span>

<span class=c1>-- ‚úÖ UNION as alternative</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;pending&#39;</span>
<span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>123</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=s1>&#39;pending&#39;</span><span class=p>;</span>

<span class=c1>-- ‚ùå SELECT * (fetches unnecessary data)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>large_table</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>

<span class=c1>-- ‚úÖ Select only needed columns</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>large_table</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</code></pre></div> <p><strong>Statistics Maintenance:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Update statistics (PostgreSQL)</span>
<span class=k>ANALYZE</span><span class=w> </span><span class=n>orders</span><span class=p>;</span>

<span class=c1>-- Reindex for bloated indexes</span>
<span class=k>REINDEX</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_orders_status</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Performance debugging ability.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses EXPLAIN ANALYZE, not just EXPLAIN</li> <li>Knows composite index column order matters</li> <li>Avoids functions on indexed columns</li> <li>Mentions covering indexes for read-heavy queries</li> </ul> </div> </details> <hr> <h3 id=what-is-the-difference-between-union-intersect-and-except-google-amazon-interview-question>What is the Difference Between UNION, INTERSECT, and EXCEPT? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Set Operations</code>, <code>Query Combination</code>, <code>SQL Basics</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Set Operations in SQL:</strong></p> <table> <thead> <tr> <th>Operation</th> <th>Result</th> </tr> </thead> <tbody> <tr> <td>UNION</td> <td>All rows from both queries (removes duplicates)</td> </tr> <tr> <td>UNION ALL</td> <td>All rows from both queries (keeps duplicates)</td> </tr> <tr> <td>INTERSECT</td> <td>Only rows in both queries</td> </tr> <tr> <td>EXCEPT / MINUS</td> <td>Rows in first but not in second</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><span class=c1>-- Sample tables</span>
<span class=c1>-- table1: (1, 2, 3, 4)</span>
<span class=c1>-- table2: (3, 4, 5, 6)</span>

<span class=c1>-- UNION - combines, removes duplicates</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table1</span>
<span class=k>UNION</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table2</span><span class=p>;</span>
<span class=c1>-- Result: 1, 2, 3, 4, 5, 6</span>

<span class=c1>-- UNION ALL - combines, keeps duplicates</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table1</span>
<span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table2</span><span class=p>;</span>
<span class=c1>-- Result: 1, 2, 3, 4, 3, 4, 5, 6</span>

<span class=c1>-- INTERSECT - common elements</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table1</span>
<span class=k>INTERSECT</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table2</span><span class=p>;</span>
<span class=c1>-- Result: 3, 4</span>

<span class=c1>-- EXCEPT (MINUS in Oracle) - difference</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table1</span>
<span class=k>EXCEPT</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table2</span><span class=p>;</span>
<span class=c1>-- Result: 1, 2</span>
</code></pre></div> <p><strong>Requirements:</strong></p> <ul> <li>Same number of columns</li> <li>Compatible data types</li> <li>Column names from first query</li> </ul> <p><strong>Performance Tip:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- UNION ALL is faster (no duplicate removal)</span>
<span class=c1>-- Use UNION ALL when duplicates are impossible or acceptable</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Set theory understanding.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows UNION removes duplicates, UNION ALL doesn't</li> <li>Uses UNION ALL for performance when appropriate</li> <li>Knows EXCEPT is MINUS in Oracle</li> <li>Can explain when each operation is useful</li> </ul> </div> </details> <hr> <h3 id=when-to-use-in-vs-exists-google-amazon-interview-question>When to Use IN vs EXISTS? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Subqueries</code>, <code>Performance</code>, <code>Optimization</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>IN vs EXISTS:</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>IN</th> <th>EXISTS</th> </tr> </thead> <tbody> <tr> <td>How it works</td> <td>Checks value against list</td> <td>Checks if subquery returns rows</td> </tr> <tr> <td>NULL handling</td> <td>Returns NULL if list contains NULL</td> <td>Handles NULLs correctly</td> </tr> <tr> <td>Performance</td> <td>Better for small lists</td> <td>Better for large outer, small inner</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><span class=c1>-- IN - checks if value is in subquery result</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>country</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;USA&#39;</span>
<span class=p>);</span>

<span class=c1>-- EXISTS - checks if subquery returns any rows</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=n>o</span>
<span class=k>WHERE</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=k>c</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>customer_id</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>country</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;USA&#39;</span>
<span class=p>);</span>
</code></pre></div> <p><strong>When to Use IN:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Small, static list</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;pending&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;processing&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;shipped&#39;</span><span class=p>)</span>

<span class=c1>-- Subquery returns few rows</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>small_table</span><span class=p>)</span>
</code></pre></div> <p><strong>When to Use EXISTS:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Correlated subquery with large outer table</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>large_orders</span><span class=w> </span><span class=n>o</span>
<span class=k>WHERE</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>small_customers</span><span class=w> </span><span class=k>c</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>customer_id</span>
<span class=p>);</span>

<span class=c1>-- Checking existence only (no values needed)</span>
<span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;test@example.com&#39;</span><span class=p>)</span>
</code></pre></div> <p><strong>NOT IN vs NOT EXISTS (Critical Difference):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- ‚ö†Ô∏è NOT IN fails with NULLs</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>customers</span><span class=p>);</span>
<span class=c1>-- If customers.id has NULL, returns empty!</span>

<span class=c1>-- ‚úÖ NOT EXISTS handles NULLs correctly</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=n>o</span>
<span class=k>WHERE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>customer_id</span>
<span class=p>);</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Query optimization understanding.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows NOT IN danger with NULLs</li> <li>Uses EXISTS for existence checks</li> <li>Explains performance differences</li> <li>Mentions query optimizer often makes them equivalent</li> </ul> </div> </details> <hr> <h3 id=how-do-you-write-a-pivot-query-amazon-google-interview-question>How Do You Write a Pivot Query? - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Pivot</code>, <code>Data Transformation</code>, <code>Reporting</code> | <strong>Asked by:</strong> Amazon, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Pivot in SQL:</strong></p> <p>Transform rows to columns - useful for reporting.</p> <p><strong>Using CASE Statements (Universal):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Sales data: product, month, amount</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>product</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=k>month</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Jan&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>jan</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=k>month</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Feb&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>feb</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=k>month</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Mar&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>mar</span>
<span class=k>FROM</span><span class=w> </span><span class=n>sales</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>product</span><span class=p>;</span>

<span class=c1>-- Result:</span>
<span class=c1>-- product | jan  | feb  | mar</span>
<span class=c1>-- A       | 100  | 150  | 200</span>
<span class=c1>-- B       | 80   | 90   | 110</span>
</code></pre></div> <p><strong>SQL Server PIVOT:</strong></p> <div class=highlight><pre><span></span><code><span class=k>SELECT</span><span class=w> </span><span class=n>product</span><span class=p>,</span><span class=w> </span><span class=p>[</span><span class=n>Jan</span><span class=p>],</span><span class=w> </span><span class=p>[</span><span class=n>Feb</span><span class=p>],</span><span class=w> </span><span class=p>[</span><span class=n>Mar</span><span class=p>]</span>
<span class=k>FROM</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>product</span><span class=p>,</span><span class=w> </span><span class=k>month</span><span class=p>,</span><span class=w> </span><span class=n>amount</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>sales</span>
<span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>source</span>
<span class=n>PIVOT</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span>
<span class=w>    </span><span class=k>FOR</span><span class=w> </span><span class=k>month</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>([</span><span class=n>Jan</span><span class=p>],</span><span class=w> </span><span class=p>[</span><span class=n>Feb</span><span class=p>],</span><span class=w> </span><span class=p>[</span><span class=n>Mar</span><span class=p>])</span>
<span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>pivoted</span><span class=p>;</span>
</code></pre></div> <p><strong>PostgreSQL crosstab:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Requires tablefunc extension</span>
<span class=k>CREATE</span><span class=w> </span><span class=n>EXTENSION</span><span class=w> </span><span class=k>IF</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=n>tablefunc</span><span class=p>;</span>

<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>crosstab</span><span class=p>(</span>
<span class=w>    </span><span class=s1>&#39;SELECT product, month, amount FROM sales ORDER BY 1, 2&#39;</span><span class=p>,</span>
<span class=w>    </span><span class=s1>&#39;SELECT DISTINCT month FROM sales ORDER BY 1&#39;</span>
<span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>ct</span><span class=p>(</span><span class=n>product</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w> </span><span class=n>jan</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span><span class=w> </span><span class=n>feb</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span><span class=w> </span><span class=n>mar</span><span class=w> </span><span class=nb>INT</span><span class=p>);</span>
</code></pre></div> <p><strong>Unpivot (Columns to Rows):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- CASE-based unpivot</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>product</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Jan&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>month</span><span class=p>,</span><span class=w> </span><span class=n>jan</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>pivoted_table</span>
<span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>product</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Feb&#39;</span><span class=p>,</span><span class=w> </span><span class=n>feb</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>pivoted_table</span>
<span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>product</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Mar&#39;</span><span class=p>,</span><span class=w> </span><span class=n>mar</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>pivoted_table</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Advanced data transformation.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses CASE for cross-database compatibility</li> <li>Knows PIVOT syntax varies by database</li> <li>Can handle dynamic column lists</li> <li>Understands when pivoting is appropriate</li> </ul> </div> </details> <hr> <h3 id=how-does-the-merge-statement-work-amazon-microsoft-interview-question>How Does the MERGE Statement Work? - Amazon, Microsoft Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>MERGE</code>, <code>UPSERT</code>, <code>DML</code> | <strong>Asked by:</strong> Amazon, Microsoft, Oracle</p> <details class=success> <summary>View Answer</summary> <p><strong>MERGE Statement:</strong></p> <p>Performs INSERT, UPDATE, or DELETE in a single statement based on source data.</p> <div class=highlight><pre><span></span><code><span class=c1>-- SQL Server / Oracle / PostgreSQL 15+</span>
<span class=n>MERGE</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>target_table</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>target</span>
<span class=k>USING</span><span class=w> </span><span class=n>source_table</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>source</span>
<span class=k>ON</span><span class=w> </span><span class=n>target</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>id</span>

<span class=c1>-- When matched (update)</span>
<span class=k>WHEN</span><span class=w> </span><span class=n>MATCHED</span><span class=w> </span><span class=k>THEN</span>
<span class=w>    </span><span class=k>UPDATE</span><span class=w> </span><span class=k>SET</span>
<span class=w>        </span><span class=n>target</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>name</span><span class=p>,</span>
<span class=w>        </span><span class=n>target</span><span class=p>.</span><span class=n>updated_at</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>CURRENT_TIMESTAMP</span>

<span class=c1>-- When not matched (insert)</span>
<span class=k>WHEN</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>MATCHED</span><span class=w> </span><span class=k>THEN</span>
<span class=w>    </span><span class=k>INSERT</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>created_at</span><span class=p>)</span>
<span class=w>    </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=k>source</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=k>CURRENT_TIMESTAMP</span><span class=p>)</span>

<span class=c1>-- When matched but should delete</span>
<span class=k>WHEN</span><span class=w> </span><span class=n>MATCHED</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>source</span><span class=p>.</span><span class=n>deleted</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>TRUE</span><span class=w> </span><span class=k>THEN</span>
<span class=w>    </span><span class=k>DELETE</span><span class=p>;</span>
</code></pre></div> <p><strong>PostgreSQL INSERT ON CONFLICT (UPSERT):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Simpler upsert syntax</span>
<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>email</span><span class=p>)</span>
<span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;John&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;john@example.com&#39;</span><span class=p>)</span>
<span class=k>ON</span><span class=w> </span><span class=n>CONFLICT</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>)</span><span class=w> </span>
<span class=k>DO</span><span class=w> </span><span class=k>UPDATE</span><span class=w> </span><span class=k>SET</span>
<span class=w>    </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>EXCLUDED</span><span class=p>.</span><span class=n>name</span><span class=p>,</span>
<span class=w>    </span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>EXCLUDED</span><span class=p>.</span><span class=n>email</span><span class=p>,</span>
<span class=w>    </span><span class=n>updated_at</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>CURRENT_TIMESTAMP</span><span class=p>;</span>

<span class=c1>-- Do nothing on conflict</span>
<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>)</span>
<span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;John&#39;</span><span class=p>)</span>
<span class=k>ON</span><span class=w> </span><span class=n>CONFLICT</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=k>DO</span><span class=w> </span><span class=k>NOTHING</span><span class=p>;</span>
</code></pre></div> <p><strong>MySQL UPSERT:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- INSERT ... ON DUPLICATE KEY UPDATE</span>
<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>email</span><span class=p>)</span>
<span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;John&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;john@example.com&#39;</span><span class=p>)</span>
<span class=k>ON</span><span class=w> </span><span class=n>DUPLICATE</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=k>UPDATE</span>
<span class=w>    </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=n>name</span><span class=p>),</span>
<span class=w>    </span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=n>email</span><span class=p>);</span>

<span class=c1>-- REPLACE (delete then insert)</span>
<span class=k>REPLACE</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>email</span><span class=p>)</span>
<span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;John&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;john@example.com&#39;</span><span class=p>);</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Data synchronization knowledge.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows MERGE syntax and alternatives</li> <li>Uses ON CONFLICT for PostgreSQL</li> <li>Understands atomicity benefits</li> <li>Mentions performance for bulk operations</li> </ul> </div> </details> <hr> <h3 id=how-do-you-write-recursive-ctes-google-amazon-interview-question>How Do You Write Recursive CTEs? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Recursive CTE</code>, <code>Hierarchical Data</code>, <code>Trees</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Recursive CTE Structure:</strong></p> <div class=highlight><pre><span></span><code><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span><span class=w> </span><span class=n>cte_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=c1>-- Base case (anchor)</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=p>...</span>

<span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>

<span class=w>    </span><span class=c1>-- Recursive case</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=p>...</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>cte_name</span><span class=w>  </span><span class=c1>-- Self-reference</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=p>...</span><span class=w>      </span><span class=c1>-- Termination condition</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>cte_name</span><span class=p>;</span>
</code></pre></div> <p><strong>Employee Hierarchy:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- employees: id, name, manager_id</span>
<span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span><span class=w> </span><span class=n>org_chart</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=c1>-- Base: CEO (no manager)</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>manager_id</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>level</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>path</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>manager_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span>

<span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>

<span class=w>    </span><span class=c1>-- Recursive: employees with managers</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>manager_id</span><span class=p>,</span><span class=w> </span>
<span class=w>           </span><span class=n>o</span><span class=p>.</span><span class=k>level</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>           </span><span class=n>o</span><span class=p>.</span><span class=n>path</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39; &gt; &#39;</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>name</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e</span>
<span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>org_chart</span><span class=w> </span><span class=n>o</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>manager_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>id</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>org_chart</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>level</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>;</span>
</code></pre></div> <p><strong>Generate Series (Numbers/Dates):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Generate 1 to 10</span>
<span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span><span class=w> </span><span class=n>numbers</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>n</span>
<span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>numbers</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>10</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>numbers</span><span class=p>;</span>

<span class=c1>-- Generate date range</span>
<span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span><span class=w> </span><span class=n>dates</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>::</span><span class=nb>date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>d</span>
<span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dates</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=s1>&#39;2024-01-31&#39;</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dates</span><span class=p>;</span>
</code></pre></div> <p><strong>Bill of Materials (BOM):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Find all components of a product</span>
<span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span><span class=w> </span><span class=n>bom</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>component_id</span><span class=p>,</span><span class=w> </span><span class=n>parent_id</span><span class=p>,</span><span class=w> </span><span class=n>quantity</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>level</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>components</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>parent_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PRODUCT_001&#39;</span>

<span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>

<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>component_id</span><span class=p>,</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>parent_id</span><span class=p>,</span><span class=w> </span>
<span class=w>           </span><span class=k>c</span><span class=p>.</span><span class=n>quantity</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>quantity</span><span class=p>,</span>
<span class=w>           </span><span class=n>b</span><span class=p>.</span><span class=k>level</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>components</span><span class=w> </span><span class=k>c</span>
<span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>bom</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>parent_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>component_id</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>bom</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Advanced SQL and tree processing.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Understands anchor + recursive structure</li> <li>Knows to include termination condition</li> <li>Can track depth/level</li> <li>Mentions max recursion limits</li> </ul> </div> </details> <hr> <h3 id=what-is-a-lateral-join-google-amazon-interview-question>What is a Lateral Join? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Lateral Join</code>, <code>Correlated Subquery</code>, <code>Advanced</code> | <strong>Asked by:</strong> Google, Amazon, Snowflake</p> <details class=success> <summary>View Answer</summary> <p><strong>Lateral Join (PostgreSQL/MySQL 8+):</strong></p> <p>Allows subquery to reference columns from preceding tables (like a correlated subquery but as a join).</p> <div class=highlight><pre><span></span><code><span class=c1>-- Get top 3 orders per customer</span>
<span class=k>SELECT</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=o>*</span>
<span class=k>FROM</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=k>c</span>
<span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>LATERAL</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>orders</span><span class=p>.</span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>id</span><span class=w>  </span><span class=c1>-- References c!</span>
<span class=w>    </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=k>DESC</span>
<span class=w>    </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>3</span>
<span class=p>)</span><span class=w> </span><span class=n>o</span><span class=p>;</span>
</code></pre></div> <p><strong>Use Cases:</strong></p> <p><strong>Top-N per Group:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Top 5 products per category</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>cat</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>prod</span><span class=p>.</span><span class=o>*</span>
<span class=k>FROM</span><span class=w> </span><span class=n>categories</span><span class=w> </span><span class=n>cat</span>
<span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>LATERAL</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>category_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cat</span><span class=p>.</span><span class=n>id</span>
<span class=w>    </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>sales</span><span class=w> </span><span class=k>DESC</span>
<span class=w>    </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>5</span>
<span class=p>)</span><span class=w> </span><span class=n>prod</span><span class=p>;</span>
</code></pre></div> <p><strong>Running Calculations:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Calculate moving average</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>t</span><span class=p>.</span><span class=n>id</span><span class=p>,</span>
<span class=w>    </span><span class=n>t</span><span class=p>.</span><span class=n>value</span><span class=p>,</span>
<span class=w>    </span><span class=n>stats</span><span class=p>.</span><span class=n>moving_avg</span>
<span class=k>FROM</span><span class=w> </span><span class=n>time_series</span><span class=w> </span><span class=n>t</span>
<span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>LATERAL</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>moving_avg</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>time_series</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=n>t</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>t</span><span class=p>.</span><span class=n>id</span>
<span class=p>)</span><span class=w> </span><span class=n>stats</span><span class=p>;</span>
</code></pre></div> <p><strong>Expanding JSON Arrays:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- PostgreSQL: Expand JSON array</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>users</span><span class=p>.</span><span class=n>id</span><span class=p>,</span>
<span class=w>    </span><span class=n>tags</span><span class=p>.</span><span class=n>tag</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>LATERAL</span><span class=w> </span><span class=n>jsonb_array_elements_text</span><span class=p>(</span><span class=n>users</span><span class=p>.</span><span class=n>tags</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>tags</span><span class=p>(</span><span class=n>tag</span><span class=p>);</span>
</code></pre></div> <p><strong>SQL Server Equivalent (APPLY):</strong></p> <div class=highlight><pre><span></span><code><span class=k>SELECT</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=o>*</span>
<span class=k>FROM</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=k>c</span>
<span class=k>CROSS</span><span class=w> </span><span class=n>APPLY</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>TOP</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=o>*</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>orders</span><span class=p>.</span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>id</span>
<span class=w>    </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=k>DESC</span>
<span class=p>)</span><span class=w> </span><span class=n>o</span><span class=p>;</span>
<span class=c1>-- OUTER APPLY for left join behavior</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Advanced join understanding.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows LATERAL allows correlated subqueries in FROM</li> <li>Uses for top-N per group problems</li> <li>Knows CROSS APPLY in SQL Server</li> <li>Compares to window functions for alternatives</li> </ul> </div> </details> <hr> <h3 id=how-do-you-query-json-data-in-sql-google-amazon-interview-question>How Do You Query JSON Data in SQL? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>JSON</code>, <code>Semi-structured</code>, <code>Modern SQL</code> | <strong>Asked by:</strong> Google, Amazon, Snowflake, MongoDB</p> <details class=success> <summary>View Answer</summary> <p><strong>PostgreSQL JSON/JSONB:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Create table with JSON</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>SERIAL</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span>
<span class=w>    </span><span class=k>data</span><span class=w> </span><span class=n>JSONB</span>
<span class=p>);</span>

<span class=c1>-- Insert JSON</span>
<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=p>(</span><span class=k>data</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span>
<span class=p>(</span><span class=s1>&#39;{&quot;name&quot;: &quot;John&quot;, &quot;age&quot;: 30, &quot;tags&quot;: [&quot;admin&quot;, &quot;user&quot;]}&#39;</span><span class=p>);</span>

<span class=c1>-- Extract values</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=k>data</span><span class=o>-&gt;&gt;</span><span class=s1>&#39;name&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w>           </span><span class=c1>-- Text extraction</span>
<span class=w>    </span><span class=p>(</span><span class=k>data</span><span class=o>-&gt;&gt;</span><span class=s1>&#39;age&#39;</span><span class=p>)::</span><span class=nb>int</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>age</span><span class=p>,</span><span class=w>      </span><span class=c1>-- With casting</span>
<span class=w>    </span><span class=k>data</span><span class=o>-&gt;</span><span class=s1>&#39;tags&#39;</span><span class=o>-&gt;</span><span class=mi>0</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>first_tag</span><span class=w>     </span><span class=c1>-- Array access</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=p>;</span>

<span class=c1>-- Query JSON fields</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=k>data</span><span class=o>-&gt;&gt;</span><span class=s1>&#39;name&#39;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;John&#39;</span><span class=p>;</span>

<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=k>data</span><span class=w> </span><span class=o>@&gt;</span><span class=w> </span><span class=s1>&#39;{&quot;tags&quot;: [&quot;admin&quot;]}&#39;</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Contains</span>

<span class=c1>-- Index for performance</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_users_name</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=p>((</span><span class=k>data</span><span class=o>-&gt;&gt;</span><span class=s1>&#39;name&#39;</span><span class=p>));</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_users_data</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>GIN</span><span class=w> </span><span class=p>(</span><span class=k>data</span><span class=p>);</span>
</code></pre></div> <p><strong>MySQL JSON:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Extract with JSON_EXTRACT</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>JSON_EXTRACT</span><span class=p>(</span><span class=k>data</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;$.name&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span><span class=p>,</span>
<span class=w>    </span><span class=n>JSON_UNQUOTE</span><span class=p>(</span><span class=n>JSON_EXTRACT</span><span class=p>(</span><span class=k>data</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;$.name&#39;</span><span class=p>))</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name_text</span><span class=p>,</span>
<span class=w>    </span><span class=k>data</span><span class=o>-&gt;&gt;</span><span class=s1>&#39;$.name&#39;</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name_shorthand</span><span class=w>  </span><span class=c1>-- MySQL 8+</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=p>;</span>

<span class=c1>-- Query</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>JSON_CONTAINS</span><span class=p>(</span><span class=k>data</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;&quot;admin&quot;&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;$.tags&#39;</span><span class=p>);</span>
</code></pre></div> <p><strong>SQL Server JSON:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Extract</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>JSON_VALUE</span><span class=p>(</span><span class=k>data</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;$.name&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>name</span><span class=p>,</span>
<span class=w>    </span><span class=n>JSON_QUERY</span><span class=p>(</span><span class=k>data</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;$.tags&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>tags</span><span class=w>  </span><span class=c1>-- Returns JSON</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=p>;</span>

<span class=c1>-- Query</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>JSON_VALUE</span><span class=p>(</span><span class=k>data</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;$.name&#39;</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;John&#39;</span><span class=p>;</span>

<span class=c1>-- Cross apply for array expansion</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>u</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>t</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>tag</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=n>u</span>
<span class=k>CROSS</span><span class=w> </span><span class=n>APPLY</span><span class=w> </span><span class=n>OPENJSON</span><span class=p>(</span><span class=n>u</span><span class=p>.</span><span class=k>data</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;$.tags&#39;</span><span class=p>)</span><span class=w> </span><span class=n>t</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Modern data handling.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows JSON syntax varies by database</li> <li>Uses JSONB over JSON in PostgreSQL</li> <li>Indexes JSON fields for performance</li> <li>Understands when to use relational vs JSON</li> </ul> </div> </details> <hr> <h3 id=what-is-full-text-search-in-sql-google-amazon-interview-question>What is Full-Text Search in SQL? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Full-Text Search</code>, <code>Text Search</code>, <code>Performance</code> | <strong>Asked by:</strong> Google, Amazon, Elastic</p> <details class=success> <summary>View Answer</summary> <p><strong>PostgreSQL Full-Text Search:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Create text search index</span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>search_vector</span><span class=w> </span><span class=n>tsvector</span><span class=p>;</span>

<span class=k>UPDATE</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=n>search_vector</span><span class=w> </span><span class=o>=</span><span class=w> </span>
<span class=w>    </span><span class=n>to_tsvector</span><span class=p>(</span><span class=s1>&#39;english&#39;</span><span class=p>,</span><span class=w> </span><span class=k>coalesce</span><span class=p>(</span><span class=n>title</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>)</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39; &#39;</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=k>coalesce</span><span class=p>(</span><span class=n>body</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>));</span>

<span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_fts</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>GIN</span><span class=p>(</span><span class=n>search_vector</span><span class=p>);</span>

<span class=c1>-- Search</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>search_vector</span><span class=w> </span><span class=o>@@</span><span class=w> </span><span class=n>to_tsquery</span><span class=p>(</span><span class=s1>&#39;english&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;database &amp; performance&#39;</span><span class=p>);</span>

<span class=c1>-- With ranking</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>title</span><span class=p>,</span>
<span class=w>    </span><span class=n>ts_rank</span><span class=p>(</span><span class=n>search_vector</span><span class=p>,</span><span class=w> </span><span class=n>query</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>rank</span>
<span class=k>FROM</span><span class=w> </span><span class=n>articles</span><span class=p>,</span><span class=w> </span><span class=n>to_tsquery</span><span class=p>(</span><span class=s1>&#39;database | postgresql&#39;</span><span class=p>)</span><span class=w> </span><span class=n>query</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>search_vector</span><span class=w> </span><span class=o>@@</span><span class=w> </span><span class=n>query</span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>rank</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span>

<span class=c1>-- Phrase search</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>search_vector</span><span class=w> </span><span class=o>@@</span><span class=w> </span><span class=n>phraseto_tsquery</span><span class=p>(</span><span class=s1>&#39;full text search&#39;</span><span class=p>);</span>
</code></pre></div> <p><strong>MySQL Full-Text Search:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Create FULLTEXT index</span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>articles</span>
<span class=k>ADD</span><span class=w> </span><span class=n>FULLTEXT</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>ft_idx</span><span class=w> </span><span class=p>(</span><span class=n>title</span><span class=p>,</span><span class=w> </span><span class=n>body</span><span class=p>);</span>

<span class=c1>-- Natural language search</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span>
<span class=k>WHERE</span><span class=w> </span><span class=k>MATCH</span><span class=p>(</span><span class=n>title</span><span class=p>,</span><span class=w> </span><span class=n>body</span><span class=p>)</span><span class=w> </span><span class=n>AGAINST</span><span class=p>(</span><span class=s1>&#39;database performance&#39;</span><span class=p>);</span>

<span class=c1>-- Boolean mode</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span>
<span class=k>WHERE</span><span class=w> </span><span class=k>MATCH</span><span class=p>(</span><span class=n>title</span><span class=p>,</span><span class=w> </span><span class=n>body</span><span class=p>)</span><span class=w> </span>
<span class=n>AGAINST</span><span class=p>(</span><span class=s1>&#39;+database -mysql&#39;</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=nb>BOOLEAN</span><span class=w> </span><span class=k>MODE</span><span class=p>);</span>

<span class=c1>-- With relevance score</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>title</span><span class=p>,</span>
<span class=w>    </span><span class=k>MATCH</span><span class=p>(</span><span class=n>title</span><span class=p>,</span><span class=w> </span><span class=n>body</span><span class=p>)</span><span class=w> </span><span class=n>AGAINST</span><span class=p>(</span><span class=s1>&#39;database&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>relevance</span>
<span class=k>FROM</span><span class=w> </span><span class=n>articles</span>
<span class=k>HAVING</span><span class=w> </span><span class=n>relevance</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>relevance</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span>
</code></pre></div> <p><strong>SQL Server Full-Text:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Create catalog and index</span>
<span class=k>CREATE</span><span class=w> </span><span class=n>FULLTEXT</span><span class=w> </span><span class=k>CATALOG</span><span class=w> </span><span class=n>ftCatalog</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>DEFAULT</span><span class=p>;</span>
<span class=k>CREATE</span><span class=w> </span><span class=n>FULLTEXT</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>articles</span><span class=p>(</span><span class=n>title</span><span class=p>,</span><span class=w> </span><span class=n>body</span><span class=p>)</span><span class=w> </span>
<span class=w>    </span><span class=k>KEY</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>PK_articles</span><span class=p>;</span>

<span class=c1>-- Search</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span>
<span class=k>WHERE</span><span class=w> </span><span class=k>CONTAINS</span><span class=p>(</span><span class=n>body</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;database AND performance&#39;</span><span class=p>);</span>

<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>articles</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>FREETEXT</span><span class=p>(</span><span class=n>body</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;database optimization tips&#39;</span><span class=p>);</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Text search capabilities.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows full-text vs LIKE performance</li> <li>Uses appropriate index types (GIN, GIST)</li> <li>Understands stemming and stop words</li> <li>Knows when to use dedicated search (Elasticsearch)</li> </ul> </div> </details> <hr> <h3 id=how-do-you-use-regular-expressions-in-sql-amazon-google-interview-question>How Do You Use Regular Expressions in SQL? - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Regex</code>, <code>Pattern Matching</code>, <code>Text Processing</code> | <strong>Asked by:</strong> Amazon, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>PostgreSQL Regular Expressions:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Match patterns</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=o>~</span><span class=w> </span><span class=s1>&#39;^[a-z]+@[a-z]+\.[a-z]{2,}$&#39;</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Case sensitive</span>

<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=o>~*</span><span class=w> </span><span class=s1>&#39;GMAIL\.COM$&#39;</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Case insensitive</span>

<span class=c1>-- Not match</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>phone</span><span class=w> </span><span class=o>!~</span><span class=w> </span><span class=s1>&#39;^\+1&#39;</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Doesn&#39;t start with +1</span>

<span class=c1>-- Extract with regexp_match</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>email</span><span class=p>,</span>
<span class=w>    </span><span class=p>(</span><span class=n>regexp_match</span><span class=p>(</span><span class=n>email</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;^([^@]+)@(.+)$&#39;</span><span class=p>))[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>username</span><span class=p>,</span>
<span class=w>    </span><span class=p>(</span><span class=n>regexp_match</span><span class=p>(</span><span class=n>email</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;^([^@]+)@(.+)$&#39;</span><span class=p>))[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>domain</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=p>;</span>

<span class=c1>-- Replace</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>regexp_replace</span><span class=p>(</span><span class=n>phone</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;[^0-9]&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;g&#39;</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>digits_only</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=p>;</span>

<span class=c1>-- Split</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>regexp_split_to_array</span><span class=p>(</span><span class=s1>&#39;a,b;c|d&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;[,;|]&#39;</span><span class=p>);</span>
</code></pre></div> <p><strong>MySQL Regular Expressions:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Match (MySQL 8+)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=n>REGEXP</span><span class=w> </span><span class=s1>&#39;^[a-z]+@[a-z]+\\.[a-z]{2,}$&#39;</span><span class=p>;</span>

<span class=c1>-- Case insensitive by default</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=n>REGEXP</span><span class=w> </span><span class=s1>&#39;gmail\\.com$&#39;</span><span class=p>;</span>

<span class=c1>-- Replace (MySQL 8+)</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>REGEXP_REPLACE</span><span class=p>(</span><span class=n>phone</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;[^0-9]&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=p>);</span>

<span class=c1>-- Extract (MySQL 8+)</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>REGEXP_SUBSTR</span><span class=p>(</span><span class=n>email</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;@.+$&#39;</span><span class=p>);</span>
</code></pre></div> <p><strong>SQL Server:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Limited native regex, use LIKE or CLR</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%@%.%&#39;</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Simple pattern only</span>

<span class=c1>-- For complex patterns, use CLR functions or </span>
<span class=c1>-- PATINDEX with wildcards</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>PATINDEX</span><span class=p>(</span><span class=s1>&#39;%[0-9]%&#39;</span><span class=p>,</span><span class=w> </span><span class=n>phone</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Text processing ability.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows regex syntax varies by database</li> <li>Uses regex for validation and extraction</li> <li>Warns about performance impact</li> <li>Knows LIKE for simple patterns</li> </ul> </div> </details> <hr> <h3 id=what-are-sequences-in-sql-amazon-oracle-interview-question>What Are Sequences in SQL? - Amazon, Oracle Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Sequences</code>, <code>Auto-increment</code>, <code>Primary Keys</code> | <strong>Asked by:</strong> Amazon, Oracle, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>What is a Sequence?</strong></p> <p>A database object that generates unique numbers, commonly used for primary keys.</p> <p><strong>PostgreSQL Sequences:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Create sequence</span>
<span class=k>CREATE</span><span class=w> </span><span class=n>SEQUENCE</span><span class=w> </span><span class=n>order_seq</span>
<span class=w>    </span><span class=k>START</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=mi>1000</span>
<span class=w>    </span><span class=k>INCREMENT</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=mi>1</span>
<span class=w>    </span><span class=k>NO</span><span class=w> </span><span class=k>MAXVALUE</span>
<span class=w>    </span><span class=k>CACHE</span><span class=w> </span><span class=mi>20</span><span class=p>;</span>

<span class=c1>-- Use sequence</span>
<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>product</span><span class=p>)</span>
<span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=n>nextval</span><span class=p>(</span><span class=s1>&#39;order_seq&#39;</span><span class=p>),</span><span class=w> </span><span class=s1>&#39;Product A&#39;</span><span class=p>);</span>

<span class=c1>-- Get current value</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>currval</span><span class=p>(</span><span class=s1>&#39;order_seq&#39;</span><span class=p>);</span>

<span class=c1>-- Serial (auto-sequence) - shorthand</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>SERIAL</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>  </span><span class=c1>-- Creates sequence automatically</span>
<span class=w>    </span><span class=n>product</span><span class=w> </span><span class=nb>TEXT</span>
<span class=p>);</span>

<span class=c1>-- IDENTITY (SQL standard, PostgreSQL 10+)</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>GENERATED</span><span class=w> </span><span class=n>ALWAYS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>IDENTITY</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span>
<span class=w>    </span><span class=n>product</span><span class=w> </span><span class=nb>TEXT</span>
<span class=p>);</span>
</code></pre></div> <p><strong>Oracle Sequences:</strong></p> <div class=highlight><pre><span></span><code><span class=k>CREATE</span><span class=w> </span><span class=n>SEQUENCE</span><span class=w> </span><span class=n>order_seq</span>
<span class=w>    </span><span class=k>START</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=mi>1</span>
<span class=w>    </span><span class=k>INCREMENT</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=mi>1</span>
<span class=w>    </span><span class=n>NOCACHE</span><span class=p>;</span>

<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>product</span><span class=p>)</span>
<span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=n>order_seq</span><span class=p>.</span><span class=n>NEXTVAL</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Product A&#39;</span><span class=p>);</span>

<span class=k>SELECT</span><span class=w> </span><span class=n>order_seq</span><span class=p>.</span><span class=n>CURRVAL</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dual</span><span class=p>;</span>
</code></pre></div> <p><strong>SQL Server:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- IDENTITY (column property)</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>IDENTITY</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span>
<span class=w>    </span><span class=n>product</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
<span class=p>);</span>

<span class=c1>-- Sequence (SQL Server 2012+)</span>
<span class=k>CREATE</span><span class=w> </span><span class=n>SEQUENCE</span><span class=w> </span><span class=n>order_seq</span>
<span class=w>    </span><span class=k>START</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=mi>1</span>
<span class=w>    </span><span class=k>INCREMENT</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>

<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>product</span><span class=p>)</span>
<span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=k>NEXT</span><span class=w> </span><span class=n>VALUE</span><span class=w> </span><span class=k>FOR</span><span class=w> </span><span class=n>order_seq</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Product A&#39;</span><span class=p>);</span>
</code></pre></div> <p><strong>Gaps in Sequences:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Sequences can have gaps due to:</span>
<span class=c1>-- - Rollbacks</span>
<span class=c1>-- - Cached values</span>
<span class=c1>-- - Concurrent inserts</span>

<span class=c1>-- Reset sequence</span>
<span class=k>ALTER</span><span class=w> </span><span class=n>SEQUENCE</span><span class=w> </span><span class=n>order_seq</span><span class=w> </span><span class=k>RESTART</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> ID generation knowledge.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows sequences vs IDENTITY differences</li> <li>Understands gaps are normal</li> <li>Uses CACHE for performance</li> <li>Knows SERIAL is PostgreSQL shorthand</li> </ul> </div> </details> <hr> <h3 id=how-do-you-create-and-use-temporary-tables-amazon-google-interview-question>How Do You Create and Use Temporary Tables? - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Temp Tables</code>, <code>Session Data</code>, <code>Performance</code> | <strong>Asked by:</strong> Amazon, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Temporary Tables:</strong></p> <p>Tables that exist only for the session/transaction.</p> <p><strong>PostgreSQL:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Session-scoped (default)</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TEMPORARY</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>temp_results</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span>
<span class=w>    </span><span class=n>value</span><span class=w> </span><span class=nb>TEXT</span>
<span class=p>);</span>

<span class=c1>-- Transaction-scoped</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TEMPORARY</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>temp_data</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span>
<span class=p>)</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>COMMIT</span><span class=w> </span><span class=k>DROP</span><span class=p>;</span>

<span class=c1>-- Create from query</span>
<span class=k>CREATE</span><span class=w> </span><span class=n>TEMP</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>temp_orders</span><span class=w> </span><span class=k>AS</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>;</span>

<span class=c1>-- Use it</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>temp_orders</span><span class=p>;</span>

<span class=c1>-- Automatically dropped at session end</span>
</code></pre></div> <p><strong>SQL Server:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Local temp table (session-scoped)</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>#</span><span class=n>temp_orders</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span>
<span class=w>    </span><span class=n>product</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
<span class=p>);</span>

<span class=c1>-- Global temp table (visible to all sessions)</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>##</span><span class=n>global_temp</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span>
<span class=p>);</span>

<span class=c1>-- Table variable (stored in memory)</span>
<span class=k>DECLARE</span><span class=w> </span><span class=o>@</span><span class=n>temp</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span>
<span class=w>    </span><span class=n>value</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
<span class=p>);</span>

<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=o>@</span><span class=n>temp</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;test&#39;</span><span class=p>);</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=o>@</span><span class=n>temp</span><span class=p>;</span>
</code></pre></div> <p><strong>MySQL:</strong></p> <div class=highlight><pre><span></span><code><span class=k>CREATE</span><span class=w> </span><span class=k>TEMPORARY</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>temp_users</span><span class=w> </span><span class=k>AS</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>active</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>

<span class=c1>-- Explicitly drop</span>
<span class=k>DROP</span><span class=w> </span><span class=k>TEMPORARY</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>IF</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=n>temp_users</span><span class=p>;</span>
</code></pre></div> <p><strong>When to Use:</strong></p> <table> <thead> <tr> <th>Use Case</th> <th>Recommendation</th> </tr> </thead> <tbody> <tr> <td>Complex multi-step queries</td> <td>Temp table</td> </tr> <tr> <td>Store intermediate results</td> <td>Temp table</td> </tr> <tr> <td>Small row sets</td> <td>Table variable (SQL Server)</td> </tr> <tr> <td>Need indexes</td> <td>Temp table</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Query optimization strategies.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows temp tables for multi-step processing</li> <li>Uses CTEs for simpler cases</li> <li>Understands session vs transaction scope</li> <li>Knows #local vs ##global in SQL Server</li> </ul> </div> </details> <hr> <h3 id=how-do-you-perform-a-safe-update-with-join-amazon-google-interview-question>How Do You Perform a Safe UPDATE with JOIN? - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>UPDATE</code>, <code>JOIN</code>, <code>Data Modification</code> | <strong>Asked by:</strong> Amazon, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>UPDATE with JOIN:</strong></p> <p>Update one table based on values from another.</p> <p><strong>PostgreSQL / MySQL:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- PostgreSQL syntax</span>
<span class=k>UPDATE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=n>o</span>
<span class=k>SET</span><span class=w> </span>
<span class=w>    </span><span class=n>customer_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>name</span><span class=p>,</span>
<span class=w>    </span><span class=n>customer_email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>email</span>
<span class=k>FROM</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=k>c</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>id</span>
<span class=w>  </span><span class=k>AND</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;pending&#39;</span><span class=p>;</span>

<span class=c1>-- MySQL syntax</span>
<span class=k>UPDATE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=n>o</span>
<span class=k>JOIN</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>id</span>
<span class=k>SET</span><span class=w> </span>
<span class=w>    </span><span class=n>o</span><span class=p>.</span><span class=n>customer_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>name</span><span class=p>,</span>
<span class=w>    </span><span class=n>o</span><span class=p>.</span><span class=n>customer_email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>email</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;pending&#39;</span><span class=p>;</span>
</code></pre></div> <p><strong>SQL Server:</strong></p> <div class=highlight><pre><span></span><code><span class=k>UPDATE</span><span class=w> </span><span class=n>o</span>
<span class=k>SET</span><span class=w> </span>
<span class=w>    </span><span class=n>o</span><span class=p>.</span><span class=n>customer_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>name</span><span class=p>,</span>
<span class=w>    </span><span class=n>o</span><span class=p>.</span><span class=n>customer_email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>email</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=n>o</span>
<span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>id</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;pending&#39;</span><span class=p>;</span>
</code></pre></div> <p><strong>Safe Update Practices:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- 1. Preview with SELECT first</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>customer_name</span><span class=p>,</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>new_name</span>
<span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=n>o</span>
<span class=k>JOIN</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>id</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;pending&#39;</span><span class=p>;</span>

<span class=c1>-- 2. Use transaction</span>
<span class=k>BEGIN</span><span class=p>;</span>
<span class=k>UPDATE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=n>o</span>
<span class=k>SET</span><span class=w> </span><span class=n>customer_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>name</span>
<span class=k>FROM</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=k>c</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>id</span><span class=p>;</span>

<span class=c1>-- Verify</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>customer_name</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span>

<span class=c1>-- Commit or rollback</span>
<span class=k>COMMIT</span><span class=p>;</span><span class=w>  </span><span class=c1>-- or ROLLBACK;</span>

<span class=c1>-- 3. Limit rows for testing</span>
<span class=k>UPDATE</span><span class=w> </span><span class=n>orders</span>
<span class=k>SET</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;processed&#39;</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;pending&#39;</span><span class=w> </span>
<span class=w>    </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>10</span>
<span class=p>);</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Safe data modification.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Always previews with SELECT first</li> <li>Uses transactions for safety</li> <li>Knows UPDATE syntax varies by database</li> <li>Tests on limited rows before full update</li> </ul> </div> </details> <hr> <h3 id=what-is-the-difference-between-having-and-where-most-tech-companies-interview-question>What is the Difference Between HAVING and WHERE? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Filtering</code>, <code>Aggregation</code>, <code>SQL Basics</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>WHERE vs HAVING:</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>WHERE</th> <th>HAVING</th> </tr> </thead> <tbody> <tr> <td>Filters</td> <td>Row-level before grouping</td> <td>Groups after aggregation</td> </tr> <tr> <td>Can use aggregates</td> <td>No</td> <td>Yes</td> </tr> <tr> <td>Executed</td> <td>Before GROUP BY</td> <td>After GROUP BY</td> </tr> <tr> <td>Performance</td> <td>Reduces data early</td> <td>Filters after calculation</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><span class=c1>-- WHERE: filters rows before grouping</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>category</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>product_count</span>
<span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>price</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>10</span><span class=w>  </span><span class=c1>-- Filter individual rows</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>category</span><span class=p>;</span>

<span class=c1>-- HAVING: filters groups after aggregation</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>category</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>product_count</span>
<span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>category</span>
<span class=k>HAVING</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>5</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Filter groups</span>

<span class=c1>-- Combined: both WHERE and HAVING</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>category</span><span class=p>,</span>
<span class=w>    </span><span class=k>AVG</span><span class=p>(</span><span class=n>price</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_price</span><span class=p>,</span>
<span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>count</span>
<span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>active</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>true</span><span class=w>          </span><span class=c1>-- First: filter rows</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>category</span>
<span class=k>HAVING</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>price</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>100</span><span class=p>;</span><span class=w>     </span><span class=c1>-- Then: filter groups</span>
</code></pre></div> <p><strong>Common Mistake:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- ‚ùå Wrong: Can&#39;t use aggregate in WHERE</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>category</span><span class=p>,</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>price</span><span class=p>)</span>
<span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=k>WHERE</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>price</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>100</span><span class=w>  </span><span class=c1>-- ERROR!</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>category</span><span class=p>;</span>

<span class=c1>-- ‚úÖ Correct: Use HAVING for aggregates</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>category</span><span class=p>,</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>price</span><span class=p>)</span>
<span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>category</span>
<span class=k>HAVING</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>price</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>100</span><span class=p>;</span>

<span class=c1>-- ‚ùå Inefficient: Filtering rows in HAVING</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>category</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span>
<span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>category</span>
<span class=k>HAVING</span><span class=w> </span><span class=n>price</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>10</span><span class=p>;</span><span class=w>  </span><span class=c1>-- Should be in WHERE!</span>

<span class=c1>-- ‚úÖ Better: Filter early</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>category</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span>
<span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>price</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>10</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>category</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Aggregation understanding.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows WHERE is for rows, HAVING for groups</li> <li>Filters as early as possible (WHERE)</li> <li>Uses correct syntax for aggregates</li> <li>Understands execution order</li> </ul> </div> </details> <hr> <h3 id=how-do-you-handle-duplicate-detection-and-removal-amazon-google-interview-question>How Do You Handle Duplicate Detection and Removal? - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Duplicates</code>, <code>Data Quality</code>, <code>Deduplication</code> | <strong>Asked by:</strong> Amazon, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Find Duplicates:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Find duplicate rows</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>email</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>count</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>email</span>
<span class=k>HAVING</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>

<span class=c1>-- Find duplicate with all columns</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>email</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>dup_count</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=k>HAVING</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span>
<span class=p>);</span>

<span class=c1>-- Find duplicate pairs</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>u1</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id1</span><span class=p>,</span><span class=w> </span><span class=n>u2</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>id2</span><span class=p>,</span><span class=w> </span>
<span class=w>    </span><span class=n>u1</span><span class=p>.</span><span class=n>email</span>
<span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=n>u1</span>
<span class=k>JOIN</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=n>u2</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>u1</span><span class=p>.</span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>u2</span><span class=p>.</span><span class=n>email</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>u1</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>u2</span><span class=p>.</span><span class=n>id</span><span class=p>;</span>
</code></pre></div> <p><strong>Remove Duplicates (Keep One):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Delete keeping lowest ID</span>
<span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=k>MIN</span><span class=p>(</span><span class=n>id</span><span class=p>)</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>email</span>
<span class=p>);</span>

<span class=c1>-- PostgreSQL: Using ctid (row identifier)</span>
<span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=n>a</span>
<span class=k>USING</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=n>b</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>ctid</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>ctid</span>
<span class=w>  </span><span class=k>AND</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>email</span><span class=p>;</span>

<span class=c1>-- SQL Server: Using ROW_NUMBER</span>
<span class=k>WITH</span><span class=w> </span><span class=n>cte</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=p>,</span>
<span class=w>        </span><span class=n>ROW_NUMBER</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>rn</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=p>)</span>
<span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>cte</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>rn</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>

<span class=c1>-- PostgreSQL equivalent</span>
<span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span>
<span class=w>            </span><span class=n>ROW_NUMBER</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>rn</span>
<span class=w>        </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=n>t</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>rn</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span>
<span class=p>);</span>
</code></pre></div> <p><strong>Prevent Duplicates:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Unique constraint</span>
<span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=n>unique_email</span><span class=w> </span><span class=k>UNIQUE</span><span class=w> </span><span class=p>(</span><span class=n>email</span><span class=p>);</span>

<span class=c1>-- Insert ignore duplicates</span>
<span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=p>(</span><span class=n>email</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>)</span>
<span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;test@example.com&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Test&#39;</span><span class=p>)</span>
<span class=k>ON</span><span class=w> </span><span class=n>CONFLICT</span><span class=w> </span><span class=p>(</span><span class=n>email</span><span class=p>)</span><span class=w> </span><span class=k>DO</span><span class=w> </span><span class=k>NOTHING</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Data quality skills.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses window functions for efficient dedup</li> <li>Previews before deleting</li> <li>Knows to add constraints to prevent</li> <li>Handles which duplicate to keep</li> </ul> </div> </details> <hr> <h3 id=what-is-database-normalization-explain-1nf-2nf-3nf-google-amazon-interview-question>What is Database Normalization? Explain 1NF, 2NF, 3NF - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Normalization</code>, <code>Database Design</code>, <code>Schema</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>Normalization:</strong></p> <p>Process of organizing data to reduce redundancy and improve integrity.</p> <p><strong>1NF (First Normal Form):</strong></p> <ul> <li>Atomic values (no arrays/lists in cells)</li> <li>Unique rows (primary key)</li> </ul> <div class=highlight><pre><span></span><code><span class=c1>-- ‚ùå Not 1NF</span>
<span class=c1>-- id | name  | phones</span>
<span class=c1>-- 1  | John  | 123-456, 789-012</span>

<span class=c1>-- ‚úÖ 1NF</span>
<span class=c1>-- users: id, name</span>
<span class=c1>-- phones: id, user_id, phone</span>
</code></pre></div> <p><strong>2NF (Second Normal Form):</strong></p> <ul> <li>1NF + No partial dependencies</li> <li>All non-key columns depend on entire primary key</li> </ul> <div class=highlight><pre><span></span><code><span class=c1>-- ‚ùå Not 2NF (partial dependency)</span>
<span class=c1>-- order_items: order_id, product_id, product_name, quantity</span>
<span class=c1>-- product_name depends only on product_id, not full key</span>

<span class=c1>-- ‚úÖ 2NF</span>
<span class=c1>-- order_items: order_id, product_id, quantity</span>
<span class=c1>-- products: product_id, product_name</span>
</code></pre></div> <p><strong>3NF (Third Normal Form):</strong></p> <ul> <li>2NF + No transitive dependencies</li> <li>Non-key columns don't depend on other non-key columns</li> </ul> <div class=highlight><pre><span></span><code><span class=c1>-- ‚ùå Not 3NF (transitive dependency)</span>
<span class=c1>-- employees: id, department_id, department_name</span>
<span class=c1>-- department_name depends on department_id (non-key)</span>

<span class=c1>-- ‚úÖ 3NF</span>
<span class=c1>-- employees: id, department_id</span>
<span class=c1>-- departments: id, name</span>
</code></pre></div> <p><strong>When to Denormalize:</strong></p> <table> <thead> <tr> <th>Normalize</th> <th>Denormalize</th> </tr> </thead> <tbody> <tr> <td>OLTP (transactions)</td> <td>OLAP (analytics)</td> </tr> <tr> <td>Data integrity critical</td> <td>Read performance critical</td> </tr> <tr> <td>Storage is limited</td> <td>Complex joins hurt performance</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Database design fundamentals.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Explains normal forms progressively</li> <li>Gives concrete examples</li> <li>Knows when to denormalize</li> <li>Understands trade-offs</li> </ul> </div> </details> <hr> <h3 id=how-do-you-calculate-running-totals-and-moving-averages-google-amazon-interview-question>How Do You Calculate Running Totals and Moving Averages? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Window Functions</code>, <code>Analytics</code>, <code>Time Series</code> | <strong>Asked by:</strong> Google, Amazon, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>Running Total:</strong></p> <div class=highlight><pre><span></span><code><span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=nb>date</span><span class=p>,</span>
<span class=w>    </span><span class=n>amount</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>running_total</span>
<span class=k>FROM</span><span class=w> </span><span class=n>transactions</span><span class=p>;</span>

<span class=c1>-- Running total per category</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>category</span><span class=p>,</span>
<span class=w>    </span><span class=nb>date</span><span class=p>,</span>
<span class=w>    </span><span class=n>amount</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>category</span><span class=w> </span>
<span class=w>        </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>category_running_total</span>
<span class=k>FROM</span><span class=w> </span><span class=n>transactions</span><span class=p>;</span>

<span class=c1>-- Running total with reset each month</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=nb>date</span><span class=p>,</span>
<span class=w>    </span><span class=n>amount</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>DATE_TRUNC</span><span class=p>(</span><span class=s1>&#39;month&#39;</span><span class=p>,</span><span class=w> </span><span class=nb>date</span><span class=p>)</span>
<span class=w>        </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>monthly_running_total</span>
<span class=k>FROM</span><span class=w> </span><span class=n>transactions</span><span class=p>;</span>
</code></pre></div> <p><strong>Moving Average:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- 7-day moving average</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=nb>date</span><span class=p>,</span>
<span class=w>    </span><span class=n>value</span><span class=p>,</span>
<span class=w>    </span><span class=k>AVG</span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span>
<span class=w>        </span><span class=k>ROWS</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>6</span><span class=w> </span><span class=n>PRECEDING</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>CURRENT</span><span class=w> </span><span class=k>ROW</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>moving_avg_7d</span>
<span class=k>FROM</span><span class=w> </span><span class=n>daily_metrics</span><span class=p>;</span>

<span class=c1>-- Moving average by rows</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=nb>date</span><span class=p>,</span>
<span class=w>    </span><span class=n>value</span><span class=p>,</span>
<span class=w>    </span><span class=k>AVG</span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span>
<span class=w>        </span><span class=k>ROWS</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=n>PRECEDING</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=n>FOLLOWING</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>centered_avg</span>
<span class=k>FROM</span><span class=w> </span><span class=n>daily_metrics</span><span class=p>;</span>

<span class=c1>-- Exponential moving average (approximation)</span>
<span class=k>WITH</span><span class=w> </span><span class=n>recursive_ema</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=nb>date</span><span class=p>,</span><span class=w> </span>
<span class=w>        </span><span class=n>value</span><span class=p>,</span>
<span class=w>        </span><span class=n>value</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>ema</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>daily_metrics</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>MIN</span><span class=p>(</span><span class=nb>date</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>daily_metrics</span><span class=p>)</span>

<span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>

<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=n>d</span><span class=p>.</span><span class=nb>date</span><span class=p>,</span>
<span class=w>        </span><span class=n>d</span><span class=p>.</span><span class=n>value</span><span class=p>,</span>
<span class=w>        </span><span class=mi>0</span><span class=p>.</span><span class=mi>2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>8</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=n>ema</span><span class=w>  </span><span class=c1>-- alpha = 0.2</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>daily_metrics</span><span class=w> </span><span class=n>d</span>
<span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>recursive_ema</span><span class=w> </span><span class=n>r</span><span class=w> </span>
<span class=w>        </span><span class=k>ON</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=nb>date</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r</span><span class=p>.</span><span class=nb>date</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>&#39;1 day&#39;</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>recursive_ema</span><span class=p>;</span>
</code></pre></div> <p><strong>ROWS vs RANGE:</strong></p> <table> <thead> <tr> <th>Frame</th> <th>Behavior</th> </tr> </thead> <tbody> <tr> <td>ROWS</td> <td>Exact number of rows</td> </tr> <tr> <td>RANGE</td> <td>All rows with same value</td> </tr> <tr> <td>GROUPS</td> <td>Number of peer groups</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Time series analysis in SQL.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses window frames correctly</li> <li>Knows ROWS vs RANGE difference</li> <li>Can calculate various moving stats</li> <li>Understands PARTITION BY for grouping</li> </ul> </div> </details> <hr> <h3 id=how-do-you-find-gaps-in-sequential-data-amazon-google-interview-question>How Do You Find Gaps in Sequential Data? - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Gaps</code>, <code>Sequences</code>, <code>Data Quality</code> | <strong>Asked by:</strong> Amazon, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Find Gaps in ID Sequence:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Using window function</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>gap_start</span><span class=p>,</span>
<span class=w>    </span><span class=n>next_id</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>gap_end</span>
<span class=k>FROM</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=n>id</span><span class=p>,</span>
<span class=w>        </span><span class=n>LEAD</span><span class=p>(</span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>next_id</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span>
<span class=p>)</span><span class=w> </span><span class=n>t</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>next_id</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>

<span class=c1>-- Alternative: generate series</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>missing_id</span>
<span class=k>FROM</span><span class=w> </span><span class=n>generate_series</span><span class=p>(</span>
<span class=w>    </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>MIN</span><span class=p>(</span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=p>),</span>
<span class=w>    </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>MAX</span><span class=p>(</span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=p>)</span>
<span class=p>)</span><span class=w> </span><span class=n>s</span><span class=p>(</span><span class=n>id</span><span class=p>)</span>
<span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=n>o</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>id</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span>
</code></pre></div> <p><strong>Find Gaps in Dates:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Days without transactions</span>
<span class=k>WITH</span><span class=w> </span><span class=n>date_range</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>generate_series</span><span class=p>(</span>
<span class=w>        </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>MIN</span><span class=p>(</span><span class=n>transaction_date</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>transactions</span><span class=p>),</span>
<span class=w>        </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>MAX</span><span class=p>(</span><span class=n>transaction_date</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>transactions</span><span class=p>),</span>
<span class=w>        </span><span class=nb>INTERVAL</span><span class=w> </span><span class=s1>&#39;1 day&#39;</span>
<span class=w>    </span><span class=p>)::</span><span class=nb>date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>date</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=nb>date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>missing_date</span>
<span class=k>FROM</span><span class=w> </span><span class=n>date_range</span><span class=w> </span><span class=n>d</span>
<span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>transactions</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=nb>date</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>t</span><span class=p>.</span><span class=n>transaction_date</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>t</span><span class=p>.</span><span class=n>transaction_date</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span>

<span class=c1>-- Using window function</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>transaction_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>gap_start</span><span class=p>,</span>
<span class=w>    </span><span class=n>next_date</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>gap_end</span><span class=p>,</span>
<span class=w>    </span><span class=n>next_date</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>transaction_date</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_missing</span>
<span class=k>FROM</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=n>transaction_date</span><span class=p>,</span>
<span class=w>        </span><span class=n>LEAD</span><span class=p>(</span><span class=n>transaction_date</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>transaction_date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>next_date</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>transaction_date</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>transactions</span><span class=p>)</span><span class=w> </span><span class=n>t</span>
<span class=p>)</span><span class=w> </span><span class=n>gaps</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>next_date</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>transaction_date</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</code></pre></div> <p><strong>Find Gaps in Time Ranges (Islands):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Identify islands of continuous data</span>
<span class=k>WITH</span><span class=w> </span><span class=n>numbered</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=o>*</span><span class=p>,</span>
<span class=w>        </span><span class=nb>date</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=p>(</span><span class=n>ROW_NUMBER</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span><span class=p>))::</span><span class=nb>int</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>grp</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>daily_data</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=k>MIN</span><span class=p>(</span><span class=nb>date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>island_start</span><span class=p>,</span>
<span class=w>    </span><span class=k>MAX</span><span class=p>(</span><span class=nb>date</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>island_end</span><span class=p>,</span>
<span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>days_in_island</span>
<span class=k>FROM</span><span class=w> </span><span class=n>numbered</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>grp</span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>island_start</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Data quality analysis.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses LEAD/LAG for gap detection</li> <li>Uses generate_series for completeness checks</li> <li>Knows islands and gaps problem</li> <li>Understands performance implications</li> </ul> </div> </details> <hr> <h3 id=how-do-you-write-efficient-pagination-queries-amazon-google-interview-question>How Do You Write Efficient Pagination Queries? - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Pagination</code>, <code>Performance</code>, <code>Large Tables</code> | <strong>Asked by:</strong> Amazon, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>OFFSET Pagination (Simple but Slow):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Page 1</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span><span class=w> </span><span class=k>OFFSET</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>

<span class=c1>-- Page 50 (slow - scans 1000 rows!)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span><span class=w> </span><span class=k>OFFSET</span><span class=w> </span><span class=mi>980</span><span class=p>;</span>

<span class=c1>-- Problem: OFFSET scans and discards rows</span>
<span class=c1>-- O(n) complexity for large offsets</span>
</code></pre></div> <p><strong>Keyset Pagination (Fast):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- First page</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>id</span>
<span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span><span class=p>;</span>

<span class=c1>-- Next page (after id 20)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>20</span><span class=w>  </span><span class=c1>-- Last ID from previous page</span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>id</span>
<span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span><span class=p>;</span>

<span class=c1>-- With multiple columns</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=k>WHERE</span><span class=w> </span><span class=p>(</span><span class=n>created_at</span><span class=p>,</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;2024-01-15&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>100</span><span class=p>)</span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>created_at</span><span class=p>,</span><span class=w> </span><span class=n>id</span>
<span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span><span class=p>;</span>

<span class=c1>-- Previous page</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>20</span>
<span class=w>    </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>DESC</span>
<span class=w>    </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span>
<span class=p>)</span><span class=w> </span><span class=n>t</span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>ASC</span><span class=p>;</span>
</code></pre></div> <p><strong>Indexed Pagination:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Requires covering index</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_products_pagination</span><span class=w> </span>
<span class=k>ON</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=p>(</span><span class=n>created_at</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>DESC</span><span class=p>);</span>

<span class=c1>-- Very fast with index</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>price</span><span class=p>,</span><span class=w> </span><span class=n>created_at</span>
<span class=k>FROM</span><span class=w> </span><span class=n>products</span>
<span class=k>WHERE</span><span class=w> </span><span class=p>(</span><span class=n>created_at</span><span class=p>,</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;2024-01-15&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>100</span><span class=p>)</span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>DESC</span>
<span class=k>LIMIT</span><span class=w> </span><span class=mi>20</span><span class=p>;</span>
</code></pre></div> <p><strong>Comparison:</strong></p> <table> <thead> <tr> <th>Method</th> <th>Page 1</th> <th>Page 1000</th> <th>Jump to page</th> </tr> </thead> <tbody> <tr> <td>OFFSET</td> <td>Fast</td> <td>Very slow</td> <td>Easy</td> </tr> <tr> <td>Keyset</td> <td>Fast</td> <td>Fast</td> <td>Hard</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Performance awareness.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows OFFSET performance issue</li> <li>Uses keyset for large datasets</li> <li>Understands index requirements</li> <li>Trade-offs: keyset can't jump to page N</li> </ul> </div> </details> <hr> <h3 id=what-is-data-warehouse-star-schema-amazon-google-interview-question>What is Data Warehouse Star Schema? - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Data Warehouse</code>, <code>Star Schema</code>, <code>OLAP</code> | <strong>Asked by:</strong> Amazon, Google, Snowflake</p> <details class=success> <summary>View Answer</summary> <p><strong>Star Schema:</strong></p> <p>Dimensional modeling with central fact table surrounded by dimension tables.</p> <div class=highlight><pre><span></span><code><span class=c1>-- Fact table (metrics/events)</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>fact_sales</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>sale_id</span><span class=w> </span><span class=nb>SERIAL</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span>
<span class=w>    </span><span class=n>date_key</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>dim_date</span><span class=p>(</span><span class=n>date_key</span><span class=p>),</span>
<span class=w>    </span><span class=n>product_key</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>dim_product</span><span class=p>(</span><span class=n>product_key</span><span class=p>),</span>
<span class=w>    </span><span class=n>store_key</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>dim_store</span><span class=p>(</span><span class=n>store_key</span><span class=p>),</span>
<span class=w>    </span><span class=n>customer_key</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>dim_customer</span><span class=p>(</span><span class=n>customer_key</span><span class=p>),</span>

<span class=w>    </span><span class=c1>-- Measures</span>
<span class=w>    </span><span class=n>quantity</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span>
<span class=w>    </span><span class=n>unit_price</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=mi>2</span><span class=p>),</span>
<span class=w>    </span><span class=n>total_amount</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=mi>2</span><span class=p>),</span>
<span class=w>    </span><span class=n>discount</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span>
<span class=p>);</span>

<span class=c1>-- Dimension tables (descriptive attributes)</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>dim_date</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>date_key</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span>
<span class=w>    </span><span class=n>full_date</span><span class=w> </span><span class=nb>DATE</span><span class=p>,</span>
<span class=w>    </span><span class=k>year</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span>
<span class=w>    </span><span class=n>quarter</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span>
<span class=w>    </span><span class=k>month</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span>
<span class=w>    </span><span class=n>month_name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span>
<span class=w>    </span><span class=n>week</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span>
<span class=w>    </span><span class=n>day_of_week</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span>
<span class=w>    </span><span class=n>is_weekend</span><span class=w> </span><span class=nb>BOOLEAN</span><span class=p>,</span>
<span class=w>    </span><span class=n>is_holiday</span><span class=w> </span><span class=nb>BOOLEAN</span>
<span class=p>);</span>

<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>dim_product</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=n>product_key</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span>
<span class=w>    </span><span class=n>product_id</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>50</span><span class=p>),</span>
<span class=w>    </span><span class=n>product_name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>200</span><span class=p>),</span>
<span class=w>    </span><span class=n>category</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>100</span><span class=p>),</span>
<span class=w>    </span><span class=n>subcategory</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>100</span><span class=p>),</span>
<span class=w>    </span><span class=n>brand</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
<span class=p>);</span>
</code></pre></div> <p><strong>Query Example:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Sales by category and quarter</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>p</span><span class=p>.</span><span class=n>category</span><span class=p>,</span>
<span class=w>    </span><span class=n>d</span><span class=p>.</span><span class=k>year</span><span class=p>,</span>
<span class=w>    </span><span class=n>d</span><span class=p>.</span><span class=n>quarter</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>f</span><span class=p>.</span><span class=n>total_amount</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>total_sales</span><span class=p>,</span>
<span class=w>    </span><span class=k>COUNT</span><span class=p>(</span><span class=k>DISTINCT</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>sale_id</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>transaction_count</span>
<span class=k>FROM</span><span class=w> </span><span class=n>fact_sales</span><span class=w> </span><span class=n>f</span>
<span class=k>JOIN</span><span class=w> </span><span class=n>dim_date</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>date_key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>date_key</span>
<span class=k>JOIN</span><span class=w> </span><span class=n>dim_product</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>f</span><span class=p>.</span><span class=n>product_key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>product_key</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=k>year</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2024</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>category</span><span class=p>,</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>quarter</span>
<span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>category</span><span class=p>,</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>quarter</span><span class=p>;</span>
</code></pre></div> <p><strong>Star vs Snowflake Schema:</strong></p> <table> <thead> <tr> <th>Star</th> <th>Snowflake</th> </tr> </thead> <tbody> <tr> <td>Denormalized dimensions</td> <td>Normalized dimensions</td> </tr> <tr> <td>Fewer joins</td> <td>More joins</td> </tr> <tr> <td>Faster queries</td> <td>Less redundancy</td> </tr> <tr> <td>More storage</td> <td>Complex structure</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> DW design understanding.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows fact vs dimension distinction</li> <li>Uses surrogate keys</li> <li>Understands star vs snowflake trade-offs</li> <li>Can design for specific analytics needs</li> </ul> </div> </details> <hr> <h3 id=how-do-you-optimize-count-on-large-tables-amazon-google-interview-question>How Do You Optimize COUNT(*) on Large Tables? - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Performance</code>, <code>Counting</code>, <code>Optimization</code> | <strong>Asked by:</strong> Amazon, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Problem with COUNT(*):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- On 100M rows, this is SLOW</span>
<span class=k>SELECT</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>large_table</span><span class=p>;</span>
<span class=c1>-- Must scan entire table (or index)</span>
</code></pre></div> <p><strong>Optimization Strategies:</strong></p> <p><strong>1. Table Statistics (Approximate):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- PostgreSQL: estimated count from planner</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>reltuples</span><span class=p>::</span><span class=nb>bigint</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>estimate</span>
<span class=k>FROM</span><span class=w> </span><span class=n>pg_class</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>relname</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;large_table&#39;</span><span class=p>;</span>

<span class=c1>-- MySQL</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>TABLE_ROWS</span>
<span class=k>FROM</span><span class=w> </span><span class=n>INFORMATION_SCHEMA</span><span class=p>.</span><span class=n>TABLES</span>
<span class=k>WHERE</span><span class=w> </span><span class=k>TABLE_NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;large_table&#39;</span><span class=p>;</span>
</code></pre></div> <p><strong>2. Covering Index:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- PostgreSQL index-only scan</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_count</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>large_table</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>);</span>

<span class=c1>-- Vacuum to update visibility map</span>
<span class=k>VACUUM</span><span class=w> </span><span class=n>large_table</span><span class=p>;</span>

<span class=k>SELECT</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>large_table</span><span class=p>;</span>
<span class=c1>-- Uses index-only scan if visibility map is current</span>
</code></pre></div> <p><strong>3. Materialized Count:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- Maintain count in separate table</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>table_counts</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>table_name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span>
<span class=w>    </span><span class=k>row_count</span><span class=w> </span><span class=nb>BIGINT</span><span class=p>,</span>
<span class=w>    </span><span class=n>updated_at</span><span class=w> </span><span class=k>TIMESTAMP</span>
<span class=p>);</span>

<span class=c1>-- Update with trigger or periodic job</span>
<span class=k>CREATE</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>REPLACE</span><span class=w> </span><span class=k>FUNCTION</span><span class=w> </span><span class=n>update_count</span><span class=p>()</span>
<span class=k>RETURNS</span><span class=w> </span><span class=k>TRIGGER</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=err>$$</span>
<span class=k>BEGIN</span>
<span class=w>    </span><span class=k>IF</span><span class=w> </span><span class=n>TG_OP</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;INSERT&#39;</span><span class=w> </span><span class=k>THEN</span>
<span class=w>        </span><span class=k>UPDATE</span><span class=w> </span><span class=n>table_counts</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=k>row_count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>row_count</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span>
<span class=w>        </span><span class=k>WHERE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;large_table&#39;</span><span class=p>;</span>
<span class=w>    </span><span class=k>ELSIF</span><span class=w> </span><span class=n>TG_OP</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;DELETE&#39;</span><span class=w> </span><span class=k>THEN</span>
<span class=w>        </span><span class=k>UPDATE</span><span class=w> </span><span class=n>table_counts</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=k>row_count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>row_count</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span>
<span class=w>        </span><span class=k>WHERE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;large_table&#39;</span><span class=p>;</span>
<span class=w>    </span><span class=k>END</span><span class=w> </span><span class=k>IF</span><span class=p>;</span>
<span class=w>    </span><span class=k>RETURN</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span>
<span class=k>END</span><span class=p>;</span><span class=w> </span><span class=err>$$</span><span class=w> </span><span class=k>LANGUAGE</span><span class=w> </span><span class=n>plpgsql</span><span class=p>;</span>
</code></pre></div> <p><strong>4. HyperLogLog (Approximate Distinct):</strong></p> <div class=highlight><pre><span></span><code><span class=c1>-- PostgreSQL with extension</span>
<span class=k>CREATE</span><span class=w> </span><span class=n>EXTENSION</span><span class=w> </span><span class=k>IF</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>EXISTS</span><span class=w> </span><span class=n>hll</span><span class=p>;</span>

<span class=c1>-- Approximate distinct count</span>
<span class=k>SELECT</span><span class=w> </span><span class=n>hll_cardinality</span><span class=p>(</span><span class=n>hll_add_agg</span><span class=p>(</span><span class=n>hll_hash_bigint</span><span class=p>(</span><span class=n>id</span><span class=p>)))</span>
<span class=k>FROM</span><span class=w> </span><span class=n>large_table</span><span class=p>;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Large-scale optimization.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses statistics for estimates</li> <li>Knows index-only scan requirements</li> <li>Maintains materialized counts for exact needs</li> <li>Uses approximate algorithms when acceptable</li> </ul> </div> </details> <hr> <h2 id=quick-reference-100-interview-questions>Quick Reference: 100+ Interview Questions</h2> <table> <thead> <tr> <th>Sno</th> <th>Question Title</th> <th>Practice Links</th> <th>Companies Asking</th> <th>Difficulty</th> <th>Topics</th> </tr> </thead> <tbody> <tr> <td>-----</td> <td>----------------------------------------------------</td> <td>--------------------------------------------------------------------------------</td> <td>-------------------------</td> <td>------------</td> <td>-----------------------------------------</td> </tr> <tr> <td>1</td> <td>Difference between <code>DELETE</code>, <code>TRUNCATE</code>, and <code>DROP</code></td> <td><a href=https://www.geeksforgeeks.org/difference-between-delete-truncate-and-drop-in-sql/ >GeeksforGeeks</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>DDL, DML</td> </tr> <tr> <td>2</td> <td>Types of SQL Joins (INNER, LEFT, RIGHT, FULL)</td> <td><a href=https://www.w3schools.com/sql/sql_join.asp>W3Schools</a></td> <td>Google, Amazon, Meta</td> <td>Easy</td> <td>Joins</td> </tr> <tr> <td>3</td> <td>What is Normalization? Explain different forms.</td> <td><a href=https://www.studytonight.com/dbms/database-normalization.php>StudyTonight</a></td> <td>Microsoft, Oracle, IBM</td> <td>Medium</td> <td>Database Design, Normalization</td> </tr> <tr> <td>4</td> <td>Explain Primary Key vs Foreign Key vs Unique Key</td> <td><a href=https://www.geeksforgeeks.org/difference-between-primary-key-and-foreign-key/ >GeeksforGeeks</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Constraints, Database Design</td> </tr> <tr> <td>5</td> <td>What are Indexes and why are they important?</td> <td><a href=https://essentialsSQL.com/what-is-a-database-index/ >Essential SQL</a></td> <td>Google, Amazon, Netflix</td> <td>Medium</td> <td>Performance Optimization, Indexes</td> </tr> <tr> <td>6</td> <td>Write a query to find the Nth highest salary.</td> <td><a href=https://leetcode.com/problems/nth-highest-salary/ >LeetCode</a></td> <td>Amazon, Microsoft, Uber</td> <td>Medium</td> <td>Subqueries, Window Functions, Ranking</td> </tr> <tr> <td>7</td> <td>Explain ACID properties in Databases.</td> <td><a href=https://www.geeksforgeeks.org/acid-properties-in-dbms/ >GeeksforGeeks</a></td> <td>Oracle, SAP, Banks</td> <td>Medium</td> <td>Transactions, Database Fundamentals</td> </tr> <tr> <td>8</td> <td>What is a Subquery? Types of Subqueries.</td> <td><a href=https://www.sqltutorial.org/sql-subquery/ >SQLTutorial.org</a></td> <td>Meta, Google, LinkedIn</td> <td>Medium</td> <td>Subqueries, Query Structure</td> </tr> <tr> <td>9</td> <td>Difference between <code>UNION</code> and <code>UNION ALL</code>.</td> <td><a href=https://www.w3schools.com/sql/sql_union.asp>W3Schools</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Set Operations</td> </tr> <tr> <td>10</td> <td>What are Window Functions? Give examples.</td> <td><a href=https://mode.com/sql-tutorial/sql-window-functions/ >Mode Analytics</a></td> <td>Netflix, Airbnb, Spotify</td> <td>Hard</td> <td>Window Functions, Advanced SQL</td> </tr> <tr> <td>11</td> <td>Explain Common Table Expressions (CTEs).</td> <td><a href=https://www.sqlshack.com/sql-server-common-table-expressions-cte/ >SQLShack</a></td> <td>Microsoft, Google</td> <td>Medium</td> <td>CTEs, Query Readability</td> </tr> <tr> <td>12</td> <td>How to handle NULL values in SQL?</td> <td><a href=https://blog.sqlauthority.com/2007/03/29/sql-server-handling-null-values/ >SQL Authority</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>NULL Handling, Functions (COALESCE, ISNULL)</td> </tr> <tr> <td>13</td> <td>What is SQL Injection and how to prevent it?</td> <td><a href=https://owasp.org/www-community/attacks/SQL_Injection>OWASP</a></td> <td>All Security-Conscious</td> <td>Medium</td> <td>Security, Best Practices</td> </tr> <tr> <td>14</td> <td>Difference between <code>GROUP BY</code> and <code>PARTITION BY</code>.</td> <td><a href=https://stackoverflow.com/questions/13387311/whats-the-difference-between-group-by-and-partition-by>Stack Overflow</a></td> <td>Advanced Roles</td> <td>Hard</td> <td>Aggregation, Window Functions</td> </tr> <tr> <td>15</td> <td>Write a query to find duplicate records in a table.</td> <td><a href=https://www.geeksforgeeks.org/sql-query-to-find-duplicate-rows-in-a-table/ >GeeksforGeeks</a></td> <td>Data Quality Roles</td> <td>Medium</td> <td>Aggregation, GROUP BY, HAVING</td> </tr> <tr> <td>16</td> <td>Difference between <code>WHERE</code> and <code>HAVING</code> clause.</td> <td><a href=https://www.sqltutorial.org/sql-having/ >SQLTutorial.org</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Filtering, Aggregation</td> </tr> <tr> <td>17</td> <td>What are Triggers? Give an example.</td> <td><a href=https://www.geeksforgeeks.org/sql-trigger/ >GeeksforGeeks</a></td> <td>Database Roles</td> <td>Medium</td> <td>Triggers, Automation</td> </tr> <tr> <td>18</td> <td>Explain different types of relationships (1:1, 1:N, N:M).</td> <td><a href=https://www.lucidchart.com/pages/database-diagram/database-relationships>Lucidchart</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Database Design, Relationships</td> </tr> <tr> <td>19</td> <td>What is a View in SQL?</td> <td><a href=https://www.w3schools.com/sql/sql_view.asp>W3Schools</a></td> <td>Google, Microsoft</td> <td>Easy</td> <td>Views, Abstraction</td> </tr> <tr> <td>20</td> <td>How to optimize a slow SQL query?</td> <td>[Several Resources]</td> <td>Performance Engineers</td> <td>Hard</td> <td>Performance Tuning, Optimization</td> </tr> <tr> <td>21</td> <td>Difference between <code>ROW_NUMBER()</code>, <code>RANK()</code>, <code>DENSE_RANK()</code>.</td> <td><a href=https://www.sqlshack.com/overview-of-sql-rank-functions/ >SQLShack</a></td> <td>Data Analysts, Scientists</td> <td>Medium</td> <td>Window Functions, Ranking</td> </tr> <tr> <td>22</td> <td>What is Database Denormalization? When to use it?</td> <td><a href=https://www.geeksforgeeks.org/denormalization-in-databases-dbms/ >GeeksforGeeks</a></td> <td>Performance-critical Apps</td> <td>Medium</td> <td>Database Design, Performance</td> </tr> <tr> <td>23</td> <td>Explain Stored Procedures. Advantages?</td> <td><a href=https://www.sqltutorial.org/sql-stored-procedures/ >SQLTutorial.org</a></td> <td>Oracle, Microsoft</td> <td>Medium</td> <td>Stored Procedures, Reusability</td> </tr> <tr> <td>24</td> <td>How does <code>BETWEEN</code> operator work?</td> <td><a href=https://www.w3schools.com/sql/sql_between.asp>W3Schools</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Operators, Filtering</td> </tr> <tr> <td>25</td> <td>What is the <code>CASE</code> statement used for?</td> <td><a href=https://www.w3schools.com/sql/sql_case.asp>W3Schools</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Conditional Logic</td> </tr> <tr> <td>26</td> <td>Explain Self Join with an example.</td> <td><a href=https://www.geeksforgeeks.org/sql-self-join/ >GeeksforGeeks</a></td> <td>Amazon, Meta</td> <td>Medium</td> <td>Joins</td> </tr> <tr> <td>27</td> <td>What is the purpose of <code>DISTINCT</code> keyword?</td> <td><a href=https://www.w3schools.com/sql/sql_distinct.asp>W3Schools</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Deduplication, Querying</td> </tr> <tr> <td>28</td> <td>How to find the second highest value?</td> <td>[Various Methods]</td> <td>Common Interview Q</td> <td>Medium</td> <td>Subqueries, Window Functions</td> </tr> <tr> <td>29</td> <td>What is Referential Integrity?</td> <td><a href=https://www.techopedia.com/definition/24220/referential-integrity>Techopedia</a></td> <td>Database Roles</td> <td>Medium</td> <td>Constraints, Data Integrity</td> </tr> <tr> <td>30</td> <td>Explain <code>EXISTS</code> and <code>NOT EXISTS</code> operators.</td> <td><a href=https://www.sqltutorial.org/sql-exists/ >SQLTutorial.org</a></td> <td>Google, LinkedIn</td> <td>Medium</td> <td>Subqueries, Operators</td> </tr> <tr> <td>31</td> <td>What is a Schema in a database?</td> <td><a href=https://en.wikipedia.org/wiki/Database_schema>Wikipedia</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Database Concepts</td> </tr> <tr> <td>32</td> <td>Difference between <code>CHAR</code> and <code>VARCHAR</code> data types.</td> <td><a href=https://www.geeksforgeeks.org/difference-between-char-and-varchar-in-sql/ >GeeksforGeeks</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Data Types, Storage</td> </tr> <tr> <td>33</td> <td>How to concatenate strings in SQL?</td> <td><a href=https://database.guide/how-to-concatenate-strings-in-sql/ >Database.Guide</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>String Manipulation</td> </tr> <tr> <td>34</td> <td>What is Data Warehousing?</td> <td><a href=https://www.ibm.com/cloud/learn/data-warehouse>IBM</a></td> <td>BI Roles, Data Engineers</td> <td>Medium</td> <td>Data Warehousing, BI</td> </tr> <tr> <td>35</td> <td>Explain ETL (Extract, Transform, Load) process.</td> <td><a href=https://aws.amazon.com/what-is/etl/ >AWS</a></td> <td>Data Engineers</td> <td>Medium</td> <td>ETL, Data Integration</td> </tr> <tr> <td>36</td> <td>What are Aggregate Functions? List some.</td> <td><a href=https://www.w3schools.com/sql/sql_agg_functions.asp>W3Schools</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Aggregation</td> </tr> <tr> <td>37</td> <td>How to handle transactions (COMMIT, ROLLBACK)?</td> <td><a href=https://www.sqltutorial.org/sql-transaction/ >SQLTutorial.org</a></td> <td>Database Developers</td> <td>Medium</td> <td>Transactions, ACID</td> </tr> <tr> <td>38</td> <td>What is Database Sharding?</td> <td><a href=https://www.digitalocean.com/community/tutorials/understanding-database-sharding>DigitalOcean</a></td> <td>Scalability Roles</td> <td>Hard</td> <td>Scalability, Database Architecture</td> </tr> <tr> <td>39</td> <td>Explain Database Replication.</td> <td><a href=https://en.wikipedia.org/wiki/Replication_(computing)#Database_replication>Wikipedia</a></td> <td>High Availability Roles</td> <td>Hard</td> <td>High Availability, Replication</td> </tr> <tr> <td>40</td> <td>What is the <code>LIKE</code> operator used for?</td> <td><a href=https://www.w3schools.com/sql/sql_like.asp>W3Schools</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Pattern Matching, Filtering</td> </tr> <tr> <td>41</td> <td>Difference between <code>COUNT(*)</code> and <code>COUNT(column)</code>.</td> <td><a href=https://stackoverflow.com/questions/10088520/count-vs-countcolumn-name-which-is-more-correct>Stack Overflow</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Aggregation, NULL Handling</td> </tr> <tr> <td>42</td> <td>What is a Candidate Key?</td> <td><a href=https://www.geeksforgeeks.org/candidate-key-in-dbms/ >GeeksforGeeks</a></td> <td>Database Design Roles</td> <td>Medium</td> <td>Keys, Database Design</td> </tr> <tr> <td>43</td> <td>Explain Super Key.</td> <td><a href=https://www.geeksforgeeks.org/super-key-in-dbms/ >GeeksforGeeks</a></td> <td>Database Design Roles</td> <td>Medium</td> <td>Keys, Database Design</td> </tr> <tr> <td>44</td> <td>What is Composite Key?</td> <td><a href=https://www.geeksforgeeks.org/composite-key-in-dbms/ >GeeksforGeeks</a></td> <td>Database Design Roles</td> <td>Medium</td> <td>Keys, Database Design</td> </tr> <tr> <td>45</td> <td>How to get the current date and time in SQL?</td> <td>[Varies by RDBMS]</td> <td>Most Tech Companies</td> <td>Easy</td> <td>Date/Time Functions</td> </tr> <tr> <td>46</td> <td>What is the purpose of <code>ALTER TABLE</code> statement?</td> <td><a href=https://www.w3schools.com/sql/sql_alter.asp>W3Schools</a></td> <td>Database Admins/Devs</td> <td>Easy</td> <td>DDL, Schema Modification</td> </tr> <tr> <td>47</td> <td>Explain <code>CHECK</code> constraint.</td> <td><a href=https://www.w3schools.com/sql/sql_check.asp>W3Schools</a></td> <td>Database Design Roles</td> <td>Easy</td> <td>Constraints, Data Integrity</td> </tr> <tr> <td>48</td> <td>What is <code>DEFAULT</code> constraint?</td> <td><a href=https://www.w3schools.com/sql/sql_default.asp>W3Schools</a></td> <td>Database Design Roles</td> <td>Easy</td> <td>Constraints, Default Values</td> </tr> <tr> <td>49</td> <td>How to create a temporary table?</td> <td>[Varies by RDBMS]</td> <td>Developers</td> <td>Medium</td> <td>Temporary Storage, Complex Queries</td> </tr> <tr> <td>50</td> <td>What is SQL Injection? (Revisited for emphasis)</td> <td><a href=https://owasp.org/www-community/attacks/SQL_Injection>OWASP</a></td> <td>All Roles</td> <td>Medium</td> <td>Security</td> </tr> <tr> <td>51</td> <td>Explain Cross Join. When is it useful?</td> <td><a href=https://www.w3schools.com/sql/sql_join_cross.asp>W3Schools</a></td> <td>Specific Scenarios</td> <td>Medium</td> <td>Joins, Cartesian Product</td> </tr> <tr> <td>52</td> <td>What is the difference between Function and Stored Procedure?</td> <td><a href=https://www.geeksforgeeks.org/difference-between-stored-procedure-and-function-in-sql/ >GeeksforGeeks</a></td> <td>Database Developers</td> <td>Medium</td> <td>Functions, Stored Procedures</td> </tr> <tr> <td>53</td> <td>How to find the length of a string?</td> <td>[Varies by RDBMS]</td> <td>Most Tech Companies</td> <td>Easy</td> <td>String Functions</td> </tr> <tr> <td>54</td> <td>What is the <code>HAVING</code> clause used for?</td> <td><a href=https://www.w3schools.com/sql/sql_having.asp>W3Schools</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Filtering Aggregates</td> </tr> <tr> <td>55</td> <td>Explain database locking mechanisms.</td> <td><a href=https://en.wikipedia.org/wiki/Lock_(database)>Wikipedia</a></td> <td>Database Admins/Archs</td> <td>Hard</td> <td>Concurrency Control</td> </tr> <tr> <td>56</td> <td>What are Isolation Levels in transactions?</td> <td><a href=https://www.geeksforgeeks.org/transaction-isolation-levels-in-dbms/ >GeeksforGeeks</a></td> <td>Database Developers</td> <td>Hard</td> <td>Transactions, Concurrency</td> </tr> <tr> <td>57</td> <td>How to perform conditional aggregation?</td> <td><a href=https://blog.sqlauthority.com/2010/07/21/sql-server-conditional-aggregations-using-case-statement/ >SQL Authority</a></td> <td>Data Analysts</td> <td>Medium</td> <td>Aggregation, Conditional Logic</td> </tr> <tr> <td>58</td> <td>What is a Pivot Table in SQL?</td> <td><a href=https://www.sqlshack.com/dynamic-pivot-tables-in-sql-server/ >SQLShack</a></td> <td>Data Analysts, BI Roles</td> <td>Hard</td> <td>Data Transformation, Reporting</td> </tr> <tr> <td>59</td> <td>Explain the <code>MERGE</code> statement.</td> <td><a href=https://docs.microsoft.com/en-us/sql/t-sql/statements/merge-transact-sql>Microsoft Docs</a></td> <td>SQL Server Devs</td> <td>Medium</td> <td>DML, Upsert Operations</td> </tr> <tr> <td>60</td> <td>How to handle errors in SQL (e.g., TRY...CATCH)?</td> <td><a href=https://docs.microsoft.com/en-us/sql/t-sql/language-elements/try-catch-transact-sql>Microsoft Docs</a></td> <td>SQL Server Devs</td> <td>Medium</td> <td>Error Handling</td> </tr> <tr> <td>61</td> <td>What is Dynamic SQL? Pros and Cons?</td> <td><a href=https://www.sqlshack.com/dynamic-sql-in-sql-server/ >SQLShack</a></td> <td>Advanced SQL Devs</td> <td>Hard</td> <td>Dynamic Queries, Flexibility, Security</td> </tr> <tr> <td>62</td> <td>Explain Full-Text Search.</td> <td><a href=https://en.wikipedia.org/wiki/Full-text_search>Wikipedia</a></td> <td>Search Functionality</td> <td>Medium</td> <td>Indexing, Searching Text</td> </tr> <tr> <td>63</td> <td>How to work with JSON data in SQL?</td> <td>[Varies by RDBMS]</td> <td>Modern App Devs</td> <td>Medium</td> <td>JSON Support, Data Handling</td> </tr> <tr> <td>64</td> <td>What is Materialized View?</td> <td><a href=https://en.wikipedia.org/wiki/Materialized_view>Wikipedia</a></td> <td>Performance Optimization</td> <td>Hard</td> <td>Views, Performance</td> </tr> <tr> <td>65</td> <td>Difference between OLTP and OLAP.</td> <td><a href=https://www.geeksforgeeks.org/difference-between-oltp-and-olap/ >GeeksforGeeks</a></td> <td>DB Architects, BI Roles</td> <td>Medium</td> <td>Database Systems, Use Cases</td> </tr> <tr> <td>66</td> <td>How to calculate running totals?</td> <td><a href=https://mode.com/sql-tutorial/sql-window-functions/#running-totals>Mode Analytics</a></td> <td>Data Analysts</td> <td>Medium</td> <td>Window Functions, Aggregation</td> </tr> <tr> <td>67</td> <td>What is a Sequence in SQL?</td> <td><a href=https://docs.oracle.com/cd/B19306_01/server.102/b14200/statements_6015.htm>Oracle Docs</a></td> <td>Oracle/Postgres Devs</td> <td>Medium</td> <td>Sequence Generation</td> </tr> <tr> <td>68</td> <td>Explain Recursive CTEs.</td> <td><a href=https://www.sqltutorial.org/sql-recursive-cte/ >SQLTutorial.org</a></td> <td>Advanced SQL Devs</td> <td>Hard</td> <td>CTEs, Hierarchical Data</td> </tr> <tr> <td>69</td> <td>How to find the median value in SQL?</td> <td><a href=https://stackoverflow.com/questions/1290301/sql-query-to-get-median>Stack Overflow</a></td> <td>Data Analysts</td> <td>Hard</td> <td>Statistics, Window Functions</td> </tr> <tr> <td>70</td> <td>What is Query Execution Plan?</td> <td><a href=https://en.wikipedia.org/wiki/Query_plan>Wikipedia</a></td> <td>Performance Tuning</td> <td>Medium</td> <td>Query Optimization, Performance</td> </tr> <tr> <td>71</td> <td>How to use <code>COALESCE</code> or <code>ISNULL</code>?</td> <td><a href=https://www.w3schools.com/sql/sql_isnull.asp>W3Schools</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>NULL Handling</td> </tr> <tr> <td>72</td> <td>What is B-Tree Index?</td> <td><a href=https://en.wikipedia.org/wiki/B-tree>Wikipedia</a></td> <td>Database Internals</td> <td>Medium</td> <td>Indexes, Data Structures</td> </tr> <tr> <td>73</td> <td>Explain Hash Index.</td> <td><a href=https://www.postgresql.org/docs/current/indexes-hash.html>PostgreSQL Docs</a></td> <td>Database Internals</td> <td>Medium</td> <td>Indexes, Data Structures</td> </tr> <tr> <td>74</td> <td>Difference between Clustered and Non-Clustered Index.</td> <td><a href=https://www.geeksforgeeks.org/clustered-vs-non-clustered-index/ >GeeksforGeeks</a></td> <td>Database Performance</td> <td>Medium</td> <td>Indexes, Performance</td> </tr> <tr> <td>75</td> <td>How to grant and revoke permissions?</td> <td><a href=https://www.w3schools.com/sql/sql_grant.asp>W3Schools</a></td> <td>Database Admins</td> <td>Easy</td> <td>Security, Access Control</td> </tr> <tr> <td>76</td> <td>What is SQL Profiler / Tracing?</td> <td><a href=https://docs.microsoft.com/en-us/sql/tools/sql-server-profiler/sql-server-profiler>Microsoft Docs</a></td> <td>Performance Tuning</td> <td>Medium</td> <td>Monitoring, Debugging</td> </tr> <tr> <td>77</td> <td>Explain database constraints (NOT NULL, UNIQUE, etc.).</td> <td><a href=https://www.w3schools.com/sql/sql_constraints.asp>W3Schools</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Constraints, Data Integrity</td> </tr> <tr> <td>78</td> <td>How to update multiple rows with different values?</td> <td><a href=https://stackoverflow.com/questions/18797608/update-multiple-rows-in-one-query-using-postgresql>Stack Overflow</a></td> <td>Developers</td> <td>Medium</td> <td>DML, Updates</td> </tr> <tr> <td>79</td> <td>What is database normalization (revisited)?</td> <td><a href=https://www.studytonight.com/dbms/database-normalization.php>StudyTonight</a></td> <td>All Roles</td> <td>Medium</td> <td>Database Design</td> </tr> <tr> <td>80</td> <td>Explain 1NF, 2NF, 3NF, BCNF.</td> <td><a href=https://www.geeksforgeeks.org/normal-forms-in-dbms/ >GeeksforGeeks</a></td> <td>Database Design Roles</td> <td>Medium</td> <td>Normalization Forms</td> </tr> <tr> <td>81</td> <td>How to delete duplicate rows?</td> <td><a href=https://www.geeksforgeeks.org/sql-delete-duplicate-rows/ >GeeksforGeeks</a></td> <td>Data Cleaning Roles</td> <td>Medium</td> <td>DML, Data Quality</td> </tr> <tr> <td>82</td> <td>What is the <code>INTERSECT</code> operator?</td> <td><a href=https://www.w3schools.com/sql/sql_intersect.asp>W3Schools</a></td> <td>Set Operations Roles</td> <td>Medium</td> <td>Set Operations</td> </tr> <tr> <td>83</td> <td>What is the <code>EXCEPT</code> / <code>MINUS</code> operator?</td> <td><a href=https://www.w3schools.com/sql/sql_minus.asp>W3Schools</a></td> <td>Set Operations Roles</td> <td>Medium</td> <td>Set Operations</td> </tr> <tr> <td>84</td> <td>How to handle large objects (BLOB, CLOB)?</td> <td><a href=https://docs.oracle.com/database/121/ADLOB/lob_concepts.htm#ADLOB45168>Oracle Docs</a></td> <td>Specific Applications</td> <td>Medium</td> <td>Data Types, Large Data</td> </tr> <tr> <td>85</td> <td>What is database connection pooling?</td> <td><a href=https://en.wikipedia.org/wiki/Connection_pool>Wikipedia</a></td> <td>Application Developers</td> <td>Medium</td> <td>Performance, Resource Management</td> </tr> <tr> <td>86</td> <td>Explain CAP Theorem.</td> <td><a href=https://en.wikipedia.org/wiki/CAP_theorem>Wikipedia</a></td> <td>Distributed Systems</td> <td>Hard</td> <td>Distributed Databases, Tradeoffs</td> </tr> <tr> <td>87</td> <td>How to perform date/time arithmetic?</td> <td>[Varies by RDBMS]</td> <td>Most Tech Companies</td> <td>Easy</td> <td>Date/Time Functions</td> </tr> <tr> <td>88</td> <td>What is a correlated subquery?</td> <td><a href=https://www.geeksforgeeks.org/sql-correlated-subqueries/ >GeeksforGeeks</a></td> <td>Advanced SQL Users</td> <td>Medium</td> <td>Subqueries, Performance Considerations</td> </tr> <tr> <td>89</td> <td>How to use <code>GROUPING SETS</code>, <code>CUBE</code>, <code>ROLLUP</code>?</td> <td><a href=https://www.sqlshack.com/sql-server-grouping-sets-feature/ >SQLShack</a></td> <td>BI / Analytics Roles</td> <td>Hard</td> <td>Advanced Aggregation</td> </tr> <tr> <td>90</td> <td>What is Parameter Sniffing (SQL Server)?</td> <td><a href=https://www.brentozar.com/blitz/parameter-sniffing/ >Brent Ozar</a></td> <td>SQL Server DBAs/Devs</td> <td>Hard</td> <td>Performance Tuning (SQL Server)</td> </tr> <tr> <td>91</td> <td>How to create and use User-Defined Functions (UDFs)?</td> <td>[Varies by RDBMS]</td> <td>Database Developers</td> <td>Medium</td> <td>Functions, Reusability</td> </tr> <tr> <td>92</td> <td>What is database auditing?</td> <td><a href=https://en.wikipedia.org/wiki/Database_auditing>Wikipedia</a></td> <td>Security/Compliance Roles</td> <td>Medium</td> <td>Security, Monitoring</td> </tr> <tr> <td>93</td> <td>Explain optimistic vs. pessimistic locking.</td> <td><a href=https://stackoverflow.com/questions/129329/optimistic-vs-pessimistic-locking>Stack Overflow</a></td> <td>Concurrent Applications</td> <td>Hard</td> <td>Concurrency Control</td> </tr> <tr> <td>94</td> <td>How to handle deadlocks?</td> <td><a href=https://docs.microsoft.com/en-us/sql/relational-databases/sql-server-transaction-locking-and-row-versioning-guide#deadlocking>Microsoft Docs</a></td> <td>Database Admins/Devs</td> <td>Hard</td> <td>Concurrency, Error Handling</td> </tr> <tr> <td>95</td> <td>What is NoSQL? How does it differ from SQL?</td> <td><a href=https://www.mongodb.com/nosql-explained>MongoDB</a></td> <td>Modern Data Roles</td> <td>Medium</td> <td>Database Paradigms</td> </tr> <tr> <td>96</td> <td>Explain eventual consistency.</td> <td><a href=https://en.wikipedia.org/wiki/Eventual_consistency>Wikipedia</a></td> <td>Distributed Systems</td> <td>Hard</td> <td>Distributed Databases, Consistency Models</td> </tr> <tr> <td>97</td> <td>How to design a schema for a specific scenario (e.g., social media)?</td> <td>[Design Principles]</td> <td>System Design Interviews</td> <td>Hard</td> <td>Database Design, Modeling</td> </tr> <tr> <td>98</td> <td>What are spatial data types and functions?</td> <td><a href=https://postgis.net/docs/manual-3.1/reference.html>PostGIS</a></td> <td>GIS Applications</td> <td>Hard</td> <td>Spatial Data, GIS</td> </tr> <tr> <td>99</td> <td>How to perform fuzzy string matching in SQL?</td> <td><a href=https://stackoverflow.com/questions/6699158/fuzzy-string-search-in-sql>Stack Overflow</a></td> <td>Data Matching Roles</td> <td>Hard</td> <td>String Matching, Extensions</td> </tr> <tr> <td>100</td> <td>What is Change Data Capture (CDC)?</td> <td><a href=https://en.wikipedia.org/wiki/Change_data_capture>Wikipedia</a></td> <td>Data Integration/Sync</td> <td>Hard</td> <td>Data Replication, Event Streaming</td> </tr> <tr> <td>101</td> <td>Explain Graph Databases and their use cases.</td> <td><a href=https://neo4j.com/developer/graph-database/ >Neo4j</a></td> <td>Specialized Roles</td> <td>Hard</td> <td>Graph Databases, Data Modeling</td> </tr> </tbody> </table> <hr> <h2 id=code-examples>Code Examples</h2> <h3 id=1-nth-highest-salary-using-dense_rank>1. Nth Highest Salary using DENSE_RANK()</h3> <details class=success> <summary>View Code Example</summary> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Code Example</code> | <strong>Asked by:</strong> Code Pattern Finding the Nth highest salary is a classic problem. <code>DENSE_RANK()</code> is preferred over <code>ROW_NUMBER()</code> or <code>RANK()</code> because it handles ties without skipping ranks.</p> <div class=highlight><pre><span></span><code><span class=k>WITH</span><span class=w> </span><span class=n>RankedSalaries</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=n>salary</span><span class=p>,</span>
<span class=w>        </span><span class=n>DENSE_RANK</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>salary</span><span class=w> </span><span class=k>DESC</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>rank_num</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>salary</span>
<span class=k>FROM</span><span class=w> </span><span class=n>RankedSalaries</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>rank_num</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>:</span><span class=n>N</span><span class=p>;</span>
</code></pre></div> </details> <h3 id=2-recursive-cte-employee-hierarchy>2. Recursive CTE: Employee Hierarchy</h3> <details class=success> <summary>View Code Example</summary> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Code Example</code> | <strong>Asked by:</strong> Code Pattern Finding all subordinates of a manager (or traversing a graph/tree structure).</p> <div class=highlight><pre><span></span><code><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span><span class=w> </span><span class=k>Hierarchy</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=c1>-- Anchor member: Start with the top-level manager</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>employee_id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>manager_id</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=k>level</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span>
<span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>manager_id</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NULL</span>

<span class=w>    </span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span>

<span class=w>    </span><span class=c1>-- Recursive member: Join with the previous level</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>employee_id</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>manager_id</span><span class=p>,</span><span class=w> </span><span class=n>h</span><span class=p>.</span><span class=k>level</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e</span>
<span class=w>    </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>Hierarchy</span><span class=w> </span><span class=n>h</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>manager_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>h</span><span class=p>.</span><span class=n>employee_id</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>Hierarchy</span><span class=p>;</span>
</code></pre></div> </details> <h3 id=3-running-total-and-moving-average>3. Running Total and Moving Average</h3> <details class=success> <summary>View Code Example</summary> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Code Example</code> | <strong>Asked by:</strong> Code Pattern Using Window Functions for time-series analysis.</p> <div class=highlight><pre><span></span><code><span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=nb>date</span><span class=p>,</span>
<span class=w>    </span><span class=n>sales</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>sales</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>running_total</span><span class=p>,</span>
<span class=w>    </span><span class=k>AVG</span><span class=p>(</span><span class=n>sales</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=nb>date</span><span class=w> </span><span class=k>ROWS</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>6</span><span class=w> </span><span class=n>PRECEDING</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>CURRENT</span><span class=w> </span><span class=k>ROW</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=mi>7</span><span class=n>_day_moving_avg</span>
<span class=k>FROM</span><span class=w> </span><span class=n>daily_sales</span><span class=p>;</span>
</code></pre></div> </details> <h3 id=4-pivot-data-case-when-aggregation>4. Pivot Data (<code>CASE WHEN</code> Aggregation)</h3> <details class=success> <summary>View Code Example</summary> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Code Example</code> | <strong>Asked by:</strong> Code Pattern Transforming rows into columns (e.g., monthly sales side-by-side).</p> <div class=highlight><pre><span></span><code><span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>product_id</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=k>month</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Jan&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>sales</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>Jan_Sales</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=k>month</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Feb&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>sales</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>Feb_Sales</span><span class=p>,</span>
<span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=k>month</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Mar&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>sales</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>Mar_Sales</span>
<span class=k>FROM</span><span class=w> </span><span class=n>monthly_sales</span>
<span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>product_id</span><span class=p>;</span>
</code></pre></div> </details> <h3 id=5-gap-analysis-identifying-missing-sequences>5. Gap Analysis (Identifying Missing Sequences)</h3> <details class=success> <summary>View Code Example</summary> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Code Example</code> | <strong>Asked by:</strong> Code Pattern Finding gaps in sequential data (e.g., missing ID numbers).</p> <div class=highlight><pre><span></span><code><span class=k>WITH</span><span class=w> </span><span class=n>LaggedData</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=k>SELECT</span><span class=w> </span>
<span class=w>        </span><span class=n>id</span><span class=p>,</span><span class=w> </span>
<span class=w>        </span><span class=n>LEAD</span><span class=p>(</span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>next_id</span>
<span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>sequences</span>
<span class=p>)</span>
<span class=k>SELECT</span><span class=w> </span>
<span class=w>    </span><span class=n>id</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>gap_start</span><span class=p>,</span><span class=w> </span>
<span class=w>    </span><span class=n>next_id</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>gap_end</span>
<span class=k>FROM</span><span class=w> </span><span class=n>LaggedData</span>
<span class=k>WHERE</span><span class=w> </span><span class=n>next_id</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</code></pre></div> </details> <hr> <h2 id=additional-resources>Additional Resources</h2> <ul> <li><a href=https://www.postgresql.org/docs/ >PostgreSQL Documentation</a> - The gold standard for SQL reference.</li> <li><a href=https://leetcode.com/problemset/database/ >LeetCode Database Problems</a> - Best for practice.</li> <li><a href=https://mode.com/sql-tutorial/ >Mode Analytics SQL Tutorial</a> - Excellent for data analysis focus.</li> <li><a href=https://use-the-index-luke.com/ >Use The Index, Luke!</a> - Deep dive into SQL performance and indexing.</li> <li><a href=https://modern-sql.com/ >Modern SQL</a> - Features of newer SQL standards.</li> </ul> <hr> <h2 id=questions-asked-in-google-interviews>Questions asked in Google interviews</h2> <ol> <li>Explain window functions and their applications in analytical queries.</li> <li>Write a query to find users who have logged in on consecutive days.</li> <li>How would you optimize a slow-performing query that involves multiple joins?</li> <li>Explain the difference between <code>RANK()</code>, <code>DENSE_RANK()</code>, and <code>ROW_NUMBER()</code>.</li> <li>Write a query to calculate a running total or moving average.</li> <li>How would you handle hierarchical data in SQL?</li> <li>Explain Common Table Expressions (CTEs) and their benefits.</li> <li>What are the performance implications of using subqueries vs. joins?</li> <li>How would you design a database schema for a specific application?</li> <li>Explain how indexes work and when they should be used.</li> </ol> <h2 id=questions-asked-in-amazon-interviews>Questions asked in Amazon interviews</h2> <ol> <li>Write a query to find the nth highest salary in a table.</li> <li>How would you identify and remove duplicate records?</li> <li>Explain the difference between <code>UNION</code> and <code>UNION ALL</code>.</li> <li>Write a query to pivot data from rows to columns.</li> <li>How would you handle time-series data in SQL?</li> <li>Explain the concept of database sharding.</li> <li>Write a query to find users who purchased products in consecutive months.</li> <li>How would you implement a recommendation system using SQL?</li> <li>Explain how you would optimize a query for large datasets.</li> <li>Write a query to calculate year-over-year growth.</li> </ol> <h2 id=questions-asked-in-microsoft-interviews>Questions asked in Microsoft interviews</h2> <ol> <li>Explain database normalization and denormalization.</li> <li>How would you implement error handling in SQL?</li> <li>Write a query to find departments with above-average salaries.</li> <li>Explain the different types of joins and their use cases.</li> <li>How would you handle slowly changing dimensions?</li> <li>Write a query to implement a pagination system.</li> <li>Explain transaction isolation levels.</li> <li>How would you design a database for high availability?</li> <li>Write a query to find the most frequent values in a column.</li> <li>Explain the differences between clustered and non-clustered indexes.</li> </ol> <h2 id=questions-asked-in-meta-interviews>Questions asked in Meta interviews</h2> <ol> <li>Write a query to analyze user engagement metrics.</li> <li>How would you implement a friend recommendation algorithm?</li> <li>Explain how you would handle large-scale data processing.</li> <li>Write a query to identify trending content.</li> <li>How would you design a database schema for a social media platform?</li> <li>Explain the concept of data partitioning.</li> <li>Write a query to calculate the conversion rate between different user actions.</li> <li>How would you implement A/B testing analysis using SQL?</li> <li>Explain how you would handle real-time analytics.</li> <li>Write a query to identify anomalies in user behavior.</li> </ol> <h2 id=questions-asked-in-netflix-interviews>Questions asked in Netflix interviews</h2> <ol> <li>Write a query to analyze streaming patterns and user retention.</li> <li>How would you implement a content recommendation system?</li> <li>Explain how you would handle data for personalized user experiences.</li> <li>Write a query to identify viewing trends across different demographics.</li> <li>How would you design a database for content metadata?</li> <li>Explain how you would optimize queries for real-time recommendations.</li> <li>Write a query to calculate user engagement metrics.</li> <li>How would you implement A/B testing for UI changes?</li> <li>Explain how you would handle data for regional content preferences.</li> <li>Write a query to identify factors affecting user churn.</li> </ol> <h2 id=questions-asked-in-apple-interviews>Questions asked in Apple interviews</h2> <ol> <li>Explain database security best practices.</li> <li>How would you design a database for an e-commerce platform?</li> <li>Write a query to analyze product performance.</li> <li>Explain how you would handle data migration.</li> <li>How would you implement data validation in SQL?</li> <li>Write a query to track user interactions with products.</li> <li>Explain how you would optimize database performance.</li> <li>How would you implement data archiving strategies?</li> <li>Write a query to analyze customer feedback data.</li> <li>Explain how you would handle internationalization in databases.</li> </ol> <h2 id=questions-asked-in-linkedin-interviews>Questions asked in LinkedIn interviews</h2> <ol> <li>Write a query to implement a connection recommendation system.</li> <li>How would you design a database schema for professional profiles?</li> <li>Explain how you would handle data for skill endorsements.</li> <li>Write a query to analyze user networking patterns.</li> <li>How would you implement job recommendation algorithms?</li> <li>Explain how you would handle data for company pages.</li> <li>Write a query to identify trending job skills.</li> <li>How would you implement search functionality for profiles?</li> <li>Explain how you would handle data privacy requirements.</li> </ol> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2020 - <script>document.write(/\d{4}/.exec(Date())[0])</script> ‚Ä¢ <strong>Kuldeep Singh Sidhu</strong> ‚Ä¢ <u><a href=https://choosealicense.com/licenses/agpl-3.0/ target=‚Äù_blank‚Äù>License</a></u> ‚Ä¢ <u><a href=/privacy>Privacy Policy</a></u> ‚Ä¢ <u><a href=/contact>Contact</a></u> ‚Ä¢ </div> </div> <div class=md-social> <a href=https://github.com/singhsidhukuldeep/ target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M8 0c4.42 0 8 3.58 8 8a8.01 8.01 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27s-1.36.09-2 .27c-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8"/></svg> </a> <a href=https://linkedin.com/in/singhsidhukuldeep target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=https://twitter.com/kuldeep_s_s target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg> </a> <a href=https://stackoverflow.com/u/7182350/ target=_blank rel=noopener title=stackoverflow.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M290.7 311 95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"/></svg> </a> <a href=https://huggingface.co/singhsidhukuldeep target=_blank rel=noopener title=huggingface.co class=md-social__link> <svg width=500 height=463 viewbox="0 0 500 463" fill=none xmlns=http://www.w3.org/2000/svg> <path fill=white d="M496.592 369.699C500.563 381.093 499.61 393.227 494.315 403.778C490.503 411.48 485.05 417.441 478.379 422.769C470.331 429.099 460.324 434.48 448.253 439.65C433.852 445.77 416.274 451.52 408.226 453.63C387.63 458.958 367.829 462.334 347.762 462.493C319.066 462.756 294.34 456.004 276.762 438.753C267.656 439.861 258.443 440.494 249.178 440.494C240.389 440.494 231.706 439.967 223.076 438.912C205.445 456.057 180.825 462.756 152.234 462.493C132.168 462.334 112.366 458.958 91.7177 453.63C83.7229 451.52 66.145 445.77 51.7439 439.65C39.6723 434.48 29.6656 429.099 21.6708 422.769C14.9467 417.441 9.49334 411.48 5.68127 403.778C0.439661 393.227 -0.566304 381.093 3.45755 369.699C-0.248631 360.994 -1.20165 351.024 1.71035 339.998C3.03399 334.987 5.20476 330.344 7.95792 326.229C7.37552 324.067 6.89901 321.851 6.58134 319.424C4.56941 304.97 9.59923 291.781 19.0765 281.547C23.7357 276.43 28.7655 272.895 34.0071 270.627C30.1421 254.273 28.1302 237.445 28.1302 220.247C28.1302 98.5969 127.085 0 249.178 0C291.111 0 330.343 11.6058 363.805 31.8633C369.84 35.5561 375.77 39.5126 381.436 43.7329C384.242 45.8431 387.048 48.006 389.748 50.2744C392.501 52.49 395.201 54.8112 397.796 57.1851C405.632 64.3069 412.991 71.9562 419.715 80.133C421.992 82.8235 424.163 85.6194 426.28 88.4681C430.569 94.1128 434.54 99.9685 438.193 106.035C443.752 115.109 448.623 124.604 452.859 134.469C455.665 141.064 458.101 147.816 460.271 154.727C463.501 165.067 465.99 175.723 467.684 186.696C468.213 190.336 468.69 194.028 469.06 197.721C469.802 205.107 470.225 212.598 470.225 220.247C470.225 237.234 468.213 253.904 464.454 269.994C470.278 272.262 475.784 275.955 480.92 281.547C490.397 291.781 495.427 305.022 493.415 319.477C493.098 321.851 492.621 324.067 492.039 326.229C494.792 330.344 496.963 334.987 498.286 339.998C501.198 351.024 500.245 360.994 496.592 369.699Z"/> <path fill=black d="M433.839 221.75C433.839 120.838 351.531 39.0323 250 39.0323C148.469 39.0323 66.1613 120.838 66.1613 221.75C66.1613 322.662 148.469 404.468 250 404.468C351.531 404.468 433.839 322.662 433.839 221.75ZM45 221.75C45 109.222 136.782 18 250 18C363.218 18 455 109.222 455 221.75C455 334.278 363.218 425.5 250 425.5C136.782 425.5 45 334.278 45 221.75Z"/> <path fill=white d="M250 405.5C352.173 405.5 435 323.232 435 221.75C435 120.268 352.173 38 250 38C147.827 38 65 120.268 65 221.75C65 323.232 147.827 405.5 250 405.5Z"/> <path fill=white d="M202.198 404.174C216.789 383.118 215.755 367.316 195.735 347.627C175.715 327.943 164.062 299.145 164.062 299.145C164.062 299.145 159.709 282.419 149.794 283.958C139.88 285.497 132.6 310.492 153.368 325.783C174.135 341.069 149.232 351.456 141.242 337.099C133.252 322.741 111.435 285.831 100.121 278.772C88.8117 271.713 80.8483 275.668 83.5151 290.218C86.182 304.769 133.48 340.036 128.878 347.668C124.276 355.296 108.058 338.7 108.058 338.7C108.058 338.7 57.3079 293.255 46.2587 305.097C35.2096 316.94 54.641 326.863 82.3328 343.359C110.03 359.85 112.177 364.206 108.248 370.446C104.314 376.685 43.1836 325.971 37.4417 347.47C31.705 368.969 99.8291 375.209 95.6247 390.051C91.4203 404.899 47.6372 361.958 38.6823 378.689C29.7221 395.425 100.465 415.088 101.038 415.234C123.889 421.067 181.924 433.426 202.198 404.174Z"/> <path fill=black d="M90.9935 255C82.4744 255 74.8603 258.477 69.551 264.784C66.2675 268.69 62.8367 274.986 62.5578 284.414C58.985 283.394 55.5489 282.824 52.3391 282.824C44.183 282.824 36.8163 285.93 31.6069 291.573C24.9137 298.815 21.9407 307.715 23.2351 316.62C23.8508 320.861 25.2768 324.663 27.4079 328.182C22.9142 331.795 19.6044 336.826 18.0047 342.876C16.7524 347.619 15.4685 357.497 22.1722 367.673C21.746 368.337 21.3461 369.027 20.9725 369.733C16.9418 377.336 16.684 385.927 20.2411 393.928C25.6346 406.054 39.0368 415.608 65.0625 425.863C81.2536 432.242 96.0661 436.321 96.1976 436.357C117.603 441.874 136.962 444.677 153.721 444.677C184.525 444.677 206.578 435.301 219.27 416.811C239.697 387.036 236.776 359.803 210.346 333.552C195.717 319.026 185.993 297.607 183.967 292.906C179.884 278.986 169.086 263.513 151.138 263.513H151.133C149.622 263.513 148.096 263.633 146.592 263.869C138.73 265.097 131.858 269.595 126.949 276.361C121.65 269.814 116.504 264.606 111.847 261.667C104.827 257.243 97.813 255 90.9935 255ZM90.9935 275.917C93.6771 275.917 96.9553 277.051 100.57 279.331C111.794 286.406 133.452 323.403 141.382 337.793C144.039 342.614 148.581 344.654 152.669 344.654C160.783 344.654 167.118 336.638 153.411 326.451C132.8 311.124 140.03 286.072 149.87 284.529C150.301 284.461 150.727 284.43 151.138 284.43C160.083 284.43 164.03 299.751 164.03 299.751C164.03 299.751 175.595 328.616 195.465 348.346C215.334 368.08 216.36 383.919 201.879 405.024C192.002 419.415 173.096 421.292 153.721 421.292C133.626 421.292 112.99 417.772 101.445 414.796C100.877 414.65 30.7019 396.255 39.5946 379.48C41.089 376.661 43.5516 375.532 46.6509 375.532C59.1744 375.532 81.9535 394.054 91.746 394.054C93.935 394.054 95.5662 392.371 96.1976 390.112C100.555 374.522 32.6646 369.738 38.3633 348.189C39.3683 344.377 42.094 342.829 45.9248 342.834C62.4737 342.834 99.6021 371.756 107.385 371.756C107.979 371.756 108.405 371.584 108.637 371.218C112.536 364.964 110.74 359.872 83.257 343.343C55.7738 326.808 36.1428 317.588 47.114 305.718C48.3768 304.347 50.1659 303.741 52.3391 303.741C69.0248 303.746 108.447 339.398 108.447 339.398C108.447 339.398 119.087 350.395 125.523 350.395C127.001 350.395 128.259 349.815 129.111 348.382C133.673 340.737 86.7366 305.388 84.0898 290.804C82.2955 280.921 85.3474 275.917 90.9935 275.917Z"/> <path fill=white d="M296.9 404.174C282.31 383.118 283.343 367.316 303.363 347.627C323.383 327.943 335.037 299.145 335.037 299.145C335.037 299.145 339.39 282.419 349.304 283.958C359.219 285.497 366.498 310.492 345.731 325.783C324.963 341.069 349.866 351.456 357.856 337.099C365.846 322.741 387.663 285.831 398.978 278.772C410.287 271.713 418.25 275.668 415.583 290.218C412.916 304.769 365.618 340.036 370.22 347.668C374.822 355.296 391.041 338.7 391.041 338.7C391.041 338.7 441.791 293.255 452.84 305.097C463.889 316.94 444.457 326.863 416.766 343.359C389.068 359.85 386.921 364.206 390.85 370.446C394.784 376.685 455.915 325.971 461.657 347.47C467.393 368.969 399.269 375.209 403.474 390.051C407.678 404.899 451.461 361.958 460.416 378.689C469.376 395.425 398.633 415.088 398.06 415.234C375.209 421.067 317.175 433.426 296.9 404.174Z"/> <path fill=black d="M408.105 255C416.624 255 424.238 258.477 429.547 264.784C432.831 268.69 436.262 274.986 436.541 284.414C440.113 283.394 443.549 282.824 446.759 282.824C454.915 282.824 462.282 285.93 467.491 291.573C474.185 298.815 477.158 307.715 475.863 316.62C475.248 320.861 473.822 324.663 471.69 328.182C476.184 331.795 479.494 336.826 481.094 342.876C482.346 347.619 483.63 357.497 476.926 367.673C477.352 368.337 477.752 369.027 478.126 369.733C482.157 377.336 482.414 385.927 478.857 393.928C473.464 406.054 460.062 415.608 434.036 425.863C417.845 432.242 403.032 436.321 402.901 436.357C381.495 441.874 362.136 444.677 345.377 444.677C314.573 444.677 292.52 435.301 279.829 416.811C259.402 387.036 262.322 359.803 288.753 333.552C303.381 319.026 313.105 297.607 315.131 292.906C319.214 278.986 330.012 263.513 347.961 263.513H347.966C349.476 263.513 351.002 263.633 352.507 263.869C360.368 265.097 367.24 269.595 372.15 276.361C377.449 269.814 382.595 264.606 387.252 261.667C394.271 257.243 401.285 255 408.105 255ZM408.105 275.917C405.421 275.917 402.143 277.051 398.528 279.331C387.304 286.406 365.646 323.403 357.716 337.793C355.059 342.614 350.518 344.654 346.429 344.654C338.315 344.654 331.98 336.638 345.687 326.451C366.299 311.124 359.069 286.072 349.229 284.529C348.797 284.461 348.371 284.43 347.961 284.43C339.015 284.43 335.069 299.751 335.069 299.751C335.069 299.751 323.503 328.616 303.634 348.346C283.764 368.08 282.738 383.919 297.219 405.024C307.096 419.415 326.002 421.292 345.377 421.292C365.472 421.292 386.108 417.772 397.653 414.796C398.221 414.65 468.397 396.255 459.504 379.48C458.009 376.661 455.547 375.532 452.447 375.532C439.924 375.532 417.145 394.054 407.352 394.054C405.163 394.054 403.532 392.371 402.901 390.112C398.543 374.522 466.434 369.738 460.735 348.189C459.73 344.377 457.004 342.829 453.174 342.834C436.625 342.834 399.496 371.756 391.714 371.756C391.119 371.756 390.693 371.584 390.461 371.218C386.562 364.964 388.358 359.872 415.841 343.343C443.325 326.808 462.956 317.588 451.984 305.718C450.722 304.347 448.932 303.741 446.759 303.741C430.074 303.746 390.651 339.398 390.651 339.398C390.651 339.398 380.011 350.395 373.576 350.395C372.097 350.395 370.84 349.815 369.987 348.382C365.425 340.737 412.362 305.388 415.009 290.804C416.803 280.921 413.751 275.917 408.105 275.917Z"/> <path fill=#0E1116 d="M319.277 228.901C319.277 205.236 288.585 241.304 250.637 241.465C212.692 241.306 182 205.238 182 228.901C182 244.591 189.507 270.109 209.669 285.591C213.681 271.787 235.726 260.729 238.877 262.317C243.364 264.578 243.112 270.844 250.637 276.365C258.163 270.844 257.911 264.58 262.398 262.317C265.551 260.729 287.594 271.787 291.605 285.591C311.767 270.109 319.275 244.591 319.275 228.903L319.277 228.901Z"/> <path fill=#FF323D d="M262.4 262.315C257.913 264.576 258.165 270.842 250.639 276.363C243.114 270.842 243.366 264.578 238.879 262.315C235.726 260.727 213.683 271.785 209.672 285.589C219.866 293.417 233.297 298.678 250.627 298.806C250.631 298.806 250.635 298.806 250.641 298.806C250.646 298.806 250.65 298.806 250.656 298.806C267.986 298.68 281.417 293.417 291.611 285.589C287.6 271.785 265.555 260.727 262.404 262.315H262.4Z"/> <path fill=black d="M373 196C382.389 196 390 188.389 390 179C390 169.611 382.389 162 373 162C363.611 162 356 169.611 356 179C356 188.389 363.611 196 373 196Z"/> <path fill=black d="M128 196C137.389 196 145 188.389 145 179C145 169.611 137.389 162 128 162C118.611 162 111 169.611 111 179C111 188.389 118.611 196 128 196Z"/> <path fill=#0E1116 d="M313.06 171.596C319.796 173.968 322.476 187.779 329.281 184.171C342.167 177.337 347.06 161.377 340.208 148.524C333.356 135.671 317.354 130.792 304.467 137.626C291.58 144.46 286.688 160.419 293.54 173.272C296.774 179.339 307.039 169.475 313.06 171.596Z"/> <path fill=#0E1116 d="M188.554 171.596C181.818 173.968 179.138 187.779 172.334 184.171C159.447 177.337 154.555 161.377 161.407 148.524C168.259 135.671 184.26 130.792 197.147 137.626C210.034 144.46 214.926 160.419 208.074 173.272C204.84 179.339 194.575 169.475 188.554 171.596Z"/> </svg> </a> <a href=http://kuldeepsinghsidhu.com target=_blank rel=noopener title=kuldeepsinghsidhu.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0M5.78 8.75a9.64 9.64 0 0 0 1.363 4.177q.383.64.857 1.215c.245-.296.551-.705.857-1.215A9.64 9.64 0 0 0 10.22 8.75Zm4.44-1.5a9.64 9.64 0 0 0-1.363-4.177c-.307-.51-.612-.919-.857-1.215a10 10 0 0 0-.857 1.215A9.64 9.64 0 0 0 5.78 7.25Zm-5.944 1.5H1.543a6.51 6.51 0 0 0 4.666 5.5q-.184-.271-.352-.552c-.715-1.192-1.437-2.874-1.581-4.948m-2.733-1.5h2.733c.144-2.074.866-3.756 1.58-4.948q.18-.295.353-.552a6.51 6.51 0 0 0-4.666 5.5m10.181 1.5c-.144 2.074-.866 3.756-1.58 4.948q-.18.296-.353.552a6.51 6.51 0 0 0 4.666-5.5Zm2.733-1.5a6.51 6.51 0 0 0-4.666-5.5q.184.272.353.552c.714 1.192 1.436 2.874 1.58 4.948Z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "search.highlight", "search.share", "search.suggest", "content.tooltips", "navigation.instant.progress", "navigation.path", "navigation.top", "toc.follow"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.60a45f97.min.js></script> <script src=../../javascripts/mathjax.js></script> <script src=https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../javascripts/xfile.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>