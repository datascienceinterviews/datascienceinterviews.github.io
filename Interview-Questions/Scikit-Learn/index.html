<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This is a completely open-source platform for maintaining curated list of interview questions and answers for people looking and preparing for data science opportunities."><meta name=author content="Kuldeep Singh Sidhu"><link href=https://singhsidhukuldeep.github.io/Interview-Questions/Scikit-Learn/ rel=canonical><link href=../NumPy/ rel=prev><link href=../LangChain/ rel=next><link rel=icon href=https://repository-images.githubusercontent.com/275878203/13719500-bb75-11ea-8f3a-be2ffb87a6a2><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.50"><title>Scikit-Learn - Data Science Interview preparation</title><link rel=stylesheet href=../../assets/stylesheets/main.a40c8224.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-EVGNTG49J7"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-EVGNTG49J7",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-EVGNTG49J7",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#scikit-learn-interview-questions class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <!-- Add announcement here, including arbitrary HTML --> <style>
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
      20%, 40%, 60%, 80% { transform: translateX(2px); }
    }
    @keyframes glow {
      0%, 100% { text-shadow: 0 0 5px rgba(255, 165, 0, 0.5); }
      50% { text-shadow: 0 0 20px rgba(255, 165, 0, 0.8), 0 0 30px rgba(255, 140, 0, 0.6); }
    }
    .shake-text {
      display: inline-block;
      animation: shake 3s ease-in-out infinite;
    }
    .glow-link {
      animation: glow 2s ease-in-out infinite;
      font-weight: bold;
    }
  </style> <span class=shake-text>üöÄ <a href=/flashcards class=glow-link>Flashcards</a> feature is live!</span> <meta name=google-adsense-account content=ca-pub-4988388949365963> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4988388949365963" crossorigin=anonymous></script> </div> </aside> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Data Science Interview preparation" class="md-header__button md-logo" aria-label="Data Science Interview preparation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M9.4 86.6c-12.5-12.5-12.5-32.7 0-45.2s32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L178.7 256zM256 416h288c17.7 0 32 14.3 32 32s-14.3 32-32 32H256c-17.7 0-32-14.3-32-32s14.3-32 32-32"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Data Science Interview preparation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Scikit-Learn </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=deep-purple data-md-color-accent=purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=deep-purple data-md-color-accent=purple aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/singhsidhukuldeep/singhsidhukuldeep.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> singhsidhukuldeep/singhsidhukuldeep.github.io </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Data Science Interview preparation" class="md-nav__button md-logo" aria-label="Data Science Interview preparation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M9.4 86.6c-12.5-12.5-12.5-32.7 0-45.2s32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L178.7 256zM256 416h288c17.7 0 32 14.3 32 32s-14.3 32-32 32H256c-17.7 0-32-14.3-32-32s14.3-32 32-32"/></svg> </a> Data Science Interview preparation </label> <div class=md-nav__source> <a href=https://github.com/singhsidhukuldeep/singhsidhukuldeep.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> singhsidhukuldeep/singhsidhukuldeep.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> üè° Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> üë®üèø‚Äçüè´ Interview Questions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> üë®üèø‚Äçüè´ Interview Questions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../flashcards/ class=md-nav__link> <span class=md-ellipsis> üìá Flashcards </span> </a> </li> <li class=md-nav__item> <a href=../data-structures-algorithms/ class=md-nav__link> <span class=md-ellipsis> DSA (Data Structures & Algorithms) </span> </a> </li> <li class=md-nav__item> <a href=../Machine-Learning/ class=md-nav__link> <span class=md-ellipsis> Machine Learning </span> </a> </li> <li class=md-nav__item> <a href=../System-design/ class=md-nav__link> <span class=md-ellipsis> System Design </span> </a> </li> <li class=md-nav__item> <a href=../Natural-Language-Processing/ class=md-nav__link> <span class=md-ellipsis> Natural Language Processing (NLP) </span> </a> </li> <li class=md-nav__item> <a href=../Probability/ class=md-nav__link> <span class=md-ellipsis> Probability </span> </a> </li> <li class=md-nav__item> <a href=../AB-testing/ class=md-nav__link> <span class=md-ellipsis> A/B Testing </span> </a> </li> <li class=md-nav__item> <a href=../SQL-Interview-Questions/ class=md-nav__link> <span class=md-ellipsis> SQL </span> </a> </li> <li class=md-nav__item> <a href=../Python/ class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=../Pandas/ class=md-nav__link> <span class=md-ellipsis> Pandas </span> </a> </li> <li class=md-nav__item> <a href=../NumPy/ class=md-nav__link> <span class=md-ellipsis> NumPy </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Scikit-Learn </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Scikit-Learn </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#premium-interview-questions class=md-nav__link> <span class=md-ellipsis> Premium Interview Questions </span> </a> <nav class=md-nav aria-label="Premium Interview Questions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-the-scikit-learn-estimator-api-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain the Scikit-Learn Estimator API - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#what-is-the-scikit-learn-estimator-api class=md-nav__link> <span class=md-ellipsis> What is the Scikit-Learn Estimator API? </span> </a> </li> <li class=md-nav__item> <a href=#three-types-of-estimators class=md-nav__link> <span class=md-ellipsis> Three Types of Estimators </span> </a> <nav class=md-nav aria-label="Three Types of Estimators"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-estimator-base-class class=md-nav__link> <span class=md-ellipsis> 1. Estimator (Base Class) </span> </a> </li> <li class=md-nav__item> <a href=#2-predictor-inherits-estimator class=md-nav__link> <span class=md-ellipsis> 2. Predictor (Inherits Estimator) </span> </a> </li> <li class=md-nav__item> <a href=#3-transformer-inherits-estimator class=md-nav__link> <span class=md-ellipsis> 3. Transformer (Inherits Estimator) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#api-patterns-conventions class=md-nav__link> <span class=md-ellipsis> API Patterns &amp; Conventions </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-185-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (185 lines) </span> </a> </li> <li class=md-nav__item> <a href=#api-design-principles class=md-nav__link> <span class=md-ellipsis> API Design Principles </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#real-world-impact class=md-nav__link> <span class=md-ellipsis> Real-World Impact </span> </a> </li> <li class=md-nav__item> <a href=#creating-custom-estimators-best-practices class=md-nav__link> <span class=md-ellipsis> Creating Custom Estimators (Best Practices) </span> </a> <nav class=md-nav aria-label="Creating Custom Estimators (Best Practices)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-create-an-sklearn-pipeline-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Create an Sklearn Pipeline? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#what-is-an-sklearn-pipeline class=md-nav__link> <span class=md-ellipsis> What is an Sklearn Pipeline? </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-195-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (195 lines) </span> </a> </li> <li class=md-nav__item> <a href=#pipeline-naming-convention class=md-nav__link> <span class=md-ellipsis> Pipeline Naming Convention </span> </a> </li> <li class=md-nav__item> <a href=#common-pipeline-patterns class=md-nav__link> <span class=md-ellipsis> Common Pipeline Patterns </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_1 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#columntransformer-deep-dive class=md-nav__link> <span class=md-ellipsis> ColumnTransformer Deep Dive </span> </a> <nav class=md-nav aria-label="ColumnTransformer Deep Dive"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-cross-validation-strategies-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Cross-Validation Strategies - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#what-is-cross-validation class=md-nav__link> <span class=md-ellipsis> What is Cross-Validation? </span> </a> </li> <li class=md-nav__item> <a href=#cross-validation-strategies class=md-nav__link> <span class=md-ellipsis> Cross-Validation Strategies </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-180-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (180 lines) </span> </a> </li> <li class=md-nav__item> <a href=#choosing-the-right-cv-strategy class=md-nav__link> <span class=md-ellipsis> Choosing the Right CV Strategy </span> </a> </li> <li class=md-nav__item> <a href=#common-data-leakage-scenarios class=md-nav__link> <span class=md-ellipsis> Common Data Leakage Scenarios </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_1 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_2 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#nested-cv-for-hyperparameter-tuning class=md-nav__link> <span class=md-ellipsis> Nested CV for Hyperparameter Tuning </span> </a> <nav class=md-nav aria-label="Nested CV for Hyperparameter Tuning"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-handle-class-imbalance-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Handle Class Imbalance? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#what-is-class-imbalance class=md-nav__link> <span class=md-ellipsis> What is Class Imbalance? </span> </a> </li> <li class=md-nav__item> <a href=#techniques-to-handle-imbalance class=md-nav__link> <span class=md-ellipsis> Techniques to Handle Imbalance </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-190-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (190 lines) </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-each-technique class=md-nav__link> <span class=md-ellipsis> When to Use Each Technique </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_2 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_3 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#smote-pipeline-preventing-data-leakage class=md-nav__link> <span class=md-ellipsis> SMOTE Pipeline (Preventing Data Leakage) </span> </a> </li> <li class=md-nav__item> <a href=#choosing-the-right-metric class=md-nav__link> <span class=md-ellipsis> Choosing the Right Metric </span> </a> <nav class=md-nav aria-label="Choosing the Right Metric"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-gridsearchcv-vs-randomizedsearchcv-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain GridSearchCV vs RandomizedSearchCV - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#gridsearchcv-vs-randomizedsearchcv class=md-nav__link> <span class=md-ellipsis> GridSearchCV vs RandomizedSearchCV </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-which class=md-nav__link> <span class=md-ellipsis> When to Use Which </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-180-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (180 lines) </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_4 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#real-world-performance class=md-nav__link> <span class=md-ellipsis> Real-World Performance </span> </a> <nav class=md-nav aria-label="Real-World Performance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-create-a-custom-transformer-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Create a Custom Transformer? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#overview_1 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#required-base-classes class=md-nav__link> <span class=md-ellipsis> Required Base Classes </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-195-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (195 lines) </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_5 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#real-world-examples class=md-nav__link> <span class=md-ellipsis> Real-World Examples </span> </a> <nav class=md-nav aria-label="Real-World Examples"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-feature-scaling-methods-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Feature Scaling Methods - Most Tech Companies Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#overview_2 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#scaling-methods-comparison class=md-nav__link> <span class=md-ellipsis> Scaling Methods Comparison </span> </a> </li> <li class=md-nav__item> <a href=#when-scaling-matters class=md-nav__link> <span class=md-ellipsis> When Scaling Matters </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-170-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (170 lines) </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_6 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#real-world-performance_1 class=md-nav__link> <span class=md-ellipsis> Real-World Performance </span> </a> <nav class=md-nav aria-label="Real-World Performance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-evaluate-classification-models-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Evaluate Classification Models? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#overview_3 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#classification-metrics-summary class=md-nav__link> <span class=md-ellipsis> Classification Metrics Summary </span> </a> </li> <li class=md-nav__item> <a href=#confusion-matrix-breakdown class=md-nav__link> <span class=md-ellipsis> Confusion Matrix Breakdown </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-185-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (185 lines) </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_7 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#real-world-metric-choices class=md-nav__link> <span class=md-ellipsis> Real-World Metric Choices </span> </a> <nav class=md-nav aria-label="Real-World Metric Choices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-ridge-vs-lasso-vs-elasticnet-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Ridge vs Lasso vs ElasticNet - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#overview_4 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#mathematical-formulation class=md-nav__link> <span class=md-ellipsis> Mathematical Formulation </span> </a> </li> <li class=md-nav__item> <a href=#ridge-vs-lasso-vs-elasticnet class=md-nav__link> <span class=md-ellipsis> Ridge vs Lasso vs ElasticNet </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-190-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (190 lines) </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_8 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#real-world-performance_2 class=md-nav__link> <span class=md-ellipsis> Real-World Performance </span> </a> <nav class=md-nav aria-label="Real-World Performance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-implement-feature-selection-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Implement Feature Selection? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#overview_5 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#feature-selection-methods class=md-nav__link> <span class=md-ellipsis> Feature Selection Methods </span> </a> </li> <li class=md-nav__item> <a href=#filter-vs-wrapper-vs-embedded class=md-nav__link> <span class=md-ellipsis> Filter vs Wrapper vs Embedded </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-195-lines_2 class=md-nav__link> <span class=md-ellipsis> Production Implementation (195 lines) </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_9 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#real-world-performance_3 class=md-nav__link> <span class=md-ellipsis> Real-World Performance </span> </a> <nav class=md-nav aria-label="Real-World Performance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-save-and-load-models-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to Save and Load Models? - Most Tech Companies Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#overview_6 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#production-code-120-lines class=md-nav__link> <span class=md-ellipsis> Production Code (120 lines) </span> </a> </li> <li class=md-nav__item> <a href=#security-versioning class=md-nav__link> <span class=md-ellipsis> Security &amp; Versioning </span> </a> <nav class=md-nav aria-label="Security & Versioning"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-random-forest-feature-importance-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Random Forest Feature Importance - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-votingclassifier-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use VotingClassifier? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-detect-overfitting-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to Detect Overfitting? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-handle-missing-values-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Handle Missing Values? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-debug-a-failing-model-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Debug a Failing Model? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-probability-calibration-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain probability calibration - Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-columntransformer-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to use ColumnTransformer? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-multi-label-classification-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement multi-label classification? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-make_scorer-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to use make_scorer? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-perform-polynomial-regression-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to perform polynomial regression? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-compute-learning-curves-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to compute learning curves? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-smote-for-imbalanced-data-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to use SMOTE for imbalanced data? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-perform-stratified-sampling-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to perform stratified sampling? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-tune-hyperparameters-with-optunahalvinggridsearch-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to tune hyperparameters with Optuna/HalvingGridSearch? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-svm-classification-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement SVM classification? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-k-means-clustering-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement K-Means clustering? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-pca-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement PCA? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-gradient-boosting-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Gradient Boosting? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-naive-bayes-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Naive Bayes? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-dbscan-clustering-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement DBSCAN clustering? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-t-sne-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement t-SNE? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-knn-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement KNN? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-isolation-forest-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Isolation Forest? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-label-propagation-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Label Propagation? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-one-class-svm-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement One-Class SVM? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-target-encoding-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement target encoding? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-compute-partial-dependence-plots-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to compute partial dependence plots? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-stratified-group-split-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement stratified group split? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-validation-curves-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement validation curves? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-decision-boundary-visualization-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement decision boundary visualization? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-neural-network-classifier-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement neural network classifier? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-threshold-tuning-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement threshold tuning? - Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-cost-sensitive-classification-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement cost-sensitive classification? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-leaveoneout-cv-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement LeaveOneOut CV? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-confusion-matrix-visualization-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement confusion matrix visualization? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-precision-recall-curves-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement precision-recall curves? - Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-model-calibration-check-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement model calibration check? - Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-cross_validate-for-multiple-metrics-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement cross_validate for multiple metrics? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-linear-regression-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Linear Regression? - Most Tech Companies Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#linear-regression-workflow class=md-nav__link> <span class=md-ellipsis> Linear Regression Workflow </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-180-lines_2 class=md-nav__link> <span class=md-ellipsis> Production Implementation (180 lines) </span> </a> </li> <li class=md-nav__item> <a href=#linear-regression-comparison class=md-nav__link> <span class=md-ellipsis> Linear Regression Comparison </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-linear-regression-vs-alternatives class=md-nav__link> <span class=md-ellipsis> When to Use Linear Regression vs Alternatives </span> </a> </li> <li class=md-nav__item> <a href=#real-world-performance_4 class=md-nav__link> <span class=md-ellipsis> Real-World Performance </span> </a> <nav class=md-nav aria-label="Real-World Performance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-ridge-regression-and-when-to-use-it-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is Ridge Regression and when to use it? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ridge-vs-no-regularization class=md-nav__link> <span class=md-ellipsis> Ridge vs No Regularization </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-165-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (165 lines) </span> </a> </li> <li class=md-nav__item> <a href=#ridge-regression-properties class=md-nav__link> <span class=md-ellipsis> Ridge Regression Properties </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-ridge class=md-nav__link> <span class=md-ellipsis> When to Use Ridge </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_3 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-lasso-regression-and-when-to-use-it-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is Lasso Regression and when to use it? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lasso-feature-selection-process class=md-nav__link> <span class=md-ellipsis> Lasso Feature Selection Process </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-175-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (175 lines) </span> </a> </li> <li class=md-nav__item> <a href=#lasso-vs-ridge-comparison class=md-nav__link> <span class=md-ellipsis> Lasso vs Ridge Comparison </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-lasso class=md-nav__link> <span class=md-ellipsis> When to Use Lasso </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_4 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-elasticnet-regression-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is ElasticNet regression? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#elasticnet-decision-flow class=md-nav__link> <span class=md-ellipsis> ElasticNet Decision Flow </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-155-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (155 lines) </span> </a> </li> <li class=md-nav__item> <a href=#elasticnet-properties class=md-nav__link> <span class=md-ellipsis> ElasticNet Properties </span> </a> </li> <li class=md-nav__item> <a href=#ridge-vs-lasso-vs-elasticnet-decision-guide class=md-nav__link> <span class=md-ellipsis> Ridge vs Lasso vs ElasticNet Decision Guide </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_5 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-implement-logistic-regression-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Logistic Regression? - Most Tech Companies Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#logistic-regression-workflow class=md-nav__link> <span class=md-ellipsis> Logistic Regression Workflow </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-180-lines_3 class=md-nav__link> <span class=md-ellipsis> Production Implementation (180 lines) </span> </a> </li> <li class=md-nav__item> <a href=#logistic-regression-properties class=md-nav__link> <span class=md-ellipsis> Logistic Regression Properties </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-logistic-regression class=md-nav__link> <span class=md-ellipsis> When to Use Logistic Regression </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_6 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-the-solver-options-in-logistic-regression-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain the solver options in Logistic Regression - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#solver-decision-tree class=md-nav__link> <span class=md-ellipsis> Solver Decision Tree </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-140-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (140 lines) </span> </a> </li> <li class=md-nav__item> <a href=#solver-comparison-table class=md-nav__link> <span class=md-ellipsis> Solver Comparison Table </span> </a> </li> <li class=md-nav__item> <a href=#solver-selection-guide class=md-nav__link> <span class=md-ellipsis> Solver Selection Guide </span> </a> </li> <li class=md-nav__item> <a href=#real-world-solver-usage class=md-nav__link> <span class=md-ellipsis> Real-World Solver Usage </span> </a> <nav class=md-nav aria-label="Real-World Solver Usage"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-implement-decision-trees-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Decision Trees? - Most Tech Companies Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#decision-tree-structure class=md-nav__link> <span class=md-ellipsis> Decision Tree Structure </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-170-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (170 lines) </span> </a> </li> <li class=md-nav__item> <a href=#decision-tree-hyperparameters class=md-nav__link> <span class=md-ellipsis> Decision Tree Hyperparameters </span> </a> </li> <li class=md-nav__item> <a href=#advantages-vs-disadvantages class=md-nav__link> <span class=md-ellipsis> Advantages vs Disadvantages </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_7 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-are-the-hyperparameters-for-decision-trees-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What are the hyperparameters for Decision Trees? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#hyperparameter-impact-flow class=md-nav__link> <span class=md-ellipsis> Hyperparameter Impact Flow </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-160-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (160 lines) </span> </a> </li> <li class=md-nav__item> <a href=#hyperparameter-tuning-guide class=md-nav__link> <span class=md-ellipsis> Hyperparameter Tuning Guide </span> </a> </li> <li class=md-nav__item> <a href=#common-hyperparameter-combinations class=md-nav__link> <span class=md-ellipsis> Common Hyperparameter Combinations </span> </a> </li> <li class=md-nav__item> <a href=#real-world-configurations class=md-nav__link> <span class=md-ellipsis> Real-World Configurations </span> </a> <nav class=md-nav aria-label="Real-World Configurations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-implement-random-forest-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Random Forest? - Most Tech Companies Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#random-forest-architecture class=md-nav__link> <span class=md-ellipsis> Random Forest Architecture </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-175-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (175 lines) </span> </a> </li> <li class=md-nav__item> <a href=#random-forest-key-parameters class=md-nav__link> <span class=md-ellipsis> Random Forest Key Parameters </span> </a> </li> <li class=md-nav__item> <a href=#random-forest-advantages class=md-nav__link> <span class=md-ellipsis> Random Forest Advantages </span> </a> </li> <li class=md-nav__item> <a href=#random-forest-vs-gradient-boosting class=md-nav__link> <span class=md-ellipsis> Random Forest vs Gradient Boosting </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_8 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-random-forest class=md-nav__link> <span class=md-ellipsis> When to Use Random Forest </span> </a> <nav class=md-nav aria-label="When to Use Random Forest"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#difference-between-bagging-and-boosting-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Difference between Bagging and Boosting? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bagging-vs-boosting-visual class=md-nav__link> <span class=md-ellipsis> Bagging vs Boosting Visual </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-140-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (140 lines) </span> </a> </li> <li class=md-nav__item> <a href=#bagging-vs-boosting-comparison class=md-nav__link> <span class=md-ellipsis> Bagging vs Boosting Comparison </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-each class=md-nav__link> <span class=md-ellipsis> When to Use Each </span> </a> <nav class=md-nav aria-label="When to Use Each"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-does-gradient-boosting-work-senior-dsml-engineer-question class=md-nav__link> <span class=md-ellipsis> How does Gradient Boosting work? - Senior DS/ML Engineer Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#gradient-boosting-algorithm-flow class=md-nav__link> <span class=md-ellipsis> Gradient Boosting Algorithm Flow </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-160-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (160 lines) </span> </a> </li> <li class=md-nav__item> <a href=#gradient-boosting-key-parameters class=md-nav__link> <span class=md-ellipsis> Gradient Boosting Key Parameters </span> </a> </li> <li class=md-nav__item> <a href=#gbm-vs-random-forest class=md-nav__link> <span class=md-ellipsis> GBM vs Random Forest </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_9 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-does-adaboost-work-meta-apple-interview-question class=md-nav__link> <span class=md-ellipsis> How does AdaBoost work? - Meta, Apple Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#adaboost-algorithm-flow class=md-nav__link> <span class=md-ellipsis> AdaBoost Algorithm Flow </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-145-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (145 lines) </span> </a> </li> <li class=md-nav__item> <a href=#adaboost-key-parameters class=md-nav__link> <span class=md-ellipsis> AdaBoost Key Parameters </span> </a> </li> <li class=md-nav__item> <a href=#adaboost-vs-gradient-boosting class=md-nav__link> <span class=md-ellipsis> AdaBoost vs Gradient Boosting </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_10 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-implement-svm-microsoft-nvidia-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement SVM? - Microsoft, NVIDIA Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#svm-margin-maximization class=md-nav__link> <span class=md-ellipsis> SVM Margin Maximization </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-155-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (155 lines) </span> </a> </li> <li class=md-nav__item> <a href=#svm-key-parameters class=md-nav__link> <span class=md-ellipsis> SVM Key Parameters </span> </a> </li> <li class=md-nav__item> <a href=#svm-vs-logistic-regression class=md-nav__link> <span class=md-ellipsis> SVM vs Logistic Regression </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_11 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-are-svm-kernels-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What are SVM kernels? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#kernel-decision-tree class=md-nav__link> <span class=md-ellipsis> Kernel Decision Tree </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-150-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (150 lines) </span> </a> </li> <li class=md-nav__item> <a href=#kernel-function-formulas class=md-nav__link> <span class=md-ellipsis> Kernel Function Formulas </span> </a> </li> <li class=md-nav__item> <a href=#kernel-selection-guide class=md-nav__link> <span class=md-ellipsis> Kernel Selection Guide </span> </a> </li> <li class=md-nav__item> <a href=#rbf-gamma-tuning class=md-nav__link> <span class=md-ellipsis> RBF Gamma Tuning </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_12 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-implement-knn-entry-level-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement KNN? - Entry-Level Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#knn-algorithm-flow class=md-nav__link> <span class=md-ellipsis> KNN Algorithm Flow </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-145-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (145 lines) </span> </a> </li> <li class=md-nav__item> <a href=#knn-key-parameters class=md-nav__link> <span class=md-ellipsis> KNN Key Parameters </span> </a> </li> <li class=md-nav__item> <a href=#knn-pros-cons class=md-nav__link> <span class=md-ellipsis> KNN Pros &amp; Cons </span> </a> </li> <li class=md-nav__item> <a href=#distance-metrics class=md-nav__link> <span class=md-ellipsis> Distance Metrics </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_13 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-the-curse-of-dimensionality-senior-interview-question class=md-nav__link> <span class=md-ellipsis> What is the curse of dimensionality? - Senior Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#curse-of-dimensionality-visualization class=md-nav__link> <span class=md-ellipsis> Curse of Dimensionality Visualization </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-135-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (135 lines) </span> </a> </li> <li class=md-nav__item> <a href=#curse-of-dimensionality-effects class=md-nav__link> <span class=md-ellipsis> Curse of Dimensionality Effects </span> </a> </li> <li class=md-nav__item> <a href=#solutions-to-curse-of-dimensionality class=md-nav__link> <span class=md-ellipsis> Solutions to Curse of Dimensionality </span> </a> </li> <li class=md-nav__item> <a href=#dimensionality-guidelines class=md-nav__link> <span class=md-ellipsis> Dimensionality Guidelines </span> </a> </li> <li class=md-nav__item> <a href=#real-world-examples_1 class=md-nav__link> <span class=md-ellipsis> Real-World Examples </span> </a> <nav class=md-nav aria-label="Real-World Examples"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-are-naive-bayes-variants-common-interview-question class=md-nav__link> <span class=md-ellipsis> What are Naive Bayes variants? - Common Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#naive-bayes-variants-decision-tree class=md-nav__link> <span class=md-ellipsis> Naive Bayes Variants Decision Tree </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-165-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (165 lines) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../LangChain/ class=md-nav__link> <span class=md-ellipsis> LangChain </span> </a> </li> <li class=md-nav__item> <a href=../LangGraph/ class=md-nav__link> <span class=md-ellipsis> LangGraph </span> </a> </li> <li class=md-nav__item> <a href=../Interview-Question-Resources/ class=md-nav__link> <span class=md-ellipsis> Interview Question Resources </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> üìù Cheat Sheets </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> üìù Cheat Sheets </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Cheat-Sheets/Django/ class=md-nav__link> <span class=md-ellipsis> Django </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Flask/ class=md-nav__link> <span class=md-ellipsis> Flask </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Hypothesis-Tests/ class=md-nav__link> <span class=md-ellipsis> Hypothesis Tests </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Keras/ class=md-nav__link> <span class=md-ellipsis> Keras </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/LangChain-LangGraph/ class=md-nav__link> <span class=md-ellipsis> LangChain & LangGraph </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/NumPy/ class=md-nav__link> <span class=md-ellipsis> NumPy </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Pandas/ class=md-nav__link> <span class=md-ellipsis> Pandas </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/PySpark/ class=md-nav__link> <span class=md-ellipsis> PySpark </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/PyTorch/ class=md-nav__link> <span class=md-ellipsis> PyTorch </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Python/ class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/RegEx/ class=md-nav__link> <span class=md-ellipsis> Regular Expressions (RegEx) </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Sk-learn/ class=md-nav__link> <span class=md-ellipsis> Scikit Learn </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/SQL/ class=md-nav__link> <span class=md-ellipsis> SQL </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/tensorflow/ class=md-nav__link> <span class=md-ellipsis> TensorFlow </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> ‚Äçüéì ML Topics </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> ‚Äçüéì ML Topics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Machine-Learning/ARIMA/ class=md-nav__link> <span class=md-ellipsis> ARIMA </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Activation%20functions/ class=md-nav__link> <span class=md-ellipsis> Activation functions </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Collaborative%20Filtering/ class=md-nav__link> <span class=md-ellipsis> Collaborative Filtering </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Confusion%20Matrix/ class=md-nav__link> <span class=md-ellipsis> Confusion Matrix </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/DBSCAN/ class=md-nav__link> <span class=md-ellipsis> DBSCAN </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Decision%20Trees/ class=md-nav__link> <span class=md-ellipsis> Decision Trees </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Gradient%20Boosting/ class=md-nav__link> <span class=md-ellipsis> Gradient Boosting </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/K-means%20clustering/ class=md-nav__link> <span class=md-ellipsis> K-means clustering </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Linear%20Regression/ class=md-nav__link> <span class=md-ellipsis> Linear Regression </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Logistic%20Regression/ class=md-nav__link> <span class=md-ellipsis> Logistic Regression </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Loss%20Function%20MAE%2C%20RMSE/ class=md-nav__link> <span class=md-ellipsis> Loss Function MAE, RMSE </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Neural%20Networks/ class=md-nav__link> <span class=md-ellipsis> Neural Networks </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Normal%20Distribution/ class=md-nav__link> <span class=md-ellipsis> Normal Distribution </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Normalization%20Regularisation/ class=md-nav__link> <span class=md-ellipsis> Normalization Regularisation </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Overfitting%2C%20Underfitting/ class=md-nav__link> <span class=md-ellipsis> Overfitting, Underfitting </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/PCA/ class=md-nav__link> <span class=md-ellipsis> PCA </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Random%20Forest/ class=md-nav__link> <span class=md-ellipsis> Random Forest </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Support%20Vector%20Machines/ class=md-nav__link> <span class=md-ellipsis> Support Vector Machines </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Unbalanced%2C%20Skewed%20data/ class=md-nav__link> <span class=md-ellipsis> Unbalanced, Skewed data </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/kNN/ class=md-nav__link> <span class=md-ellipsis> kNN </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> üë®üèæ‚Äçüíª Online Resources </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> üë®üèæ‚Äçüíª Online Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Online-Material/Online-Material-for-Learning/ class=md-nav__link> <span class=md-ellipsis> Online Study Material </span> </a> </li> <li class=md-nav__item> <a href=../../Online-Material/popular-resources/ class=md-nav__link> <span class=md-ellipsis> Popular Blogs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../Contribute/ class=md-nav__link> <span class=md-ellipsis> ü§ù Contribute </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#premium-interview-questions class=md-nav__link> <span class=md-ellipsis> Premium Interview Questions </span> </a> <nav class=md-nav aria-label="Premium Interview Questions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-the-scikit-learn-estimator-api-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain the Scikit-Learn Estimator API - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#what-is-the-scikit-learn-estimator-api class=md-nav__link> <span class=md-ellipsis> What is the Scikit-Learn Estimator API? </span> </a> </li> <li class=md-nav__item> <a href=#three-types-of-estimators class=md-nav__link> <span class=md-ellipsis> Three Types of Estimators </span> </a> <nav class=md-nav aria-label="Three Types of Estimators"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-estimator-base-class class=md-nav__link> <span class=md-ellipsis> 1. Estimator (Base Class) </span> </a> </li> <li class=md-nav__item> <a href=#2-predictor-inherits-estimator class=md-nav__link> <span class=md-ellipsis> 2. Predictor (Inherits Estimator) </span> </a> </li> <li class=md-nav__item> <a href=#3-transformer-inherits-estimator class=md-nav__link> <span class=md-ellipsis> 3. Transformer (Inherits Estimator) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#api-patterns-conventions class=md-nav__link> <span class=md-ellipsis> API Patterns &amp; Conventions </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-185-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (185 lines) </span> </a> </li> <li class=md-nav__item> <a href=#api-design-principles class=md-nav__link> <span class=md-ellipsis> API Design Principles </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#real-world-impact class=md-nav__link> <span class=md-ellipsis> Real-World Impact </span> </a> </li> <li class=md-nav__item> <a href=#creating-custom-estimators-best-practices class=md-nav__link> <span class=md-ellipsis> Creating Custom Estimators (Best Practices) </span> </a> <nav class=md-nav aria-label="Creating Custom Estimators (Best Practices)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-create-an-sklearn-pipeline-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Create an Sklearn Pipeline? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#what-is-an-sklearn-pipeline class=md-nav__link> <span class=md-ellipsis> What is an Sklearn Pipeline? </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-195-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (195 lines) </span> </a> </li> <li class=md-nav__item> <a href=#pipeline-naming-convention class=md-nav__link> <span class=md-ellipsis> Pipeline Naming Convention </span> </a> </li> <li class=md-nav__item> <a href=#common-pipeline-patterns class=md-nav__link> <span class=md-ellipsis> Common Pipeline Patterns </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_1 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#columntransformer-deep-dive class=md-nav__link> <span class=md-ellipsis> ColumnTransformer Deep Dive </span> </a> <nav class=md-nav aria-label="ColumnTransformer Deep Dive"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-cross-validation-strategies-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Cross-Validation Strategies - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#what-is-cross-validation class=md-nav__link> <span class=md-ellipsis> What is Cross-Validation? </span> </a> </li> <li class=md-nav__item> <a href=#cross-validation-strategies class=md-nav__link> <span class=md-ellipsis> Cross-Validation Strategies </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-180-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (180 lines) </span> </a> </li> <li class=md-nav__item> <a href=#choosing-the-right-cv-strategy class=md-nav__link> <span class=md-ellipsis> Choosing the Right CV Strategy </span> </a> </li> <li class=md-nav__item> <a href=#common-data-leakage-scenarios class=md-nav__link> <span class=md-ellipsis> Common Data Leakage Scenarios </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_1 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_2 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#nested-cv-for-hyperparameter-tuning class=md-nav__link> <span class=md-ellipsis> Nested CV for Hyperparameter Tuning </span> </a> <nav class=md-nav aria-label="Nested CV for Hyperparameter Tuning"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-handle-class-imbalance-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Handle Class Imbalance? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#what-is-class-imbalance class=md-nav__link> <span class=md-ellipsis> What is Class Imbalance? </span> </a> </li> <li class=md-nav__item> <a href=#techniques-to-handle-imbalance class=md-nav__link> <span class=md-ellipsis> Techniques to Handle Imbalance </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-190-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (190 lines) </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-each-technique class=md-nav__link> <span class=md-ellipsis> When to Use Each Technique </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_2 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_3 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#smote-pipeline-preventing-data-leakage class=md-nav__link> <span class=md-ellipsis> SMOTE Pipeline (Preventing Data Leakage) </span> </a> </li> <li class=md-nav__item> <a href=#choosing-the-right-metric class=md-nav__link> <span class=md-ellipsis> Choosing the Right Metric </span> </a> <nav class=md-nav aria-label="Choosing the Right Metric"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-gridsearchcv-vs-randomizedsearchcv-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain GridSearchCV vs RandomizedSearchCV - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#gridsearchcv-vs-randomizedsearchcv class=md-nav__link> <span class=md-ellipsis> GridSearchCV vs RandomizedSearchCV </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-which class=md-nav__link> <span class=md-ellipsis> When to Use Which </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-180-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (180 lines) </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_4 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#real-world-performance class=md-nav__link> <span class=md-ellipsis> Real-World Performance </span> </a> <nav class=md-nav aria-label="Real-World Performance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-create-a-custom-transformer-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Create a Custom Transformer? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#overview_1 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#required-base-classes class=md-nav__link> <span class=md-ellipsis> Required Base Classes </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-195-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (195 lines) </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_5 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#real-world-examples class=md-nav__link> <span class=md-ellipsis> Real-World Examples </span> </a> <nav class=md-nav aria-label="Real-World Examples"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-feature-scaling-methods-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Feature Scaling Methods - Most Tech Companies Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#overview_2 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#scaling-methods-comparison class=md-nav__link> <span class=md-ellipsis> Scaling Methods Comparison </span> </a> </li> <li class=md-nav__item> <a href=#when-scaling-matters class=md-nav__link> <span class=md-ellipsis> When Scaling Matters </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-170-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (170 lines) </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_6 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#real-world-performance_1 class=md-nav__link> <span class=md-ellipsis> Real-World Performance </span> </a> <nav class=md-nav aria-label="Real-World Performance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-evaluate-classification-models-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Evaluate Classification Models? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#overview_3 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#classification-metrics-summary class=md-nav__link> <span class=md-ellipsis> Classification Metrics Summary </span> </a> </li> <li class=md-nav__item> <a href=#confusion-matrix-breakdown class=md-nav__link> <span class=md-ellipsis> Confusion Matrix Breakdown </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-185-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (185 lines) </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_7 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#real-world-metric-choices class=md-nav__link> <span class=md-ellipsis> Real-World Metric Choices </span> </a> <nav class=md-nav aria-label="Real-World Metric Choices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-ridge-vs-lasso-vs-elasticnet-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Ridge vs Lasso vs ElasticNet - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#overview_4 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#mathematical-formulation class=md-nav__link> <span class=md-ellipsis> Mathematical Formulation </span> </a> </li> <li class=md-nav__item> <a href=#ridge-vs-lasso-vs-elasticnet class=md-nav__link> <span class=md-ellipsis> Ridge vs Lasso vs ElasticNet </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-190-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (190 lines) </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_8 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#real-world-performance_2 class=md-nav__link> <span class=md-ellipsis> Real-World Performance </span> </a> <nav class=md-nav aria-label="Real-World Performance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-implement-feature-selection-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Implement Feature Selection? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#overview_5 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#feature-selection-methods class=md-nav__link> <span class=md-ellipsis> Feature Selection Methods </span> </a> </li> <li class=md-nav__item> <a href=#filter-vs-wrapper-vs-embedded class=md-nav__link> <span class=md-ellipsis> Filter vs Wrapper vs Embedded </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-195-lines_2 class=md-nav__link> <span class=md-ellipsis> Production Implementation (195 lines) </span> </a> </li> <li class=md-nav__item> <a href=#common-pitfalls-solutions_9 class=md-nav__link> <span class=md-ellipsis> Common Pitfalls &amp; Solutions </span> </a> </li> <li class=md-nav__item> <a href=#real-world-performance_3 class=md-nav__link> <span class=md-ellipsis> Real-World Performance </span> </a> <nav class=md-nav aria-label="Real-World Performance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-save-and-load-models-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to Save and Load Models? - Most Tech Companies Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#overview_6 class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#production-code-120-lines class=md-nav__link> <span class=md-ellipsis> Production Code (120 lines) </span> </a> </li> <li class=md-nav__item> <a href=#security-versioning class=md-nav__link> <span class=md-ellipsis> Security &amp; Versioning </span> </a> <nav class=md-nav aria-label="Security & Versioning"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-random-forest-feature-importance-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Random Forest Feature Importance - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-votingclassifier-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use VotingClassifier? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-detect-overfitting-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to Detect Overfitting? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-handle-missing-values-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Handle Missing Values? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-debug-a-failing-model-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Debug a Failing Model? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-probability-calibration-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain probability calibration - Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-columntransformer-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to use ColumnTransformer? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-multi-label-classification-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement multi-label classification? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-make_scorer-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to use make_scorer? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-perform-polynomial-regression-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to perform polynomial regression? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-compute-learning-curves-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to compute learning curves? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-smote-for-imbalanced-data-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to use SMOTE for imbalanced data? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-perform-stratified-sampling-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to perform stratified sampling? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-tune-hyperparameters-with-optunahalvinggridsearch-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to tune hyperparameters with Optuna/HalvingGridSearch? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-svm-classification-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement SVM classification? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-k-means-clustering-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement K-Means clustering? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-pca-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement PCA? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-gradient-boosting-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Gradient Boosting? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-naive-bayes-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Naive Bayes? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-dbscan-clustering-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement DBSCAN clustering? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-t-sne-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement t-SNE? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-knn-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement KNN? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-isolation-forest-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Isolation Forest? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-label-propagation-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Label Propagation? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-one-class-svm-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement One-Class SVM? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-target-encoding-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement target encoding? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-compute-partial-dependence-plots-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to compute partial dependence plots? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-stratified-group-split-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement stratified group split? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-validation-curves-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement validation curves? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-decision-boundary-visualization-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement decision boundary visualization? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-neural-network-classifier-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement neural network classifier? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-threshold-tuning-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement threshold tuning? - Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-cost-sensitive-classification-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement cost-sensitive classification? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-leaveoneout-cv-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement LeaveOneOut CV? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-confusion-matrix-visualization-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement confusion matrix visualization? - Most Tech Companies Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-precision-recall-curves-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement precision-recall curves? - Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-model-calibration-check-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement model calibration check? - Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-cross_validate-for-multiple-metrics-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement cross_validate for multiple metrics? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-linear-regression-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Linear Regression? - Most Tech Companies Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#linear-regression-workflow class=md-nav__link> <span class=md-ellipsis> Linear Regression Workflow </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-180-lines_2 class=md-nav__link> <span class=md-ellipsis> Production Implementation (180 lines) </span> </a> </li> <li class=md-nav__item> <a href=#linear-regression-comparison class=md-nav__link> <span class=md-ellipsis> Linear Regression Comparison </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-linear-regression-vs-alternatives class=md-nav__link> <span class=md-ellipsis> When to Use Linear Regression vs Alternatives </span> </a> </li> <li class=md-nav__item> <a href=#real-world-performance_4 class=md-nav__link> <span class=md-ellipsis> Real-World Performance </span> </a> <nav class=md-nav aria-label="Real-World Performance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-ridge-regression-and-when-to-use-it-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is Ridge Regression and when to use it? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ridge-vs-no-regularization class=md-nav__link> <span class=md-ellipsis> Ridge vs No Regularization </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-165-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (165 lines) </span> </a> </li> <li class=md-nav__item> <a href=#ridge-regression-properties class=md-nav__link> <span class=md-ellipsis> Ridge Regression Properties </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-ridge class=md-nav__link> <span class=md-ellipsis> When to Use Ridge </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_3 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-lasso-regression-and-when-to-use-it-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is Lasso Regression and when to use it? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lasso-feature-selection-process class=md-nav__link> <span class=md-ellipsis> Lasso Feature Selection Process </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-175-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (175 lines) </span> </a> </li> <li class=md-nav__item> <a href=#lasso-vs-ridge-comparison class=md-nav__link> <span class=md-ellipsis> Lasso vs Ridge Comparison </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-lasso class=md-nav__link> <span class=md-ellipsis> When to Use Lasso </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_4 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-elasticnet-regression-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is ElasticNet regression? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#elasticnet-decision-flow class=md-nav__link> <span class=md-ellipsis> ElasticNet Decision Flow </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-155-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (155 lines) </span> </a> </li> <li class=md-nav__item> <a href=#elasticnet-properties class=md-nav__link> <span class=md-ellipsis> ElasticNet Properties </span> </a> </li> <li class=md-nav__item> <a href=#ridge-vs-lasso-vs-elasticnet-decision-guide class=md-nav__link> <span class=md-ellipsis> Ridge vs Lasso vs ElasticNet Decision Guide </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_5 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-implement-logistic-regression-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Logistic Regression? - Most Tech Companies Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#logistic-regression-workflow class=md-nav__link> <span class=md-ellipsis> Logistic Regression Workflow </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-180-lines_3 class=md-nav__link> <span class=md-ellipsis> Production Implementation (180 lines) </span> </a> </li> <li class=md-nav__item> <a href=#logistic-regression-properties class=md-nav__link> <span class=md-ellipsis> Logistic Regression Properties </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-logistic-regression class=md-nav__link> <span class=md-ellipsis> When to Use Logistic Regression </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_6 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-the-solver-options-in-logistic-regression-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain the solver options in Logistic Regression - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#solver-decision-tree class=md-nav__link> <span class=md-ellipsis> Solver Decision Tree </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-140-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (140 lines) </span> </a> </li> <li class=md-nav__item> <a href=#solver-comparison-table class=md-nav__link> <span class=md-ellipsis> Solver Comparison Table </span> </a> </li> <li class=md-nav__item> <a href=#solver-selection-guide class=md-nav__link> <span class=md-ellipsis> Solver Selection Guide </span> </a> </li> <li class=md-nav__item> <a href=#real-world-solver-usage class=md-nav__link> <span class=md-ellipsis> Real-World Solver Usage </span> </a> <nav class=md-nav aria-label="Real-World Solver Usage"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-implement-decision-trees-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Decision Trees? - Most Tech Companies Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#decision-tree-structure class=md-nav__link> <span class=md-ellipsis> Decision Tree Structure </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-170-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (170 lines) </span> </a> </li> <li class=md-nav__item> <a href=#decision-tree-hyperparameters class=md-nav__link> <span class=md-ellipsis> Decision Tree Hyperparameters </span> </a> </li> <li class=md-nav__item> <a href=#advantages-vs-disadvantages class=md-nav__link> <span class=md-ellipsis> Advantages vs Disadvantages </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_7 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-are-the-hyperparameters-for-decision-trees-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What are the hyperparameters for Decision Trees? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#hyperparameter-impact-flow class=md-nav__link> <span class=md-ellipsis> Hyperparameter Impact Flow </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-160-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (160 lines) </span> </a> </li> <li class=md-nav__item> <a href=#hyperparameter-tuning-guide class=md-nav__link> <span class=md-ellipsis> Hyperparameter Tuning Guide </span> </a> </li> <li class=md-nav__item> <a href=#common-hyperparameter-combinations class=md-nav__link> <span class=md-ellipsis> Common Hyperparameter Combinations </span> </a> </li> <li class=md-nav__item> <a href=#real-world-configurations class=md-nav__link> <span class=md-ellipsis> Real-World Configurations </span> </a> <nav class=md-nav aria-label="Real-World Configurations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-implement-random-forest-most-tech-companies-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement Random Forest? - Most Tech Companies Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#random-forest-architecture class=md-nav__link> <span class=md-ellipsis> Random Forest Architecture </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-175-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (175 lines) </span> </a> </li> <li class=md-nav__item> <a href=#random-forest-key-parameters class=md-nav__link> <span class=md-ellipsis> Random Forest Key Parameters </span> </a> </li> <li class=md-nav__item> <a href=#random-forest-advantages class=md-nav__link> <span class=md-ellipsis> Random Forest Advantages </span> </a> </li> <li class=md-nav__item> <a href=#random-forest-vs-gradient-boosting class=md-nav__link> <span class=md-ellipsis> Random Forest vs Gradient Boosting </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_8 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-random-forest class=md-nav__link> <span class=md-ellipsis> When to Use Random Forest </span> </a> <nav class=md-nav aria-label="When to Use Random Forest"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#difference-between-bagging-and-boosting-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Difference between Bagging and Boosting? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bagging-vs-boosting-visual class=md-nav__link> <span class=md-ellipsis> Bagging vs Boosting Visual </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-140-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (140 lines) </span> </a> </li> <li class=md-nav__item> <a href=#bagging-vs-boosting-comparison class=md-nav__link> <span class=md-ellipsis> Bagging vs Boosting Comparison </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-each class=md-nav__link> <span class=md-ellipsis> When to Use Each </span> </a> <nav class=md-nav aria-label="When to Use Each"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-does-gradient-boosting-work-senior-dsml-engineer-question class=md-nav__link> <span class=md-ellipsis> How does Gradient Boosting work? - Senior DS/ML Engineer Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#gradient-boosting-algorithm-flow class=md-nav__link> <span class=md-ellipsis> Gradient Boosting Algorithm Flow </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-160-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (160 lines) </span> </a> </li> <li class=md-nav__item> <a href=#gradient-boosting-key-parameters class=md-nav__link> <span class=md-ellipsis> Gradient Boosting Key Parameters </span> </a> </li> <li class=md-nav__item> <a href=#gbm-vs-random-forest class=md-nav__link> <span class=md-ellipsis> GBM vs Random Forest </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_9 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-does-adaboost-work-meta-apple-interview-question class=md-nav__link> <span class=md-ellipsis> How does AdaBoost work? - Meta, Apple Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#adaboost-algorithm-flow class=md-nav__link> <span class=md-ellipsis> AdaBoost Algorithm Flow </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-145-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (145 lines) </span> </a> </li> <li class=md-nav__item> <a href=#adaboost-key-parameters class=md-nav__link> <span class=md-ellipsis> AdaBoost Key Parameters </span> </a> </li> <li class=md-nav__item> <a href=#adaboost-vs-gradient-boosting class=md-nav__link> <span class=md-ellipsis> AdaBoost vs Gradient Boosting </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_10 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-implement-svm-microsoft-nvidia-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement SVM? - Microsoft, NVIDIA Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#svm-margin-maximization class=md-nav__link> <span class=md-ellipsis> SVM Margin Maximization </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-155-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (155 lines) </span> </a> </li> <li class=md-nav__item> <a href=#svm-key-parameters class=md-nav__link> <span class=md-ellipsis> SVM Key Parameters </span> </a> </li> <li class=md-nav__item> <a href=#svm-vs-logistic-regression class=md-nav__link> <span class=md-ellipsis> SVM vs Logistic Regression </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_11 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-are-svm-kernels-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What are SVM kernels? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#kernel-decision-tree class=md-nav__link> <span class=md-ellipsis> Kernel Decision Tree </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-150-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (150 lines) </span> </a> </li> <li class=md-nav__item> <a href=#kernel-function-formulas class=md-nav__link> <span class=md-ellipsis> Kernel Function Formulas </span> </a> </li> <li class=md-nav__item> <a href=#kernel-selection-guide class=md-nav__link> <span class=md-ellipsis> Kernel Selection Guide </span> </a> </li> <li class=md-nav__item> <a href=#rbf-gamma-tuning class=md-nav__link> <span class=md-ellipsis> RBF Gamma Tuning </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_12 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-implement-knn-entry-level-interview-question class=md-nav__link> <span class=md-ellipsis> How to implement KNN? - Entry-Level Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#knn-algorithm-flow class=md-nav__link> <span class=md-ellipsis> KNN Algorithm Flow </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-145-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (145 lines) </span> </a> </li> <li class=md-nav__item> <a href=#knn-key-parameters class=md-nav__link> <span class=md-ellipsis> KNN Key Parameters </span> </a> </li> <li class=md-nav__item> <a href=#knn-pros-cons class=md-nav__link> <span class=md-ellipsis> KNN Pros &amp; Cons </span> </a> </li> <li class=md-nav__item> <a href=#distance-metrics class=md-nav__link> <span class=md-ellipsis> Distance Metrics </span> </a> </li> <li class=md-nav__item> <a href=#real-world-applications_13 class=md-nav__link> <span class=md-ellipsis> Real-World Applications </span> </a> <nav class=md-nav aria-label="Real-World Applications"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-the-curse-of-dimensionality-senior-interview-question class=md-nav__link> <span class=md-ellipsis> What is the curse of dimensionality? - Senior Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#curse-of-dimensionality-visualization class=md-nav__link> <span class=md-ellipsis> Curse of Dimensionality Visualization </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-135-lines class=md-nav__link> <span class=md-ellipsis> Production Implementation (135 lines) </span> </a> </li> <li class=md-nav__item> <a href=#curse-of-dimensionality-effects class=md-nav__link> <span class=md-ellipsis> Curse of Dimensionality Effects </span> </a> </li> <li class=md-nav__item> <a href=#solutions-to-curse-of-dimensionality class=md-nav__link> <span class=md-ellipsis> Solutions to Curse of Dimensionality </span> </a> </li> <li class=md-nav__item> <a href=#dimensionality-guidelines class=md-nav__link> <span class=md-ellipsis> Dimensionality Guidelines </span> </a> </li> <li class=md-nav__item> <a href=#real-world-examples_1 class=md-nav__link> <span class=md-ellipsis> Real-World Examples </span> </a> <nav class=md-nav aria-label="Real-World Examples"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-are-naive-bayes-variants-common-interview-question class=md-nav__link> <span class=md-ellipsis> What are Naive Bayes variants? - Common Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#naive-bayes-variants-decision-tree class=md-nav__link> <span class=md-ellipsis> Naive Bayes Variants Decision Tree </span> </a> </li> <li class=md-nav__item> <a href=#production-implementation-165-lines_1 class=md-nav__link> <span class=md-ellipsis> Production Implementation (165 lines) </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/singhsidhukuldeep/singhsidhukuldeep.github.io/edit/master/docs/Interview-Questions/Scikit-Learn.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/singhsidhukuldeep/singhsidhukuldeep.github.io/raw/master/docs/Interview-Questions/Scikit-Learn.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1 id=scikit-learn-interview-questions>Scikit-Learn Interview Questions</h1> <!-- [TOC] --> <p>This document provides a curated list of Scikit-Learn interview questions commonly asked in technical interviews for Machine Learning Engineer, Data Scientist, and AI/ML roles. It covers fundamental concepts to advanced machine learning techniques, model evaluation, and production deployment.</p> <p>This is updated frequently but right now this is the most exhaustive list of type of questions being asked.</p> <hr> <h2 id=premium-interview-questions>Premium Interview Questions</h2> <h3 id=explain-the-scikit-learn-estimator-api-google-amazon-interview-question>Explain the Scikit-Learn Estimator API - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>API Design</code>, <code>Core Concepts</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <h2 id=what-is-the-scikit-learn-estimator-api>What is the Scikit-Learn Estimator API?</h2> <p>The <strong>Estimator API</strong> is Scikit-Learn's unified interface for all machine learning algorithms. It provides a consistent pattern across 100+ algorithms, making code predictable and maintainable.</p> <p><strong>Core Philosophy:</strong> "All estimators implement <code>fit()</code>"</p> <p><strong>Why It Matters:</strong> - <strong>Consistency:</strong> Same API for LinearRegression, RandomForest, SVM, Neural Networks - <strong>Composability:</strong> Mix and match algorithms without code changes - <strong>Production:</strong> Easy to swap models (A/B testing, experimentation) - <strong>Learning:</strong> Once you know the pattern, you know all sklearn algorithms</p> <h2 id=three-types-of-estimators>Three Types of Estimators</h2> <h3 id=1-estimator-base-class>1. Estimator (Base Class)</h3> <ul> <li><strong>Method:</strong> <code>fit(X, y)</code> - Learn from data</li> <li><strong>Returns:</strong> <code>self</code> (for method chaining)</li> <li><strong>Example:</strong> <code>KMeans</code>, <code>PCA</code> (unsupervised)</li> </ul> <h3 id=2-predictor-inherits-estimator>2. Predictor (Inherits Estimator)</h3> <ul> <li><strong>Methods:</strong> <code>fit(X, y)</code>, <code>predict(X)</code>, <code>score(X, y)</code></li> <li><strong>Used for:</strong> Supervised learning (classification, regression)</li> <li><strong>Example:</strong> <code>RandomForestClassifier</code>, <code>LinearRegression</code></li> </ul> <h3 id=3-transformer-inherits-estimator>3. Transformer (Inherits Estimator)</h3> <ul> <li><strong>Methods:</strong> <code>fit(X)</code>, <code>transform(X)</code>, <code>fit_transform(X)</code></li> <li><strong>Used for:</strong> Feature engineering, preprocessing</li> <li><strong>Example:</strong> <code>StandardScaler</code>, <code>PCA</code>, <code>TfidfVectorizer</code></li> </ul> <h2 id=api-patterns-conventions>API Patterns &amp; Conventions</h2> <p><strong>Learned Attributes (End with <code>_</code>):</strong> <div class=highlight><pre><span></span><code><span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>()</span>
<span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

<span class=c1># Learned attributes (computed during fit)</span>
<span class=n>model</span><span class=o>.</span><span class=n>feature_importances_</span>  <span class=c1># Feature importance scores</span>
<span class=n>model</span><span class=o>.</span><span class=n>n_features_in_</span>        <span class=c1># Number of features seen during fit</span>
<span class=n>model</span><span class=o>.</span><span class=n>classes_</span>              <span class=c1># Unique class labels</span>
<span class=n>model</span><span class=o>.</span><span class=n>estimators_</span>           <span class=c1># Individual trees in forest</span>
</code></pre></div></p> <p><strong>Hyperparameters (Set before fit):</strong> <div class=highlight><pre><span></span><code><span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span>
    <span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>      <span class=c1># Number of trees</span>
    <span class=n>max_depth</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>          <span class=c1># Max tree depth</span>
    <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>        <span class=c1># Reproducibility</span>
<span class=p>)</span>
</code></pre></div></p> <p><strong>Method Chaining:</strong> <div class=highlight><pre><span></span><code><span class=c1># fit() returns self, enabling chaining</span>
<span class=n>predictions</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>()</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
</code></pre></div></p> <h2 id=production-implementation-185-lines>Production Implementation (185 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># sklearn_estimator_api.py</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.base</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>ClassifierMixin</span><span class=p>,</span> <span class=n>TransformerMixin</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.utils.validation</span><span class=w> </span><span class=kn>import</span> <span class=n>check_X_y</span><span class=p>,</span> <span class=n>check_array</span><span class=p>,</span> <span class=n>check_is_fitted</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LogisticRegression</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>from</span><span class=w> </span><span class=nn>typing</span><span class=w> </span><span class=kn>import</span> <span class=n>Optional</span>

<span class=k>class</span><span class=w> </span><span class=nc>CustomEstimatorDemo</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>ClassifierMixin</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Custom estimator following sklearn API conventions</span>

<span class=sd>    Demonstrates:</span>
<span class=sd>    1. fit() method with input validation</span>
<span class=sd>    2. predict() method with fitted checks</span>
<span class=sd>    3. Learned attributes with underscore suffix</span>
<span class=sd>    4. get_params() and set_params() for GridSearchCV</span>
<span class=sd>    5. __repr__() for string representation</span>

<span class=sd>    Time: O(n √ó d) for n samples, d features</span>
<span class=sd>    Space: O(d) for model parameters</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>alpha</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span> <span class=n>max_iter</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>100</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Initialize with hyperparameters (no data-dependent logic!)</span>

<span class=sd>        Args:</span>
<span class=sd>            alpha: Regularization strength</span>
<span class=sd>            max_iter: Maximum iterations</span>

<span class=sd>        NOTE: __init__ must NOT access data - only set hyperparameters</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>alpha</span> <span class=o>=</span> <span class=n>alpha</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>max_iter</span> <span class=o>=</span> <span class=n>max_iter</span>

    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Fit model to training data</span>

<span class=sd>        Args:</span>
<span class=sd>            X: Features (n_samples, n_features)</span>
<span class=sd>            y: Labels (n_samples,)</span>

<span class=sd>        Returns:</span>
<span class=sd>            self (for method chaining)</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=c1># 1. Input validation (sklearn convention)</span>
        <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>check_X_y</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>accept_sparse</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

        <span class=c1># 2. Store training metadata</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>n_features_in_</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>classes_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>

        <span class=c1># 3. Fit underlying model (simplified logistic regression for demo)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>coef_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>intercept_</span> <span class=o>=</span> <span class=mf>0.0</span>

        <span class=c1># Simple gradient descent (real: use scipy.optimize)</span>
        <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>max_iter</span><span class=p>):</span>
            <span class=c1># Logistic regression update (simplified)</span>
            <span class=n>predictions</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_predict_proba</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
            <span class=n>error</span> <span class=o>=</span> <span class=n>y</span> <span class=o>-</span> <span class=n>predictions</span>
            <span class=n>gradient</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>error</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>coef_</span> <span class=o>+=</span> <span class=mf>0.01</span> <span class=o>*</span> <span class=n>gradient</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>alpha</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>coef_</span>  <span class=c1># L2 regularization</span>

        <span class=c1># 4. Mark as fitted</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>is_fitted_</span> <span class=o>=</span> <span class=kc>True</span>

        <span class=k>return</span> <span class=bp>self</span>  <span class=c1># Method chaining</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_predict_proba</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Internal method to compute probabilities&quot;&quot;&quot;</span>
        <span class=n>logits</span> <span class=o>=</span> <span class=n>X</span> <span class=o>@</span> <span class=bp>self</span><span class=o>.</span><span class=n>coef_</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>intercept_</span>
        <span class=k>return</span> <span class=mi>1</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=n>logits</span><span class=p>))</span>  <span class=c1># Sigmoid</span>

    <span class=k>def</span><span class=w> </span><span class=nf>predict</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Make predictions on new data</span>

<span class=sd>        Args:</span>
<span class=sd>            X: Features (n_samples, n_features)</span>

<span class=sd>        Returns:</span>
<span class=sd>            Predictions (n_samples,)</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=c1># 1. Check if fitted</span>
        <span class=n>check_is_fitted</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;coef_&#39;</span><span class=p>,</span> <span class=s1>&#39;intercept_&#39;</span><span class=p>])</span>

        <span class=c1># 2. Validate input</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>check_array</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>accept_sparse</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

        <span class=c1># 3. Check feature count</span>
        <span class=k>if</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=bp>self</span><span class=o>.</span><span class=n>n_features_in_</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Expected </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>n_features_in_</span><span class=si>}</span><span class=s2> features, got </span><span class=si>{</span><span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

        <span class=c1># 4. Make predictions</span>
        <span class=n>probabilities</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_predict_proba</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
        <span class=k>return</span> <span class=p>(</span><span class=n>probabilities</span> <span class=o>&gt;</span> <span class=mf>0.5</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>score</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Compute accuracy score</span>

<span class=sd>        Args:</span>
<span class=sd>            X: Features</span>
<span class=sd>            y: True labels</span>

<span class=sd>        Returns:</span>
<span class=sd>            Accuracy (float)</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>predictions</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>predictions</span> <span class=o>==</span> <span class=n>y</span><span class=p>)</span>

<span class=k>class</span><span class=w> </span><span class=nc>CustomTransformerDemo</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Custom transformer following sklearn API</span>

<span class=sd>    Example: Simple feature scaling</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>method</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s1>&#39;standard&#39;</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Args:</span>
<span class=sd>            method: Scaling method (&#39;standard&#39;, &#39;minmax&#39;)</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>method</span> <span class=o>=</span> <span class=n>method</span>

    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Learn scaling parameters from data</span>

<span class=sd>        Args:</span>
<span class=sd>            X: Features</span>
<span class=sd>            y: Ignored (for API compatibility)</span>

<span class=sd>        Returns:</span>
<span class=sd>            self</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>check_array</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>

        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;standard&#39;</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>mean_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>std_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;minmax&#39;</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>min_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>min</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>max_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>n_features_in_</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Transform features using learned parameters</span>

<span class=sd>        Args:</span>
<span class=sd>            X: Features</span>

<span class=sd>        Returns:</span>
<span class=sd>            Transformed features</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>check_is_fitted</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;n_features_in_&#39;</span><span class=p>])</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>check_array</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>

        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;standard&#39;</span><span class=p>:</span>
            <span class=k>return</span> <span class=p>(</span><span class=n>X</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>mean_</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>std_</span> <span class=o>+</span> <span class=mf>1e-8</span><span class=p>)</span>
        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;minmax&#39;</span><span class=p>:</span>
            <span class=k>return</span> <span class=p>(</span><span class=n>X</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>min_</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>max_</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>min_</span> <span class=o>+</span> <span class=mf>1e-8</span><span class=p>)</span>

<span class=c1># Demonstration of sklearn API patterns</span>
<span class=k>def</span><span class=w> </span><span class=nf>demo_estimator_api</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Demonstrate sklearn estimator API patterns&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;SKLEARN ESTIMATOR API DEMO&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=c1># Generate sample data</span>
    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Demo 1: Consistent API across algorithms</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>1. CONSISTENT API PATTERN&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=n>algorithms</span> <span class=o>=</span> <span class=p>[</span>
        <span class=p>(</span><span class=s1>&#39;Random Forest&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)),</span>
        <span class=p>(</span><span class=s1>&#39;Logistic Regression&#39;</span><span class=p>,</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>max_iter</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)),</span>
        <span class=p>(</span><span class=s1>&#39;Custom Estimator&#39;</span><span class=p>,</span> <span class=n>CustomEstimatorDemo</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>100</span><span class=p>))</span>
    <span class=p>]</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>algorithms</span><span class=p>:</span>
        <span class=c1># Same pattern for all!</span>
        <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>score</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>20s</span><span class=si>}</span><span class=s2> Accuracy: </span><span class=si>{</span><span class=n>score</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Demo 2: Learned attributes (end with _)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>2. LEARNED ATTRIBUTES (underscore suffix)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=n>rf</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>rf</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;n_features_in_: </span><span class=si>{</span><span class=n>rf</span><span class=o>.</span><span class=n>n_features_in_</span><span class=si>}</span><span class=s2> (features seen during fit)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;classes_: </span><span class=si>{</span><span class=n>rf</span><span class=o>.</span><span class=n>classes_</span><span class=si>}</span><span class=s2> (unique classes)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;n_estimators: </span><span class=si>{</span><span class=n>rf</span><span class=o>.</span><span class=n>n_estimators</span><span class=si>}</span><span class=s2> (hyperparameter, no underscore)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;feature_importances_: shape </span><span class=si>{</span><span class=n>rf</span><span class=o>.</span><span class=n>feature_importances_</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2> (learned)&quot;</span><span class=p>)</span>

    <span class=c1># Demo 3: Transformer pattern</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>3. TRANSFORMER API (fit, transform, fit_transform)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>

    <span class=c1># Option 1: fit() then transform()</span>
    <span class=n>scaler</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_train_scaled_1</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>

    <span class=c1># Option 2: fit_transform() (more efficient)</span>
    <span class=n>scaler2</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled_2</span> <span class=o>=</span> <span class=n>scaler2</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Original mean: </span><span class=si>{</span><span class=n>X_train</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Scaled mean: </span><span class=si>{</span><span class=n>X_train_scaled_1</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2> (close to 0)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Scaled std: </span><span class=si>{</span><span class=n>X_train_scaled_1</span><span class=o>.</span><span class=n>std</span><span class=p>()</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> (close to 1)&quot;</span><span class=p>)</span>

    <span class=c1># Demo 4: Method chaining</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>4. METHOD CHAINING (fit returns self)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=c1># Chain fit() and predict()</span>
    <span class=n>predictions</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Chained prediction shape: </span><span class=si>{</span><span class=n>predictions</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Demo 5: Custom transformer</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>5. CUSTOM TRANSFORMER&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=n>custom_scaler</span> <span class=o>=</span> <span class=n>CustomTransformerDemo</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s1>&#39;standard&#39;</span><span class=p>)</span>
    <span class=n>X_custom_scaled</span> <span class=o>=</span> <span class=n>custom_scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Custom scaled mean: </span><span class=si>{</span><span class=n>X_custom_scaled</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Custom scaled std: </span><span class=si>{</span><span class=n>X_custom_scaled</span><span class=o>.</span><span class=n>std</span><span class=p>()</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;KEY TAKEAWAYS:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. All estimators have fit()&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. Predictors add predict() and score()&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. Transformers add transform() and fit_transform()&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Learned attributes end with underscore&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. Hyperparameters set in __init__(), NO data access&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_estimator_api</span><span class=p>()</span>
</code></pre></div> <p><strong>Output:</strong> <div class=highlight><pre><span></span><code>======================================================================
SKLEARN ESTIMATOR API DEMO
======================================================================

1. CONSISTENT API PATTERN
----------------------------------------------------------------------
Random Forest        Accuracy: 0.885
Logistic Regression  Accuracy: 0.870
Custom Estimator     Accuracy: 0.855

2. LEARNED ATTRIBUTES (underscore suffix)
----------------------------------------------------------------------
n_features_in_: 20 (features seen during fit)
classes_: [0 1] (unique classes)
n_estimators: 10 (hyperparameter, no underscore)
feature_importances_: shape (20,) (learned)
</code></pre></div></p> <h2 id=api-design-principles>API Design Principles</h2> <table> <thead> <tr> <th>Principle</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>Consistency</strong></td> <td>Same methods across all algorithms</td> <td>All classifiers have <code>fit()</code>, <code>predict()</code>, <code>score()</code></td> </tr> <tr> <td><strong>Inspection</strong></td> <td>Learned attributes accessible via <code>_</code> suffix</td> <td><code>model.coef_</code>, <code>model.feature_importances_</code></td> </tr> <tr> <td><strong>Composition</strong></td> <td>Objects work together (Pipelines)</td> <td><code>Pipeline([('scaler', Scaler()), ('model', Model())])</code></td> </tr> <tr> <td><strong>Sensible defaults</strong></td> <td>Works out-of-the-box, tune later</td> <td><code>RandomForestClassifier()</code> without args</td> </tr> <tr> <td><strong>No side effects</strong></td> <td><code>fit()</code> returns <code>self</code>, doesn't modify inputs</td> <td>Method chaining: <code>model.fit(X, y).predict(X_test)</code></td> </tr> </tbody> </table> <h2 id=common-pitfalls-solutions>Common Pitfalls &amp; Solutions</h2> <table> <thead> <tr> <th>Pitfall</th> <th>Impact</th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td><strong>Data in <strong>init</strong>()</strong></td> <td>Breaks cloning, GridSearchCV fails</td> <td>Only set hyperparameters in <strong>init</strong>(), use fit() for data</td> </tr> <tr> <td><strong>Missing underscore on learned attributes</strong></td> <td>Confuses hyperparameters with learned params</td> <td>Always add <code>_</code> suffix: <code>coef_</code>, not <code>coef</code></td> </tr> <tr> <td><strong>Modifying input data</strong></td> <td>Side effects, breaks reproducibility</td> <td>Copy data if modification needed: <code>X = X.copy()</code></td> </tr> <tr> <td><strong>Not checking is_fitted</strong></td> <td>predict() before fit() crashes</td> <td>Use <code>check_is_fitted(self, ['coef_'])</code> in predict()</td> </tr> <tr> <td><strong>Wrong feature count</strong></td> <td>Mismatched dimensions crash</td> <td>Store <code>n_features_in_</code> during fit(), validate in predict()</td> </tr> </tbody> </table> <h2 id=real-world-impact>Real-World Impact</h2> <p><strong>Netflix (Model Experimentation):</strong> - <strong>Challenge:</strong> Compare 50+ algorithms for recommendation - <strong>Solution:</strong> Consistent API enables rapid experimentation - <strong>Result:</strong> Swap <code>RandomForest</code> ‚Üí <code>XGBoost</code> ‚Üí <code>LightGBM</code> with 1 line change</p> <p><strong>Uber (Production ML):</strong> - <strong>Challenge:</strong> Deploy models across 100+ microservices - <strong>Solution:</strong> All models follow same API (fit, predict, score) - <strong>Result:</strong> Unified deployment pipeline for all models</p> <p><strong>Google Cloud AI Platform:</strong> - <strong>Challenge:</strong> Support any sklearn model - <strong>Solution:</strong> Relies on consistent Estimator API - <strong>Result:</strong> Auto-deploy any sklearn model without code changes</p> <h2 id=creating-custom-estimators-best-practices>Creating Custom Estimators (Best Practices)</h2> <p><strong>1. Inherit from Base Classes:</strong> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.base</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>ClassifierMixin</span>

<span class=k>class</span><span class=w> </span><span class=nc>MyClassifier</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>ClassifierMixin</span><span class=p>):</span>
    <span class=k>pass</span>  <span class=c1># Automatically gets get_params(), set_params(), __repr__()</span>
</code></pre></div></p> <p><strong>2. Follow Naming Conventions:</strong> - Hyperparameters: <code>alpha</code>, <code>n_estimators</code> (no underscore) - Learned attributes: <code>coef_</code>, <code>classes_</code> (underscore suffix)</p> <p><strong>3. Use Validation Utilities:</strong> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.utils.validation</span><span class=w> </span><span class=kn>import</span> <span class=n>check_X_y</span><span class=p>,</span> <span class=n>check_array</span><span class=p>,</span> <span class=n>check_is_fitted</span>

<span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>check_X_y</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>  <span class=c1># Validates input</span>
    <span class=c1># ... training logic</span>
    <span class=k>return</span> <span class=bp>self</span>
</code></pre></div></p> <p><strong>4. Enable GridSearchCV Support:</strong> - Don't override <code>get_params()</code> or <code>set_params()</code> (inherited from BaseEstimator) - Ensure <strong>init</strong>() only sets hyperparameters</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>Strong candidates:</strong></p> <ul> <li>Explain three types: "Estimator (fit), Predictor (fit + predict), Transformer (fit + transform)"</li> <li>Know underscore convention: "Learned attributes end with <code>_</code> (coef_), hyperparameters don't (alpha)"</li> <li>Understand method chaining: "fit() returns self ‚Üí enables <code>model.fit(X, y).predict(X_test)</code>"</li> <li>Reference real systems: "Netflix uses consistent API to swap 50+ algorithms; Uber deploys 100+ services with same interface"</li> <li>Discuss custom estimators: "Inherit from BaseEstimator for get_params(); only set hyperparameters in <strong>init</strong>(), never access data"</li> <li>Know validation: "Use check_X_y(), check_array(), check_is_fitted() for robust custom estimators"</li> </ul> </div> </details> <hr> <h3 id=how-to-create-an-sklearn-pipeline-google-amazon-interview-question>How to Create an Sklearn Pipeline? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Pipeline</code>, <code>Best Practices</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <h2 id=what-is-an-sklearn-pipeline>What is an Sklearn Pipeline?</h2> <p>A <strong>Pipeline</strong> chains multiple preprocessing steps and a final estimator into a single object. It ensures that transformations (scaling, encoding) are applied consistently to training and test data, <strong>preventing data leakage</strong>.</p> <p><strong>Critical Problem Solved:</strong> <div class=highlight><pre><span></span><code><span class=c1># ‚ùå WRONG: Data leakage!</span>
<span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>  <span class=c1># Fit on ALL data (train + test)</span>
<span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
<span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>  <span class=c1># Test data influenced training!</span>

<span class=c1># ‚úÖ CORRECT: Pipeline prevents leakage</span>
<span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span> <span class=p>(</span><span class=s1>&#39;model&#39;</span><span class=p>,</span> <span class=n>RandomForest</span><span class=p>())])</span>
<span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>  <span class=c1># Scaler only sees training data</span>
<span class=n>pipeline</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>  <span class=c1># Scaler uses training params on test</span>
</code></pre></div></p> <p><strong>Why Pipelines Matter:</strong> - <strong>No Data Leakage:</strong> Transformers fit only on training data - <strong>Clean Code:</strong> Single <code>fit()</code> instead of manual step-by-step - <strong>Easy Deployment:</strong> Serialize entire pipeline with <code>joblib.dump()</code> - <strong>GridSearchCV Compatible:</strong> Tune preprocessing + model together</p> <h2 id=production-implementation-195-lines>Production Implementation (195 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># sklearn_pipeline.py</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span><span class=p>,</span> <span class=n>FeatureUnion</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span><span class=p>,</span> <span class=n>OneHotEncoder</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.compose</span><span class=w> </span><span class=kn>import</span> <span class=n>ColumnTransformer</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.impute</span><span class=w> </span><span class=kn>import</span> <span class=n>SimpleImputer</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>GridSearchCV</span><span class=p>,</span> <span class=n>cross_val_score</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.base</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>from</span><span class=w> </span><span class=nn>typing</span><span class=w> </span><span class=kn>import</span> <span class=n>List</span>

<span class=k>class</span><span class=w> </span><span class=nc>FeatureSelector</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Custom transformer to select specific columns&quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>columns</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>columns</span> <span class=o>=</span> <span class=n>columns</span>

    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
        <span class=k>return</span> <span class=n>X</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>columns</span><span class=p>]</span>

<span class=k>class</span><span class=w> </span><span class=nc>OutlierClipper</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Custom transformer to clip outliers using IQR&quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>factor</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.5</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>factor</span> <span class=o>=</span> <span class=n>factor</span>

    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
        <span class=n>Q1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
        <span class=n>Q3</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=mi>75</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
        <span class=n>IQR</span> <span class=o>=</span> <span class=n>Q3</span> <span class=o>-</span> <span class=n>Q1</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>lower_bound_</span> <span class=o>=</span> <span class=n>Q1</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>factor</span> <span class=o>*</span> <span class=n>IQR</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>upper_bound_</span> <span class=o>=</span> <span class=n>Q3</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>factor</span> <span class=o>*</span> <span class=n>IQR</span>
        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>lower_bound_</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>upper_bound_</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_basic_pipeline</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Basic pipeline example&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. BASIC PIPELINE (Prevent Data Leakage)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Sample data</span>
    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Create pipeline</span>
    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
        <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>
        <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>))</span>
    <span class=p>])</span>

    <span class=c1># Single fit() call</span>
    <span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># Single predict() call</span>
    <span class=n>accuracy</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Pipeline steps: </span><span class=si>{</span><span class=p>[</span><span class=n>name</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>_</span><span class=w> </span><span class=ow>in</span><span class=w> </span><span class=n>pipeline</span><span class=o>.</span><span class=n>steps</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Accuracy: </span><span class=si>{</span><span class=n>accuracy</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Scaler was fit ONLY on training data (no leakage!)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_column_transformer</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;ColumnTransformer for mixed data types&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. COLUMN TRANSFORMER (Mixed Numeric/Categorical)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Create sample data with mixed types</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
        <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>25</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>55</span><span class=p>,</span> <span class=mi>60</span><span class=p>],</span>
        <span class=s1>&#39;income&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>30000</span><span class=p>,</span> <span class=mi>45000</span><span class=p>,</span> <span class=mi>60000</span><span class=p>,</span> <span class=mi>75000</span><span class=p>,</span> <span class=mi>90000</span><span class=p>,</span> <span class=mi>105000</span><span class=p>,</span> <span class=mi>120000</span><span class=p>,</span> <span class=mi>135000</span><span class=p>],</span>
        <span class=s1>&#39;city&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;NYC&#39;</span><span class=p>,</span> <span class=s1>&#39;LA&#39;</span><span class=p>,</span> <span class=s1>&#39;NYC&#39;</span><span class=p>,</span> <span class=s1>&#39;LA&#39;</span><span class=p>,</span> <span class=s1>&#39;SF&#39;</span><span class=p>,</span> <span class=s1>&#39;NYC&#39;</span><span class=p>,</span> <span class=s1>&#39;SF&#39;</span><span class=p>,</span> <span class=s1>&#39;LA&#39;</span><span class=p>],</span>
        <span class=s1>&#39;education&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;HS&#39;</span><span class=p>,</span> <span class=s1>&#39;BS&#39;</span><span class=p>,</span> <span class=s1>&#39;MS&#39;</span><span class=p>,</span> <span class=s1>&#39;PhD&#39;</span><span class=p>,</span> <span class=s1>&#39;BS&#39;</span><span class=p>,</span> <span class=s1>&#39;MS&#39;</span><span class=p>,</span> <span class=s1>&#39;PhD&#39;</span><span class=p>,</span> <span class=s1>&#39;BS&#39;</span><span class=p>],</span>
        <span class=s1>&#39;target&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
    <span class=p>})</span>

    <span class=n>X</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=s1>&#39;target&#39;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
    <span class=n>y</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;target&#39;</span><span class=p>]</span>

    <span class=c1># Define transformers for different column types</span>
    <span class=n>numeric_features</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>,</span> <span class=s1>&#39;income&#39;</span><span class=p>]</span>
    <span class=n>categorical_features</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;city&#39;</span><span class=p>,</span> <span class=s1>&#39;education&#39;</span><span class=p>]</span>

    <span class=n>numeric_transformer</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
        <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;median&#39;</span><span class=p>)),</span>
        <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>())</span>
    <span class=p>])</span>

    <span class=n>categorical_transformer</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
        <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;constant&#39;</span><span class=p>,</span> <span class=n>fill_value</span><span class=o>=</span><span class=s1>&#39;missing&#39;</span><span class=p>)),</span>
        <span class=p>(</span><span class=s1>&#39;onehot&#39;</span><span class=p>,</span> <span class=n>OneHotEncoder</span><span class=p>(</span><span class=n>handle_unknown</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>,</span> <span class=n>sparse_output</span><span class=o>=</span><span class=kc>False</span><span class=p>))</span>
    <span class=p>])</span>

    <span class=c1># Combine with ColumnTransformer</span>
    <span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>([</span>
        <span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>,</span> <span class=n>numeric_transformer</span><span class=p>,</span> <span class=n>numeric_features</span><span class=p>),</span>
        <span class=p>(</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=n>categorical_transformer</span><span class=p>,</span> <span class=n>categorical_features</span><span class=p>)</span>
    <span class=p>])</span>

    <span class=c1># Full pipeline</span>
    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
        <span class=p>(</span><span class=s1>&#39;preprocessor&#39;</span><span class=p>,</span> <span class=n>preprocessor</span><span class=p>),</span>
        <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>))</span>
    <span class=p>])</span>

    <span class=c1># Fit and evaluate</span>
    <span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Numeric features: </span><span class=si>{</span><span class=n>numeric_features</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Categorical features: </span><span class=si>{</span><span class=n>categorical_features</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Different transformations applied to different column types!&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_custom_transformers</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Pipeline with custom transformers&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. CUSTOM TRANSFORMERS IN PIPELINE&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Sample data with outliers</span>
    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
    <span class=n>X</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>  <span class=c1># Outlier</span>
    <span class=n>X</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=mi>100</span>  <span class=c1># Outlier</span>
    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>

    <span class=c1># Pipeline with custom transformer</span>
    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
        <span class=p>(</span><span class=s1>&#39;outlier_clipper&#39;</span><span class=p>,</span> <span class=n>OutlierClipper</span><span class=p>(</span><span class=n>factor</span><span class=o>=</span><span class=mf>1.5</span><span class=p>)),</span>
        <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>
        <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>))</span>
    <span class=p>])</span>

    <span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Pipeline with custom OutlierClipper:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Step 1: OutlierClipper (clips to IQR bounds)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Step 2: StandardScaler&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Step 3: RandomForestClassifier&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Custom transformers seamlessly integrate!&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_gridsearch_pipeline</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;GridSearchCV with Pipeline (tune preprocessing + model)&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. GRIDSEARCHCV WITH PIPELINE (Tune Everything)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Pipeline</span>
    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
        <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>
        <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>))</span>
    <span class=p>])</span>

    <span class=c1># Parameter grid (use pipeline__step__param format)</span>
    <span class=n>param_grid</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;scaler&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>StandardScaler</span><span class=p>(),</span> <span class=kc>None</span><span class=p>],</span>  <span class=c1># Try with/without scaling</span>
        <span class=s1>&#39;classifier__n_estimators&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span>
        <span class=s1>&#39;classifier__max_depth&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>]</span>
    <span class=p>}</span>

    <span class=c1># GridSearch</span>
    <span class=n>grid_search</span> <span class=o>=</span> <span class=n>GridSearchCV</span><span class=p>(</span><span class=n>pipeline</span><span class=p>,</span> <span class=n>param_grid</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
    <span class=n>grid_search</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Best params: </span><span class=si>{</span><span class=n>grid_search</span><span class=o>.</span><span class=n>best_params_</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Best CV score: </span><span class=si>{</span><span class=n>grid_search</span><span class=o>.</span><span class=n>best_score_</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Test score: </span><span class=si>{</span><span class=n>grid_search</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span><span class=w> </span><span class=n>y_test</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Tuned preprocessing AND model hyperparameters together!&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_feature_union</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;FeatureUnion to combine multiple feature extraction methods&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. FEATURE UNION (Combine Multiple Features)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.decomposition</span><span class=w> </span><span class=kn>import</span> <span class=n>PCA</span>
    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.feature_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>SelectKBest</span>

    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>50</span><span class=p>)</span>
    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>

    <span class=c1># Combine PCA features + SelectKBest features</span>
    <span class=n>feature_union</span> <span class=o>=</span> <span class=n>FeatureUnion</span><span class=p>([</span>
        <span class=p>(</span><span class=s1>&#39;pca&#39;</span><span class=p>,</span> <span class=n>PCA</span><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=mi>10</span><span class=p>)),</span>
        <span class=p>(</span><span class=s1>&#39;select_k_best&#39;</span><span class=p>,</span> <span class=n>SelectKBest</span><span class=p>(</span><span class=n>k</span><span class=o>=</span><span class=mi>10</span><span class=p>))</span>
    <span class=p>])</span>

    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
        <span class=p>(</span><span class=s1>&#39;features&#39;</span><span class=p>,</span> <span class=n>feature_union</span><span class=p>),</span>
        <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>))</span>
    <span class=p>])</span>

    <span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>FeatureUnion combines:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - PCA: 10 principal components&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - SelectKBest: 10 best features&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - Total: 20 features fed to classifier&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Combined multiple feature engineering strategies!&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_pipeline_deployment</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Save and load pipeline for deployment&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;6. PIPELINE DEPLOYMENT (Save/Load)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=kn>import</span><span class=w> </span><span class=nn>joblib</span>
    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>200</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Train pipeline</span>
    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
        <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>
        <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>))</span>
    <span class=p>])</span>
    <span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>

    <span class=c1># Save to disk</span>
    <span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>pipeline</span><span class=p>,</span> <span class=s1>&#39;model_pipeline.pkl&#39;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Pipeline saved to &#39;model_pipeline.pkl&#39;&quot;</span><span class=p>)</span>

    <span class=c1># Load from disk</span>
    <span class=n>loaded_pipeline</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;model_pipeline.pkl&#39;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Pipeline loaded from disk&quot;</span><span class=p>)</span>

    <span class=c1># Make predictions</span>
    <span class=n>predictions</span> <span class=o>=</span> <span class=n>loaded_pipeline</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=p>[:</span><span class=mi>5</span><span class=p>])</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Predictions: </span><span class=si>{</span><span class=n>predictions</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Ready for production deployment!&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_basic_pipeline</span><span class=p>()</span>
    <span class=n>demo_column_transformer</span><span class=p>()</span>
    <span class=n>demo_custom_transformers</span><span class=p>()</span>
    <span class=n>demo_gridsearch_pipeline</span><span class=p>()</span>
    <span class=n>demo_feature_union</span><span class=p>()</span>
    <span class=n>demo_pipeline_deployment</span><span class=p>()</span>
</code></pre></div> <p><strong>Sample Output:</strong> <div class=highlight><pre><span></span><code>======================================================================
1. BASIC PIPELINE (Prevent Data Leakage)
======================================================================

Pipeline steps: [&#39;scaler&#39;, &#39;classifier&#39;]
Accuracy: 0.885

‚úÖ Scaler was fit ONLY on training data (no leakage!)

======================================================================
4. GRIDSEARCHCV WITH PIPELINE (Tune Everything)
======================================================================

Best params: {&#39;classifier__max_depth&#39;: 10, &#39;classifier__n_estimators&#39;: 100, &#39;scaler&#39;: StandardScaler()}
Best CV score: 0.882
Test score: 0.890

‚úÖ Tuned preprocessing AND model hyperparameters together!
</code></pre></div></p> <h2 id=pipeline-naming-convention>Pipeline Naming Convention</h2> <p><strong>Accessing pipeline components:</strong> <div class=highlight><pre><span></span><code><span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>
    <span class=p>(</span><span class=s1>&#39;pca&#39;</span><span class=p>,</span> <span class=n>PCA</span><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=mi>10</span><span class=p>)),</span>
    <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>())</span>
<span class=p>])</span>

<span class=c1># Access specific step</span>
<span class=n>pipeline</span><span class=o>.</span><span class=n>named_steps</span><span class=p>[</span><span class=s1>&#39;scaler&#39;</span><span class=p>]</span>
<span class=n>pipeline</span><span class=p>[</span><span class=s1>&#39;scaler&#39;</span><span class=p>]</span>  <span class=c1># Shorthand</span>

<span class=c1># Access attributes from final estimator</span>
<span class=n>pipeline</span><span class=o>.</span><span class=n>named_steps</span><span class=p>[</span><span class=s1>&#39;classifier&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>feature_importances_</span>

<span class=c1># GridSearchCV parameter naming</span>
<span class=n>param_grid</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;scaler__with_mean&#39;</span><span class=p>:</span> <span class=p>[</span><span class=kc>True</span><span class=p>,</span> <span class=kc>False</span><span class=p>],</span>
    <span class=s1>&#39;pca__n_components&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>15</span><span class=p>],</span>
    <span class=s1>&#39;classifier__n_estimators&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>]</span>
<span class=p>}</span>
</code></pre></div></p> <h2 id=common-pipeline-patterns>Common Pipeline Patterns</h2> <table> <thead> <tr> <th>Use Case</th> <th>Pipeline Structure</th> <th>Why</th> </tr> </thead> <tbody> <tr> <td><strong>Numeric data</strong></td> <td>Imputer ‚Üí Scaler ‚Üí Model</td> <td>Handle missing, then scale</td> </tr> <tr> <td><strong>Categorical data</strong></td> <td>Imputer ‚Üí OneHotEncoder ‚Üí Model</td> <td>Handle missing, then encode</td> </tr> <tr> <td><strong>Mixed data</strong></td> <td>ColumnTransformer (num + cat) ‚Üí Model</td> <td>Different preprocessing per type</td> </tr> <tr> <td><strong>Text data</strong></td> <td>TfidfVectorizer ‚Üí Model</td> <td>Extract features from text</td> </tr> <tr> <td><strong>High-dimensional</strong></td> <td>SelectKBest ‚Üí PCA ‚Üí Model</td> <td>Feature selection, then reduction</td> </tr> </tbody> </table> <h2 id=real-world-applications>Real-World Applications</h2> <p><strong>Airbnb (Pricing Model):</strong> - <strong>Challenge:</strong> 100+ features (numeric, categorical, text, geo) - <strong>Solution:</strong> ColumnTransformer pipeline with 5 sub-pipelines - <strong>Result:</strong> Single <code>pipeline.fit()</code> deploys consistently - <strong>Impact:</strong> Reduced deployment bugs by 80%</p> <p><strong>Uber (ETA Prediction):</strong> - <strong>Challenge:</strong> Real-time predictions, no data leakage - <strong>Solution:</strong> Pipeline with time-based feature engineering - <strong>Result:</strong> Guaranteed training/serving consistency - <strong>Scale:</strong> 1M+ predictions/second</p> <p><strong>Spotify (Recommendation):</strong> - <strong>Challenge:</strong> Mix audio features (numeric) + metadata (categorical) - <strong>Solution:</strong> ColumnTransformer in production pipeline - <strong>Result:</strong> A/B tested preprocessing changes seamlessly - <strong>Impact:</strong> 15% improvement in recommendation CTR</p> <h2 id=common-pitfalls-solutions_1>Common Pitfalls &amp; Solutions</h2> <table> <thead> <tr> <th>Pitfall</th> <th>Impact</th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td><strong>Fitting transformers on all data</strong></td> <td>Data leakage, overoptimistic metrics</td> <td>Always use Pipeline - it handles train/test split correctly</td> </tr> <tr> <td><strong>Forgetting to scale test data</strong></td> <td>Wrong predictions</td> <td>Pipeline automatically applies transformations to test data</td> </tr> <tr> <td><strong>Manual step-by-step preprocessing</strong></td> <td>Error-prone, hard to deploy</td> <td>Use Pipeline - single fit()/predict()</td> </tr> <tr> <td><strong>Different preprocessing in train/test</strong></td> <td>Train/serve skew</td> <td>Pipeline ensures consistency</td> </tr> <tr> <td><strong>Can't tune preprocessing params</strong></td> <td>Suboptimal preprocessing</td> <td>Use GridSearchCV with pipeline__step__param</td> </tr> <tr> <td><strong>Complex to serialize</strong></td> <td>Deployment issues</td> <td>Pipeline serializes all steps with joblib.dump()</td> </tr> </tbody> </table> <h2 id=columntransformer-deep-dive>ColumnTransformer Deep Dive</h2> <p><strong>Problem:</strong> Different columns need different preprocessing <div class=highlight><pre><span></span><code><span class=c1># Numeric: impute median, then scale</span>
<span class=c1># Categorical: impute &#39;missing&#39;, then one-hot encode</span>
<span class=c1># Text: TF-IDF vectorization</span>
</code></pre></div></p> <p><strong>Solution:</strong> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.compose</span><span class=w> </span><span class=kn>import</span> <span class=n>ColumnTransformer</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.feature_extraction.text</span><span class=w> </span><span class=kn>import</span> <span class=n>TfidfVectorizer</span>

<span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>,</span> <span class=n>numeric_pipeline</span><span class=p>,</span> <span class=n>numeric_cols</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=n>categorical_pipeline</span><span class=p>,</span> <span class=n>categorical_cols</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;text&#39;</span><span class=p>,</span> <span class=n>TfidfVectorizer</span><span class=p>(),</span> <span class=s1>&#39;description&#39;</span><span class=p>)</span>  <span class=c1># Single column</span>
<span class=p>])</span>

<span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;preprocessor&#39;</span><span class=p>,</span> <span class=n>preprocessor</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>())</span>
<span class=p>])</span>
</code></pre></div></p> <p><strong>Benefits:</strong> - Apply different transformations to different columns - Automatically handles column selection - Works with column names (DataFrame) or indices (array)</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>Strong candidates:</strong></p> <ul> <li>Explain data leakage: "Pipeline ensures transformers fit only on training data - prevents test data from influencing preprocessing"</li> <li>Know ColumnTransformer: "Apply different transformations to numeric (scale) vs categorical (one-hot) columns in single pipeline"</li> <li>Understand deployment: "Pipeline serializes entire workflow with joblib.dump() - guarantees train/serve consistency"</li> <li>Reference GridSearchCV: "Tune preprocessing AND model hyperparameters together using pipeline__step__param syntax"</li> <li>Cite real systems: "Airbnb uses ColumnTransformer for 100+ mixed-type features; Uber pipelines ensure no train/serve skew at 1M+ pred/s"</li> <li>Know custom transformers: "Inherit from BaseEstimator and TransformerMixin for custom preprocessing steps"</li> </ul> </div> </details> <hr> <h3 id=explain-cross-validation-strategies-google-amazon-interview-question>Explain Cross-Validation Strategies - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Model Evaluation</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <h2 id=what-is-cross-validation>What is Cross-Validation?</h2> <p><strong>Cross-Validation (CV)</strong> splits data into multiple train/test sets to evaluate model performance more reliably than a single train/test split. It reduces variance in performance estimates and detects overfitting.</p> <p><strong>The Problem with Single Split:</strong> <div class=highlight><pre><span></span><code><span class=c1># ‚ùå UNRELIABLE: Single split can be lucky/unlucky</span>
<span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
<span class=c1># Accuracy: 85% ‚Üê Could be 75% or 95% with different split!</span>

<span class=c1># ‚úÖ RELIABLE: Multiple splits average out randomness</span>
<span class=n>cross_val_score</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
<span class=c1># Scores: [82%, 84%, 81%, 86%, 83%] ‚Üí Mean: 83.2% ¬± 1.9%</span>
</code></pre></div></p> <p><strong>Why Cross-Validation Matters:</strong> - <strong>Robust estimates:</strong> Averages over multiple splits (reduces variance) - <strong>Detects overfitting:</strong> High train score, low CV score = overfit - <strong>Uses all data:</strong> Every sample used for both training and testing - <strong>Hyperparameter tuning:</strong> GridSearchCV uses CV to select best params</p> <h2 id=cross-validation-strategies>Cross-Validation Strategies</h2> <table> <thead> <tr> <th>Strategy</th> <th>Use Case</th> <th>How it Works</th> <th>Data Leakage Risk</th> </tr> </thead> <tbody> <tr> <td><strong>KFold</strong></td> <td>General (balanced classes)</td> <td>Split into K folds randomly</td> <td>Low</td> </tr> <tr> <td><strong>StratifiedKFold</strong></td> <td><strong>Imbalanced classes</strong></td> <td>Preserves class distribution</td> <td>Low</td> </tr> <tr> <td><strong>GroupKFold</strong></td> <td><strong>Grouped data</strong> (patients, sessions)</td> <td>Keeps groups together</td> <td>Low (if used correctly)</td> </tr> <tr> <td><strong>TimeSeriesSplit</strong></td> <td><strong>Time series</strong> (stock prices, logs)</td> <td>Train on past, test on future</td> <td>High (if shuffled)</td> </tr> <tr> <td><strong>LeaveOneOut</strong></td> <td>Very small datasets (&lt;100 samples)</td> <td>Train on n-1, test on 1</td> <td>Low but expensive</td> </tr> <tr> <td><strong>ShuffleSplit</strong></td> <td>Custom train/test proportions</td> <td>Random sampling with replacement</td> <td>Low</td> </tr> </tbody> </table> <h2 id=production-implementation-180-lines>Production Implementation (180 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># sklearn_cross_validation.py</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
    <span class=n>KFold</span><span class=p>,</span> <span class=n>StratifiedKFold</span><span class=p>,</span> <span class=n>GroupKFold</span><span class=p>,</span> <span class=n>TimeSeriesSplit</span><span class=p>,</span>
    <span class=n>LeaveOneOut</span><span class=p>,</span> <span class=n>ShuffleSplit</span><span class=p>,</span> <span class=n>cross_val_score</span><span class=p>,</span> <span class=n>cross_validate</span>
<span class=p>)</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>accuracy_score</span><span class=p>,</span> <span class=n>f1_score</span><span class=p>,</span> <span class=n>roc_auc_score</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_kfold</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Standard K-Fold (for balanced data)&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. K-FOLD (General Purpose)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Balanced dataset</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>],</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># 5-Fold CV</span>
    <span class=n>kf</span> <span class=o>=</span> <span class=n>KFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scores</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>fold</span><span class=p>,</span> <span class=p>(</span><span class=n>train_idx</span><span class=p>,</span> <span class=n>test_idx</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>kf</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>X</span><span class=p>),</span> <span class=mi>1</span><span class=p>):</span>
        <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=n>train_idx</span><span class=p>],</span> <span class=n>X</span><span class=p>[</span><span class=n>test_idx</span><span class=p>]</span>
        <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>y</span><span class=p>[</span><span class=n>train_idx</span><span class=p>],</span> <span class=n>y</span><span class=p>[</span><span class=n>test_idx</span><span class=p>]</span>

        <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>score</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>scores</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>score</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Fold </span><span class=si>{</span><span class=n>fold</span><span class=si>}</span><span class=s2>: Train=</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>train_idx</span><span class=p>)</span><span class=si>}</span><span class=s2>, Test=</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>test_idx</span><span class=p>)</span><span class=si>}</span><span class=s2>, Acc=</span><span class=si>{</span><span class=n>score</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Mean Accuracy: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>scores</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> ¬± </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>scores</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Use KFold for balanced datasets&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_stratified_kfold</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;StratifiedKFold (for imbalanced classes)&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. STRATIFIED K-FOLD (Imbalanced Classes)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Imbalanced dataset (10% positive class)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>],</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Overall class distribution: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>bincount</span><span class=p>(</span><span class=n>y</span><span class=p>)</span><span class=si>}</span><span class=s2> (10% positive)&quot;</span><span class=p>)</span>

    <span class=c1># Compare KFold vs StratifiedKFold</span>
    <span class=n>kf</span> <span class=o>=</span> <span class=n>KFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>skf</span> <span class=o>=</span> <span class=n>StratifiedKFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚ùå KFold (can create imbalanced folds):&quot;</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>fold</span><span class=p>,</span> <span class=p>(</span><span class=n>train_idx</span><span class=p>,</span> <span class=n>test_idx</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>kf</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>X</span><span class=p>),</span> <span class=mi>1</span><span class=p>):</span>
        <span class=n>test_distribution</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>bincount</span><span class=p>(</span><span class=n>y</span><span class=p>[</span><span class=n>test_idx</span><span class=p>])</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Fold </span><span class=si>{</span><span class=n>fold</span><span class=si>}</span><span class=s2>: Test distribution </span><span class=si>{</span><span class=n>test_distribution</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>test_distribution</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>/</span><span class=nb>len</span><span class=p>(</span><span class=n>test_idx</span><span class=p>)</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.0f</span><span class=si>}</span><span class=s2>% positive)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ StratifiedKFold (preserves class distribution):&quot;</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>fold</span><span class=p>,</span> <span class=p>(</span><span class=n>train_idx</span><span class=p>,</span> <span class=n>test_idx</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>skf</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=mi>1</span><span class=p>):</span>
        <span class=n>test_distribution</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>bincount</span><span class=p>(</span><span class=n>y</span><span class=p>[</span><span class=n>test_idx</span><span class=p>])</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Fold </span><span class=si>{</span><span class=n>fold</span><span class=si>}</span><span class=s2>: Test distribution </span><span class=si>{</span><span class=n>test_distribution</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>test_distribution</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>/</span><span class=nb>len</span><span class=p>(</span><span class=n>test_idx</span><span class=p>)</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.0f</span><span class=si>}</span><span class=s2>% positive)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Always use StratifiedKFold for imbalanced data!&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_group_kfold</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;GroupKFold (for grouped/clustered data)&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. GROUP K-FOLD (Grouped Data - Patients, Sessions)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Example: Medical data with multiple measurements per patient</span>
    <span class=n>n_patients</span> <span class=o>=</span> <span class=mi>20</span>
    <span class=n>measurements_per_patient</span> <span class=o>=</span> <span class=mi>5</span>

    <span class=n>patients</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>repeat</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>n_patients</span><span class=p>),</span> <span class=n>measurements_per_patient</span><span class=p>)</span>
    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>patients</span><span class=p>),</span> <span class=mi>10</span><span class=p>)</span>
    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>patients</span><span class=p>))</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total samples: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>X</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Number of patients: </span><span class=si>{</span><span class=n>n_patients</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Measurements per patient: </span><span class=si>{</span><span class=n>measurements_per_patient</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># ‚ùå WRONG: KFold can split same patient across train/test (DATA LEAKAGE!)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚ùå KFold (DATA LEAKAGE - same patient in train &amp; test):&quot;</span><span class=p>)</span>
    <span class=n>kf</span> <span class=o>=</span> <span class=n>KFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>fold</span><span class=p>,</span> <span class=p>(</span><span class=n>train_idx</span><span class=p>,</span> <span class=n>test_idx</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>kf</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>X</span><span class=p>),</span> <span class=mi>1</span><span class=p>):</span>
        <span class=n>train_patients</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>patients</span><span class=p>[</span><span class=n>train_idx</span><span class=p>])</span>
        <span class=n>test_patients</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>patients</span><span class=p>[</span><span class=n>test_idx</span><span class=p>])</span>
        <span class=n>overlap</span> <span class=o>=</span> <span class=n>train_patients</span> <span class=o>&amp;</span> <span class=n>test_patients</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Fold </span><span class=si>{</span><span class=n>fold</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>overlap</span><span class=p>)</span><span class=si>}</span><span class=s2> patients in BOTH train and test ‚ùå&quot;</span><span class=p>)</span>

    <span class=c1># ‚úÖ CORRECT: GroupKFold ensures patient in either train OR test (not both)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ GroupKFold (NO LEAKAGE - patients separated):&quot;</span><span class=p>)</span>
    <span class=n>gkf</span> <span class=o>=</span> <span class=n>GroupKFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>fold</span><span class=p>,</span> <span class=p>(</span><span class=n>train_idx</span><span class=p>,</span> <span class=n>test_idx</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>gkf</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>groups</span><span class=o>=</span><span class=n>patients</span><span class=p>),</span> <span class=mi>1</span><span class=p>):</span>
        <span class=n>train_patients</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>patients</span><span class=p>[</span><span class=n>train_idx</span><span class=p>])</span>
        <span class=n>test_patients</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>patients</span><span class=p>[</span><span class=n>test_idx</span><span class=p>])</span>
        <span class=n>overlap</span> <span class=o>=</span> <span class=n>train_patients</span> <span class=o>&amp;</span> <span class=n>test_patients</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Fold </span><span class=si>{</span><span class=n>fold</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>overlap</span><span class=p>)</span><span class=si>}</span><span class=s2> patients overlap (should be 0) ‚úÖ&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Use GroupKFold for patient data, user sessions, etc.&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_timeseries_split</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;TimeSeriesSplit (for time-ordered data)&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. TIME SERIES SPLIT (Temporal Data)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Time series data (e.g., stock prices)</span>
    <span class=n>dates</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2020-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>)</span>
    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
    <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Time series: 100 days of data&quot;</span><span class=p>)</span>

    <span class=c1># ‚úÖ TimeSeriesSplit: Always train on past, test on future</span>
    <span class=n>tscv</span> <span class=o>=</span> <span class=n>TimeSeriesSplit</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ TimeSeriesSplit (train on past, test on future):&quot;</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>fold</span><span class=p>,</span> <span class=p>(</span><span class=n>train_idx</span><span class=p>,</span> <span class=n>test_idx</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>tscv</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>X</span><span class=p>),</span> <span class=mi>1</span><span class=p>):</span>
        <span class=n>train_dates</span> <span class=o>=</span> <span class=n>dates</span><span class=p>[</span><span class=n>train_idx</span><span class=p>]</span>
        <span class=n>test_dates</span> <span class=o>=</span> <span class=n>dates</span><span class=p>[</span><span class=n>test_idx</span><span class=p>]</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Fold </span><span class=si>{</span><span class=n>fold</span><span class=si>}</span><span class=s2>: Train </span><span class=si>{</span><span class=n>train_dates</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>date</span><span class=p>()</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>train_dates</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>date</span><span class=p>()</span><span class=si>}</span><span class=s2>, &quot;</span>
              <span class=sa>f</span><span class=s2>&quot;Test </span><span class=si>{</span><span class=n>test_dates</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>date</span><span class=p>()</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>test_dates</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>date</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚ùå NEVER shuffle time series data (breaks temporal order)!&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Use TimeSeriesSplit for stock prices, logs, sensor data&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_cross_val_score</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Using cross_val_score (convenient wrapper)&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. CROSS_VAL_SCORE (Convenient API)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>200</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Simple usage</span>
    <span class=n>scores</span> <span class=o>=</span> <span class=n>cross_val_score</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;accuracy&#39;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;5-Fold CV Accuracy: </span><span class=si>{</span><span class=n>scores</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Mean: </span><span class=si>{</span><span class=n>scores</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> ¬± </span><span class=si>{</span><span class=n>scores</span><span class=o>.</span><span class=n>std</span><span class=p>()</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Multiple metrics with cross_validate</span>
    <span class=n>scoring</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;accuracy&#39;</span><span class=p>,</span> <span class=s1>&#39;precision&#39;</span><span class=p>,</span> <span class=s1>&#39;recall&#39;</span><span class=p>,</span> <span class=s1>&#39;f1&#39;</span><span class=p>,</span> <span class=s1>&#39;roc_auc&#39;</span><span class=p>]</span>
    <span class=n>results</span> <span class=o>=</span> <span class=n>cross_validate</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=n>scoring</span><span class=p>,</span> <span class=n>return_train_score</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Multiple metrics:&quot;</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>metric</span> <span class=ow>in</span> <span class=n>scoring</span><span class=p>:</span>
        <span class=n>test_scores</span> <span class=o>=</span> <span class=n>results</span><span class=p>[</span><span class=sa>f</span><span class=s1>&#39;test_</span><span class=si>{</span><span class=n>metric</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>]</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>metric</span><span class=si>:</span><span class=s2>12s</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>test_scores</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> ¬± </span><span class=si>{</span><span class=n>test_scores</span><span class=o>.</span><span class=n>std</span><span class=p>()</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Training vs Test scores (detect overfitting):&quot;</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>metric</span> <span class=ow>in</span> <span class=n>scoring</span><span class=p>:</span>
        <span class=n>train_mean</span> <span class=o>=</span> <span class=n>results</span><span class=p>[</span><span class=sa>f</span><span class=s1>&#39;train_</span><span class=si>{</span><span class=n>metric</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
        <span class=n>test_mean</span> <span class=o>=</span> <span class=n>results</span><span class=p>[</span><span class=sa>f</span><span class=s1>&#39;test_</span><span class=si>{</span><span class=n>metric</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
        <span class=n>gap</span> <span class=o>=</span> <span class=n>train_mean</span> <span class=o>-</span> <span class=n>test_mean</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>metric</span><span class=si>:</span><span class=s2>12s</span><span class=si>}</span><span class=s2>: Train=</span><span class=si>{</span><span class=n>train_mean</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, Test=</span><span class=si>{</span><span class=n>test_mean</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>, Gap=</span><span class=si>{</span><span class=n>gap</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_nested_cv</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Nested CV for unbiased hyperparameter tuning&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;6. NESTED CV (Unbiased Hyperparameter Tuning)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>GridSearchCV</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>200</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Inner loop: hyperparameter tuning</span>
    <span class=n>param_grid</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;n_estimators&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span> <span class=s1>&#39;max_depth&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>]}</span>
    <span class=n>inner_cv</span> <span class=o>=</span> <span class=n>StratifiedKFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>model</span> <span class=o>=</span> <span class=n>GridSearchCV</span><span class=p>(</span>
        <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>),</span>
        <span class=n>param_grid</span><span class=p>,</span>
        <span class=n>cv</span><span class=o>=</span><span class=n>inner_cv</span><span class=p>,</span>
        <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;accuracy&#39;</span>
    <span class=p>)</span>

    <span class=c1># Outer loop: performance estimation</span>
    <span class=n>outer_cv</span> <span class=o>=</span> <span class=n>StratifiedKFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>scores</span> <span class=o>=</span> <span class=n>cross_val_score</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=n>outer_cv</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;accuracy&#39;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Nested CV scores: </span><span class=si>{</span><span class=n>scores</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Mean: </span><span class=si>{</span><span class=n>scores</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> ¬± </span><span class=si>{</span><span class=n>scores</span><span class=o>.</span><span class=n>std</span><span class=p>()</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Nested CV gives unbiased performance estimate&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;   (Inner CV tunes params, Outer CV evaluates)&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_kfold</span><span class=p>()</span>
    <span class=n>demo_stratified_kfold</span><span class=p>()</span>
    <span class=n>demo_group_kfold</span><span class=p>()</span>
    <span class=n>demo_timeseries_split</span><span class=p>()</span>
    <span class=n>demo_cross_val_score</span><span class=p>()</span>
    <span class=n>demo_nested_cv</span><span class=p>()</span>
</code></pre></div> <p><strong>Sample Output:</strong> <div class=highlight><pre><span></span><code>======================================================================
2. STRATIFIED K-FOLD (Imbalanced Classes)
======================================================================
Overall class distribution: [90 10] (10% positive)

‚ùå KFold (can create imbalanced folds):
  Fold 1: Test distribution [19  1] (5% positive)
  Fold 2: Test distribution [17  3] (15% positive)

‚úÖ StratifiedKFold (preserves class distribution):
  Fold 1: Test distribution [18  2] (10% positive)
  Fold 2: Test distribution [18  2] (10% positive)

‚úÖ Always use StratifiedKFold for imbalanced data!
</code></pre></div></p> <h2 id=choosing-the-right-cv-strategy>Choosing the Right CV Strategy</h2> <table> <thead> <tr> <th>Data Type</th> <th>Use This CV</th> <th>Why</th> </tr> </thead> <tbody> <tr> <td><strong>Balanced classes</strong></td> <td>KFold</td> <td>Simple, works well</td> </tr> <tr> <td><strong>Imbalanced classes</strong></td> <td><strong>StratifiedKFold</strong></td> <td>Preserves class distribution</td> </tr> <tr> <td><strong>Grouped data</strong> (patients, users)</td> <td><strong>GroupKFold</strong></td> <td>Prevents data leakage</td> </tr> <tr> <td><strong>Time series</strong> (stocks, logs)</td> <td><strong>TimeSeriesSplit</strong></td> <td>Respects temporal order</td> </tr> <tr> <td><strong>Very small dataset</strong> (&lt;100)</td> <td>LeaveOneOut</td> <td>Maximum training data per fold</td> </tr> <tr> <td><strong>Custom splits</strong></td> <td>ShuffleSplit</td> <td>Flexible train/test ratios</td> </tr> </tbody> </table> <h2 id=common-data-leakage-scenarios>Common Data Leakage Scenarios</h2> <p><strong>Scenario 1: Grouped Data (Patients)</strong> <div class=highlight><pre><span></span><code><span class=c1># ‚ùå WRONG: Patient measurements split across train/test</span>
<span class=n>KFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>  <span class=c1># Patient #3 in both train and test!</span>

<span class=c1># ‚úÖ CORRECT: Each patient entirely in train OR test</span>
<span class=n>GroupKFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>groups</span><span class=o>=</span><span class=n>patient_ids</span><span class=p>)</span>
</code></pre></div></p> <p><strong>Scenario 2: Time Series</strong> <div class=highlight><pre><span></span><code><span class=c1># ‚ùå WRONG: Testing on past data (shuffle=True)</span>
<span class=n>KFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>  <span class=c1># Future leaks into past!</span>

<span class=c1># ‚úÖ CORRECT: Always test on future</span>
<span class=n>TimeSeriesSplit</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
</code></pre></div></p> <p><strong>Scenario 3: Preprocessing</strong> <div class=highlight><pre><span></span><code><span class=c1># ‚ùå WRONG: Fit scaler on ALL data before CV</span>
<span class=n>X_scaled</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>  <span class=c1># Test data leakage!</span>
<span class=n>cross_val_score</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>X_scaled</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>

<span class=c1># ‚úÖ CORRECT: Fit scaler inside CV loop (use Pipeline!)</span>
<span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span> <span class=p>(</span><span class=s1>&#39;model&#39;</span><span class=p>,</span> <span class=n>model</span><span class=p>)])</span>
<span class=n>cross_val_score</span><span class=p>(</span><span class=n>pipeline</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</code></pre></div></p> <h2 id=real-world-applications_1>Real-World Applications</h2> <p><strong>Kaggle Competitions:</strong> - <strong>Standard:</strong> 5-10 fold StratifiedKFold for reliable leaderboard scores - <strong>Time series:</strong> TimeSeriesSplit for temporal data (e.g., sales forecasting) - <strong>Grouped:</strong> GroupKFold for hierarchical data (e.g., store-level predictions)</p> <p><strong>Netflix (A/B Testing):</strong> - <strong>Challenge:</strong> Users in test set mustn't be in training - <strong>Solution:</strong> GroupKFold with user_id as groups - <strong>Impact:</strong> Prevents overoptimistic metrics (user leakage = 10-20% inflated accuracy)</p> <p><strong>Medical ML (Clinical Trials):</strong> - <strong>Challenge:</strong> Multiple measurements per patient - <strong>Solution:</strong> GroupKFold with patient_id - <strong>Regulation:</strong> FDA requires this to prevent data leakage in submissions</p> <h2 id=common-pitfalls-solutions_2>Common Pitfalls &amp; Solutions</h2> <table> <thead> <tr> <th>Pitfall</th> <th>Impact</th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td><strong>Using accuracy for imbalanced data</strong></td> <td>Misleading (99% accuracy if 99% class 0)</td> <td>Use F1, precision, recall, ROC-AUC</td> </tr> <tr> <td><strong>Not using StratifiedKFold for imbalanced</strong></td> <td>Some folds have no positive class!</td> <td>Always use StratifiedKFold for classification</td> </tr> <tr> <td><strong>Shuffling time series</strong></td> <td>Future leaks into past (overoptimistic)</td> <td>Use TimeSeriesSplit, never shuffle=True</td> </tr> <tr> <td><strong>Ignoring groups (patients, sessions)</strong></td> <td>Data leakage (same entity in train/test)</td> <td>Use GroupKFold with group identifiers</td> </tr> <tr> <td><strong>Fitting preprocessor before CV</strong></td> <td>Test data influences training (leakage)</td> <td>Use Pipeline - fit inside CV loop</td> </tr> <tr> <td><strong>Using too few folds (k=2)</strong></td> <td>High variance in estimates</td> <td>Use k=5 or k=10 (standard)</td> </tr> <tr> <td><strong>Using too many folds (k=n)</strong></td> <td>Computationally expensive</td> <td>LeaveOneOut only for n&lt;100</td> </tr> </tbody> </table> <h2 id=nested-cv-for-hyperparameter-tuning>Nested CV for Hyperparameter Tuning</h2> <p><strong>Why Nested CV?</strong> - <strong>Inner CV:</strong> Selects best hyperparameters - <strong>Outer CV:</strong> Estimates performance of tuning procedure - <strong>Result:</strong> Unbiased performance estimate</p> <div class=highlight><pre><span></span><code><span class=c1># Nested CV structure</span>
<span class=k>for</span> <span class=n>outer_train</span><span class=p>,</span> <span class=n>outer_test</span> <span class=ow>in</span> <span class=n>OuterCV</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
    <span class=c1># Inner CV: tune hyperparameters on outer_train</span>
    <span class=n>grid_search</span> <span class=o>=</span> <span class=n>GridSearchCV</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=n>InnerCV</span><span class=p>)</span>
    <span class=n>grid_search</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>outer_train</span><span class=p>],</span> <span class=n>y</span><span class=p>[</span><span class=n>outer_train</span><span class=p>])</span>

    <span class=c1># Evaluate best model on outer_test</span>
    <span class=n>score</span> <span class=o>=</span> <span class=n>grid_search</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>outer_test</span><span class=p>],</span> <span class=n>y</span><span class=p>[</span><span class=n>outer_test</span><span class=p>])</span>
</code></pre></div> <p><strong>Performance:</strong> - Single CV: Optimistic (hyperparams tuned on same data used for evaluation) - Nested CV: Unbiased (hyperparams tuned on separate data)</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>Strong candidates:</strong></p> <ul> <li>Choose correct CV: "StratifiedKFold for imbalanced (preserves 90:10 ratio); GroupKFold for patients (prevents leakage); TimeSeriesSplit for stocks (train on past)"</li> <li>Understand data leakage: "GroupKFold ensures patient #3 entirely in train OR test, never both - KFold would leak patient measurements"</li> <li>Know preprocessing: "Fit scaler INSIDE CV loop using Pipeline - fitting on all data before CV causes test leakage"</li> <li>Reference real systems: "Netflix uses GroupKFold with user_id (prevents user leakage); Medical ML requires this for FDA submissions"</li> <li>Discuss metrics: "Never use accuracy for imbalanced data - StratifiedKFold + F1/ROC-AUC instead"</li> <li>Know nested CV: "Inner CV tunes params, Outer CV evaluates - prevents optimistic bias from tuning on test data"</li> </ul> </div> </details> <hr> <h3 id=how-to-handle-class-imbalance-google-amazon-interview-question>How to Handle Class Imbalance? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Imbalanced Data</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <h2 id=what-is-class-imbalance>What is Class Imbalance?</h2> <p><strong>Class imbalance</strong> occurs when one class vastly outnumbers another (e.g., 99% negative, 1% positive). Standard metrics and algorithms perform poorly because they optimize for the majority class.</p> <p><strong>The Problem:</strong> <div class=highlight><pre><span></span><code><span class=c1># 99% class 0, 1% class 1</span>
<span class=n>y</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>*</span><span class=mi>990</span> <span class=o>+</span> <span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=mi>10</span>  <span class=c1># 1000 samples</span>

<span class=c1># ‚ùå Naive classifier: Always predict 0</span>
<span class=n>predictions</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>1000</span>
<span class=n>accuracy</span> <span class=o>=</span> <span class=mi>99</span><span class=o>%</span>  <span class=c1># Looks great but useless! Missed all positive cases.</span>
</code></pre></div></p> <p><strong>Real-World Examples:</strong> - <strong>Fraud detection:</strong> 0.1% fraudulent transactions - <strong>Medical diagnosis:</strong> 1-5% disease prevalence - <strong>Click prediction:</strong> 2-5% CTR - <strong>Churn prediction:</strong> 5-10% churn rate - <strong>Spam detection:</strong> 10-20% spam emails</p> <h2 id=techniques-to-handle-imbalance>Techniques to Handle Imbalance</h2> <table> <thead> <tr> <th>Technique</th> <th>Approach</th> <th>Pros</th> <th>Cons</th> <th>When to Use</th> </tr> </thead> <tbody> <tr> <td><strong>Class Weights</strong></td> <td>Penalize misclassifying minority</td> <td>Simple, no data change</td> <td>May overfit minority</td> <td>First try</td> </tr> <tr> <td><strong>SMOTE</strong></td> <td>Synthetic oversampling</td> <td>Creates realistic samples</td> <td>Can create noise</td> <td>Good for moderate imbalance</td> </tr> <tr> <td><strong>Random Undersampling</strong></td> <td>Remove majority samples</td> <td>Fast, balanced</td> <td>Loses information</td> <td>Huge datasets only</td> </tr> <tr> <td><strong>Ensemble (BalancedRF)</strong></td> <td>Bootstrap with balanced samples</td> <td>Works well</td> <td>Slower training</td> <td>Tree-based models</td> </tr> <tr> <td><strong>Threshold Adjustment</strong></td> <td>Tune decision threshold</td> <td>Post-training fix</td> <td>Doesn't change model</td> <td>After training</td> </tr> </tbody> </table> <h2 id=production-implementation-190-lines>Production Implementation (190 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># class_imbalance.py</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>cross_val_score</span><span class=p>,</span> <span class=n>StratifiedKFold</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LogisticRegression</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
    <span class=n>accuracy_score</span><span class=p>,</span> <span class=n>precision_score</span><span class=p>,</span> <span class=n>recall_score</span><span class=p>,</span> <span class=n>f1_score</span><span class=p>,</span>
    <span class=n>roc_auc_score</span><span class=p>,</span> <span class=n>classification_report</span><span class=p>,</span> <span class=n>confusion_matrix</span><span class=p>,</span>
    <span class=n>precision_recall_curve</span><span class=p>,</span> <span class=n>roc_curve</span>
<span class=p>)</span>
<span class=kn>from</span><span class=w> </span><span class=nn>imblearn.over_sampling</span><span class=w> </span><span class=kn>import</span> <span class=n>SMOTE</span><span class=p>,</span> <span class=n>ADASYN</span><span class=p>,</span> <span class=n>BorderlineSMOTE</span>
<span class=kn>from</span><span class=w> </span><span class=nn>imblearn.under_sampling</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomUnderSampler</span><span class=p>,</span> <span class=n>TomekLinks</span>
<span class=kn>from</span><span class=w> </span><span class=nn>imblearn.combine</span><span class=w> </span><span class=kn>import</span> <span class=n>SMOTETomek</span>
<span class=kn>from</span><span class=w> </span><span class=nn>collections</span><span class=w> </span><span class=kn>import</span> <span class=n>Counter</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_class_weights</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Technique 1: Class Weights (Simplest)&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. CLASS WEIGHTS (Penalize Misclassifying Minority)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Imbalanced dataset (5% positive)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
        <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.95</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>],</span>  <span class=c1># 95% class 0, 5% class 1</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Class distribution: </span><span class=si>{</span><span class=n>Counter</span><span class=p>(</span><span class=n>y_train</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Imbalance ratio: </span><span class=si>{</span><span class=n>Counter</span><span class=p>(</span><span class=n>y_train</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>Counter</span><span class=p>(</span><span class=n>y_train</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>:1&quot;</span><span class=p>)</span>

    <span class=c1># ‚ùå Without class weights</span>
    <span class=n>model_default</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>model_default</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=n>y_pred_default</span> <span class=o>=</span> <span class=n>model_default</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚ùå WITHOUT class_weight:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Accuracy: </span><span class=si>{</span><span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred_default</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Recall (minority): </span><span class=si>{</span><span class=n>recall_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred_default</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  F1: </span><span class=si>{</span><span class=n>f1_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred_default</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># ‚úÖ With class weights</span>
    <span class=n>model_balanced</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span>
        <span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
        <span class=n>class_weight</span><span class=o>=</span><span class=s1>&#39;balanced&#39;</span><span class=p>,</span>  <span class=c1># Automatically compute weights</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>
    <span class=n>model_balanced</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=n>y_pred_balanced</span> <span class=o>=</span> <span class=n>model_balanced</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ WITH class_weight=&#39;balanced&#39;:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Accuracy: </span><span class=si>{</span><span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred_balanced</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Recall (minority): </span><span class=si>{</span><span class=n>recall_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred_balanced</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  F1: </span><span class=si>{</span><span class=n>f1_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred_balanced</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Class weights improved minority recall!&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_smote</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Technique 2: SMOTE (Synthetic Minority Oversampling)&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. SMOTE (Create Synthetic Minority Samples)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Imbalanced dataset</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
        <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>],</span>  <span class=c1># 90% class 0, 10% class 1</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Original distribution: </span><span class=si>{</span><span class=n>Counter</span><span class=p>(</span><span class=n>y</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Apply SMOTE</span>
    <span class=n>smote</span> <span class=o>=</span> <span class=n>SMOTE</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X_resampled</span><span class=p>,</span> <span class=n>y_resampled</span> <span class=o>=</span> <span class=n>smote</span><span class=o>.</span><span class=n>fit_resample</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;After SMOTE: </span><span class=si>{</span><span class=n>Counter</span><span class=p>(</span><span class=n>y_resampled</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;‚úÖ SMOTE created </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>y_resampled</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)</span><span class=si>}</span><span class=s2> synthetic samples&quot;</span><span class=p>)</span>

    <span class=c1># Train on resampled data</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X_train_smote</span><span class=p>,</span> <span class=n>y_train_smote</span> <span class=o>=</span> <span class=n>smote</span><span class=o>.</span><span class=n>fit_resample</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_smote</span><span class=p>,</span> <span class=n>y_train_smote</span><span class=p>)</span>

    <span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Performance after SMOTE:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Recall (minority): </span><span class=si>{</span><span class=n>recall_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  F1: </span><span class=si>{</span><span class=n>f1_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ROC-AUC: </span><span class=si>{</span><span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>model</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span><span class=mi>1</span><span class=p>])</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_smote_variants</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;SMOTE Variants: BorderlineSMOTE, ADASYN&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. SMOTE VARIANTS (Smarter Synthetic Sampling)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>],</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Compare SMOTE variants</span>
    <span class=n>techniques</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;Original (Imbalanced)&#39;</span><span class=p>:</span> <span class=kc>None</span><span class=p>,</span>
        <span class=s1>&#39;SMOTE&#39;</span><span class=p>:</span> <span class=n>SMOTE</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>),</span>
        <span class=s1>&#39;BorderlineSMOTE&#39;</span><span class=p>:</span> <span class=n>BorderlineSMOTE</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>),</span>
        <span class=s1>&#39;ADASYN&#39;</span><span class=p>:</span> <span class=n>ADASYN</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=p>}</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Technique&#39;</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Recall&#39;</span><span class=si>:</span><span class=s2>&gt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;F1&#39;</span><span class=si>:</span><span class=s2>&gt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;ROC-AUC&#39;</span><span class=si>:</span><span class=s2>&gt;8</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>sampler</span> <span class=ow>in</span> <span class=n>techniques</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=k>if</span> <span class=n>sampler</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>X_t</span><span class=p>,</span> <span class=n>y_t</span> <span class=o>=</span> <span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>X_t</span><span class=p>,</span> <span class=n>y_t</span> <span class=o>=</span> <span class=n>sampler</span><span class=o>.</span><span class=n>fit_resample</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_t</span><span class=p>,</span> <span class=n>y_t</span><span class=p>)</span>

        <span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
        <span class=n>y_proba</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span><span class=mi>1</span><span class=p>]</span>

        <span class=n>recall</span> <span class=o>=</span> <span class=n>recall_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
        <span class=n>f1</span> <span class=o>=</span> <span class=n>f1_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
        <span class=n>auc</span> <span class=o>=</span> <span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_proba</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>recall</span><span class=si>:</span><span class=s2>&gt;8.3f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>f1</span><span class=si>:</span><span class=s2>&gt;8.3f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>auc</span><span class=si>:</span><span class=s2>&gt;8.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ BorderlineSMOTE focuses on boundary samples (often best)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_undersampling</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Technique 3: Random Undersampling&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. UNDERSAMPLING (Remove Majority Samples)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>10000</span><span class=p>,</span>  <span class=c1># Large dataset</span>
        <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.95</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>],</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span>
    <span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Original: </span><span class=si>{</span><span class=n>Counter</span><span class=p>(</span><span class=n>y</span><span class=p>)</span><span class=si>}</span><span class=s2> (large dataset)&quot;</span><span class=p>)</span>

    <span class=c1># Random undersampling</span>
    <span class=n>undersampler</span> <span class=o>=</span> <span class=n>RandomUnderSampler</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X_resampled</span><span class=p>,</span> <span class=n>y_resampled</span> <span class=o>=</span> <span class=n>undersampler</span><span class=o>.</span><span class=n>fit_resample</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;After undersampling: </span><span class=si>{</span><span class=n>Counter</span><span class=p>(</span><span class=n>y_resampled</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;‚úÖ Removed </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=n>y_resampled</span><span class=p>)</span><span class=si>}</span><span class=s2> majority samples&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;‚ö†Ô∏è  Lost </span><span class=si>{</span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=n>y_resampled</span><span class=p>)</span><span class=o>/</span><span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>))</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>% of data&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Use undersampling ONLY for very large datasets (millions)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚ùå Don&#39;t use for small datasets (loses too much information)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_combined_sampling</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Technique 4: Combined SMOTE + Tomek Links&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. COMBINED SAMPLING (SMOTE + Tomek Links)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>],</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Original: </span><span class=si>{</span><span class=n>Counter</span><span class=p>(</span><span class=n>y</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># SMOTETomek: Oversample with SMOTE, then clean with Tomek Links</span>
    <span class=n>smt</span> <span class=o>=</span> <span class=n>SMOTETomek</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X_resampled</span><span class=p>,</span> <span class=n>y_resampled</span> <span class=o>=</span> <span class=n>smt</span><span class=o>.</span><span class=n>fit_resample</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;After SMOTETomek: </span><span class=si>{</span><span class=n>Counter</span><span class=p>(</span><span class=n>y_resampled</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ SMOTE creates synthetic samples, Tomek removes noisy borderline samples&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_threshold_tuning</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Technique 5: Threshold Adjustment&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;6. THRESHOLD TUNING (Post-Training Adjustment)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>],</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Train model</span>
    <span class=n>model</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>max_iter</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># Get probabilities</span>
    <span class=n>y_proba</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span><span class=mi>1</span><span class=p>]</span>

    <span class=c1># Try different thresholds</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Threshold&#39;</span><span class=si>:</span><span class=s2>&gt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Precision&#39;</span><span class=si>:</span><span class=s2>&gt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Recall&#39;</span><span class=si>:</span><span class=s2>&gt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;F1&#39;</span><span class=si>:</span><span class=s2>&gt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>threshold</span> <span class=ow>in</span> <span class=p>[</span><span class=mf>0.3</span><span class=p>,</span> <span class=mf>0.4</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.6</span><span class=p>,</span> <span class=mf>0.7</span><span class=p>]:</span>
        <span class=n>y_pred</span> <span class=o>=</span> <span class=p>(</span><span class=n>y_proba</span> <span class=o>&gt;=</span> <span class=n>threshold</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>

        <span class=n>precision</span> <span class=o>=</span> <span class=n>precision_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
        <span class=n>recall</span> <span class=o>=</span> <span class=n>recall_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
        <span class=n>f1</span> <span class=o>=</span> <span class=n>f1_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>threshold</span><span class=si>:</span><span class=s2>&gt;10.1f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>precision</span><span class=si>:</span><span class=s2>&gt;10.3f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>recall</span><span class=si>:</span><span class=s2>&gt;10.3f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>f1</span><span class=si>:</span><span class=s2>&gt;10.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Lower threshold ‚Üí Higher recall (catch more positives)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Higher threshold ‚Üí Higher precision (fewer false positives)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_metrics</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Proper Metrics for Imbalanced Data&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;7. PROPER METRICS (Not Accuracy!)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.95</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>],</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>class_weight</span><span class=o>=</span><span class=s1>&#39;balanced&#39;</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
    <span class=n>y_proba</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span><span class=mi>1</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Use these metrics for imbalanced data:</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Precision: </span><span class=si>{</span><span class=n>precision_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ‚Üí Of predicted positives, % actually positive&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Recall (Sensitivity): </span><span class=si>{</span><span class=n>recall_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ‚Üí Of actual positives, % correctly identified&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>F1 Score: </span><span class=si>{</span><span class=n>f1_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ‚Üí Harmonic mean of precision &amp; recall&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>ROC-AUC: </span><span class=si>{</span><span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_proba</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ‚Üí Area under ROC curve (threshold-independent)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚ùå Accuracy: </span><span class=si>{</span><span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred</span><span class=p>)</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ‚Üí Misleading for imbalanced data!&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=n>classification_report</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>target_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Class 0&#39;</span><span class=p>,</span> <span class=s1>&#39;Class 1&#39;</span><span class=p>]))</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_class_weights</span><span class=p>()</span>
    <span class=n>demo_smote</span><span class=p>()</span>
    <span class=n>demo_smote_variants</span><span class=p>()</span>
    <span class=n>demo_undersampling</span><span class=p>()</span>
    <span class=n>demo_combined_sampling</span><span class=p>()</span>
    <span class=n>demo_threshold_tuning</span><span class=p>()</span>
    <span class=n>demo_metrics</span><span class=p>()</span>
</code></pre></div> <p><strong>Sample Output:</strong> <div class=highlight><pre><span></span><code>======================================================================
1. CLASS WEIGHTS (Penalize Misclassifying Minority)
======================================================================
Class distribution: Counter({0: 760, 1: 40})
Imbalance ratio: 19.0:1

‚ùå WITHOUT class_weight:
  Accuracy: 0.960
  Recall (minority): 0.250  ‚Üê Missed 75% of positives!
  F1: 0.333

‚úÖ WITH class_weight=&#39;balanced&#39;:
  Accuracy: 0.940
  Recall (minority): 0.750  ‚Üê Found 75% of positives!
  F1: 0.600

‚úÖ Class weights improved minority recall!
</code></pre></div></p> <h2 id=when-to-use-each-technique>When to Use Each Technique</h2> <table> <thead> <tr> <th>Imbalance Ratio</th> <th>Dataset Size</th> <th>Best Technique</th> <th>Why</th> </tr> </thead> <tbody> <tr> <td><strong>2:1 to 5:1</strong></td> <td>Any</td> <td>Class weights</td> <td>Mild imbalance, weights sufficient</td> </tr> <tr> <td><strong>5:1 to 20:1</strong></td> <td>Small (&lt;10K)</td> <td>SMOTE + class weights</td> <td>Moderate imbalance</td> </tr> <tr> <td><strong>5:1 to 20:1</strong></td> <td>Large (&gt;100K)</td> <td>Class weights or undersampling</td> <td>Enough data to undersample</td> </tr> <tr> <td><strong>&gt;20:1</strong></td> <td>Any</td> <td>SMOTE variants + ensemble</td> <td>Severe imbalance</td> </tr> <tr> <td><strong>&gt;100:1</strong></td> <td>Large</td> <td>Anomaly detection</td> <td>Extreme imbalance</td> </tr> </tbody> </table> <h2 id=real-world-applications_2>Real-World Applications</h2> <p><strong>Stripe (Fraud Detection - 0.1% fraud rate):</strong> - <strong>Technique:</strong> SMOTE + XGBoost with class weights - <strong>Metric:</strong> Precision-Recall AUC (not ROC-AUC) - <strong>Result:</strong> 90% fraud recall with 5% false positive rate - <strong>Impact:</strong> Saved $100M+ annually</p> <p><strong>Healthcare (Disease Diagnosis - 2% prevalence):</strong> - <strong>Technique:</strong> BorderlineSMOTE + StratifiedKFold - <strong>Metric:</strong> Recall (minimize false negatives) - <strong>Requirement:</strong> 95%+ recall (catch all cases) - <strong>Regulation:</strong> FDA requires imbalance-aware evaluation</p> <p><strong>Google Ads (Click Prediction - 3% CTR):</strong> - <strong>Technique:</strong> Class weights + calibrated probabilities - <strong>Scale:</strong> Billions of impressions/day - <strong>Metric:</strong> Log loss (calibrated probabilities matter) - <strong>Impact:</strong> 10% improvement ‚Üí $1B+ revenue</p> <h2 id=common-pitfalls-solutions_3>Common Pitfalls &amp; Solutions</h2> <table> <thead> <tr> <th>Pitfall</th> <th>Impact</th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td><strong>Using accuracy</strong></td> <td>99% accuracy by predicting majority class</td> <td>Use F1, precision, recall, ROC-AUC</td> </tr> <tr> <td><strong>SMOTE on test data</strong></td> <td>Data leakage, overoptimistic metrics</td> <td>Only apply SMOTE to training data</td> </tr> <tr> <td><strong>Oversampling before CV</strong></td> <td>Test data leaks into training folds</td> <td>Use Pipeline or imblearn.pipeline</td> </tr> <tr> <td><strong>Wrong metric optimization</strong></td> <td>Optimize accuracy instead of F1</td> <td>Use scoring='f1' in GridSearchCV</td> </tr> <tr> <td><strong>Too much oversampling</strong></td> <td>Model memorizes synthetic samples</td> <td>Limit SMOTE to 50% or use BorderlineSMOTE</td> </tr> <tr> <td><strong>Ignoring probability calibration</strong></td> <td>Probabilities not meaningful</td> <td>Use CalibratedClassifierCV after training</td> </tr> </tbody> </table> <h2 id=smote-pipeline-preventing-data-leakage>SMOTE Pipeline (Preventing Data Leakage)</h2> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>imblearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span> <span class=k>as</span> <span class=n>ImbPipeline</span>
<span class=kn>from</span><span class=w> </span><span class=nn>imblearn.over_sampling</span><span class=w> </span><span class=kn>import</span> <span class=n>SMOTE</span>

<span class=c1># ‚úÖ CORRECT: SMOTE inside pipeline</span>
<span class=n>pipeline</span> <span class=o>=</span> <span class=n>ImbPipeline</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;smote&#39;</span><span class=p>,</span> <span class=n>SMOTE</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)),</span>
    <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>
    <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>())</span>
<span class=p>])</span>

<span class=c1># Cross-validation applies SMOTE separately to each fold</span>
<span class=n>cross_val_score</span><span class=p>(</span><span class=n>pipeline</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;f1&#39;</span><span class=p>)</span>

<span class=c1># ‚ùå WRONG: SMOTE before CV (data leakage!)</span>
<span class=n>X_resampled</span><span class=p>,</span> <span class=n>y_resampled</span> <span class=o>=</span> <span class=n>SMOTE</span><span class=p>()</span><span class=o>.</span><span class=n>fit_resample</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<span class=n>cross_val_score</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>X_resampled</span><span class=p>,</span> <span class=n>y_resampled</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</code></pre></div> <h2 id=choosing-the-right-metric>Choosing the Right Metric</h2> <table> <thead> <tr> <th>Business Goal</th> <th>Metric</th> <th>Why</th> </tr> </thead> <tbody> <tr> <td><strong>Minimize false negatives</strong> (disease, fraud)</td> <td><strong>Recall</strong></td> <td>Can't miss positive cases</td> </tr> <tr> <td><strong>Minimize false positives</strong> (spam, alerts)</td> <td><strong>Precision</strong></td> <td>Avoid annoying users</td> </tr> <tr> <td><strong>Balance both</strong></td> <td><strong>F1 Score</strong></td> <td>Harmonic mean</td> </tr> <tr> <td><strong>Probability calibration matters</strong></td> <td><strong>Log Loss</strong></td> <td>Need reliable probabilities</td> </tr> <tr> <td><strong>Threshold-independent</strong></td> <td><strong>ROC-AUC</strong></td> <td>Compare models overall</td> </tr> <tr> <td><strong>Imbalanced, care about minority</strong></td> <td><strong>PR-AUC</strong></td> <td>Better than ROC-AUC for imbalance</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>Strong candidates:</strong></p> <ul> <li>Start simple: "Try class_weight='balanced' first - simplest, no data modification, often sufficient"</li> <li>Know SMOTE: "Synthetic minority oversampling - creates realistic samples between minority neighbors, not random duplication"</li> <li>Understand metrics: "Never use accuracy for imbalanced data - 99% accuracy by predicting majority class is useless; use F1, recall, PR-AUC"</li> <li>Prevent leakage: "Apply SMOTE ONLY to training data inside Pipeline - applying before CV causes test data leakage"</li> <li>Reference real systems: "Stripe uses SMOTE + XGBoost for fraud (0.1% rate, 90% recall); Google Ads uses class weights at billions/day scale"</li> <li>Know variants: "BorderlineSMOTE focuses on boundary samples - often better than vanilla SMOTE; ADASYN adapts to local density"</li> <li>Discuss thresholds: "Tune decision threshold post-training - lower threshold increases recall, higher increases precision"</li> </ul> </div> </details> <hr> <h3 id=explain-gridsearchcv-vs-randomizedsearchcv-google-amazon-interview-question>Explain GridSearchCV vs RandomizedSearchCV - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Hyperparameter Tuning</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <h2 id=overview>Overview</h2> <p><strong>GridSearchCV</strong> and <strong>RandomizedSearchCV</strong> are sklearn's hyperparameter tuning tools. The fundamental difference is <strong>search strategy</strong>:</p> <ul> <li><strong>GridSearchCV:</strong> Exhaustive search over all combinations ‚Üí guarantees finding best params in grid</li> <li><strong>RandomizedSearchCV:</strong> Random sampling from distributions ‚Üí faster for large search spaces</li> </ul> <p><strong>Real-World Context:</strong> - <strong>Kaggle competitions:</strong> RandomSearch ‚Üí GridSearch refinement (2-stage tuning) - <strong>Netflix:</strong> RandomSearch on 10+ hyperparameters, saves 70% compute time - <strong>Uber ML Platform:</strong> Automated RandomSearch for 1000+ models/week</p> <h2 id=gridsearchcv-vs-randomizedsearchcv>GridSearchCV vs RandomizedSearchCV</h2> <table> <thead> <tr> <th>Aspect</th> <th>GridSearchCV</th> <th>RandomizedSearchCV</th> </tr> </thead> <tbody> <tr> <td><strong>Search Strategy</strong></td> <td>Exhaustive (all combinations)</td> <td>Random sampling</td> </tr> <tr> <td><strong>Complexity</strong></td> <td>O(n<sup>d</sup>) where d=dimensions</td> <td>O(n_iter)</td> </tr> <tr> <td><strong>When to Use</strong></td> <td>Small param spaces (&lt; 100 combos)</td> <td>Large/continuous spaces</td> </tr> <tr> <td><strong>Guarantees</strong></td> <td>Finds best in grid</td> <td>No guarantee</td> </tr> <tr> <td><strong>Speed</strong></td> <td>Slow for large spaces</td> <td>Fast (controllable n_iter)</td> </tr> <tr> <td><strong>Best For</strong></td> <td>Final tuning (narrow range)</td> <td>Initial exploration</td> </tr> </tbody> </table> <p><strong>Example:</strong> - 3 hyperparameters √ó 10 values each = 1,000 combinations - GridSearchCV: trains 1,000 models (+ CV folds) - RandomizedSearchCV: trains n_iter=50 models ‚Üí <strong>20√ó faster</strong></p> <h2 id=when-to-use-which>When to Use Which</h2> <p><strong>Use GridSearchCV when:</strong> 1. Small parameter space (&lt; 100 combinations) 2. Discrete parameters (e.g., n_estimators=[50, 100, 200]) 3. Final refinement after RandomSearch 4. Need guaranteed best in grid</p> <p><strong>Use RandomizedSearchCV when:</strong> 1. Large parameter space (&gt; 1000 combinations) 2. Continuous parameters (e.g., learning_rate ‚àà [0.001, 0.1]) 3. Initial exploration 4. Limited compute budget</p> <h2 id=production-implementation-180-lines_1>Production Implementation (180 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># hyperparameter_tuning.py</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>GridSearchCV</span><span class=p>,</span> <span class=n>RandomizedSearchCV</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span><span class=p>,</span> <span class=n>GradientBoostingClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>StratifiedKFold</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>classification_report</span><span class=p>,</span> <span class=n>roc_auc_score</span>
<span class=kn>from</span><span class=w> </span><span class=nn>scipy.stats</span><span class=w> </span><span class=kn>import</span> <span class=n>randint</span><span class=p>,</span> <span class=n>uniform</span><span class=p>,</span> <span class=n>loguniform</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_grid_search</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    GridSearchCV: Exhaustive search</span>

<span class=sd>    Use Case: Small parameter space, need best params guaranteed</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. GridSearchCV (Exhaustive Search)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Sample dataset</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Small parameter grid</span>
    <span class=n>param_grid</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;n_estimators&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>],</span>
        <span class=s1>&#39;max_depth&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>15</span><span class=p>],</span>
        <span class=s1>&#39;min_samples_split&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>]</span>
    <span class=p>}</span>

    <span class=n>total_combinations</span> <span class=o>=</span> <span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>param_grid</span><span class=p>[</span><span class=s1>&#39;n_estimators&#39;</span><span class=p>])</span> <span class=o>*</span>
                         <span class=nb>len</span><span class=p>(</span><span class=n>param_grid</span><span class=p>[</span><span class=s1>&#39;max_depth&#39;</span><span class=p>])</span> <span class=o>*</span>
                         <span class=nb>len</span><span class=p>(</span><span class=n>param_grid</span><span class=p>[</span><span class=s1>&#39;min_samples_split&#39;</span><span class=p>]))</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Parameter grid: </span><span class=si>{</span><span class=n>param_grid</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total combinations: </span><span class=si>{</span><span class=n>total_combinations</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;With 5-fold CV: </span><span class=si>{</span><span class=n>total_combinations</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>5</span><span class=si>}</span><span class=s2> model fits</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># GridSearchCV</span>
    <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>

    <span class=n>grid_search</span> <span class=o>=</span> <span class=n>GridSearchCV</span><span class=p>(</span>
        <span class=n>estimator</span><span class=o>=</span><span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>),</span>
        <span class=n>param_grid</span><span class=o>=</span><span class=n>param_grid</span><span class=p>,</span>
        <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
        <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;roc_auc&#39;</span><span class=p>,</span>
        <span class=n>n_jobs</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>  <span class=c1># Parallel processing</span>
        <span class=n>verbose</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
        <span class=n>return_train_score</span><span class=o>=</span><span class=kc>True</span>
    <span class=p>)</span>

    <span class=n>grid_search</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=n>elapsed</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ GridSearchCV completed in </span><span class=si>{</span><span class=n>elapsed</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Best params: </span><span class=si>{</span><span class=n>grid_search</span><span class=o>.</span><span class=n>best_params_</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Best CV score: </span><span class=si>{</span><span class=n>grid_search</span><span class=o>.</span><span class=n>best_score_</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Test set performance</span>
    <span class=n>y_pred</span> <span class=o>=</span> <span class=n>grid_search</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
    <span class=n>y_proba</span> <span class=o>=</span> <span class=n>grid_search</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span><span class=mi>1</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Test ROC-AUC: </span><span class=si>{</span><span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_proba</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Inspect CV results</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 3 configurations:&quot;</span><span class=p>)</span>
    <span class=n>results</span> <span class=o>=</span> <span class=n>grid_search</span><span class=o>.</span><span class=n>cv_results_</span>
    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>):</span>
        <span class=n>idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>results</span><span class=p>[</span><span class=s1>&#39;rank_test_score&#39;</span><span class=p>])[</span><span class=n>i</span><span class=p>]</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>. Score: </span><span class=si>{</span><span class=n>results</span><span class=p>[</span><span class=s1>&#39;mean_test_score&#39;</span><span class=p>][</span><span class=n>idx</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> | &quot;</span>
              <span class=sa>f</span><span class=s2>&quot;Params: </span><span class=si>{</span><span class=n>results</span><span class=p>[</span><span class=s1>&#39;params&#39;</span><span class=p>][</span><span class=n>idx</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_randomized_search</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    RandomizedSearchCV: Random sampling from distributions</span>

<span class=sd>    Use Case: Large parameter space, continuous distributions</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. RandomizedSearchCV (Random Sampling)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Large parameter space with scipy distributions</span>
    <span class=n>param_distributions</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;n_estimators&#39;</span><span class=p>:</span> <span class=n>randint</span><span class=p>(</span><span class=mi>50</span><span class=p>,</span> <span class=mi>500</span><span class=p>),</span>           <span class=c1># Discrete: [50, 500)</span>
        <span class=s1>&#39;max_depth&#39;</span><span class=p>:</span> <span class=n>randint</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>20</span><span class=p>),</span>                <span class=c1># Discrete: [3, 20)</span>
        <span class=s1>&#39;min_samples_split&#39;</span><span class=p>:</span> <span class=n>randint</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>20</span><span class=p>),</span>        <span class=c1># Discrete: [2, 20)</span>
        <span class=s1>&#39;min_samples_leaf&#39;</span><span class=p>:</span> <span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>),</span>         <span class=c1># Discrete: [1, 10)</span>
        <span class=s1>&#39;max_features&#39;</span><span class=p>:</span> <span class=n>uniform</span><span class=p>(</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.9</span><span class=p>),</span>          <span class=c1># Continuous: [0.1, 1.0)</span>
        <span class=s1>&#39;bootstrap&#39;</span><span class=p>:</span> <span class=p>[</span><span class=kc>True</span><span class=p>,</span> <span class=kc>False</span><span class=p>]</span>
    <span class=p>}</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Parameter distributions: </span><span class=si>{</span><span class=n>param_distributions</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Search space size: ~10^8 combinations (intractable for GridSearch)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;RandomSearch samples: n_iter=50 (controllable)</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># RandomizedSearchCV</span>
    <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>

    <span class=n>random_search</span> <span class=o>=</span> <span class=n>RandomizedSearchCV</span><span class=p>(</span>
        <span class=n>estimator</span><span class=o>=</span><span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>),</span>
        <span class=n>param_distributions</span><span class=o>=</span><span class=n>param_distributions</span><span class=p>,</span>
        <span class=n>n_iter</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>  <span class=c1># Number of random samples</span>
        <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
        <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;roc_auc&#39;</span><span class=p>,</span>
        <span class=n>n_jobs</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
        <span class=n>verbose</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span>
        <span class=n>return_train_score</span><span class=o>=</span><span class=kc>True</span>
    <span class=p>)</span>

    <span class=n>random_search</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=n>elapsed</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ RandomizedSearchCV completed in </span><span class=si>{</span><span class=n>elapsed</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Best params: </span><span class=si>{</span><span class=n>random_search</span><span class=o>.</span><span class=n>best_params_</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Best CV score: </span><span class=si>{</span><span class=n>random_search</span><span class=o>.</span><span class=n>best_score_</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=n>y_proba</span> <span class=o>=</span> <span class=n>random_search</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span><span class=mi>1</span><span class=p>]</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Test ROC-AUC: </span><span class=si>{</span><span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_proba</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_scipy_distributions</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Using scipy distributions for continuous hyperparameters</span>

<span class=sd>    Key distributions:</span>
<span class=sd>    - loguniform: Learning rates, regularization (log scale)</span>
<span class=sd>    - uniform: Dropout, max_features (linear scale)</span>
<span class=sd>    - randint: Tree depth, n_estimators (discrete)</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. Scipy Distributions (For Continuous Params)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Gradient Boosting with log-scale learning rate</span>
    <span class=n>param_distributions</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;learning_rate&#39;</span><span class=p>:</span> <span class=n>loguniform</span><span class=p>(</span><span class=mf>1e-4</span><span class=p>,</span> <span class=mf>1e-1</span><span class=p>),</span>  <span class=c1># Log scale: [0.0001, 0.1]</span>
        <span class=s1>&#39;n_estimators&#39;</span><span class=p>:</span> <span class=n>randint</span><span class=p>(</span><span class=mi>50</span><span class=p>,</span> <span class=mi>300</span><span class=p>),</span>
        <span class=s1>&#39;max_depth&#39;</span><span class=p>:</span> <span class=n>randint</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>10</span><span class=p>),</span>
        <span class=s1>&#39;subsample&#39;</span><span class=p>:</span> <span class=n>uniform</span><span class=p>(</span><span class=mf>0.6</span><span class=p>,</span> <span class=mf>0.4</span><span class=p>),</span>           <span class=c1># Linear: [0.6, 1.0]</span>
        <span class=s1>&#39;min_samples_split&#39;</span><span class=p>:</span> <span class=n>randint</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>20</span><span class=p>)</span>
    <span class=p>}</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Parameter distributions:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  learning_rate: loguniform(1e-4, 1e-1)  # Log scale!&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  subsample: uniform(0.6, 0.4)           # Linear [0.6, 1.0]&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  n_estimators: randint(50, 300)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>()</span>

    <span class=n>random_search</span> <span class=o>=</span> <span class=n>RandomizedSearchCV</span><span class=p>(</span>
        <span class=n>estimator</span><span class=o>=</span><span class=n>GradientBoostingClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>),</span>
        <span class=n>param_distributions</span><span class=o>=</span><span class=n>param_distributions</span><span class=p>,</span>
        <span class=n>n_iter</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span>
        <span class=n>cv</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
        <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;roc_auc&#39;</span><span class=p>,</span>
        <span class=n>n_jobs</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>random_search</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;‚úÖ Best learning_rate: </span><span class=si>{</span><span class=n>random_search</span><span class=o>.</span><span class=n>best_params_</span><span class=p>[</span><span class=s1>&#39;learning_rate&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   (Sampled on log scale for better coverage)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Best CV score: </span><span class=si>{</span><span class=n>random_search</span><span class=o>.</span><span class=n>best_score_</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_two_stage_tuning</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Production Strategy: RandomSearch ‚Üí GridSearch</span>

<span class=sd>    Stage 1 (RandomSearch): Broad exploration</span>
<span class=sd>    Stage 2 (GridSearch): Fine-tuning around best region</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Two-Stage Tuning (RandomSearch ‚Üí GridSearch)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># STAGE 1: RandomSearch (broad exploration)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>üìç STAGE 1: RandomSearch (Broad Exploration)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=n>param_distributions</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;n_estimators&#39;</span><span class=p>:</span> <span class=n>randint</span><span class=p>(</span><span class=mi>50</span><span class=p>,</span> <span class=mi>500</span><span class=p>),</span>
        <span class=s1>&#39;max_depth&#39;</span><span class=p>:</span> <span class=n>randint</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>20</span><span class=p>),</span>
        <span class=s1>&#39;min_samples_split&#39;</span><span class=p>:</span> <span class=n>randint</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>20</span><span class=p>)</span>
    <span class=p>}</span>

    <span class=n>random_search</span> <span class=o>=</span> <span class=n>RandomizedSearchCV</span><span class=p>(</span>
        <span class=n>estimator</span><span class=o>=</span><span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>),</span>
        <span class=n>param_distributions</span><span class=o>=</span><span class=n>param_distributions</span><span class=p>,</span>
        <span class=n>n_iter</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span>
        <span class=n>cv</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
        <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;roc_auc&#39;</span><span class=p>,</span>
        <span class=n>n_jobs</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>random_search</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=n>best_random</span> <span class=o>=</span> <span class=n>random_search</span><span class=o>.</span><span class=n>best_params_</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Best params from RandomSearch: </span><span class=si>{</span><span class=n>best_random</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CV score: </span><span class=si>{</span><span class=n>random_search</span><span class=o>.</span><span class=n>best_score_</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># STAGE 2: GridSearch (fine-tuning)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>üìç STAGE 2: GridSearch (Refine Around Best Region)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=c1># Create narrow grid around best params</span>
    <span class=n>param_grid</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;n_estimators&#39;</span><span class=p>:</span> <span class=p>[</span>
            <span class=nb>max</span><span class=p>(</span><span class=mi>50</span><span class=p>,</span> <span class=n>best_random</span><span class=p>[</span><span class=s1>&#39;n_estimators&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=mi>50</span><span class=p>),</span>
            <span class=n>best_random</span><span class=p>[</span><span class=s1>&#39;n_estimators&#39;</span><span class=p>],</span>
            <span class=n>best_random</span><span class=p>[</span><span class=s1>&#39;n_estimators&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=mi>50</span>
        <span class=p>],</span>
        <span class=s1>&#39;max_depth&#39;</span><span class=p>:</span> <span class=p>[</span>
            <span class=nb>max</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=n>best_random</span><span class=p>[</span><span class=s1>&#39;max_depth&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=mi>2</span><span class=p>),</span>
            <span class=n>best_random</span><span class=p>[</span><span class=s1>&#39;max_depth&#39;</span><span class=p>],</span>
            <span class=nb>min</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=n>best_random</span><span class=p>[</span><span class=s1>&#39;max_depth&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=mi>2</span><span class=p>)</span>
        <span class=p>],</span>
        <span class=s1>&#39;min_samples_split&#39;</span><span class=p>:</span> <span class=p>[</span>
            <span class=nb>max</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=n>best_random</span><span class=p>[</span><span class=s1>&#39;min_samples_split&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=mi>2</span><span class=p>),</span>
            <span class=n>best_random</span><span class=p>[</span><span class=s1>&#39;min_samples_split&#39;</span><span class=p>],</span>
            <span class=nb>min</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=n>best_random</span><span class=p>[</span><span class=s1>&#39;min_samples_split&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=mi>2</span><span class=p>)</span>
        <span class=p>]</span>
    <span class=p>}</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Refined grid: </span><span class=si>{</span><span class=n>param_grid</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=n>grid_search</span> <span class=o>=</span> <span class=n>GridSearchCV</span><span class=p>(</span>
        <span class=n>estimator</span><span class=o>=</span><span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>),</span>
        <span class=n>param_grid</span><span class=o>=</span><span class=n>param_grid</span><span class=p>,</span>
        <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>  <span class=c1># More folds for final tuning</span>
        <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;roc_auc&#39;</span><span class=p>,</span>
        <span class=n>n_jobs</span><span class=o>=-</span><span class=mi>1</span>
    <span class=p>)</span>

    <span class=n>grid_search</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Best params from GridSearch: </span><span class=si>{</span><span class=n>grid_search</span><span class=o>.</span><span class=n>best_params_</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CV score: </span><span class=si>{</span><span class=n>grid_search</span><span class=o>.</span><span class=n>best_score_</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Compare stages</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Improvement: </span><span class=si>{</span><span class=p>(</span><span class=n>grid_search</span><span class=o>.</span><span class=n>best_score_</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>random_search</span><span class=o>.</span><span class=n>best_score_</span><span class=p>)</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>

    <span class=c1># Final test performance</span>
    <span class=n>y_proba</span> <span class=o>=</span> <span class=n>grid_search</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span><span class=mi>1</span><span class=p>]</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Final Test ROC-AUC: </span><span class=si>{</span><span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_proba</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_grid_search</span><span class=p>()</span>
    <span class=n>demo_randomized_search</span><span class=p>()</span>
    <span class=n>demo_scipy_distributions</span><span class=p>()</span>
    <span class=n>demo_two_stage_tuning</span><span class=p>()</span>
</code></pre></div> <h2 id=common-pitfalls-solutions_4>Common Pitfalls &amp; Solutions</h2> <table> <thead> <tr> <th>Pitfall</th> <th>Problem</th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td><strong>Using GridSearch for large spaces</strong></td> <td>Combinatorial explosion (days to run)</td> <td>Use RandomSearch with n_iter budget</td> </tr> <tr> <td><strong>Wrong distribution</strong></td> <td>uniform(0.001, 0.1) misses low values</td> <td>Use loguniform for log-scale params</td> </tr> <tr> <td><strong>Not refining</strong></td> <td>RandomSearch finds region, doesn't optimize</td> <td>Two-stage: Random ‚Üí Grid refinement</td> </tr> <tr> <td><strong>Data leakage in CV</strong></td> <td>Preprocessing on full data before CV</td> <td>Put preprocessing IN pipeline</td> </tr> <tr> <td><strong>Ignoring n_jobs=-1</strong></td> <td>Single-core search (slow)</td> <td>Use n_jobs=-1 for parallelism</td> </tr> </tbody> </table> <h2 id=real-world-performance>Real-World Performance</h2> <table> <thead> <tr> <th>Company</th> <th>Task</th> <th>Strategy</th> <th>Result</th> </tr> </thead> <tbody> <tr> <td><strong>Kaggle Winners</strong></td> <td>Competition tuning</td> <td>Random (n=200) ‚Üí Grid (narrow)</td> <td>Top 1%</td> </tr> <tr> <td><strong>Netflix</strong></td> <td>Recommendation models</td> <td>RandomSearch on 10+ params</td> <td>70% faster than Grid</td> </tr> <tr> <td><strong>Uber</strong></td> <td>Fraud detection</td> <td>Automated RandomSearch (Michelangelo)</td> <td>1000+ models/week</td> </tr> <tr> <td><strong>Spotify</strong></td> <td>Music recommendations</td> <td>Bayesian Optimization (better than both)</td> <td>40% fewer iterations</td> </tr> </tbody> </table> <p><strong>Key Insight:</strong> - <strong>Small spaces (&lt; 100 combos):</strong> GridSearchCV - <strong>Large spaces (&gt; 1000 combos):</strong> RandomizedSearchCV - <strong>Production:</strong> Two-stage (Random ‚Üí Grid) or Bayesian Optimization (Optuna, Hyperopt)</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Mentions <strong>two-stage tuning</strong> (RandomSearch ‚Üí GridSearch refinement)</li> <li>Uses <strong>scipy distributions</strong> (<code>loguniform</code> for learning_rate, <code>uniform</code> for dropout)</li> <li>Knows <strong>when NOT to use GridSearch</strong> (combinatorial explosion for &gt; 5 hyperparameters)</li> <li>Prevents <strong>data leakage</strong> by putting preprocessing inside Pipeline before CV</li> <li>Real-world: <strong>Kaggle competitions use Random (n=100-200) then Grid refinement</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-create-a-custom-transformer-google-amazon-interview-question>How to Create a Custom Transformer? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Custom Transformers</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <h2 id=overview_1>Overview</h2> <p><strong>Custom transformers</strong> let you integrate domain-specific preprocessing into sklearn pipelines. They follow the <strong>Transformer API</strong>:</p> <ul> <li>Inherit from <code>BaseEstimator</code> and <code>TransformerMixin</code></li> <li>Implement <code>fit(X, y=None)</code> and <code>transform(X)</code> methods</li> <li>Return <code>self</code> in <code>fit()</code> for method chaining</li> <li>Use <code>check_array()</code> for input validation</li> <li>Store learned attributes with underscore suffix (e.g., <code>self.mean_</code>)</li> </ul> <p><strong>Real-World Context:</strong> - <strong>Netflix:</strong> Custom transformers for time-based features (watch_hour, day_of_week) - <strong>Airbnb:</strong> Domain-specific transformers for pricing (SeasonalityTransformer, EventProximityTransformer) - <strong>Uber:</strong> LocationClusterTransformer for geographic features</p> <h2 id=required-base-classes>Required Base Classes</h2> <table> <thead> <tr> <th>Base Class</th> <th>Purpose</th> <th>Methods Provided</th> </tr> </thead> <tbody> <tr> <td><strong>BaseEstimator</strong></td> <td>Enables <code>get_params()</code> and <code>set_params()</code></td> <td>Required for GridSearchCV compatibility</td> </tr> <tr> <td><strong>TransformerMixin</strong></td> <td>Provides <code>fit_transform()</code></td> <td>Calls <code>fit()</code> then <code>transform()</code></td> </tr> <tr> <td><strong>ClassifierMixin</strong></td> <td>For custom classifiers</td> <td>Provides <code>score()</code> method</td> </tr> <tr> <td><strong>RegressorMixin</strong></td> <td>For custom regressors</td> <td>Provides <code>score()</code> method</td> </tr> </tbody> </table> <p><strong>Key Pattern:</strong> <div class=highlight><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>MyTransformer</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>param</span><span class=o>=</span><span class=mf>1.0</span><span class=p>):</span>  <span class=c1># Hyperparameters only</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>param</span> <span class=o>=</span> <span class=n>param</span>

    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
        <span class=c1># Learn from training data</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>learned_attr_</span> <span class=o>=</span> <span class=n>compute</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>  <span class=c1># Underscore suffix!</span>
        <span class=k>return</span> <span class=bp>self</span>  <span class=c1># Method chaining</span>

    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
        <span class=c1># Apply transformation</span>
        <span class=k>return</span> <span class=n>transformed_X</span>
</code></pre></div></p> <h2 id=production-implementation-195-lines_1>Production Implementation (195 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># custom_transformers.py</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.base</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.utils.validation</span><span class=w> </span><span class=kn>import</span> <span class=n>check_array</span><span class=p>,</span> <span class=n>check_is_fitted</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>GridSearchCV</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=k>class</span><span class=w> </span><span class=nc>LogTransformer</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Applies log transformation: log(1 + x)</span>

<span class=sd>    Use Case: Reduce skewness in features (income, price, counts)</span>

<span class=sd>    Methods:</span>
<span class=sd>    - fit(): No-op (stateless transformer)</span>
<span class=sd>    - transform(): Apply log1p</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>feature_names</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
        <span class=c1># IMPORTANT: __init__ must NOT access X or y - only set hyperparameters</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>feature_names</span> <span class=o>=</span> <span class=n>feature_names</span>

    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Fit method (no-op for stateless transformers)</span>

<span class=sd>        Must return self for method chaining!</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=c1># Input validation</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>check_array</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>accept_sparse</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>force_all_finite</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

        <span class=c1># Store number of features (convention)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>n_features_in_</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>

        <span class=c1># Check for negative values</span>
        <span class=k>if</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>X</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>):</span>
            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;LogTransformer requires non-negative values&quot;</span><span class=p>)</span>

        <span class=k>return</span> <span class=bp>self</span>  <span class=c1># REQUIRED: Return self</span>

    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Apply log(1 + x) transformation&quot;&quot;&quot;</span>
        <span class=c1># Check that fit() was called</span>
        <span class=n>check_is_fitted</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s1>&#39;n_features_in_&#39;</span><span class=p>)</span>

        <span class=c1># Validate input</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>check_array</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>accept_sparse</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=bp>self</span><span class=o>.</span><span class=n>n_features_in_</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Expected </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>n_features_in_</span><span class=si>}</span><span class=s2> features, got </span><span class=si>{</span><span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>log1p</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_feature_names_out</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_features</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Required for sklearn 1.2+ pipeline feature name propagation&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>input_features</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>input_features</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&quot;x</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_features_in_</span><span class=p>)]</span>

        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=sa>f</span><span class=s2>&quot;log_</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>input_features</span><span class=p>])</span>

<span class=k>class</span><span class=w> </span><span class=nc>OutlierClipper</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Clips values to [lower_quantile, upper_quantile]</span>

<span class=sd>    Use Case: Handle outliers in features (age, price, duration)</span>

<span class=sd>    Learned Attributes:</span>
<span class=sd>    - lower_bounds_: Lower clip values (per feature)</span>
<span class=sd>    - upper_bounds_: Upper clip values (per feature)</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>lower_quantile</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span> <span class=n>upper_quantile</span><span class=o>=</span><span class=mf>0.99</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>lower_quantile</span> <span class=o>=</span> <span class=n>lower_quantile</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>upper_quantile</span> <span class=o>=</span> <span class=n>upper_quantile</span>

    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Learn quantiles from training data&quot;&quot;&quot;</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>check_array</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>accept_sparse</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>n_features_in_</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>

        <span class=c1># Learn bounds (IMPORTANT: Add underscore suffix!)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>lower_bounds_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>lower_quantile</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>upper_bounds_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>upper_quantile</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>

        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Clip values to learned bounds&quot;&quot;&quot;</span>
        <span class=n>check_is_fitted</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;lower_bounds_&#39;</span><span class=p>,</span> <span class=s1>&#39;upper_bounds_&#39;</span><span class=p>])</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>check_array</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>accept_sparse</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

        <span class=c1># Clip each feature independently</span>
        <span class=n>X_clipped</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>lower_bounds_</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>upper_bounds_</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>X_clipped</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_feature_names_out</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_features</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
        <span class=k>if</span> <span class=n>input_features</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>input_features</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&quot;x</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>n_features_in_</span><span class=p>)]</span>

        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=sa>f</span><span class=s2>&quot;clipped_</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>input_features</span><span class=p>])</span>

<span class=k>class</span><span class=w> </span><span class=nc>DomainFeatureExtractor</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Creates domain-specific features from timestamp</span>

<span class=sd>    Use Case: Extract time-based patterns (hour, day_of_week, is_weekend)</span>

<span class=sd>    Example: Netflix watch patterns, Uber ride demand</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>include_hour</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>include_day</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>include_weekend</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>include_hour</span> <span class=o>=</span> <span class=n>include_hour</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>include_day</span> <span class=o>=</span> <span class=n>include_day</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>include_weekend</span> <span class=o>=</span> <span class=n>include_weekend</span>

    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Stateless - just validate&quot;&quot;&quot;</span>
        <span class=c1># X should be timestamps (1D array)</span>
        <span class=k>if</span> <span class=n>X</span><span class=o>.</span><span class=n>ndim</span> <span class=o>!=</span> <span class=mi>1</span> <span class=ow>and</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Expected 1D array of timestamps&quot;</span><span class=p>)</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>n_features_in_</span> <span class=o>=</span> <span class=mi>1</span>
        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Extract time features&quot;&quot;&quot;</span>
        <span class=n>check_is_fitted</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s1>&#39;n_features_in_&#39;</span><span class=p>)</span>

        <span class=c1># Flatten if 2D</span>
        <span class=k>if</span> <span class=n>X</span><span class=o>.</span><span class=n>ndim</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
            <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span>

        <span class=c1># Convert to datetime</span>
        <span class=n>timestamps</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>

        <span class=n>features</span> <span class=o>=</span> <span class=p>[]</span>

        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>include_hour</span><span class=p>:</span>
            <span class=n>features</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>timestamps</span><span class=o>.</span><span class=n>hour</span><span class=o>.</span><span class=n>values</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>

        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>include_day</span><span class=p>:</span>
            <span class=n>features</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>timestamps</span><span class=o>.</span><span class=n>dayofweek</span><span class=o>.</span><span class=n>values</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>

        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>include_weekend</span><span class=p>:</span>
            <span class=n>is_weekend</span> <span class=o>=</span> <span class=p>(</span><span class=n>timestamps</span><span class=o>.</span><span class=n>dayofweek</span> <span class=o>&gt;=</span> <span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
            <span class=n>features</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>is_weekend</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>(</span><span class=n>features</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>get_feature_names_out</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_features</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
        <span class=n>features</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>include_hour</span><span class=p>:</span>
            <span class=n>features</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;hour&quot;</span><span class=p>)</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>include_day</span><span class=p>:</span>
            <span class=n>features</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;day_of_week&quot;</span><span class=p>)</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>include_weekend</span><span class=p>:</span>
            <span class=n>features</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;is_weekend&quot;</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>features</span><span class=p>)</span>

<span class=k>class</span><span class=w> </span><span class=nc>MeanImputer</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Imputes missing values with mean (per feature)</span>

<span class=sd>    Use Case: Handle NaN values in numerical features</span>

<span class=sd>    Learned Attributes:</span>
<span class=sd>    - means_: Mean values per feature (from training data)</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>pass</span>

    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Learn means from training data&quot;&quot;&quot;</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>check_array</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>accept_sparse</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>force_all_finite</span><span class=o>=</span><span class=s1>&#39;allow-nan&#39;</span><span class=p>)</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>n_features_in_</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>

        <span class=c1># Learn means (ignoring NaN)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>means_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nanmean</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>

        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Replace NaN with learned means&quot;&quot;&quot;</span>
        <span class=n>check_is_fitted</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s1>&#39;means_&#39;</span><span class=p>)</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>check_array</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>accept_sparse</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>force_all_finite</span><span class=o>=</span><span class=s1>&#39;allow-nan&#39;</span><span class=p>,</span> <span class=n>copy</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

        <span class=c1># Replace NaN with means</span>
        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]):</span>
            <span class=n>mask</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>isnan</span><span class=p>(</span><span class=n>X</span><span class=p>[:,</span> <span class=n>i</span><span class=p>])</span>
            <span class=n>X</span><span class=p>[</span><span class=n>mask</span><span class=p>,</span> <span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>means_</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>

        <span class=k>return</span> <span class=n>X</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_custom_transformers</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Demonstrate custom transformers in pipeline&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Custom Transformers in Pipeline&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Synthetic data</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Add skewness and outliers</span>
    <span class=n>X</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>X</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>])</span>  <span class=c1># Skewed feature</span>
    <span class=n>X</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>X</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>*</span> <span class=mi>100</span>    <span class=c1># Feature with outliers</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Pipeline with custom transformers</span>
    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
        <span class=p>(</span><span class=s1>&#39;log&#39;</span><span class=p>,</span> <span class=n>LogTransformer</span><span class=p>()),</span>             <span class=c1># De-skew</span>
        <span class=p>(</span><span class=s1>&#39;clipper&#39;</span><span class=p>,</span> <span class=n>OutlierClipper</span><span class=p>()),</span>         <span class=c1># Remove outliers</span>
        <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>          <span class=c1># Scale</span>
        <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>))</span>
    <span class=p>])</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Pipeline steps:&quot;</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>step</span> <span class=ow>in</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>named_steps</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>step</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Fit pipeline</span>
    <span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># Evaluate</span>
    <span class=n>train_score</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>test_score</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Train accuracy: </span><span class=si>{</span><span class=n>train_score</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;‚úÖ Test accuracy: </span><span class=si>{</span><span class=n>test_score</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Inspect learned attributes</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>üìä OutlierClipper learned bounds:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   Lower: </span><span class=si>{</span><span class=n>pipeline</span><span class=o>.</span><span class=n>named_steps</span><span class=p>[</span><span class=s1>&#39;clipper&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>lower_bounds_</span><span class=p>[:</span><span class=mi>3</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;   Upper: </span><span class=si>{</span><span class=n>pipeline</span><span class=o>.</span><span class=n>named_steps</span><span class=p>[</span><span class=s1>&#39;clipper&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>upper_bounds_</span><span class=p>[:</span><span class=mi>3</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_gridsearch_compatibility</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Custom transformers work with GridSearchCV&quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Custom Transformers with GridSearchCV&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>X</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>])</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
        <span class=p>(</span><span class=s1>&#39;clipper&#39;</span><span class=p>,</span> <span class=n>OutlierClipper</span><span class=p>()),</span>
        <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>))</span>
    <span class=p>])</span>

    <span class=c1># GridSearch over custom transformer params</span>
    <span class=n>param_grid</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;clipper__lower_quantile&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>],</span>
        <span class=s1>&#39;clipper__upper_quantile&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.95</span><span class=p>,</span> <span class=mf>0.99</span><span class=p>],</span>
        <span class=s1>&#39;classifier__n_estimators&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>]</span>
    <span class=p>}</span>

    <span class=n>grid_search</span> <span class=o>=</span> <span class=n>GridSearchCV</span><span class=p>(</span><span class=n>pipeline</span><span class=p>,</span> <span class=n>param_grid</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;accuracy&#39;</span><span class=p>)</span>
    <span class=n>grid_search</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;‚úÖ Best params: </span><span class=si>{</span><span class=n>grid_search</span><span class=o>.</span><span class=n>best_params_</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;‚úÖ Best CV score: </span><span class=si>{</span><span class=n>grid_search</span><span class=o>.</span><span class=n>best_score_</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Custom transformers work seamlessly with GridSearchCV!&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_custom_transformers</span><span class=p>()</span>
    <span class=n>demo_gridsearch_compatibility</span><span class=p>()</span>
</code></pre></div> <h2 id=common-pitfalls-solutions_5>Common Pitfalls &amp; Solutions</h2> <table> <thead> <tr> <th>Pitfall</th> <th>Problem</th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td><strong>Forgetting <code>return self</code></strong></td> <td>Pipeline breaks (no method chaining)</td> <td>Always return <code>self</code> in <code>fit()</code></td> </tr> <tr> <td><strong>No underscore on learned attrs</strong></td> <td>Breaks <code>check_is_fitted()</code></td> <td>Use <code>self.mean_</code> NOT <code>self.mean</code></td> </tr> <tr> <td><strong>Accessing X in <code>__init__</code></strong></td> <td>Breaks pickle/GridSearchCV</td> <td>Only set hyperparameters in <code>__init__</code></td> </tr> <tr> <td><strong>No input validation</strong></td> <td>Silent errors on bad input</td> <td>Use <code>check_array()</code>, <code>check_is_fitted()</code></td> </tr> <tr> <td><strong>Not implementing <code>get_feature_names_out</code></strong></td> <td>Breaks sklearn 1.2+ pipelines</td> <td>Return feature names array</td> </tr> </tbody> </table> <h2 id=real-world-examples>Real-World Examples</h2> <table> <thead> <tr> <th>Company</th> <th>Custom Transformer</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td><strong>Netflix</strong></td> <td><code>TimeFeatureExtractor</code></td> <td>Extract hour, day_of_week from timestamps</td> </tr> <tr> <td><strong>Airbnb</strong></td> <td><code>SeasonalityTransformer</code></td> <td>Encode peak/off-peak travel seasons</td> </tr> <tr> <td><strong>Uber</strong></td> <td><code>LocationClusterTransformer</code></td> <td>Cluster lat/lon into zones</td> </tr> <tr> <td><strong>Stripe</strong></td> <td><code>TransactionVelocityTransformer</code></td> <td>Compute transaction rate (fraud detection)</td> </tr> </tbody> </table> <p><strong>When to Use Custom Transformers:</strong> 1. Domain-specific preprocessing (time features, geospatial) 2. Complex feature engineering not in sklearn 3. Need Pipeline compatibility + GridSearchCV tuning 4. Reusable preprocessing across projects</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Inherits from <strong>both <code>BaseEstimator</code> and <code>TransformerMixin</code></strong></li> <li>Returns <strong><code>self</code> in <code>fit()</code></strong> (method chaining)</li> <li>Uses <strong>underscore suffix</strong> for learned attributes (<code>self.mean_</code>)</li> <li>Implements <strong><code>get_feature_names_out()</code></strong> for sklearn 1.2+ compatibility</li> <li>Validates input with <strong><code>check_array()</code></strong> and <strong><code>check_is_fitted()</code></strong></li> <li>Real-world: <strong>Netflix uses custom transformers for time-based features in recommendation pipelines</strong></li> </ul> </div> </details> <hr> <h3 id=explain-feature-scaling-methods-most-tech-companies-interview-question>Explain Feature Scaling Methods - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Preprocessing</code> | <strong>Asked by:</strong> Most Tech Companies</p> <details class=success> <summary>View Answer</summary> <h2 id=overview_2>Overview</h2> <p><strong>Feature scaling</strong> normalizes features to similar ranges, critical for distance-based algorithms and gradient descent. Three main methods:</p> <ul> <li><strong>StandardScaler:</strong> z-score normalization (mean=0, std=1)</li> <li><strong>MinMaxScaler:</strong> Scales to [0, 1] range</li> <li><strong>RobustScaler:</strong> Uses median/IQR (robust to outliers)</li> </ul> <p><strong>Real-World Context:</strong> - <strong>Google:</strong> StandardScaler for logistic regression, SVM (distance-based) - <strong>Uber:</strong> RobustScaler for ride pricing (handles outlier prices) - <strong>Airbnb:</strong> MinMaxScaler for neural networks (price prediction)</p> <h2 id=scaling-methods-comparison>Scaling Methods Comparison</h2> <table> <thead> <tr> <th>Scaler</th> <th>Formula</th> <th>Range</th> <th>Robust to Outliers</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>StandardScaler</strong></td> <td><span class=arithmatex>\(\frac{x - \mu}{\sigma}\)</span></td> <td>Unbounded</td> <td>‚ùå No</td> <td>Most algorithms (LR, SVM, KNN)</td> </tr> <tr> <td><strong>MinMaxScaler</strong></td> <td><span class=arithmatex>\(\frac{x - min}{max - min}\)</span></td> <td>[0, 1]</td> <td>‚ùå No</td> <td>Neural networks, image data</td> </tr> <tr> <td><strong>RobustScaler</strong></td> <td><span class=arithmatex>\(\frac{x - median}{IQR}\)</span></td> <td>Unbounded</td> <td>‚úÖ Yes</td> <td>Data with outliers</td> </tr> <tr> <td><strong>MaxAbsScaler</strong></td> <td>$\frac{x}{</td> <td>max</td> <td>}$</td> <td>[-1, 1]</td> </tr> <tr> <td><strong>Normalizer</strong></td> <td>$\frac{x}{</td> <td></td> <td>x</td> <td></td> </tr> </tbody> </table> <h2 id=when-scaling-matters>When Scaling Matters</h2> <p><strong>Algorithms that REQUIRE scaling:</strong> - Gradient descent (linear regression, logistic regression, neural networks) - Distance-based (KNN, K-Means, SVM with RBF kernel) - PCA, LDA (variance-based)</p> <p><strong>Algorithms that DON'T need scaling:</strong> - Tree-based (Decision Trees, Random Forest, XGBoost) - Naive Bayes</p> <h2 id=production-implementation-170-lines>Production Implementation (170 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># feature_scaling.py</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
    <span class=n>StandardScaler</span><span class=p>,</span> <span class=n>MinMaxScaler</span><span class=p>,</span> <span class=n>RobustScaler</span><span class=p>,</span>
    <span class=n>MaxAbsScaler</span><span class=p>,</span> <span class=n>Normalizer</span>
<span class=p>)</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LogisticRegression</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.svm</span><span class=w> </span><span class=kn>import</span> <span class=n>SVC</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.neighbors</span><span class=w> </span><span class=kn>import</span> <span class=n>KNeighborsClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>cross_val_score</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_standard_scaler</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    StandardScaler: z-score normalization</span>

<span class=sd>    Formula: (x - mean) / std</span>
<span class=sd>    Result: mean=0, std=1</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. StandardScaler (Z-Score Normalization)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Feature with different scales</span>
    <span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span>
        <span class=p>[</span><span class=mf>1.0</span><span class=p>,</span> <span class=mf>1000.0</span><span class=p>],</span>   <span class=c1># Feature 0: [1-5], Feature 1: [1000-5000]</span>
        <span class=p>[</span><span class=mf>2.0</span><span class=p>,</span> <span class=mf>2000.0</span><span class=p>],</span>
        <span class=p>[</span><span class=mf>3.0</span><span class=p>,</span> <span class=mf>3000.0</span><span class=p>],</span>
        <span class=p>[</span><span class=mf>4.0</span><span class=p>,</span> <span class=mf>4000.0</span><span class=p>],</span>
        <span class=p>[</span><span class=mf>5.0</span><span class=p>,</span> <span class=mf>5000.0</span><span class=p>]</span>
    <span class=p>])</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Original data:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Feature 0: mean=</span><span class=si>{</span><span class=n>data</span><span class=p>[:,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>, std=</span><span class=si>{</span><span class=n>data</span><span class=p>[:,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>std</span><span class=p>()</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Feature 1: mean=</span><span class=si>{</span><span class=n>data</span><span class=p>[:,</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>, std=</span><span class=si>{</span><span class=n>data</span><span class=p>[:,</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>std</span><span class=p>()</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Apply StandardScaler</span>
    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>scaler</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>

    <span class=n>data_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>After StandardScaler:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Feature 0: mean=</span><span class=si>{</span><span class=n>data_scaled</span><span class=p>[:,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>, std=</span><span class=si>{</span><span class=n>data_scaled</span><span class=p>[:,</span><span class=w> </span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>std</span><span class=p>()</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Feature 1: mean=</span><span class=si>{</span><span class=n>data_scaled</span><span class=p>[:,</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>, std=</span><span class=si>{</span><span class=n>data_scaled</span><span class=p>[:,</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>std</span><span class=p>()</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Learned parameters:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  scaler.mean_: </span><span class=si>{</span><span class=n>scaler</span><span class=o>.</span><span class=n>mean_</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  scaler.scale_ (std): </span><span class=si>{</span><span class=n>scaler</span><span class=o>.</span><span class=n>scale_</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Both features now have mean=0, std=1&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_minmax_scaler</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    MinMaxScaler: Scale to [0, 1] range</span>

<span class=sd>    Formula: (x - min) / (max - min)</span>
<span class=sd>    Result: values in [0, 1]</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. MinMaxScaler (Scale to [0, 1])&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mf>1.</span><span class=p>],</span> <span class=p>[</span><span class=mf>3.</span><span class=p>],</span> <span class=p>[</span><span class=mf>5.</span><span class=p>],</span> <span class=p>[</span><span class=mf>10.</span><span class=p>],</span> <span class=p>[</span><span class=mf>20.</span><span class=p>]])</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Original data: min=</span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>min</span><span class=p>()</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>, max=</span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>MinMaxScaler</span><span class=p>()</span>
    <span class=n>data_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;After MinMaxScaler: min=</span><span class=si>{</span><span class=n>data_scaled</span><span class=o>.</span><span class=n>min</span><span class=p>()</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>, max=</span><span class=si>{</span><span class=n>data_scaled</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Scaled values: </span><span class=si>{</span><span class=n>data_scaled</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Values now in [0, 1] range (required for some neural networks)&quot;</span><span class=p>)</span>

    <span class=c1># Custom range [a, b]</span>
    <span class=n>scaler_custom</span> <span class=o>=</span> <span class=n>MinMaxScaler</span><span class=p>(</span><span class=n>feature_range</span><span class=o>=</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
    <span class=n>data_custom</span> <span class=o>=</span> <span class=n>scaler_custom</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Custom range [-1, 1]: </span><span class=si>{</span><span class=n>data_custom</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_robust_scaler</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    RobustScaler: Uses median and IQR (robust to outliers)</span>

<span class=sd>    Formula: (x - median) / IQR</span>
<span class=sd>    Result: median=0, IQR-based scaling</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. RobustScaler (Robust to Outliers)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Data with outliers</span>
    <span class=n>data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mf>1.</span><span class=p>],</span> <span class=p>[</span><span class=mf>2.</span><span class=p>],</span> <span class=p>[</span><span class=mf>3.</span><span class=p>],</span> <span class=p>[</span><span class=mf>4.</span><span class=p>],</span> <span class=p>[</span><span class=mf>5.</span><span class=p>],</span> <span class=p>[</span><span class=mf>100.</span><span class=p>]])</span>  <span class=c1># 100 is outlier</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Data with outlier: </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># StandardScaler (affected by outliers)</span>
    <span class=n>standard_scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>data_standard</span> <span class=o>=</span> <span class=n>standard_scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>

    <span class=c1># RobustScaler (NOT affected by outliers)</span>
    <span class=n>robust_scaler</span> <span class=o>=</span> <span class=n>RobustScaler</span><span class=p>()</span>
    <span class=n>data_robust</span> <span class=o>=</span> <span class=n>robust_scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>StandardScaler (affected by outlier):&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Scaled: </span><span class=si>{</span><span class=n>data_standard</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Range: [</span><span class=si>{</span><span class=n>data_standard</span><span class=o>.</span><span class=n>min</span><span class=p>()</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>data_standard</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>]&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>RobustScaler (robust to outlier):&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Scaled: </span><span class=si>{</span><span class=n>data_robust</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Range: [</span><span class=si>{</span><span class=n>data_robust</span><span class=o>.</span><span class=n>min</span><span class=p>()</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>data_robust</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>]&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ RobustScaler uses median/IQR ‚Üí less affected by outliers&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_data_leakage_prevention</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    CRITICAL: Fit on train, transform on test (avoid data leakage)</span>

<span class=sd>    ‚ùå WRONG: Fit on all data before split</span>
<span class=sd>    ‚úÖ CORRECT: Fit only on training data</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Data Leakage Prevention (CRITICAL)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Split data</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># ‚ùå WRONG: Fit on all data (data leakage!)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚ùå WRONG: Fit scaler on all data&quot;</span><span class=p>)</span>
    <span class=n>scaler_wrong</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>scaler_wrong</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>([</span><span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>]))</span>  <span class=c1># LEAKAGE!</span>

    <span class=n>X_train_wrong</span> <span class=o>=</span> <span class=n>scaler_wrong</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_wrong</span> <span class=o>=</span> <span class=n>scaler_wrong</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>model_wrong</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>max_iter</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
    <span class=n>model_wrong</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_wrong</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>score_wrong</span> <span class=o>=</span> <span class=n>model_wrong</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_wrong</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Test accuracy: </span><span class=si>{</span><span class=n>score_wrong</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> (optimistically biased!)&quot;</span><span class=p>)</span>

    <span class=c1># ‚úÖ CORRECT: Fit only on training data</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ CORRECT: Fit scaler only on training data&quot;</span><span class=p>)</span>
    <span class=n>scaler_correct</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>scaler_correct</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>  <span class=c1># Only training data!</span>

    <span class=n>X_train_correct</span> <span class=o>=</span> <span class=n>scaler_correct</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_correct</span> <span class=o>=</span> <span class=n>scaler_correct</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>model_correct</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>max_iter</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
    <span class=n>model_correct</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_correct</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>score_correct</span> <span class=o>=</span> <span class=n>model_correct</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_correct</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Test accuracy: </span><span class=si>{</span><span class=n>score_correct</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> (unbiased estimate)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ ALWAYS fit scaler on training data only!&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_pipeline_integration</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Use Pipeline to prevent data leakage automatically</span>

<span class=sd>    Pipeline ensures scaler only sees training data during CV</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. Pipeline Integration (Best Practice)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Pipeline: scaler + model</span>
    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
        <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>
        <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>max_iter</span><span class=o>=</span><span class=mi>1000</span><span class=p>))</span>
    <span class=p>])</span>

    <span class=c1># Cross-validation (scaler fit separately on each fold!)</span>
    <span class=n>cv_scores</span> <span class=o>=</span> <span class=n>cross_val_score</span><span class=p>(</span><span class=n>pipeline</span><span class=p>,</span> <span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CV scores: </span><span class=si>{</span><span class=n>cv_scores</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Mean CV accuracy: </span><span class=si>{</span><span class=n>cv_scores</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> ¬± </span><span class=si>{</span><span class=n>cv_scores</span><span class=o>.</span><span class=n>std</span><span class=p>()</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Fit on full training set, evaluate on test</span>
    <span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>test_score</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Test accuracy: </span><span class=si>{</span><span class=n>test_score</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Pipeline automatically prevents data leakage!&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_when_scaling_matters</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Compare algorithms with/without scaling</span>

<span class=sd>    Distance-based algorithms NEED scaling</span>
<span class=sd>    Tree-based algorithms DON&#39;T need scaling</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;6. When Scaling Matters (Algorithm-Specific)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Dataset with different feature scales</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>*=</span> <span class=mi>1000</span>  <span class=c1># Feature 0: large scale</span>
    <span class=n>X</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>*=</span> <span class=mf>0.01</span>  <span class=c1># Feature 1: small scale</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>algorithms</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;Logistic Regression&#39;</span><span class=p>:</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>max_iter</span><span class=o>=</span><span class=mi>1000</span><span class=p>),</span>
        <span class=s1>&#39;SVM (RBF kernel)&#39;</span><span class=p>:</span> <span class=n>SVC</span><span class=p>(</span><span class=n>kernel</span><span class=o>=</span><span class=s1>&#39;rbf&#39;</span><span class=p>),</span>
        <span class=s1>&#39;KNN&#39;</span><span class=p>:</span> <span class=n>KNeighborsClassifier</span><span class=p>(),</span>
        <span class=s1>&#39;Random Forest&#39;</span><span class=p>:</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=p>}</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Algorithm&#39;</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Without Scaling&#39;</span><span class=si>:</span><span class=s2>&gt;18</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;With Scaling&#39;</span><span class=si>:</span><span class=s2>&gt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>algorithms</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=c1># Without scaling</span>
        <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>score_no_scale</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=c1># With scaling</span>
        <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
        <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
        <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

        <span class=n>model_fresh</span> <span class=o>=</span> <span class=n>algorithms</span><span class=p>[</span><span class=n>name</span><span class=p>]</span>  <span class=c1># Fresh model instance</span>
        <span class=n>model_fresh</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>score_scaled</span> <span class=o>=</span> <span class=n>model_fresh</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=n>improvement</span> <span class=o>=</span> <span class=p>(</span><span class=n>score_scaled</span> <span class=o>-</span> <span class=n>score_no_scale</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>score_no_scale</span><span class=si>:</span><span class=s2>&gt;18.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>score_scaled</span><span class=si>:</span><span class=s2>&gt;15.4f</span><span class=si>}</span><span class=s2>  (</span><span class=si>{</span><span class=n>improvement</span><span class=si>:</span><span class=s2>+.1f</span><span class=si>}</span><span class=s2>%)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Distance-based algorithms NEED scaling&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Tree-based algorithms DON&#39;T need scaling&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_standard_scaler</span><span class=p>()</span>
    <span class=n>demo_minmax_scaler</span><span class=p>()</span>
    <span class=n>demo_robust_scaler</span><span class=p>()</span>
    <span class=n>demo_data_leakage_prevention</span><span class=p>()</span>
    <span class=n>demo_pipeline_integration</span><span class=p>()</span>
    <span class=n>demo_when_scaling_matters</span><span class=p>()</span>
</code></pre></div> <h2 id=common-pitfalls-solutions_6>Common Pitfalls &amp; Solutions</h2> <table> <thead> <tr> <th>Pitfall</th> <th>Problem</th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td><strong>Fitting on all data</strong></td> <td>Data leakage (optimistic test scores)</td> <td>Fit on train only, transform test</td> </tr> <tr> <td><strong>Scaling after split manually</strong></td> <td>Easy to make mistakes</td> <td>Use Pipeline (automatic)</td> </tr> <tr> <td><strong>Using wrong scaler</strong></td> <td>StandardScaler fails on outliers</td> <td>Use RobustScaler for outliers</td> </tr> <tr> <td><strong>Scaling tree-based models</strong></td> <td>Unnecessary computation</td> <td>Skip scaling for RF, XGBoost</td> </tr> <tr> <td><strong>Not scaling new data</strong></td> <td>Model sees unscaled features</td> <td>Always transform new data with same scaler</td> </tr> </tbody> </table> <h2 id=real-world-performance_1>Real-World Performance</h2> <table> <thead> <tr> <th>Company</th> <th>Task</th> <th>Scaler</th> <th>Why</th> </tr> </thead> <tbody> <tr> <td><strong>Google</strong></td> <td>Logistic regression (CTR)</td> <td>StandardScaler</td> <td>Distance-based, needs mean=0</td> </tr> <tr> <td><strong>Uber</strong></td> <td>Ride pricing (SVM)</td> <td>RobustScaler</td> <td>Handles outlier prices</td> </tr> <tr> <td><strong>Airbnb</strong></td> <td>Neural network (price)</td> <td>MinMaxScaler</td> <td>NN expects [0, 1] inputs</td> </tr> <tr> <td><strong>Netflix</strong></td> <td>K-Means clustering</td> <td>StandardScaler</td> <td>Distance-based clustering</td> </tr> </tbody> </table> <p><strong>Key Insight:</strong> - <strong>StandardScaler:</strong> Default choice for most algorithms (LR, SVM, KNN, PCA) - <strong>RobustScaler:</strong> When data has outliers (prices, durations, counts) - <strong>MinMaxScaler:</strong> Neural networks, bounded outputs - <strong>Always fit on train, transform test</strong> (use Pipeline to automate)</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>data leakage prevention</strong> (fit on train only, transform test)</li> <li>Uses <strong>Pipeline</strong> to automate scaling + prevent leakage</li> <li>Chooses <strong>appropriate scaler</strong> (RobustScaler for outliers, MinMaxScaler for NN)</li> <li>Knows <strong>which algorithms need scaling</strong> (distance-based YES, tree-based NO)</li> <li>Real-world: <strong>Uber uses RobustScaler for ride pricing to handle outlier prices</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-evaluate-classification-models-google-amazon-interview-question>How to Evaluate Classification Models? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Metrics</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <h2 id=overview_3>Overview</h2> <p><strong>Classification metrics</strong> measure model performance beyond simple accuracy. Choice depends on <strong>business context</strong> (cost of FP vs FN):</p> <ul> <li><strong>Precision:</strong> Minimize false positives (spam detection, medical diagnosis)</li> <li><strong>Recall:</strong> Minimize false negatives (fraud detection, disease screening)</li> <li><strong>F1-Score:</strong> Balance precision and recall (general classifier)</li> <li><strong>ROC-AUC:</strong> Threshold-independent metric (ranking quality)</li> </ul> <p><strong>Real-World Context:</strong> - <strong>Google Ads:</strong> Precision (avoid showing bad ads ‚Üí brand damage) - <strong>Stripe Fraud:</strong> Recall 95%+ (catch fraud, even if some FPs) - <strong>Netflix Recommendations:</strong> ROC-AUC (ranking quality matters)</p> <h2 id=classification-metrics-summary>Classification Metrics Summary</h2> <table> <thead> <tr> <th>Metric</th> <th>Formula</th> <th>When to Use</th> <th>Business Example</th> </tr> </thead> <tbody> <tr> <td><strong>Accuracy</strong></td> <td><span class=arithmatex>\(\frac{TP + TN}{Total}\)</span></td> <td>Balanced classes only</td> <td>Sentiment (50% pos/neg)</td> </tr> <tr> <td><strong>Precision</strong></td> <td><span class=arithmatex>\(\frac{TP}{TP + FP}\)</span></td> <td>Cost of FP is high</td> <td>Spam (FP annoys users)</td> </tr> <tr> <td><strong>Recall</strong></td> <td><span class=arithmatex>\(\frac{TP}{TP + FN}\)</span></td> <td>Cost of FN is high</td> <td>Fraud (FN loses money)</td> </tr> <tr> <td><strong>F1-Score</strong></td> <td><span class=arithmatex>\(\frac{2 \cdot P \cdot R}{P + R}\)</span></td> <td>Balance P and R</td> <td>General classifier</td> </tr> <tr> <td><strong>ROC-AUC</strong></td> <td>Area under ROC curve</td> <td>Threshold-independent</td> <td>Ranking quality</td> </tr> <tr> <td><strong>PR-AUC</strong></td> <td>Area under PR curve</td> <td>Imbalanced classes</td> <td>Fraud (1% positive)</td> </tr> </tbody> </table> <h2 id=confusion-matrix-breakdown>Confusion Matrix Breakdown</h2> <table> <thead> <tr> <th></th> <th><strong>Predicted Positive</strong></th> <th><strong>Predicted Negative</strong></th> </tr> </thead> <tbody> <tr> <td><strong>Actual Positive</strong></td> <td>TP (True Positive)</td> <td>FN (False Negative)</td> </tr> <tr> <td><strong>Actual Negative</strong></td> <td>FP (False Positive)</td> <td>TN (True Negative)</td> </tr> </tbody> </table> <p><strong>Derived Metrics:</strong> - <strong>Precision = TP / (TP + FP)</strong> ‚Üí "Of predicted positives, how many correct?" - <strong>Recall = TP / (TP + FN)</strong> ‚Üí "Of actual positives, how many caught?" - <strong>Specificity = TN / (TN + FP)</strong> ‚Üí "Of actual negatives, how many correct?"</p> <h2 id=production-implementation-185-lines_1>Production Implementation (185 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># classification_metrics.py</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
    <span class=n>accuracy_score</span><span class=p>,</span> <span class=n>precision_score</span><span class=p>,</span> <span class=n>recall_score</span><span class=p>,</span> <span class=n>f1_score</span><span class=p>,</span>
    <span class=n>roc_auc_score</span><span class=p>,</span> <span class=n>average_precision_score</span><span class=p>,</span>
    <span class=n>classification_report</span><span class=p>,</span> <span class=n>confusion_matrix</span><span class=p>,</span>
    <span class=n>roc_curve</span><span class=p>,</span> <span class=n>precision_recall_curve</span><span class=p>,</span>
    <span class=n>ConfusionMatrixDisplay</span>
<span class=p>)</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_basic_metrics</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Basic classification metrics: Accuracy, Precision, Recall, F1</span>

<span class=sd>    Use Case: Understand fundamental metrics and when to use each</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Basic Classification Metrics&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Imbalanced dataset (5% positive)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
        <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.95</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>],</span>  <span class=c1># 5% fraud</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Train model</span>
    <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
    <span class=n>y_proba</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>]</span>

    <span class=c1># Compute metrics</span>
    <span class=n>accuracy</span> <span class=o>=</span> <span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
    <span class=n>precision</span> <span class=o>=</span> <span class=n>precision_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
    <span class=n>recall</span> <span class=o>=</span> <span class=n>recall_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
    <span class=n>f1</span> <span class=o>=</span> <span class=n>f1_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
    <span class=n>roc_auc</span> <span class=o>=</span> <span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_proba</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Class distribution: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>bincount</span><span class=p>(</span><span class=n>y_test</span><span class=p>)</span><span class=si>}</span><span class=s2> (95% class 0, 5% class 1)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Metrics:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Accuracy:  </span><span class=si>{</span><span class=n>accuracy</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>  ‚ùå Misleading for imbalanced data!&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Precision: </span><span class=si>{</span><span class=n>precision</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>  (Of predicted fraud, % correct)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Recall:    </span><span class=si>{</span><span class=n>recall</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>  (Of actual fraud, % caught)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  F1-Score:  </span><span class=si>{</span><span class=n>f1</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>  (Harmonic mean of P and R)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ROC-AUC:   </span><span class=si>{</span><span class=n>roc_auc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>  (Ranking quality)&quot;</span><span class=p>)</span>

    <span class=c1># Confusion matrix</span>
    <span class=n>cm</span> <span class=o>=</span> <span class=n>confusion_matrix</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Confusion Matrix:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  TN=</span><span class=si>{</span><span class=n>cm</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>, FP=</span><span class=si>{</span><span class=n>cm</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  FN=</span><span class=si>{</span><span class=n>cm</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>, TP=</span><span class=si>{</span><span class=n>cm</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ For imbalanced data: Use Precision, Recall, F1, ROC-AUC (NOT accuracy!)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_business_context</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Choosing metrics based on business context</span>

<span class=sd>    High FP cost ‚Üí Maximize Precision</span>
<span class=sd>    High FN cost ‚Üí Maximize Recall</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. Business Context: Precision vs Recall&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>],</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>y_proba</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>]</span>

    <span class=c1># Vary decision threshold</span>
    <span class=n>thresholds</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.3</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.7</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Threshold&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Precision&#39;</span><span class=si>:</span><span class=s2>&gt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Recall&#39;</span><span class=si>:</span><span class=s2>&gt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;F1&#39;</span><span class=si>:</span><span class=s2>&gt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Use Case&#39;</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>80</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>threshold</span> <span class=ow>in</span> <span class=n>thresholds</span><span class=p>:</span>
        <span class=n>y_pred</span> <span class=o>=</span> <span class=p>(</span><span class=n>y_proba</span> <span class=o>&gt;=</span> <span class=n>threshold</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>

        <span class=n>precision</span> <span class=o>=</span> <span class=n>precision_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
        <span class=n>recall</span> <span class=o>=</span> <span class=n>recall_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
        <span class=n>f1</span> <span class=o>=</span> <span class=n>f1_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>threshold</span> <span class=o>==</span> <span class=mf>0.3</span><span class=p>:</span>
            <span class=n>use_case</span> <span class=o>=</span> <span class=s2>&quot;Fraud (high recall)&quot;</span>
        <span class=k>elif</span> <span class=n>threshold</span> <span class=o>==</span> <span class=mf>0.5</span><span class=p>:</span>
            <span class=n>use_case</span> <span class=o>=</span> <span class=s2>&quot;Balanced&quot;</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>use_case</span> <span class=o>=</span> <span class=s2>&quot;Spam (high precision)&quot;</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>threshold</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>precision</span><span class=si>:</span><span class=s2>&gt;10.3f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>recall</span><span class=si>:</span><span class=s2>&gt;10.3f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>f1</span><span class=si>:</span><span class=s2>&gt;10.3f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>use_case</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Low threshold (0.3) ‚Üí High recall (catch all fraud)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ High threshold (0.7) ‚Üí High precision (avoid false spam)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_classification_report</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    classification_report: All metrics in one table</span>

<span class=sd>    Includes precision, recall, F1 per class + averages</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. classification_report (Comprehensive Summary)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>],</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Print classification report</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>classification_report</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>target_names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Negative&#39;</span><span class=p>,</span> <span class=s1>&#39;Positive&#39;</span><span class=p>]))</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Shows precision, recall, F1 for EACH class + macro/weighted averages&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_roc_auc</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    ROC-AUC: Threshold-independent metric</span>

<span class=sd>    Measures ranking quality (how well model separates classes)</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. ROC-AUC (Threshold-Independent)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.8</span><span class=p>,</span> <span class=mf>0.2</span><span class=p>],</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>y_proba</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>]</span>

    <span class=c1># ROC-AUC</span>
    <span class=n>roc_auc</span> <span class=o>=</span> <span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_proba</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;ROC-AUC: </span><span class=si>{</span><span class=n>roc_auc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Interpretation</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>ROC-AUC Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  1.0: Perfect classifier (all positives ranked above negatives)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  0.5: Random classifier (coin flip)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  0.9+: Excellent&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  0.8-0.9: Good&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  0.7-0.8: Fair&quot;</span><span class=p>)</span>

    <span class=c1># Compute ROC curve</span>
    <span class=n>fpr</span><span class=p>,</span> <span class=n>tpr</span><span class=p>,</span> <span class=n>thresholds</span> <span class=o>=</span> <span class=n>roc_curve</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_proba</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ ROC-AUC = </span><span class=si>{</span><span class=n>roc_auc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> (threshold-independent ranking quality)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_pr_auc</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    PR-AUC: Better than ROC-AUC for imbalanced data</span>

<span class=sd>    Precision-Recall curve focuses on positive class</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. PR-AUC (Better for Imbalanced Data)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Highly imbalanced (1% positive)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.99</span><span class=p>,</span> <span class=mf>0.01</span><span class=p>],</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>y_proba</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>]</span>

    <span class=c1># ROC-AUC (overly optimistic for imbalanced data)</span>
    <span class=n>roc_auc</span> <span class=o>=</span> <span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_proba</span><span class=p>)</span>

    <span class=c1># PR-AUC (more realistic for imbalanced data)</span>
    <span class=n>pr_auc</span> <span class=o>=</span> <span class=n>average_precision_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_proba</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Class distribution: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>bincount</span><span class=p>(</span><span class=n>y_test</span><span class=p>)</span><span class=si>}</span><span class=s2> (99% negative, 1% positive)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>ROC-AUC: </span><span class=si>{</span><span class=n>roc_auc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>  (overly optimistic)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;PR-AUC:  </span><span class=si>{</span><span class=n>pr_auc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>  (more realistic)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ For imbalanced data: PR-AUC is more informative than ROC-AUC&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_multiclass_metrics</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Multiclass classification metrics</span>

<span class=sd>    Averaging strategies: macro, weighted, micro</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;6. Multiclass Metrics (3+ classes)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># 3-class problem</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
        <span class=n>n_classes</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Different averaging strategies</span>
    <span class=n>precision_macro</span> <span class=o>=</span> <span class=n>precision_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>average</span><span class=o>=</span><span class=s1>&#39;macro&#39;</span><span class=p>)</span>
    <span class=n>precision_weighted</span> <span class=o>=</span> <span class=n>precision_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>average</span><span class=o>=</span><span class=s1>&#39;weighted&#39;</span><span class=p>)</span>
    <span class=n>precision_micro</span> <span class=o>=</span> <span class=n>precision_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>average</span><span class=o>=</span><span class=s1>&#39;micro&#39;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Precision (macro):    </span><span class=si>{</span><span class=n>precision_macro</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>  (unweighted mean)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Precision (weighted): </span><span class=si>{</span><span class=n>precision_weighted</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>  (weighted by support)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Precision (micro):    </span><span class=si>{</span><span class=n>precision_micro</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>  (global TP/FP)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Macro: Treats all classes equally&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Weighted: Accounts for class imbalance&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Micro: Good for imbalanced multiclass&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_basic_metrics</span><span class=p>()</span>
    <span class=n>demo_business_context</span><span class=p>()</span>
    <span class=n>demo_classification_report</span><span class=p>()</span>
    <span class=n>demo_roc_auc</span><span class=p>()</span>
    <span class=n>demo_pr_auc</span><span class=p>()</span>
    <span class=n>demo_multiclass_metrics</span><span class=p>()</span>
</code></pre></div> <h2 id=common-pitfalls-solutions_7>Common Pitfalls &amp; Solutions</h2> <table> <thead> <tr> <th>Pitfall</th> <th>Problem</th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td><strong>Using accuracy for imbalanced data</strong></td> <td>99% accuracy on 1% fraud (predicts all negative!)</td> <td>Use Precision, Recall, F1, ROC-AUC</td> </tr> <tr> <td><strong>Ignoring business context</strong></td> <td>Optimizing F1 when recall matters most</td> <td>Choose metric based on FP vs FN cost</td> </tr> <tr> <td><strong>ROC-AUC for imbalanced data</strong></td> <td>Overly optimistic (dominated by negatives)</td> <td>Use PR-AUC instead</td> </tr> <tr> <td><strong>Macro averaging for imbalanced</strong></td> <td>Gives equal weight to rare classes</td> <td>Use weighted averaging</td> </tr> <tr> <td><strong>Not tuning threshold</strong></td> <td>Default 0.5 may not be optimal</td> <td>Tune threshold on validation set</td> </tr> </tbody> </table> <h2 id=real-world-metric-choices>Real-World Metric Choices</h2> <table> <thead> <tr> <th>Company</th> <th>Task</th> <th>Metric</th> <th>Why</th> </tr> </thead> <tbody> <tr> <td><strong>Stripe</strong></td> <td>Fraud detection</td> <td>Recall 95%+</td> <td>Missing fraud costs $$$, FPs are reviewed</td> </tr> <tr> <td><strong>Google Ads</strong></td> <td>Ad quality</td> <td>Precision 90%+</td> <td>Bad ads damage brand, FPs costly</td> </tr> <tr> <td><strong>Netflix</strong></td> <td>Recommendations</td> <td>ROC-AUC</td> <td>Ranking quality matters (top-k)</td> </tr> <tr> <td><strong>Airbnb</strong></td> <td>Pricing</td> <td>MAE/RMSE</td> <td>Regression problem (not classification)</td> </tr> <tr> <td><strong>Uber</strong></td> <td>Fraud detection</td> <td>PR-AUC</td> <td>0.1% fraud (highly imbalanced)</td> </tr> </tbody> </table> <p><strong>Metric Selection Guide:</strong> - <strong>Balanced classes:</strong> Accuracy, F1 - <strong>Imbalanced classes:</strong> Precision, Recall, F1, PR-AUC - <strong>High FP cost:</strong> Precision (spam, medical diagnosis) - <strong>High FN cost:</strong> Recall (fraud, disease screening) - <strong>Ranking quality:</strong> ROC-AUC (recommendations, search) - <strong>Multiclass imbalanced:</strong> Weighted F1, Micro F1</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>accuracy is misleading for imbalanced data</strong> (use Precision/Recall/F1 instead)</li> <li>Chooses metrics <strong>based on business context</strong> (FP cost vs FN cost)</li> <li>Uses <strong>PR-AUC instead of ROC-AUC</strong> for highly imbalanced data (fraud, medical)</li> <li>Understands <strong>threshold tuning</strong> (lower threshold ‚Üí higher recall, higher threshold ‚Üí higher precision)</li> <li>Real-world: <strong>Stripe optimizes for 95%+ recall in fraud detection (missing fraud is costly)</strong></li> </ul> </div> </details> <hr> <h3 id=explain-ridge-vs-lasso-vs-elasticnet-google-amazon-interview-question>Explain Ridge vs Lasso vs ElasticNet - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Regularization</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <h2 id=overview_4>Overview</h2> <p><strong>Regularization</strong> prevents overfitting by penalizing large weights. Three main methods:</p> <ul> <li><strong>Ridge (L2):</strong> Shrinks all weights, but keeps all features (smooth shrinkage)</li> <li><strong>Lasso (L1):</strong> Sparse solution, drives some weights to exactly 0 (feature selection)</li> <li><strong>ElasticNet:</strong> Combines L1 + L2 (best of both, stable feature selection)</li> </ul> <p><strong>Real-World Context:</strong> - <strong>Netflix:</strong> Lasso for feature selection (10K+ features ‚Üí 100 important ones) - <strong>Google:</strong> Ridge for regularizing logistic regression (stable, all features) - <strong>Uber:</strong> ElasticNet for high-dimensional data with correlated features</p> <h2 id=mathematical-formulation>Mathematical Formulation</h2> <p><strong>Ridge (L2 Regularization):</strong> <span class=arithmatex>\(<span class=arithmatex>\(\min_w \|y - Xw\|^2 + \alpha \sum_{j=1}^p w_j^2\)</span>\)</span></p> <p><strong>Lasso (L1 Regularization):</strong> <span class=arithmatex>\(<span class=arithmatex>\(\min_w \|y - Xw\|^2 + \alpha \sum_{j=1}^p |w_j|\)</span>\)</span></p> <p><strong>ElasticNet (L1 + L2):</strong> <span class=arithmatex>\(<span class=arithmatex>\(\min_w \|y - Xw\|^2 + \alpha \left( \rho \sum_{j=1}^p |w_j| + \frac{1-\rho}{2} \sum_{j=1}^p w_j^2 \right)\)</span>\)</span></p> <p>Where: - <span class=arithmatex>\(\alpha\)</span> controls regularization strength (higher ‚Üí more shrinkage) - <span class=arithmatex>\(\rho\)</span> controls L1 vs L2 mix (0=Ridge, 1=Lasso)</p> <h2 id=ridge-vs-lasso-vs-elasticnet>Ridge vs Lasso vs ElasticNet</h2> <table> <thead> <tr> <th>Method</th> <th>Penalty</th> <th>Weights</th> <th>Feature Selection</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>Ridge (L2)</strong></td> <td><span class=arithmatex>\(\alpha \sum w^2\)</span></td> <td>Small, non-zero</td> <td>‚ùå No (keeps all)</td> <td>Multicollinearity, many weak features</td> </tr> <tr> <td><strong>Lasso (L1)</strong></td> <td>$\alpha \sum</td> <td>w</td> <td>$</td> <td>Sparse (many = 0)</td> </tr> <tr> <td><strong>ElasticNet</strong></td> <td><span class=arithmatex>\(\alpha (\rho L1 + (1-\rho) L2)\)</span></td> <td>Sparse + stable</td> <td>‚úÖ Yes (grouped)</td> <td>Correlated features, p &gt;&gt; n</td> </tr> </tbody> </table> <p><strong>Key Differences:</strong> - <strong>Ridge:</strong> Shrinks all weights smoothly, never exactly 0 - <strong>Lasso:</strong> Forces some weights to exactly 0 (automatic feature selection) - <strong>ElasticNet:</strong> Selects groups of correlated features (Lasso selects one randomly)</p> <h2 id=production-implementation-190-lines_1>Production Implementation (190 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># regularization_demo.py</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>Ridge</span><span class=p>,</span> <span class=n>Lasso</span><span class=p>,</span> <span class=n>ElasticNet</span><span class=p>,</span> <span class=n>RidgeCV</span><span class=p>,</span> <span class=n>LassoCV</span><span class=p>,</span> <span class=n>ElasticNetCV</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_regression</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>mean_squared_error</span><span class=p>,</span> <span class=n>r2_score</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_ridge</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Ridge Regression (L2): Shrinks all weights</span>

<span class=sd>    Use Case: Multicollinearity, many weak features</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Ridge Regression (L2 Regularization)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Dataset with multicollinearity</span>
    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>noise</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Try different alpha values</span>
    <span class=n>alphas</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.001</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>10.0</span><span class=p>,</span> <span class=mf>100.0</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Alpha&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train R¬≤&#39;</span><span class=si>:</span><span class=s2>&gt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test R¬≤&#39;</span><span class=si>:</span><span class=s2>&gt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Non-zero weights&#39;</span><span class=si>:</span><span class=s2>&gt;18</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>alpha</span> <span class=ow>in</span> <span class=n>alphas</span><span class=p>:</span>
        <span class=n>ridge</span> <span class=o>=</span> <span class=n>Ridge</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=n>alpha</span><span class=p>)</span>
        <span class=n>ridge</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_r2</span> <span class=o>=</span> <span class=n>ridge</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_r2</span> <span class=o>=</span> <span class=n>ridge</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=c1># Count non-zero weights (Ridge never makes weights exactly 0)</span>
        <span class=n>non_zero</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>ridge</span><span class=o>.</span><span class=n>coef_</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mf>1e-5</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>alpha</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_r2</span><span class=si>:</span><span class=s2>&gt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_r2</span><span class=si>:</span><span class=s2>&gt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>non_zero</span><span class=si>:</span><span class=s2>&gt;18</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Ridge shrinks weights but NEVER makes them exactly 0&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Higher alpha ‚Üí more shrinkage ‚Üí lower variance, higher bias&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_lasso</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Lasso Regression (L1): Sparse solution (automatic feature selection)</span>

<span class=sd>    Use Case: High-dimensional data, need interpretability</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. Lasso Regression (L1 Regularization)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>noise</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Try different alpha values</span>
    <span class=n>alphas</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.001</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>10.0</span><span class=p>,</span> <span class=mf>100.0</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Alpha&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train R¬≤&#39;</span><span class=si>:</span><span class=s2>&gt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test R¬≤&#39;</span><span class=si>:</span><span class=s2>&gt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Non-zero weights&#39;</span><span class=si>:</span><span class=s2>&gt;18</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>alpha</span> <span class=ow>in</span> <span class=n>alphas</span><span class=p>:</span>
        <span class=n>lasso</span> <span class=o>=</span> <span class=n>Lasso</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=n>alpha</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>)</span>
        <span class=n>lasso</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_r2</span> <span class=o>=</span> <span class=n>lasso</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_r2</span> <span class=o>=</span> <span class=n>lasso</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=c1># Count non-zero weights (Lasso drives many to exactly 0)</span>
        <span class=n>non_zero</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>lasso</span><span class=o>.</span><span class=n>coef_</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mf>1e-5</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>alpha</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_r2</span><span class=si>:</span><span class=s2>&gt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_r2</span><span class=si>:</span><span class=s2>&gt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>non_zero</span><span class=si>:</span><span class=s2>&gt;18</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Lasso drives many weights to EXACTLY 0 (automatic feature selection)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Higher alpha ‚Üí fewer selected features&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_elasticnet</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    ElasticNet: L1 + L2 (best of both)</span>

<span class=sd>    Use Case: Correlated features, need grouped selection</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. ElasticNet (L1 + L2)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Create correlated features</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>noise</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Add correlated features (groups)</span>
    <span class=n>X</span><span class=p>[:,</span> <span class=mi>10</span><span class=p>:</span><span class=mi>15</span><span class=p>]</span> <span class=o>=</span> <span class=n>X</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>:</span><span class=mi>5</span><span class=p>]</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>5</span><span class=p>))</span>  <span class=c1># Correlated with first 5</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Compare Lasso vs ElasticNet</span>
    <span class=n>models</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;Lasso&#39;</span><span class=p>:</span> <span class=n>Lasso</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>),</span>
        <span class=s1>&#39;ElasticNet (l1_ratio=0.5)&#39;</span><span class=p>:</span> <span class=n>ElasticNet</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>l1_ratio</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>),</span>
        <span class=s1>&#39;Ridge&#39;</span><span class=p>:</span> <span class=n>Ridge</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>
    <span class=p>}</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Model&#39;</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test R¬≤&#39;</span><span class=si>:</span><span class=s2>&gt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Non-zero&#39;</span><span class=si>:</span><span class=s2>&gt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>models</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>test_r2</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>non_zero</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>coef_</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mf>1e-5</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_r2</span><span class=si>:</span><span class=s2>&gt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>non_zero</span><span class=si>:</span><span class=s2>&gt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ ElasticNet balances sparsity (L1) and stability (L2)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Selects GROUPS of correlated features (Lasso picks one randomly)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_cv_versions</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    RidgeCV, LassoCV, ElasticNetCV: Automatic alpha selection</span>

<span class=sd>    Use Cross-Validation to choose best alpha</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. CV Versions (Automatic Alpha Selection)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>200</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>noise</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Define alpha search space</span>
    <span class=n>alphas</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>logspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>20</span><span class=p>)</span>  <span class=c1># [0.001, ..., 1000]</span>

    <span class=c1># RidgeCV</span>
    <span class=n>ridge_cv</span> <span class=o>=</span> <span class=n>RidgeCV</span><span class=p>(</span><span class=n>alphas</span><span class=o>=</span><span class=n>alphas</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
    <span class=n>ridge_cv</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># LassoCV</span>
    <span class=n>lasso_cv</span> <span class=o>=</span> <span class=n>LassoCV</span><span class=p>(</span><span class=n>alphas</span><span class=o>=</span><span class=n>alphas</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>lasso_cv</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># ElasticNetCV</span>
    <span class=n>elasticnet_cv</span> <span class=o>=</span> <span class=n>ElasticNetCV</span><span class=p>(</span><span class=n>alphas</span><span class=o>=</span><span class=n>alphas</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>l1_ratio</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>elasticnet_cv</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Model&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Best Alpha&#39;</span><span class=si>:</span><span class=s2>&gt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test R¬≤&#39;</span><span class=si>:</span><span class=s2>&gt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Non-zero&#39;</span><span class=si>:</span><span class=s2>&gt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=n>models_cv</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;RidgeCV&#39;</span><span class=p>:</span> <span class=n>ridge_cv</span><span class=p>,</span>
        <span class=s1>&#39;LassoCV&#39;</span><span class=p>:</span> <span class=n>lasso_cv</span><span class=p>,</span>
        <span class=s1>&#39;ElasticNetCV&#39;</span><span class=p>:</span> <span class=n>elasticnet_cv</span>
    <span class=p>}</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>models_cv</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>test_r2</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>non_zero</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>coef_</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mf>1e-5</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>model</span><span class=o>.</span><span class=n>alpha_</span><span class=si>:</span><span class=s2>&gt;15.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_r2</span><span class=si>:</span><span class=s2>&gt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>non_zero</span><span class=si>:</span><span class=s2>&gt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ CV versions automatically find best alpha via cross-validation&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Use these in production (no manual alpha tuning needed)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_feature_selection_with_lasso</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Lasso for feature selection: Which features are important?</span>

<span class=sd>    Use Case: Interpretability, reduce dimensionality</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. Feature Selection with Lasso&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Only first 10 features are informative</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>200</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
        <span class=n>noise</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Lasso with moderate alpha</span>
    <span class=n>lasso</span> <span class=o>=</span> <span class=n>LassoCV</span><span class=p>(</span><span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>lasso</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># Get selected features</span>
    <span class=n>selected_features</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>lasso</span><span class=o>.</span><span class=n>coef_</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mf>1e-5</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total features: 50&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Selected features: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>selected_features</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Selected indices: </span><span class=si>{</span><span class=n>selected_features</span><span class=p>[:</span><span class=mi>10</span><span class=p>]</span><span class=si>}</span><span class=s2>...&quot;</span><span class=p>)</span>  <span class=c1># Show first 10</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 5 feature weights:&quot;</span><span class=p>)</span>
    <span class=n>top5_idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>lasso</span><span class=o>.</span><span class=n>coef_</span><span class=p>))[</span><span class=o>-</span><span class=mi>5</span><span class=p>:][::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
    <span class=k>for</span> <span class=n>idx</span> <span class=ow>in</span> <span class=n>top5_idx</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Feature </span><span class=si>{</span><span class=n>idx</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>lasso</span><span class=o>.</span><span class=n>coef_</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Test R¬≤: </span><span class=si>{</span><span class=n>lasso</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span><span class=w> </span><span class=n>y_test</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Lasso automatically selected important features&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Use lasso.coef_ to see feature importance&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_when_to_use_which</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Decision guide: Ridge vs Lasso vs ElasticNet</span>

<span class=sd>    Based on data characteristics</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;6. When to Use Which?&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>decision_guide</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
<span class=s2>    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
<span class=s2>    ‚îÇ Use RIDGE when:                                             ‚îÇ</span>
<span class=s2>    ‚îÇ  ‚Ä¢ All features are (potentially) relevant                  ‚îÇ</span>
<span class=s2>    ‚îÇ  ‚Ä¢ Multicollinearity (correlated features)                  ‚îÇ</span>
<span class=s2>    ‚îÇ  ‚Ä¢ Don&#39;t need feature selection                             ‚îÇ</span>
<span class=s2>    ‚îÇ  ‚Ä¢ Example: Regularizing logistic regression at Google      ‚îÇ</span>
<span class=s2>    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>

<span class=s2>    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
<span class=s2>    ‚îÇ Use LASSO when:                                             ‚îÇ</span>
<span class=s2>    ‚îÇ  ‚Ä¢ High-dimensional data (p &gt;&gt; n)                           ‚îÇ</span>
<span class=s2>    ‚îÇ  ‚Ä¢ Need interpretability (sparse model)                     ‚îÇ</span>
<span class=s2>    ‚îÇ  ‚Ä¢ Believe many features are irrelevant                     ‚îÇ</span>
<span class=s2>    ‚îÇ  ‚Ä¢ Example: Netflix feature selection (10K ‚Üí 100 features)  ‚îÇ</span>
<span class=s2>    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>

<span class=s2>    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span>
<span class=s2>    ‚îÇ Use ELASTICNET when:                                        ‚îÇ</span>
<span class=s2>    ‚îÇ  ‚Ä¢ Groups of correlated features                            ‚îÇ</span>
<span class=s2>    ‚îÇ  ‚Ä¢ p &gt;&gt; n (like Lasso)                                      ‚îÇ</span>
<span class=s2>    ‚îÇ  ‚Ä¢ Want stability (Lasso unstable with correlated features) ‚îÇ</span>
<span class=s2>    ‚îÇ  ‚Ä¢ Example: Genomics (correlated genes)                     ‚îÇ</span>
<span class=s2>    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span>
<span class=s2>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=n>decision_guide</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_ridge</span><span class=p>()</span>
    <span class=n>demo_lasso</span><span class=p>()</span>
    <span class=n>demo_elasticnet</span><span class=p>()</span>
    <span class=n>demo_cv_versions</span><span class=p>()</span>
    <span class=n>demo_feature_selection_with_lasso</span><span class=p>()</span>
    <span class=n>demo_when_to_use_which</span><span class=p>()</span>
</code></pre></div> <h2 id=common-pitfalls-solutions_8>Common Pitfalls &amp; Solutions</h2> <table> <thead> <tr> <th>Pitfall</th> <th>Problem</th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td><strong>Not scaling features</strong></td> <td>Ridge/Lasso penalize large coefficients</td> <td>Use StandardScaler before regularization</td> </tr> <tr> <td><strong>Manual alpha tuning</strong></td> <td>Time-consuming, suboptimal</td> <td>Use RidgeCV/LassoCV (automatic)</td> </tr> <tr> <td><strong>Lasso with correlated features</strong></td> <td>Randomly selects one, drops others</td> <td>Use ElasticNet (selects groups)</td> </tr> <tr> <td><strong>Using alpha=1.0 default</strong></td> <td>Too strong regularization often</td> <td>Tune alpha (try logspace(-3, 3))</td> </tr> <tr> <td><strong>Ridge for feature selection</strong></td> <td>Never makes weights exactly 0</td> <td>Use Lasso or ElasticNet</td> </tr> </tbody> </table> <h2 id=real-world-performance_2>Real-World Performance</h2> <table> <thead> <tr> <th>Company</th> <th>Task</th> <th>Method</th> <th>Result</th> </tr> </thead> <tbody> <tr> <td><strong>Netflix</strong></td> <td>Feature selection (10K features)</td> <td>Lasso</td> <td>100 selected features, 95% of R¬≤</td> </tr> <tr> <td><strong>Google</strong></td> <td>Logistic regression regularization</td> <td>Ridge</td> <td>Prevents overfitting, stable</td> </tr> <tr> <td><strong>Uber</strong></td> <td>Pricing model (correlated features)</td> <td>ElasticNet</td> <td>Grouped selection, robust</td> </tr> <tr> <td><strong>Genomics</strong></td> <td>Gene expression (p=20K, n=100)</td> <td>ElasticNet</td> <td>Selects gene pathways (groups)</td> </tr> </tbody> </table> <p><strong>Key Insight:</strong> - <strong>Ridge (L2):</strong> Shrinks all weights, never 0 (multicollinearity) - <strong>Lasso (L1):</strong> Sparse solution, automatic feature selection - <strong>ElasticNet:</strong> Best for correlated features (grouped selection) - <strong>Always use CV versions</strong> (RidgeCV, LassoCV) for automatic alpha selection</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>L1 creates sparsity</strong> (drives weights to exactly 0, L2 does not)</li> <li>Uses <strong>CV versions</strong> (RidgeCV, LassoCV, ElasticNetCV) for automatic alpha selection</li> <li>Understands <strong>ElasticNet for correlated features</strong> (Lasso unstable, selects one randomly)</li> <li><strong>Scales features first</strong> (StandardScaler) before applying regularization</li> <li>Real-world: <strong>Netflix uses Lasso for feature selection (10K+ features ‚Üí 100 important)</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-implement-feature-selection-google-amazon-interview-question>How to Implement Feature Selection? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Feature Selection</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <h2 id=overview_5>Overview</h2> <p><strong>Feature selection</strong> reduces dimensionality by selecting the most relevant features. Three main approaches:</p> <ul> <li><strong>Filter methods:</strong> Statistical tests (fast, model-agnostic)</li> <li><strong>Wrapper methods:</strong> Search with model evaluation (slow, best performance)</li> <li><strong>Embedded methods:</strong> Built into model training (e.g., Lasso, tree importance)</li> </ul> <p><strong>Real-World Context:</strong> - <strong>Netflix:</strong> RFE for recommendation features (1000+ ‚Üí 50 features, 3% accuracy gain) - <strong>Google:</strong> SelectKBest for ad CTR prediction (fast preprocessing) - <strong>Uber:</strong> Random Forest feature importance for pricing (interpretability)</p> <h2 id=feature-selection-methods>Feature Selection Methods</h2> <table> <thead> <tr> <th>Method</th> <th>Type</th> <th>Speed</th> <th>Performance</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>SelectKBest</strong></td> <td>Filter</td> <td>‚ö° Fast</td> <td>Good</td> <td>Quick baseline, high-dim data</td> </tr> <tr> <td><strong>RFE</strong></td> <td>Wrapper</td> <td>üêå Slow</td> <td>Best</td> <td>Small-medium datasets, best accuracy</td> </tr> <tr> <td><strong>SelectFromModel</strong></td> <td>Embedded</td> <td>‚ö° Fast</td> <td>Good</td> <td>Tree/Lasso models, built-in importance</td> </tr> <tr> <td><strong>VarianceThreshold</strong></td> <td>Filter</td> <td>‚ö° Very fast</td> <td>-</td> <td>Remove low-variance features</td> </tr> <tr> <td><strong>SequentialFeatureSelector</strong></td> <td>Wrapper</td> <td>üêå Very slow</td> <td>Best</td> <td>Forward/backward search</td> </tr> </tbody> </table> <h2 id=filter-vs-wrapper-vs-embedded>Filter vs Wrapper vs Embedded</h2> <p><strong>Filter (Statistical Tests):</strong> - Independent of model - Fast (no model training) - May miss feature interactions - Example: SelectKBest (chi2, f_classif, mutual_info)</p> <p><strong>Wrapper (Search + Evaluate):</strong> - Uses model to evaluate subsets - Slow (trains many models) - Captures feature interactions - Example: RFE, SequentialFeatureSelector</p> <p><strong>Embedded (Model-Based):</strong> - Feature selection during training - Fast (one model training) - Model-specific - Example: Lasso, Random Forest importance</p> <h2 id=production-implementation-195-lines_2>Production Implementation (195 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># feature_selection_demo.py</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LogisticRegression</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.feature_selection</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
    <span class=n>SelectKBest</span><span class=p>,</span> <span class=n>f_classif</span><span class=p>,</span> <span class=n>chi2</span><span class=p>,</span> <span class=n>mutual_info_classif</span><span class=p>,</span>
    <span class=n>RFE</span><span class=p>,</span> <span class=n>SequentialFeatureSelector</span><span class=p>,</span>
    <span class=n>SelectFromModel</span><span class=p>,</span> <span class=n>VarianceThreshold</span>
<span class=p>)</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>accuracy_score</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_filter_selectkbest</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Filter Method: SelectKBest (statistical tests)</span>

<span class=sd>    Use Case: Fast preprocessing, high-dimensional data</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Filter Method: SelectKBest&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># High-dimensional dataset (100 features, only 10 informative)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Baseline: All features</span>
    <span class=n>rf_all</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>rf_all</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>acc_all</span> <span class=o>=</span> <span class=n>rf_all</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Baseline (all 100 features): </span><span class=si>{</span><span class=n>acc_all</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># SelectKBest with different scoring functions</span>
    <span class=n>scoring_funcs</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;f_classif (ANOVA)&#39;</span><span class=p>:</span> <span class=n>f_classif</span><span class=p>,</span>
        <span class=s1>&#39;mutual_info&#39;</span><span class=p>:</span> <span class=n>mutual_info_classif</span>
    <span class=p>}</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>score_func</span> <span class=ow>in</span> <span class=n>scoring_funcs</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>

        <span class=c1># Select top 20 features</span>
        <span class=n>selector</span> <span class=o>=</span> <span class=n>SelectKBest</span><span class=p>(</span><span class=n>score_func</span><span class=o>=</span><span class=n>score_func</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
        <span class=n>X_train_selected</span> <span class=o>=</span> <span class=n>selector</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>X_test_selected</span> <span class=o>=</span> <span class=n>selector</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

        <span class=n>elapsed</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

        <span class=c1># Train model on selected features</span>
        <span class=n>rf</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>rf</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_selected</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>acc</span> <span class=o>=</span> <span class=n>rf</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_selected</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>:&quot;</span><span class=p>)</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Selected features: </span><span class=si>{</span><span class=n>X_train_selected</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Accuracy: </span><span class=si>{</span><span class=n>acc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Time: </span><span class=si>{</span><span class=n>elapsed</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ SelectKBest is FAST (no model training)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Use f_classif for regression, chi2 for count data, mutual_info for general&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_wrapper_rfe</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Wrapper Method: RFE (Recursive Feature Elimination)</span>

<span class=sd>    Use Case: Best accuracy, captures feature interactions</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. Wrapper Method: RFE (Recursive Feature Elimination)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># RFE with LogisticRegression</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>

    <span class=n>rfe</span> <span class=o>=</span> <span class=n>RFE</span><span class=p>(</span>
        <span class=n>estimator</span><span class=o>=</span><span class=n>LogisticRegression</span><span class=p>(</span><span class=n>max_iter</span><span class=o>=</span><span class=mi>1000</span><span class=p>),</span>
        <span class=n>n_features_to_select</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span>
        <span class=n>step</span><span class=o>=</span><span class=mi>1</span>  <span class=c1># Remove 1 feature at a time</span>
    <span class=p>)</span>

    <span class=n>rfe</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=n>elapsed</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

    <span class=n>X_train_selected</span> <span class=o>=</span> <span class=n>rfe</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_selected</span> <span class=o>=</span> <span class=n>rfe</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Train final model</span>
    <span class=n>rf</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>rf</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_selected</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>acc</span> <span class=o>=</span> <span class=n>rf</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_selected</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=c1># Show selected features</span>
    <span class=n>selected_features</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>rfe</span><span class=o>.</span><span class=n>support_</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Selected features: </span><span class=si>{</span><span class=n>selected_features</span><span class=p>[:</span><span class=mi>10</span><span class=p>]</span><span class=si>}</span><span class=s2>... (</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>selected_features</span><span class=p>)</span><span class=si>}</span><span class=s2> total)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Accuracy: </span><span class=si>{</span><span class=n>acc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Time: </span><span class=si>{</span><span class=n>elapsed</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s (SLOW - trains many models)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ RFE captures feature interactions (model-based)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Slow but often best accuracy&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_embedded_selectfrommodel</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Embedded Method: SelectFromModel (model-based importance)</span>

<span class=sd>    Use Case: Fast, uses model&#39;s built-in feature importance</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. Embedded Method: SelectFromModel&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># SelectFromModel with Random Forest</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>

    <span class=c1># Train RF to get feature importances</span>
    <span class=n>rf_selector</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>selector</span> <span class=o>=</span> <span class=n>SelectFromModel</span><span class=p>(</span>
        <span class=n>estimator</span><span class=o>=</span><span class=n>rf_selector</span><span class=p>,</span>
        <span class=n>threshold</span><span class=o>=</span><span class=s1>&#39;mean&#39;</span>  <span class=c1># Select features above mean importance</span>
    <span class=p>)</span>

    <span class=n>selector</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=n>elapsed</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

    <span class=n>X_train_selected</span> <span class=o>=</span> <span class=n>selector</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_selected</span> <span class=o>=</span> <span class=n>selector</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Train final model</span>
    <span class=n>rf</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>rf</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_selected</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>acc</span> <span class=o>=</span> <span class=n>rf</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_selected</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Original features: </span><span class=si>{</span><span class=n>X_train</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Selected features: </span><span class=si>{</span><span class=n>X_train_selected</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Accuracy: </span><span class=si>{</span><span class=n>acc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Time: </span><span class=si>{</span><span class=n>elapsed</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>

    <span class=c1># Show top features by importance</span>
    <span class=n>importances</span> <span class=o>=</span> <span class=n>rf_selector</span><span class=o>.</span><span class=n>feature_importances_</span>
    <span class=n>top10_idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>importances</span><span class=p>)[</span><span class=o>-</span><span class=mi>10</span><span class=p>:][::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 10 features by importance:&quot;</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>idx</span> <span class=ow>in</span> <span class=n>top10_idx</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Feature </span><span class=si>{</span><span class=n>idx</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>importances</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ SelectFromModel uses model&#39;s built-in importance&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Fast (trains model once), works with tree/Lasso&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_variance_threshold</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    VarianceThreshold: Remove low-variance features</span>

<span class=sd>    Use Case: Remove constant/near-constant features (quick preprocessing)</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. VarianceThreshold (Remove Low-Variance Features)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Create dataset with some low-variance features</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Add constant and near-constant features</span>
    <span class=n>X</span><span class=p>[:,</span> <span class=mi>40</span><span class=p>]</span> <span class=o>=</span> <span class=mf>1.0</span>  <span class=c1># Constant feature</span>
    <span class=n>X</span><span class=p>[:,</span> <span class=mi>41</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>size</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=p>[</span><span class=mf>0.99</span><span class=p>,</span> <span class=mf>0.01</span><span class=p>])</span>  <span class=c1># Near-constant</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Original features: </span><span class=si>{</span><span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Remove features with variance &lt; 0.01</span>
    <span class=n>selector</span> <span class=o>=</span> <span class=n>VarianceThreshold</span><span class=p>(</span><span class=n>threshold</span><span class=o>=</span><span class=mf>0.01</span><span class=p>)</span>
    <span class=n>X_selected</span> <span class=o>=</span> <span class=n>selector</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Features after variance filter: </span><span class=si>{</span><span class=n>X_selected</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Removed </span><span class=si>{</span><span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>X_selected</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2> low-variance features&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ VarianceThreshold removes constant/near-constant features&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Very fast, good preprocessing step&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_comparison</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Compare all methods: Speed vs Accuracy</span>

<span class=sd>    Demonstrate tradeoffs</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. Method Comparison (Speed vs Accuracy)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>methods</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;All Features (baseline)&#39;</span><span class=p>:</span> <span class=kc>None</span><span class=p>,</span>
        <span class=s1>&#39;SelectKBest (k=20)&#39;</span><span class=p>:</span> <span class=n>SelectKBest</span><span class=p>(</span><span class=n>f_classif</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mi>20</span><span class=p>),</span>
        <span class=s1>&#39;RFE (n=20)&#39;</span><span class=p>:</span> <span class=n>RFE</span><span class=p>(</span><span class=n>LogisticRegression</span><span class=p>(</span><span class=n>max_iter</span><span class=o>=</span><span class=mi>1000</span><span class=p>),</span> <span class=n>n_features_to_select</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>step</span><span class=o>=</span><span class=mi>5</span><span class=p>),</span>
        <span class=s1>&#39;SelectFromModel (RF)&#39;</span><span class=p>:</span> <span class=n>SelectFromModel</span><span class=p>(</span><span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>))</span>
    <span class=p>}</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Method&#39;</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Features&#39;</span><span class=si>:</span><span class=s2>&gt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Accuracy&#39;</span><span class=si>:</span><span class=s2>&gt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Time (s)&#39;</span><span class=si>:</span><span class=s2>&gt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>selector</span> <span class=ow>in</span> <span class=n>methods</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>

        <span class=k>if</span> <span class=n>selector</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>X_train_sel</span> <span class=o>=</span> <span class=n>X_train</span>
            <span class=n>X_test_sel</span> <span class=o>=</span> <span class=n>X_test</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>X_train_sel</span> <span class=o>=</span> <span class=n>selector</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
            <span class=n>X_test_sel</span> <span class=o>=</span> <span class=n>selector</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

        <span class=c1># Train final model</span>
        <span class=n>rf</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>rf</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_sel</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>acc</span> <span class=o>=</span> <span class=n>rf</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_sel</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=n>elapsed</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>X_train_sel</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>&gt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>acc</span><span class=si>:</span><span class=s2>&gt;10.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>elapsed</span><span class=si>:</span><span class=s2>&gt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ SelectKBest: Fast, good baseline&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ RFE: Slow, often best accuracy&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ SelectFromModel: Fast, uses model importance&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_pipeline_integration</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Feature selection in Pipeline</span>

<span class=sd>    Ensures no data leakage during CV</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;6. Feature Selection in Pipeline (Best Practice)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>

    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Pipeline: scaling ‚Üí feature selection ‚Üí model</span>
    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
        <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>
        <span class=p>(</span><span class=s1>&#39;selector&#39;</span><span class=p>,</span> <span class=n>SelectKBest</span><span class=p>(</span><span class=n>f_classif</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mi>15</span><span class=p>)),</span>
        <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>))</span>
    <span class=p>])</span>

    <span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>acc</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Pipeline accuracy: </span><span class=si>{</span><span class=n>acc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Access selected features</span>
    <span class=n>selector</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>named_steps</span><span class=p>[</span><span class=s1>&#39;selector&#39;</span><span class=p>]</span>
    <span class=n>selected_features</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>selector</span><span class=o>.</span><span class=n>get_support</span><span class=p>())[</span><span class=mi>0</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Selected features: </span><span class=si>{</span><span class=n>selected_features</span><span class=p>[:</span><span class=mi>10</span><span class=p>]</span><span class=si>}</span><span class=s2>... (</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>selected_features</span><span class=p>)</span><span class=si>}</span><span class=s2> total)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Pipeline ensures feature selection only sees training data&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Prevents data leakage during cross-validation&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_filter_selectkbest</span><span class=p>()</span>
    <span class=n>demo_wrapper_rfe</span><span class=p>()</span>
    <span class=n>demo_embedded_selectfrommodel</span><span class=p>()</span>
    <span class=n>demo_variance_threshold</span><span class=p>()</span>
    <span class=n>demo_comparison</span><span class=p>()</span>
    <span class=n>demo_pipeline_integration</span><span class=p>()</span>
</code></pre></div> <h2 id=common-pitfalls-solutions_9>Common Pitfalls &amp; Solutions</h2> <table> <thead> <tr> <th>Pitfall</th> <th>Problem</th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td><strong>Feature selection before split</strong></td> <td>Data leakage (test data influences selection)</td> <td>Use Pipeline, fit on train only</td> </tr> <tr> <td><strong>Using RFE on huge datasets</strong></td> <td>Extremely slow (trains p models)</td> <td>Use SelectKBest or SelectFromModel</td> </tr> <tr> <td><strong>SelectKBest misses interactions</strong></td> <td>Independent statistical tests</td> <td>Use RFE or embedded methods</td> </tr> <tr> <td><strong>Ignoring VarianceThreshold</strong></td> <td>Waste time on constant features</td> <td>Always remove low-variance first</td> </tr> <tr> <td><strong>Not tuning k/threshold</strong></td> <td>Arbitrary cutoff (k=10)</td> <td>Use GridSearchCV to tune k</td> </tr> </tbody> </table> <h2 id=real-world-performance_3>Real-World Performance</h2> <table> <thead> <tr> <th>Company</th> <th>Method</th> <th>Task</th> <th>Result</th> </tr> </thead> <tbody> <tr> <td><strong>Netflix</strong></td> <td>RFE</td> <td>Recommendation (1000 features)</td> <td>50 selected, +3% accuracy</td> </tr> <tr> <td><strong>Google</strong></td> <td>SelectKBest</td> <td>Ad CTR (millions of features)</td> <td>Fast preprocessing, &lt;1s</td> </tr> <tr> <td><strong>Uber</strong></td> <td>Random Forest importance</td> <td>Pricing interpretability</td> <td>Top 20 features explain 90%</td> </tr> <tr> <td><strong>Genomics</strong></td> <td>Lasso (embedded)</td> <td>Gene selection (p=20K, n=100)</td> <td>50 genes selected</td> </tr> </tbody> </table> <p><strong>Decision Guide:</strong> - <strong>Need speed:</strong> SelectKBest, VarianceThreshold - <strong>Need best accuracy:</strong> RFE, SequentialFeatureSelector - <strong>Using trees/Lasso:</strong> SelectFromModel (embedded) - <strong>High-dimensional (p &gt;&gt; n):</strong> Lasso, SelectKBest - <strong>Always:</strong> Remove low-variance features first (VarianceThreshold)</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>filter/wrapper/embedded distinction</strong> (statistical vs model-based)</li> <li>Uses <strong>Pipeline</strong> to prevent data leakage (fit selector on train only)</li> <li>Understands <strong>tradeoffs</strong> (SelectKBest fast, RFE slow but accurate)</li> <li><strong>Tunes k/threshold</strong> with GridSearchCV (don't hardcode k=10)</li> <li>Real-world: <strong>Netflix uses RFE for feature selection (1000 ‚Üí 50 features, +3% accuracy)</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-save-and-load-models-most-tech-companies-interview-question>How to Save and Load Models? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Deployment</code> | <strong>Asked by:</strong> Most Tech Companies</p> <details class=success> <summary>View Answer</summary> <h2 id=overview_6>Overview</h2> <p><strong>Model persistence</strong> enables deploying trained models to production. Key methods:</p> <ul> <li><strong>joblib:</strong> Efficient for sklearn (optimized for NumPy arrays)</li> <li><strong>pickle:</strong> Python standard (less efficient for large arrays)</li> <li><strong>ONNX:</strong> Cross-platform (deploy sklearn to C++, Java, mobile)</li> </ul> <p><strong>Real-World:</strong> Netflix, Uber, Airbnb save thousands of models daily for A/B testing and deployment.</p> <h2 id=production-code-120-lines>Production Code (120 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># model_persistence.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>joblib</span>
<span class=kn>import</span><span class=w> </span><span class=nn>pickle</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
<span class=kn>import</span><span class=w> </span><span class=nn>json</span>
<span class=kn>from</span><span class=w> </span><span class=nn>datetime</span><span class=w> </span><span class=kn>import</span> <span class=n>datetime</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># Train example model</span>
<span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
<span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

<span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>
    <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>))</span>
<span class=p>])</span>

<span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

<span class=c1># Method 1: joblib (RECOMMENDED for sklearn)</span>
<span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>pipeline</span><span class=p>,</span> <span class=s1>&#39;model.joblib&#39;</span><span class=p>,</span> <span class=n>compress</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
<span class=n>loaded_model</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;model.joblib&#39;</span><span class=p>)</span>

<span class=c1># Method 2: pickle (standard Python)</span>
<span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;model.pkl&#39;</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
    <span class=n>pickle</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>pipeline</span><span class=p>,</span> <span class=n>f</span><span class=p>)</span>

<span class=c1># Method 3: Save with metadata (PRODUCTION BEST PRACTICE)</span>
<span class=n>metadata</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;model_type&#39;</span><span class=p>:</span> <span class=s1>&#39;RandomForestClassifier&#39;</span><span class=p>,</span>
    <span class=s1>&#39;sklearn_version&#39;</span><span class=p>:</span> <span class=s1>&#39;1.3.0&#39;</span><span class=p>,</span>
    <span class=s1>&#39;created_at&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>(),</span>
    <span class=s1>&#39;train_accuracy&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>pipeline</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)),</span>
    <span class=s1>&#39;test_accuracy&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>pipeline</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)),</span>
    <span class=s1>&#39;n_features&#39;</span><span class=p>:</span> <span class=n>X_train</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span>
    <span class=s1>&#39;feature_names&#39;</span><span class=p>:</span> <span class=p>[</span><span class=sa>f</span><span class=s1>&#39;feature_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>X_train</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])]</span>
<span class=p>}</span>

<span class=c1># Save model + metadata</span>
<span class=n>model_package</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;model&#39;</span><span class=p>:</span> <span class=n>pipeline</span><span class=p>,</span>
    <span class=s1>&#39;metadata&#39;</span><span class=p>:</span> <span class=n>metadata</span>
<span class=p>}</span>

<span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>model_package</span><span class=p>,</span> <span class=s1>&#39;model_with_metadata.joblib&#39;</span><span class=p>)</span>

<span class=c1># Load and validate</span>
<span class=n>loaded_package</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;model_with_metadata.joblib&#39;</span><span class=p>)</span>
<span class=n>loaded_model</span> <span class=o>=</span> <span class=n>loaded_package</span><span class=p>[</span><span class=s1>&#39;model&#39;</span><span class=p>]</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Loaded model trained at: </span><span class=si>{</span><span class=n>loaded_package</span><span class=p>[</span><span class=s1>&#39;metadata&#39;</span><span class=p>][</span><span class=s1>&#39;created_at&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Test accuracy: </span><span class=si>{</span><span class=n>loaded_package</span><span class=p>[</span><span class=s1>&#39;metadata&#39;</span><span class=p>][</span><span class=s1>&#39;test_accuracy&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># Verify model works</span>
<span class=n>predictions</span> <span class=o>=</span> <span class=n>loaded_model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Predictions shape: </span><span class=si>{</span><span class=n>predictions</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</code></pre></div> <h2 id=security-versioning>Security &amp; Versioning</h2> <table> <thead> <tr> <th>Concern</th> <th>Risk</th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td><strong>Pickle RCE</strong></td> <td>Malicious code execution</td> <td>Only load trusted models, use ONNX</td> </tr> <tr> <td><strong>Version mismatch</strong></td> <td>Model fails after sklearn upgrade</td> <td>Save sklearn version with model</td> </tr> <tr> <td><strong>Feature drift</strong></td> <td>New data has different features</td> <td>Save feature names, validate on load</td> </tr> <tr> <td><strong>Large models</strong></td> <td>Slow loading (&gt;1GB)</td> <td>Use joblib compress=3-9</td> </tr> </tbody> </table> <p><strong>Production Best Practice:</strong> <div class=highlight><pre><span></span><code><span class=c1># Save</span>
<span class=n>model_package</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;model&#39;</span><span class=p>:</span> <span class=n>pipeline</span><span class=p>,</span>
    <span class=s1>&#39;sklearn_version&#39;</span><span class=p>:</span> <span class=n>sklearn</span><span class=o>.</span><span class=n>__version__</span><span class=p>,</span>
    <span class=s1>&#39;feature_names&#39;</span><span class=p>:</span> <span class=n>feature_names</span><span class=p>,</span>
    <span class=s1>&#39;created_at&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
<span class=p>}</span>
<span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>model_package</span><span class=p>,</span> <span class=s1>&#39;model.joblib&#39;</span><span class=p>,</span> <span class=n>compress</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>

<span class=c1># Load and validate</span>
<span class=n>loaded</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;model.joblib&#39;</span><span class=p>)</span>
<span class=k>assert</span> <span class=n>loaded</span><span class=p>[</span><span class=s1>&#39;sklearn_version&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>sklearn</span><span class=o>.</span><span class=n>__version__</span><span class=p>,</span> <span class=s2>&quot;Version mismatch!&quot;</span>
</code></pre></div></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Uses <strong>joblib</strong> (not pickle) for sklearn models (10√ó faster for NumPy)</li> <li>Saves <strong>metadata</strong> (sklearn version, feature names, training date)</li> <li>Knows <strong>pickle security risk</strong> (arbitrary code execution, only load trusted models)</li> <li>Production: <strong>Netflix saves 1000+ models/day with versioning for A/B tests</strong></li> </ul> </div> </details> <hr> <h3 id=explain-random-forest-feature-importance-google-amazon-interview-question>Explain Random Forest Feature Importance - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Interpretability</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>MDI (feature_importances_):</strong> Fast but biased toward high-cardinality. <strong>Permutation:</strong> Unbiased, computed on test data (more reliable).</p> <div class=highlight><pre><span></span><code><span class=c1># MDI (built-in)</span>
<span class=n>importances</span> <span class=o>=</span> <span class=n>rf</span><span class=o>.</span><span class=n>feature_importances_</span>

<span class=c1># Permutation (recommended)</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.inspection</span><span class=w> </span><span class=kn>import</span> <span class=n>permutation_importance</span>
<span class=n>perm</span> <span class=o>=</span> <span class=n>permutation_importance</span><span class=p>(</span><span class=n>rf</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>,</span> <span class=n>n_repeats</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Knows <strong>MDI bias</strong> toward high-cardinality features. Uses <strong>permutation importance</strong> for unbiased ranking. Real-world: <strong>Uber uses permutation importance for pricing model interpretability (regulatory compliance)</strong>.</p> </div> </details> <hr> <h3 id=how-to-use-votingclassifier-google-amazon-interview-question>How to Use VotingClassifier? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Ensemble</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>VotingClassifier</strong> combines multiple models. <strong>Soft voting</strong> (average probabilities) usually better than <strong>hard voting</strong> (majority vote).</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>VotingClassifier</span>

<span class=n>voting</span> <span class=o>=</span> <span class=n>VotingClassifier</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;rf&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>()),</span>
    <span class=p>(</span><span class=s1>&#39;lr&#39;</span><span class=p>,</span> <span class=n>LogisticRegression</span><span class=p>()),</span>
    <span class=p>(</span><span class=s1>&#39;svc&#39;</span><span class=p>,</span> <span class=n>SVC</span><span class=p>(</span><span class=n>probability</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
<span class=p>],</span> <span class=n>voting</span><span class=o>=</span><span class=s1>&#39;soft&#39;</span><span class=p>)</span>  <span class=c1># soft = average probabilities</span>

<span class=n>voting</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
<span class=c1># Often 1-2% better than individual models</span>
</code></pre></div> <table> <thead> <tr> <th>Voting</th> <th>How It Works</th> <th>When to Use</th> </tr> </thead> <tbody> <tr> <td><strong>Hard</strong></td> <td>Majority vote</td> <td>Fast, discrete predictions</td> </tr> <tr> <td><strong>Soft</strong></td> <td>Average probabilities</td> <td>Better accuracy (if calibrated)</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses <strong>soft voting</strong> (average probabilities, usually better). Knows <strong>SVC needs probability=True</strong>. Real-world: <strong>Kaggle winners often use VotingClassifier (1-2% accuracy gain)</strong>.</p> </div> </details> <hr> <h3 id=how-to-detect-overfitting-most-tech-companies-interview-question>How to Detect Overfitting? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Model Selection</code> | <strong>Asked by:</strong> Most Tech Companies</p> <details class=success> <summary>View Answer</summary> <p><strong>Overfitting:</strong> High train accuracy, low test accuracy. <strong>Solutions:</strong> More data, regularization, simpler model, dropout, early stopping.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>learning_curve</span>

<span class=n>train_sizes</span><span class=p>,</span> <span class=n>train_scores</span><span class=p>,</span> <span class=n>val_scores</span> <span class=o>=</span> <span class=n>learning_curve</span><span class=p>(</span>
    <span class=n>model</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>train_sizes</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
<span class=p>)</span>

<span class=c1># Plot learning curves</span>
<span class=c1># High train, low val = overfit</span>
<span class=c1># Low train, low val = underfit</span>
<span class=c1># High train, high val (converged) = good fit</span>
</code></pre></div> <p><strong>Overfitting Mitigation:</strong> 1. <strong>More data</strong> (best solution, if possible) 2. <strong>Regularization</strong> (L1/L2, dropout) 3. <strong>Simpler model</strong> (fewer features, lower complexity) 4. <strong>Cross-validation</strong> (detect overfitting early) 5. <strong>Early stopping</strong> (neural networks)</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses <strong>learning curves</strong> to diagnose overfit/underfit. Knows <strong>multiple solutions</strong> (more data, regularization, simpler model). Real-world: <strong>Netflix uses learning curves to tune recommendation models</strong>.</p> </div> </details> <hr> <h3 id=how-to-handle-missing-values-google-amazon-interview-question>How to Handle Missing Values? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Imputation</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>SimpleImputer:</strong> Mean/median/mode (fast, simple). <strong>KNNImputer:</strong> Uses nearest neighbors (better for MCAR, slower). <strong>add_indicator:</strong> Preserve missingness info.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.impute</span><span class=w> </span><span class=kn>import</span> <span class=n>SimpleImputer</span><span class=p>,</span> <span class=n>KNNImputer</span>

<span class=c1># Method 1: SimpleImputer (fast)</span>
<span class=n>imputer</span> <span class=o>=</span> <span class=n>SimpleImputer</span><span class=p>(</span>
    <span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;median&#39;</span><span class=p>,</span>  <span class=c1># or &#39;mean&#39;, &#39;most_frequent&#39;</span>
    <span class=n>add_indicator</span><span class=o>=</span><span class=kc>True</span>  <span class=c1># Add missingness indicator</span>
<span class=p>)</span>

<span class=c1># Method 2: KNNImputer (better quality, slower)</span>
<span class=n>imputer</span> <span class=o>=</span> <span class=n>KNNImputer</span><span class=p>(</span><span class=n>n_neighbors</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>

<span class=c1># In Pipeline</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
<span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;median&#39;</span><span class=p>)),</span>
    <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>
    <span class=p>(</span><span class=s1>&#39;model&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>())</span>
<span class=p>])</span>
</code></pre></div> <p><strong>When to Use:</strong> - <strong>Mean:</strong> Numeric, normally distributed - <strong>Median:</strong> Numeric with outliers - <strong>Most_frequent:</strong> Categorical - <strong>KNNImputer:</strong> MCAR (missing completely at random), small datasets - <strong>add_indicator=True:</strong> Missingness is informative (e.g., "income missing" predicts default)</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses <strong>appropriate strategy</strong> (median for outliers, mode for categorical). Uses <strong>add_indicator=True</strong> to preserve missingness patterns. Knows <strong>KNNImputer</strong> for better quality (MCAR). Real-world: <strong>Airbnb uses add_indicator for pricing (missing amenities = lower price)</strong>.</p> </div> </details> <hr> <h3 id=how-to-debug-a-failing-model-google-amazon-interview-question>How to Debug a Failing Model? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Debugging</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Systematic Debugging:</strong> (1) Data quality checks, (2) Baseline comparison (DummyClassifier), (3) Learning curves (overfit?), (4) Error analysis, (5) Check data leakage.</p> <div class=highlight><pre><span></span><code><span class=c1># Step 1: Baseline comparison</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.dummy</span><span class=w> </span><span class=kn>import</span> <span class=n>DummyClassifier</span>
<span class=n>dummy</span> <span class=o>=</span> <span class=n>DummyClassifier</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;most_frequent&#39;</span><span class=p>)</span>
<span class=n>dummy</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Baseline: </span><span class=si>{</span><span class=n>dummy</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span><span class=w> </span><span class=n>y_test</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Your model: </span><span class=si>{</span><span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span><span class=w> </span><span class=n>y_test</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=c1># If similar ‚Üí model not learning!</span>

<span class=c1># Step 2: Learning curves (overfit detection)</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>learning_curve</span>
<span class=n>train_sizes</span><span class=p>,</span> <span class=n>train_scores</span><span class=p>,</span> <span class=n>val_scores</span> <span class=o>=</span> <span class=n>learning_curve</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>

<span class=c1># Step 3: Error analysis</span>
<span class=n>misclassified</span> <span class=o>=</span> <span class=n>X_test</span><span class=p>[</span><span class=n>y_pred</span> <span class=o>!=</span> <span class=n>y_test</span><span class=p>]</span>
<span class=c1># Inspect patterns in errors</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses <strong>DummyClassifier baseline</strong> (if model ‚âà baseline, not learning). Checks <strong>learning curves</strong> (overfit detection). Does <strong>error analysis</strong> on misclassified samples. Real-world: <strong>Google ML engineers always compare to baseline first</strong>.</p> </div> </details> <hr> <h3 id=explain-probability-calibration-google-netflix-interview-question>Explain probability calibration - Google, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Calibration</code> | <strong>Asked by:</strong> Google, Netflix, Stripe</p> <details class=success> <summary>View Answer</summary> <p><strong>Calibration:</strong> Predicted probabilities match true frequencies. <strong>Naive Bayes, SVM need calibration</strong>. <strong>Logistic Regression already calibrated</strong>.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.calibration</span><span class=w> </span><span class=kn>import</span> <span class=n>CalibratedClassifierCV</span><span class=p>,</span> <span class=n>calibration_curve</span>

<span class=c1># Calibrate model (Platt scaling or isotonic)</span>
<span class=n>calibrated</span> <span class=o>=</span> <span class=n>CalibratedClassifierCV</span><span class=p>(</span><span class=n>svm_model</span><span class=p>,</span> <span class=n>method</span><span class=o>=</span><span class=s1>&#39;sigmoid&#39;</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
<span class=n>calibrated</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

<span class=c1># Check calibration</span>
<span class=n>prob_true</span><span class=p>,</span> <span class=n>prob_pred</span> <span class=o>=</span> <span class=n>calibration_curve</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>probs</span><span class=p>,</span> <span class=n>n_bins</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
<span class=c1># Plot: perfect calibration = diagonal line</span>
</code></pre></div> <p><strong>When to Calibrate:</strong> - <strong>SVM, Naive Bayes:</strong> Need calibration (poorly calibrated) - <strong>Random Forest:</strong> Sometimes needs calibration (biased toward 0.5) - <strong>Logistic Regression:</strong> Usually well-calibrated</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Knows <strong>which models need calibration</strong> (SVM, NB yes; LR no). Uses <strong>calibration_curve</strong> to check. Real-world: <strong>Stripe calibrates fraud scores for threshold tuning</strong>.</p> </div> </details> <hr> <h3 id=how-to-use-columntransformer-google-amazon-interview-question>How to use ColumnTransformer? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Preprocessing</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>ColumnTransformer:</strong> Different preprocessing for different columns (numeric vs categorical).</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.compose</span><span class=w> </span><span class=kn>import</span> <span class=n>ColumnTransformer</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span><span class=p>,</span> <span class=n>OneHotEncoder</span>

<span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>(),</span> <span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>,</span> <span class=s1>&#39;income&#39;</span><span class=p>]),</span>
    <span class=p>(</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=n>OneHotEncoder</span><span class=p>(</span><span class=n>handle_unknown</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>),</span> <span class=p>[</span><span class=s1>&#39;city&#39;</span><span class=p>,</span> <span class=s1>&#39;category&#39;</span><span class=p>])</span>
<span class=p>],</span> <span class=n>remainder</span><span class=o>=</span><span class=s1>&#39;passthrough&#39;</span><span class=p>)</span>  <span class=c1># Keep remaining columns</span>

<span class=c1># In Pipeline</span>
<span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;preprocessor&#39;</span><span class=p>,</span> <span class=n>preprocessor</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>())</span>
<span class=p>])</span>
</code></pre></div> <p><strong>Key Parameters:</strong> - <strong>handle_unknown='ignore':</strong> Don't crash on new categories (production!) - <strong>remainder='passthrough':</strong> Keep untransformed columns - <strong>remainder='drop':</strong> Drop untransformed columns</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses <strong>ColumnTransformer</strong> for mixed types (numeric + categorical). Sets <strong>handle_unknown='ignore'</strong> for production robustness. Real-world: <strong>Airbnb uses ColumnTransformer for pricing (mixed numeric/categorical features)</strong>.</p> </div> </details> <hr> <h3 id=how-to-implement-multi-label-classification-google-amazon-interview-question>How to implement multi-label classification? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Multi-Label</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Multi-label:</strong> Each sample has multiple labels (e.g., movie tags: [action, comedy, thriller]). <strong>Multi-class:</strong> One label per sample.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.multioutput</span><span class=w> </span><span class=kn>import</span> <span class=n>MultiOutputClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>MultiLabelBinarizer</span>

<span class=c1># Example: Movie tags</span>
<span class=n>y_multilabel</span> <span class=o>=</span> <span class=p>[[</span><span class=s1>&#39;action&#39;</span><span class=p>,</span> <span class=s1>&#39;comedy&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;thriller&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;action&#39;</span><span class=p>,</span> <span class=s1>&#39;thriller&#39;</span><span class=p>]]</span>

<span class=c1># Binarize labels</span>
<span class=n>mlb</span> <span class=o>=</span> <span class=n>MultiLabelBinarizer</span><span class=p>()</span>
<span class=n>y_binary</span> <span class=o>=</span> <span class=n>mlb</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>y_multilabel</span><span class=p>)</span>
<span class=c1># [[1, 1, 0], [0, 0, 1], [1, 0, 1]]</span>

<span class=c1># Train model</span>
<span class=n>multi</span> <span class=o>=</span> <span class=n>MultiOutputClassifier</span><span class=p>(</span><span class=n>RandomForestClassifier</span><span class=p>())</span>
<span class=n>multi</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y_binary</span><span class=p>)</span>

<span class=c1># Metrics</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>hamming_loss</span><span class=p>,</span> <span class=n>f1_score</span>
<span class=n>hamming</span> <span class=o>=</span> <span class=n>hamming_loss</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>  <span class=c1># Fraction of wrong labels</span>
<span class=n>f1</span> <span class=o>=</span> <span class=n>f1_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>average</span><span class=o>=</span><span class=s1>&#39;samples&#39;</span><span class=p>)</span>  <span class=c1># Per-sample F1</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Distinguishes <strong>multi-label</strong> (multiple labels/sample) from <strong>multi-class</strong> (one label/sample). Uses <strong>hamming_loss, f1(average='samples')</strong>. Real-world: <strong>YouTube uses multi-label for video tags</strong>.</p> </div> </details> <hr> <h3 id=how-to-use-make_scorer-google-amazon-interview-question>How to use make_scorer? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Custom Metrics</code> | <strong>Asked by:</strong> Google, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>make_scorer:</strong> Create custom metrics for GridSearchCV (business-specific metrics).</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>make_scorer</span><span class=p>,</span> <span class=n>fbeta_score</span>

<span class=c1># F2 score (emphasize recall)</span>
<span class=n>f2_scorer</span> <span class=o>=</span> <span class=n>make_scorer</span><span class=p>(</span><span class=n>fbeta_score</span><span class=p>,</span> <span class=n>beta</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>

<span class=c1># Custom business metric (e.g., profit)</span>
<span class=k>def</span><span class=w> </span><span class=nf>profit_metric</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>):</span>
    <span class=c1># TP: $100 profit, FP: $10 loss</span>
    <span class=n>tp</span> <span class=o>=</span> <span class=p>((</span><span class=n>y_true</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>y_pred</span> <span class=o>==</span> <span class=mi>1</span><span class=p>))</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
    <span class=n>fp</span> <span class=o>=</span> <span class=p>((</span><span class=n>y_true</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>y_pred</span> <span class=o>==</span> <span class=mi>1</span><span class=p>))</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
    <span class=k>return</span> <span class=n>tp</span> <span class=o>*</span> <span class=mi>100</span> <span class=o>-</span> <span class=n>fp</span> <span class=o>*</span> <span class=mi>10</span>

<span class=n>profit_scorer</span> <span class=o>=</span> <span class=n>make_scorer</span><span class=p>(</span><span class=n>profit_metric</span><span class=p>,</span> <span class=n>greater_is_better</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Use in GridSearchCV</span>
<span class=n>GridSearchCV</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=n>profit_scorer</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</code></pre></div> <p><strong>Key Parameters:</strong> - <strong>greater_is_better=True:</strong> Higher is better (accuracy, profit) - <strong>greater_is_better=False:</strong> Lower is better (MSE, loss) - <strong>needs_proba=True:</strong> Scorer needs probabilities (not predictions)</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Creates <strong>business-specific metrics</strong> (e.g., profit = TP √ó value - FP √ó cost). Sets <strong>greater_is_better</strong> correctly. Real-world: <strong>Stripe optimizes for expected revenue (custom scorer)</strong>.</p> </div> </details> <hr> <h3 id=how-to-perform-polynomial-regression-most-tech-companies-interview-question>How to perform polynomial regression? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Regression</code> | <strong>Asked by:</strong> Most Tech Companies</p> <details class=success> <summary>View Answer</summary> <p><strong>Polynomial Regression:</strong> Fit non-linear relationships using polynomial features (x, x¬≤, x¬≥, ...).</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>PolynomialFeatures</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LinearRegression</span><span class=p>,</span> <span class=n>Ridge</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>

<span class=c1># Degree=2: y = Œ≤‚ÇÄ + Œ≤‚ÇÅx + Œ≤‚ÇÇx¬≤</span>
<span class=n>poly_pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;poly&#39;</span><span class=p>,</span> <span class=n>PolynomialFeatures</span><span class=p>(</span><span class=n>degree</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>include_bias</span><span class=o>=</span><span class=kc>False</span><span class=p>)),</span>
    <span class=p>(</span><span class=s1>&#39;ridge&#39;</span><span class=p>,</span> <span class=n>Ridge</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>1.0</span><span class=p>))</span>  <span class=c1># Regularize to prevent overfit</span>
<span class=p>])</span>

<span class=n>poly_pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

<span class=c1># Features generated: [x‚ÇÅ, x‚ÇÇ, x‚ÇÅ¬≤, x‚ÇÅx‚ÇÇ, x‚ÇÇ¬≤]</span>
</code></pre></div> <p><strong>Key Points:</strong> - <strong>degree=2:</strong> Quadratic (x, x¬≤), <strong>degree=3:</strong> Cubic (x, x¬≤, x¬≥) - <strong>include_bias=False:</strong> Don't add intercept column (LinearRegression adds it) - <strong>Regularization:</strong> Use Ridge/Lasso to prevent overfitting (high-degree polynomials) - <strong>Feature explosion:</strong> degree=3 with 10 features ‚Üí 286 features!</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses <strong>PolynomialFeatures in Pipeline</strong>. Sets <strong>include_bias=False</strong> (avoid duplicate intercept). Uses <strong>Ridge regularization</strong> to prevent overfitting. Real-world: <strong>Uber uses polynomial features for time-series demand forecasting</strong>.</p> </div> </details> <hr> <h3 id=how-to-compute-learning-curves-google-amazon-interview-question>How to compute learning curves? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Diagnostics</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Learning curves:</strong> Plot training/validation scores vs dataset size. Diagnose overfit (high train, low val) vs underfit (low train, low val).</p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>learning_curve</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>

<span class=n>train_sizes</span><span class=p>,</span> <span class=n>train_scores</span><span class=p>,</span> <span class=n>val_scores</span> <span class=o>=</span> <span class=n>learning_curve</span><span class=p>(</span>
    <span class=n>model</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span>
    <span class=n>train_sizes</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mi>10</span><span class=p>),</span>
    <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;accuracy&#39;</span>
<span class=p>)</span>

<span class=c1># Compute means</span>
<span class=n>train_mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>train_scores</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=n>val_mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>val_scores</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>

<span class=c1># Interpret:</span>
<span class=c1># - High train, low val ‚Üí OVERFIT (regularize, more data)</span>
<span class=c1># - Low train, low val ‚Üí UNDERFIT (more complex model)</span>
<span class=c1># - High train, high val (converged) ‚Üí GOOD FIT</span>
</code></pre></div> <p><strong>Diagnosis:</strong> - <strong>Overfit:</strong> Train score high (0.95), val score low (0.70) ‚Üí Add regularization, more data - <strong>Underfit:</strong> Train score low (0.65), val score low (0.60) ‚Üí More complex model - <strong>Good fit:</strong> Train/val converge at high score (both 0.85) ‚Üí Ideal!</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses <strong>learning curves</strong> for bias-variance diagnosis. Interprets <strong>gap between train/val</strong> (overfit if large gap). Knows <strong>solutions</strong> (overfit ‚Üí regularize/more data, underfit ‚Üí more features/complexity). Real-world: <strong>Netflix plots learning curves to decide if more user data will help</strong>.</p> </div> </details> <hr> <h3 id=how-to-use-smote-for-imbalanced-data-google-amazon-interview-question>How to use SMOTE for imbalanced data? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Imbalanced Data</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>imblearn.over_sampling</span><span class=w> </span><span class=kn>import</span> <span class=n>SMOTE</span>
<span class=kn>from</span><span class=w> </span><span class=nn>imblearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span> <span class=k>as</span> <span class=n>ImbPipeline</span>

<span class=c1># Resample</span>
<span class=n>smote</span> <span class=o>=</span> <span class=n>SMOTE</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
<span class=n>X_res</span><span class=p>,</span> <span class=n>y_res</span> <span class=o>=</span> <span class=n>smote</span><span class=o>.</span><span class=n>fit_resample</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>

<span class=c1># Pipeline (use imblearn Pipeline!)</span>
<span class=n>pipeline</span> <span class=o>=</span> <span class=n>ImbPipeline</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;smote&#39;</span><span class=p>,</span> <span class=n>SMOTE</span><span class=p>()),</span>
    <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>())</span>
<span class=p>])</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses imblearn Pipeline and applies SMOTE only on training data.</p> </div> </details> <hr> <h3 id=how-to-perform-stratified-sampling-most-tech-companies-interview-question>How to perform stratified sampling? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Data Splitting</code> | <strong>Asked by:</strong> Most Tech Companies</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>

<span class=c1># Stratified split (maintains class proportions)</span>
<span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>stratify</span><span class=o>=</span><span class=n>y</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
<span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses stratify parameter for imbalanced classification.</p> </div> </details> <hr> <h3 id=how-to-tune-hyperparameters-with-optunahalvinggridsearch-google-amazon-interview-question>How to tune hyperparameters with Optuna/HalvingGridSearch? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Hyperparameter Tuning</code> | <strong>Asked by:</strong> Google, Amazon</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.experimental</span><span class=w> </span><span class=kn>import</span> <span class=n>enable_halving_search_cv</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>HalvingGridSearchCV</span>

<span class=c1># Successive halving (faster)</span>
<span class=n>halving</span> <span class=o>=</span> <span class=n>HalvingGridSearchCV</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>param_grid</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>factor</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>

<span class=c1># Optuna integration</span>
<span class=kn>import</span><span class=w> </span><span class=nn>optuna</span>
<span class=k>def</span><span class=w> </span><span class=nf>objective</span><span class=p>(</span><span class=n>trial</span><span class=p>):</span>
    <span class=n>params</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;n_estimators&#39;</span><span class=p>:</span> <span class=n>trial</span><span class=o>.</span><span class=n>suggest_int</span><span class=p>(</span><span class=s1>&#39;n_estimators&#39;</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>500</span><span class=p>)}</span>
    <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=o>**</span><span class=n>params</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>cross_val_score</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>

<span class=n>study</span> <span class=o>=</span> <span class=n>optuna</span><span class=o>.</span><span class=n>create_study</span><span class=p>(</span><span class=n>direction</span><span class=o>=</span><span class=s1>&#39;maximize&#39;</span><span class=p>)</span>
<span class=n>study</span><span class=o>.</span><span class=n>optimize</span><span class=p>(</span><span class=n>objective</span><span class=p>,</span> <span class=n>n_trials</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Knows HalvingGridSearchCV and Optuna for efficient search.</p> </div> </details> <hr> <h3 id=how-to-implement-svm-classification-google-amazon-interview-question>How to implement SVM classification? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>SVM</code>, <code>Classification</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.svm</span><span class=w> </span><span class=kn>import</span> <span class=n>SVC</span><span class=p>,</span> <span class=n>LinearSVC</span>

<span class=c1># RBF kernel (non-linear)</span>
<span class=n>svc</span> <span class=o>=</span> <span class=n>SVC</span><span class=p>(</span><span class=n>kernel</span><span class=o>=</span><span class=s1>&#39;rbf&#39;</span><span class=p>,</span> <span class=n>C</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>gamma</span><span class=o>=</span><span class=s1>&#39;scale&#39;</span><span class=p>)</span>

<span class=c1># Linear (faster for large datasets)</span>
<span class=n>linear_svc</span> <span class=o>=</span> <span class=n>LinearSVC</span><span class=p>(</span><span class=n>C</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>

<span class=c1># For probabilities (slower)</span>
<span class=n>svc_proba</span> <span class=o>=</span> <span class=n>SVC</span><span class=p>(</span><span class=n>probability</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <p><strong>Kernels:</strong> linear, poly, rbf, sigmoid. Use rbf for most problems.</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses LinearSVC for large datasets and knows kernel selection.</p> </div> </details> <hr> <h3 id=how-to-implement-k-means-clustering-most-tech-companies-interview-question>How to implement K-Means clustering? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Clustering</code> | <strong>Asked by:</strong> Most Tech Companies</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.cluster</span><span class=w> </span><span class=kn>import</span> <span class=n>KMeans</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>silhouette_score</span>

<span class=n>kmeans</span> <span class=o>=</span> <span class=n>KMeans</span><span class=p>(</span><span class=n>n_clusters</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>init</span><span class=o>=</span><span class=s1>&#39;k-means++&#39;</span><span class=p>,</span> <span class=n>n_init</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
<span class=n>labels</span> <span class=o>=</span> <span class=n>kmeans</span><span class=o>.</span><span class=n>fit_predict</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>

<span class=c1># Evaluate</span>
<span class=n>inertia</span> <span class=o>=</span> <span class=n>kmeans</span><span class=o>.</span><span class=n>inertia_</span>  <span class=c1># Within-cluster sum of squares</span>
<span class=n>silhouette</span> <span class=o>=</span> <span class=n>silhouette_score</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>labels</span><span class=p>)</span>  <span class=c1># [-1, 1]</span>
</code></pre></div> <p>Use elbow method (inertia) or silhouette to choose k.</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses k-means++ initialization and knows evaluation metrics.</p> </div> </details> <hr> <h3 id=how-to-implement-pca-google-amazon-interview-question>How to implement PCA? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Dimensionality Reduction</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.decomposition</span><span class=w> </span><span class=kn>import</span> <span class=n>PCA</span>

<span class=c1># Reduce to n components</span>
<span class=n>pca</span> <span class=o>=</span> <span class=n>PCA</span><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=mi>50</span><span class=p>)</span>
<span class=n>X_reduced</span> <span class=o>=</span> <span class=n>pca</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>

<span class=c1># Keep 95% variance</span>
<span class=n>pca</span> <span class=o>=</span> <span class=n>PCA</span><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=mf>0.95</span><span class=p>)</span>

<span class=c1># Explained variance</span>
<span class=nb>print</span><span class=p>(</span><span class=n>pca</span><span class=o>.</span><span class=n>explained_variance_ratio_</span><span class=o>.</span><span class=n>cumsum</span><span class=p>())</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses variance ratio for component selection and knows when to use PCA.</p> </div> </details> <hr> <h3 id=how-to-implement-gradient-boosting-google-amazon-interview-question>How to implement Gradient Boosting? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Ensemble</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>GradientBoostingClassifier</span><span class=p>,</span> <span class=n>HistGradientBoostingClassifier</span>

<span class=c1># Standard (slower)</span>
<span class=n>gb</span> <span class=o>=</span> <span class=n>GradientBoostingClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>learning_rate</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>max_depth</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>

<span class=c1># Histogram-based (faster, handles missing values)</span>
<span class=n>hgb</span> <span class=o>=</span> <span class=n>HistGradientBoostingClassifier</span><span class=p>()</span>  <span class=c1># Native NA handling</span>
</code></pre></div> <p>For large data, use HistGradientBoosting or XGBoost/LightGBM.</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Knows HistGradientBoosting advantages and when to use external libraries.</p> </div> </details> <hr> <h3 id=how-to-implement-naive-bayes-most-tech-companies-interview-question>How to implement Naive Bayes? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Classification</code> | <strong>Asked by:</strong> Most Tech Companies</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.naive_bayes</span><span class=w> </span><span class=kn>import</span> <span class=n>GaussianNB</span><span class=p>,</span> <span class=n>MultinomialNB</span><span class=p>,</span> <span class=n>BernoulliNB</span>

<span class=c1># GaussianNB: continuous features (assumes normal distribution)</span>
<span class=n>gnb</span> <span class=o>=</span> <span class=n>GaussianNB</span><span class=p>()</span>

<span class=c1># MultinomialNB: text/count data</span>
<span class=n>mnb</span> <span class=o>=</span> <span class=n>MultinomialNB</span><span class=p>()</span>

<span class=c1># BernoulliNB: binary features</span>
<span class=n>bnb</span> <span class=o>=</span> <span class=n>BernoulliNB</span><span class=p>()</span>
</code></pre></div> <p>Fast, good baseline, works well for text classification.</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Chooses appropriate variant for data type.</p> </div> </details> <hr> <h3 id=how-to-implement-dbscan-clustering-google-amazon-interview-question>How to implement DBSCAN clustering? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Clustering</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.cluster</span><span class=w> </span><span class=kn>import</span> <span class=n>DBSCAN</span>

<span class=n>dbscan</span> <span class=o>=</span> <span class=n>DBSCAN</span><span class=p>(</span><span class=n>eps</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>min_samples</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
<span class=n>labels</span> <span class=o>=</span> <span class=n>dbscan</span><span class=o>.</span><span class=n>fit_predict</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>

<span class=n>n_clusters</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>labels</span><span class=p>))</span> <span class=o>-</span> <span class=p>(</span><span class=mi>1</span> <span class=k>if</span> <span class=o>-</span><span class=mi>1</span> <span class=ow>in</span> <span class=n>labels</span> <span class=k>else</span> <span class=mi>0</span><span class=p>)</span>
<span class=n>n_noise</span> <span class=o>=</span> <span class=p>(</span><span class=n>labels</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</code></pre></div> <p><strong>Advantages:</strong> Finds arbitrary shaped clusters, handles noise (-1 labels).</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Knows DBSCAN doesn't need k, handles outliers, and tunes eps.</p> </div> </details> <hr> <h3 id=how-to-implement-t-sne-google-amazon-interview-question>How to implement t-SNE? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Visualization</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.manifold</span><span class=w> </span><span class=kn>import</span> <span class=n>TSNE</span>

<span class=c1># Reduce to 2D for visualization</span>
<span class=n>tsne</span> <span class=o>=</span> <span class=n>TSNE</span><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>perplexity</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
<span class=n>X_embedded</span> <span class=o>=</span> <span class=n>tsne</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>

<span class=c1># Note: fit_transform only, no separate transform!</span>
</code></pre></div> <p><strong>Caution:</strong> Slow, only for visualization, non-deterministic, no out-of-sample.</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Knows t-SNE limitations and uses UMAP for speed/quality.</p> </div> </details> <hr> <h3 id=how-to-implement-knn-most-tech-companies-interview-question>How to implement KNN? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Classification</code>, <code>Regression</code> | <strong>Asked by:</strong> Most Tech Companies</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.neighbors</span><span class=w> </span><span class=kn>import</span> <span class=n>KNeighborsClassifier</span><span class=p>,</span> <span class=n>KNeighborsRegressor</span>

<span class=n>knn</span> <span class=o>=</span> <span class=n>KNeighborsClassifier</span><span class=p>(</span><span class=n>n_neighbors</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>weights</span><span class=o>=</span><span class=s1>&#39;distance&#39;</span><span class=p>,</span> <span class=n>metric</span><span class=o>=</span><span class=s1>&#39;euclidean&#39;</span><span class=p>)</span>
<span class=n>knn</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

<span class=c1># For large datasets, use ball_tree or kd_tree</span>
<span class=n>knn</span> <span class=o>=</span> <span class=n>KNeighborsClassifier</span><span class=p>(</span><span class=n>algorithm</span><span class=o>=</span><span class=s1>&#39;ball_tree&#39;</span><span class=p>)</span>
</code></pre></div> <p>Scale features first! KNN is sensitive to feature scales.</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Scales features and knows algorithm options for large data.</p> </div> </details> <hr> <h3 id=how-to-implement-isolation-forest-google-amazon-interview-question>How to implement Isolation Forest? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Anomaly Detection</code> | <strong>Asked by:</strong> Google, Amazon, Netflix</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>IsolationForest</span>

<span class=n>iso</span> <span class=o>=</span> <span class=n>IsolationForest</span><span class=p>(</span><span class=n>contamination</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
<span class=n>predictions</span> <span class=o>=</span> <span class=n>iso</span><span class=o>.</span><span class=n>fit_predict</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>  <span class=c1># -1 for anomalies, 1 for normal</span>

<span class=c1># Anomaly scores</span>
<span class=n>scores</span> <span class=o>=</span> <span class=n>iso</span><span class=o>.</span><span class=n>decision_function</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>  <span class=c1># Lower = more anomalous</span>
</code></pre></div> <p><strong>Advantages:</strong> No need for labels, works on high-dimensional data.</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses contamination parameter and understands isolation concept.</p> </div> </details> <hr> <h3 id=how-to-implement-label-propagation-google-amazon-interview-question>How to implement Label Propagation? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Semi-Supervised</code> | <strong>Asked by:</strong> Google, Amazon</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.semi_supervised</span><span class=w> </span><span class=kn>import</span> <span class=n>LabelPropagation</span><span class=p>,</span> <span class=n>LabelSpreading</span>

<span class=c1># -1 indicates unlabeled samples</span>
<span class=n>y_train</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>])</span>

<span class=n>lp</span> <span class=o>=</span> <span class=n>LabelPropagation</span><span class=p>()</span>
<span class=n>lp</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
<span class=n>predicted_labels</span> <span class=o>=</span> <span class=n>lp</span><span class=o>.</span><span class=n>transduction_</span>
</code></pre></div> <p>Uses graph-based approach to propagate labels to unlabeled samples.</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Knows semi-supervised learning use case (few labels, many unlabeled).</p> </div> </details> <hr> <h3 id=how-to-implement-one-class-svm-google-amazon-interview-question>How to implement One-Class SVM? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Anomaly Detection</code> | <strong>Asked by:</strong> Google, Amazon, Netflix</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.svm</span><span class=w> </span><span class=kn>import</span> <span class=n>OneClassSVM</span>

<span class=c1># Train on normal data only</span>
<span class=n>ocsvm</span> <span class=o>=</span> <span class=n>OneClassSVM</span><span class=p>(</span><span class=n>kernel</span><span class=o>=</span><span class=s1>&#39;rbf&#39;</span><span class=p>,</span> <span class=n>nu</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>
<span class=n>ocsvm</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_normal</span><span class=p>)</span>

<span class=c1># Predict</span>
<span class=n>predictions</span> <span class=o>=</span> <span class=n>ocsvm</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>  <span class=c1># -1 for anomalies</span>
</code></pre></div> <p><strong>nu:</strong> Upper bound on fraction of outliers.</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses for novelty detection (trained on normal only).</p> </div> </details> <hr> <h3 id=how-to-implement-target-encoding-google-amazon-interview-question>How to implement target encoding? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Feature Engineering</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>TargetEncoder</span>

<span class=c1># Encode categorical with target mean</span>
<span class=n>encoder</span> <span class=o>=</span> <span class=n>TargetEncoder</span><span class=p>(</span><span class=n>smooth</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>)</span>
<span class=n>X_encoded</span> <span class=o>=</span> <span class=n>encoder</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X</span><span class=p>[[</span><span class=s1>&#39;category&#39;</span><span class=p>]],</span> <span class=n>y</span><span class=p>)</span>

<span class=c1># Cross-fit to prevent leakage</span>
<span class=n>encoder</span> <span class=o>=</span> <span class=n>TargetEncoder</span><span class=p>(</span><span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</code></pre></div> <p><strong>Caution:</strong> Can cause leakage if not cross-fitted properly.</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses cross-validation to prevent target leakage.</p> </div> </details> <hr> <h3 id=how-to-compute-partial-dependence-plots-google-amazon-interview-question>How to compute partial dependence plots? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Interpretability</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.inspection</span><span class=w> </span><span class=kn>import</span> <span class=n>PartialDependenceDisplay</span><span class=p>,</span> <span class=n>partial_dependence</span>

<span class=c1># Compute</span>
<span class=n>features</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>)]</span>  <span class=c1># Feature indices</span>
<span class=n>pdp</span> <span class=o>=</span> <span class=n>PartialDependenceDisplay</span><span class=o>.</span><span class=n>from_estimator</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>features</span><span class=p>)</span>

<span class=c1># Or get raw values</span>
<span class=n>results</span> <span class=o>=</span> <span class=n>partial_dependence</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>features</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</code></pre></div> <p>Shows marginal effect of feature on prediction.</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses for model explanation and understanding feature effects.</p> </div> </details> <hr> <h3 id=how-to-implement-stratified-group-split-google-amazon-interview-question>How to implement stratified group split? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Cross-Validation</code> | <strong>Asked by:</strong> Google, Amazon</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>StratifiedGroupKFold</span>

<span class=c1># Stratified by y, no group leakage</span>
<span class=n>sgkf</span> <span class=o>=</span> <span class=n>StratifiedGroupKFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
<span class=k>for</span> <span class=n>train_idx</span><span class=p>,</span> <span class=n>test_idx</span> <span class=ow>in</span> <span class=n>sgkf</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>groups</span><span class=p>):</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=n>train_idx</span><span class=p>],</span> <span class=n>X</span><span class=p>[</span><span class=n>test_idx</span><span class=p>]</span>
</code></pre></div> <p>Use when you have groups AND imbalanced classes.</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Knows when to combine stratification with grouping.</p> </div> </details> <hr> <h3 id=how-to-implement-validation-curves-google-amazon-interview-question>How to implement validation curves? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Diagnostics</code> | <strong>Asked by:</strong> Google, Amazon</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>validation_curve</span>

<span class=n>param_range</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>]</span>
<span class=n>train_scores</span><span class=p>,</span> <span class=n>val_scores</span> <span class=o>=</span> <span class=n>validation_curve</span><span class=p>(</span>
    <span class=n>model</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span>
    <span class=n>param_name</span><span class=o>=</span><span class=s1>&#39;n_estimators&#39;</span><span class=p>,</span>
    <span class=n>param_range</span><span class=o>=</span><span class=n>param_range</span><span class=p>,</span>
    <span class=n>cv</span><span class=o>=</span><span class=mi>5</span>
<span class=p>)</span>
</code></pre></div> <p>Shows how one hyperparameter affects train/val performance.</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses to check overfitting vs hyperparameter value.</p> </div> </details> <hr> <h3 id=how-to-implement-decision-boundary-visualization-most-tech-companies-interview-question>How to implement decision boundary visualization? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Visualization</code> | <strong>Asked by:</strong> Most Tech Companies</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.inspection</span><span class=w> </span><span class=kn>import</span> <span class=n>DecisionBoundaryDisplay</span>

<span class=c1># For 2D data</span>
<span class=n>DecisionBoundaryDisplay</span><span class=o>.</span><span class=n>from_estimator</span><span class=p>(</span>
    <span class=n>model</span><span class=p>,</span> <span class=n>X</span><span class=p>[:,</span> <span class=p>:</span><span class=mi>2</span><span class=p>],</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>,</span>
    <span class=n>response_method</span><span class=o>=</span><span class=s1>&#39;predict&#39;</span><span class=p>,</span>
    <span class=n>cmap</span><span class=o>=</span><span class=n>plt</span><span class=o>.</span><span class=n>cm</span><span class=o>.</span><span class=n>RdYlBu</span>
<span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>X</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>c</span><span class=o>=</span><span class=n>y</span><span class=p>,</span> <span class=n>edgecolor</span><span class=o>=</span><span class=s1>&#39;black&#39;</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses for model explanation in 2D feature space.</p> </div> </details> <hr> <h3 id=how-to-implement-neural-network-classifier-google-amazon-interview-question>How to implement neural network classifier? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Neural Networks</code> | <strong>Asked by:</strong> Google, Amazon</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.neural_network</span><span class=w> </span><span class=kn>import</span> <span class=n>MLPClassifier</span>

<span class=n>mlp</span> <span class=o>=</span> <span class=n>MLPClassifier</span><span class=p>(</span>
    <span class=n>hidden_layer_sizes</span><span class=o>=</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>50</span><span class=p>),</span>
    <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;relu&#39;</span><span class=p>,</span>
    <span class=n>solver</span><span class=o>=</span><span class=s1>&#39;adam&#39;</span><span class=p>,</span>
    <span class=n>max_iter</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span>
    <span class=n>early_stopping</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>
</code></pre></div> <p>For serious deep learning, use PyTorch/TensorFlow instead.</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Knows sklearn MLP limitations vs deep learning frameworks.</p> </div> </details> <hr> <h3 id=how-to-implement-threshold-tuning-google-netflix-interview-question>How to implement threshold tuning? - Google, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Optimization</code> | <strong>Asked by:</strong> Google, Netflix, Stripe</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>precision_recall_curve</span>

<span class=c1># Get probabilities</span>
<span class=n>probas</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>]</span>

<span class=c1># Find optimal threshold for F1</span>
<span class=n>precisions</span><span class=p>,</span> <span class=n>recalls</span><span class=p>,</span> <span class=n>thresholds</span> <span class=o>=</span> <span class=n>precision_recall_curve</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>probas</span><span class=p>)</span>
<span class=n>f1_scores</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=p>(</span><span class=n>precisions</span> <span class=o>*</span> <span class=n>recalls</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>precisions</span> <span class=o>+</span> <span class=n>recalls</span><span class=p>)</span>
<span class=n>optimal_idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>f1_scores</span><span class=p>)</span>
<span class=n>optimal_threshold</span> <span class=o>=</span> <span class=n>thresholds</span><span class=p>[</span><span class=n>optimal_idx</span><span class=p>]</span>

<span class=c1># Apply threshold</span>
<span class=n>predictions</span> <span class=o>=</span> <span class=p>(</span><span class=n>probas</span> <span class=o>&gt;=</span> <span class=n>optimal_threshold</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Knows default 0.5 threshold is often suboptimal.</p> </div> </details> <hr> <h3 id=how-to-implement-cost-sensitive-classification-google-amazon-interview-question>How to implement cost-sensitive classification? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Imbalanced Data</code> | <strong>Asked by:</strong> Google, Amazon</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=c1># Using sample_weight</span>
<span class=n>weights</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>y</span> <span class=o>==</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>  <span class=c1># Weight positive class more</span>
<span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>sample_weight</span><span class=o>=</span><span class=n>weights</span><span class=p>)</span>

<span class=c1># Using class_weight</span>
<span class=n>model</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>class_weight</span><span class=o>=</span><span class=p>{</span><span class=mi>0</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>:</span> <span class=mi>10</span><span class=p>})</span>

<span class=c1># Custom business loss</span>
<span class=k>def</span><span class=w> </span><span class=nf>business_cost</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>):</span>
    <span class=n>fp_cost</span> <span class=o>=</span> <span class=mi>10</span>
    <span class=n>fn_cost</span> <span class=o>=</span> <span class=mi>100</span>
    <span class=n>fp</span> <span class=o>=</span> <span class=p>((</span><span class=n>y_pred</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>y_true</span> <span class=o>==</span> <span class=mi>0</span><span class=p>))</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
    <span class=n>fn</span> <span class=o>=</span> <span class=p>((</span><span class=n>y_pred</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>y_true</span> <span class=o>==</span> <span class=mi>1</span><span class=p>))</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
    <span class=k>return</span> <span class=n>fp</span> <span class=o>*</span> <span class=n>fp_cost</span> <span class=o>+</span> <span class=n>fn</span> <span class=o>*</span> <span class=n>fn_cost</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses sample_weight for business-specific costs.</p> </div> </details> <hr> <h3 id=how-to-implement-leaveoneout-cv-google-amazon-interview-question>How to implement LeaveOneOut CV? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Cross-Validation</code> | <strong>Asked by:</strong> Google, Amazon</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>LeaveOneOut</span><span class=p>,</span> <span class=n>cross_val_score</span>

<span class=n>loo</span> <span class=o>=</span> <span class=n>LeaveOneOut</span><span class=p>()</span>
<span class=n>scores</span> <span class=o>=</span> <span class=n>cross_val_score</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=n>loo</span><span class=p>)</span>

<span class=c1># Computationally expensive! n folds for n samples</span>
<span class=c1># Use for small datasets only</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Knows LOO is for small datasets and its variance characteristics.</p> </div> </details> <hr> <h3 id=how-to-implement-confusion-matrix-visualization-most-tech-companies-interview-question>How to implement confusion matrix visualization? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Visualization</code> | <strong>Asked by:</strong> Most Tech Companies</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>ConfusionMatrixDisplay</span><span class=p>,</span> <span class=n>confusion_matrix</span>

<span class=n>cm</span> <span class=o>=</span> <span class=n>confusion_matrix</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>predictions</span><span class=p>)</span>
<span class=n>disp</span> <span class=o>=</span> <span class=n>ConfusionMatrixDisplay</span><span class=p>(</span><span class=n>cm</span><span class=p>,</span> <span class=n>display_labels</span><span class=o>=</span><span class=n>model</span><span class=o>.</span><span class=n>classes_</span><span class=p>)</span>
<span class=n>disp</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;Blues&#39;</span><span class=p>)</span>

<span class=c1># Or directly</span>
<span class=n>ConfusionMatrixDisplay</span><span class=o>.</span><span class=n>from_predictions</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>predictions</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses visualization for clear communication of results.</p> </div> </details> <hr> <h3 id=how-to-implement-precision-recall-curves-google-netflix-interview-question>How to implement precision-recall curves? - Google, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Evaluation</code> | <strong>Asked by:</strong> Google, Netflix</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>PrecisionRecallDisplay</span>

<span class=c1># From estimator</span>
<span class=n>PrecisionRecallDisplay</span><span class=o>.</span><span class=n>from_estimator</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

<span class=c1># From predictions</span>
<span class=n>PrecisionRecallDisplay</span><span class=o>.</span><span class=n>from_predictions</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>probas</span><span class=p>)</span>

<span class=c1># Average Precision</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>average_precision_score</span>
<span class=n>ap</span> <span class=o>=</span> <span class=n>average_precision_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>probas</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Uses PR curves for imbalanced data instead of ROC.</p> </div> </details> <hr> <h3 id=how-to-implement-model-calibration-check-google-netflix-interview-question>How to implement model calibration check? - Google, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Calibration</code> | <strong>Asked by:</strong> Google, Netflix</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.calibration</span><span class=w> </span><span class=kn>import</span> <span class=n>CalibrationDisplay</span>

<span class=c1># Compare calibration of multiple models</span>
<span class=n>fig</span><span class=p>,</span> <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>()</span>
<span class=n>CalibrationDisplay</span><span class=o>.</span><span class=n>from_estimator</span><span class=p>(</span><span class=n>model1</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;RF&#39;</span><span class=p>)</span>
<span class=n>CalibrationDisplay</span><span class=o>.</span><span class=n>from_estimator</span><span class=p>(</span><span class=n>model2</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;LR&#39;</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Compares calibration across models for probability quality.</p> </div> </details> <hr> <h3 id=how-to-implement-cross_validate-for-multiple-metrics-google-amazon-interview-question>How to implement cross_validate for multiple metrics? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Evaluation</code> | <strong>Asked by:</strong> Google, Amazon</p> <details class=success> <summary>View Answer</summary> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>cross_validate</span>

<span class=n>scoring</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;accuracy&#39;</span><span class=p>,</span> <span class=s1>&#39;precision&#39;</span><span class=p>,</span> <span class=s1>&#39;recall&#39;</span><span class=p>,</span> <span class=s1>&#39;f1&#39;</span><span class=p>,</span> <span class=s1>&#39;roc_auc&#39;</span><span class=p>]</span>
<span class=n>results</span> <span class=o>=</span> <span class=n>cross_validate</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=n>scoring</span><span class=p>,</span> <span class=n>return_train_score</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=k>for</span> <span class=n>metric</span> <span class=ow>in</span> <span class=n>scoring</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>metric</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>results</span><span class=p>[</span><span class=sa>f</span><span class=s1>&#39;test_</span><span class=si>{</span><span class=n>metric</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p>Evaluates multiple metrics in one call efficiently.</p> </div> </details> <hr> <h3 id=how-to-implement-linear-regression-most-tech-companies-interview-question>How to implement Linear Regression? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Linear Regression</code>, <code>Supervised Learning</code> | <strong>Asked by:</strong> Most Tech Companies</p> <details class=success> <summary>View Answer</summary> <p><strong>Linear Regression</strong> models the relationship between features and target as a linear combination: <span class=arithmatex>\(y = \beta_0 + \beta_1 x_1 + ... + \beta_p x_p\)</span>. It finds coefficients by minimizing <strong>Mean Squared Error (MSE)</strong> using Ordinary Least Squares (OLS): <span class=arithmatex>\(\beta = (X^TX)^{-1}X^Ty\)</span>.</p> <p><strong>Real-World Context:</strong> - <strong>Zillow:</strong> House price prediction (R¬≤=0.82, 1M+ predictions/day) - <strong>Airbnb:</strong> Nightly pricing estimation (10+ features, &lt;5ms latency) - <strong>Tesla:</strong> Battery range forecasting (temperature, speed, terrain)</p> <h2 id=linear-regression-workflow>Linear Regression Workflow</h2> <div class=highlight><pre><span></span><code>Raw Data
   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Check Assumptions      ‚îÇ
‚îÇ ‚úì Linearity           ‚îÇ
‚îÇ ‚úì Independence        ‚îÇ
‚îÇ ‚úì Homoscedasticity    ‚îÇ
‚îÇ ‚úì Normality (errors)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Feature Engineering    ‚îÇ
‚îÇ - Handle outliers      ‚îÇ
‚îÇ - Scale features       ‚îÇ
‚îÇ - Create interactions  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Fit: Œ≤ = (X&#39;X)‚Åª¬πX&#39;y   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Evaluate               ‚îÇ
‚îÇ - R¬≤ score            ‚îÇ
‚îÇ - RMSE, MAE           ‚îÇ
‚îÇ - Residual plots      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</code></pre></div> <h2 id=production-implementation-180-lines_2>Production Implementation (180 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># linear_regression_complete.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LinearRegression</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>cross_val_score</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>mean_squared_error</span><span class=p>,</span> <span class=n>r2_score</span><span class=p>,</span> <span class=n>mean_absolute_error</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<span class=kn>from</span><span class=w> </span><span class=nn>scipy</span><span class=w> </span><span class=kn>import</span> <span class=n>stats</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_basic_linear_regression</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Basic Linear Regression: House Price Prediction</span>

<span class=sd>    Use Case: Real estate price modeling</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Basic Linear Regression - House Prices&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Realistic housing dataset</span>
    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>n_samples</span> <span class=o>=</span> <span class=mi>1000</span>

    <span class=c1># Features: sq_ft, bedrooms, age, distance_to_city</span>
    <span class=n>sq_ft</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=mi>500</span><span class=p>,</span> <span class=mi>5000</span><span class=p>,</span> <span class=n>n_samples</span><span class=p>)</span>
    <span class=n>bedrooms</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=n>n_samples</span><span class=p>)</span>
    <span class=n>age</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=n>n_samples</span><span class=p>)</span>
    <span class=n>distance</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=n>n_samples</span><span class=p>)</span>

    <span class=c1># True relationship with noise</span>
    <span class=n>price</span> <span class=o>=</span> <span class=p>(</span>
        <span class=mi>200</span> <span class=o>*</span> <span class=n>sq_ft</span> <span class=o>+</span>           <span class=c1># $200 per sq ft</span>
        <span class=mi>50000</span> <span class=o>*</span> <span class=n>bedrooms</span> <span class=o>+</span>      <span class=c1># $50k per bedroom</span>
        <span class=o>-</span><span class=mi>2000</span> <span class=o>*</span> <span class=n>age</span> <span class=o>+</span>           <span class=c1># -$2k per year</span>
        <span class=o>-</span><span class=mi>1000</span> <span class=o>*</span> <span class=n>distance</span> <span class=o>+</span>      <span class=c1># -$1k per mile</span>
        <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>50000</span><span class=p>,</span> <span class=n>n_samples</span><span class=p>)</span>  <span class=c1># Noise</span>
    <span class=p>)</span>

    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>sq_ft</span><span class=p>,</span> <span class=n>bedrooms</span><span class=p>,</span> <span class=n>age</span><span class=p>,</span> <span class=n>distance</span><span class=p>])</span>
    <span class=n>y</span> <span class=o>=</span> <span class=n>price</span>

    <span class=c1># Split data</span>
    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span>
        <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=c1># Train model</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
    <span class=n>lr</span> <span class=o>=</span> <span class=n>LinearRegression</span><span class=p>()</span>
    <span class=n>lr</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>train_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

    <span class=c1># Predictions</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
    <span class=n>y_pred</span> <span class=o>=</span> <span class=n>lr</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
    <span class=n>inference_time</span> <span class=o>=</span> <span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Evaluation</span>
    <span class=n>r2</span> <span class=o>=</span> <span class=n>r2_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
    <span class=n>rmse</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>mean_squared_error</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>))</span>
    <span class=n>mae</span> <span class=o>=</span> <span class=n>mean_absolute_error</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Model Performance:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  R¬≤ Score: </span><span class=si>{</span><span class=n>r2</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  RMSE: $</span><span class=si>{</span><span class=n>rmse</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  MAE: $</span><span class=si>{</span><span class=n>mae</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Speed:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Training: </span><span class=si>{</span><span class=n>train_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Inference: </span><span class=si>{</span><span class=n>inference_time</span><span class=o>*</span><span class=mi>1000</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>ms per prediction&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Coefficients:&quot;</span><span class=p>)</span>
    <span class=n>feature_names</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;sq_ft&#39;</span><span class=p>,</span> <span class=s1>&#39;bedrooms&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>,</span> <span class=s1>&#39;distance_to_city&#39;</span><span class=p>]</span>
    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>coef</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>feature_names</span><span class=p>,</span> <span class=n>lr</span><span class=o>.</span><span class=n>coef_</span><span class=p>):</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>: $</span><span class=si>{</span><span class=n>coef</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Intercept: $</span><span class=si>{</span><span class=n>lr</span><span class=o>.</span><span class=n>intercept_</span><span class=si>:</span><span class=s2>,.2f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Linear Regression: Fast, interpretable, good baseline&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_assumption_checking</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Check Linear Regression Assumptions</span>

<span class=sd>    Critical for valid inference</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. Assumption Checking (Critical!)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Generate data</span>
    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>200</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
    <span class=n>y</span> <span class=o>=</span> <span class=mi>2</span><span class=o>*</span><span class=n>X</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=mi>3</span><span class=o>*</span><span class=n>X</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=n>X</span><span class=p>[:,</span> <span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>200</span><span class=p>)</span> <span class=o>*</span> <span class=mf>0.5</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>lr</span> <span class=o>=</span> <span class=n>LinearRegression</span><span class=p>()</span>
    <span class=n>lr</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># Get residuals</span>
    <span class=n>y_pred_train</span> <span class=o>=</span> <span class=n>lr</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>residuals</span> <span class=o>=</span> <span class=n>y_train</span> <span class=o>-</span> <span class=n>y_pred_train</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Assumption Tests:&quot;</span><span class=p>)</span>

    <span class=c1># 1. Linearity (residuals vs fitted values)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>1. Linearity:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;   Plot residuals vs fitted values&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;   ‚úì Random scatter = linear relationship&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;   ‚úó Pattern = non-linear (try polynomial)&quot;</span><span class=p>)</span>

    <span class=c1># 2. Independence (Durbin-Watson test)</span>
    <span class=n>dw_stat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>diff</span><span class=p>(</span><span class=n>residuals</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>residuals</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>2. Independence (Durbin-Watson): </span><span class=si>{</span><span class=n>dw_stat</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;   ‚úì Close to 2.0 = independent&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;   ‚úó &lt;&lt; 2 or &gt;&gt; 2 = autocorrelation&quot;</span><span class=p>)</span>

    <span class=c1># 3. Homoscedasticity (constant variance)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>3. Homoscedasticity:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;   Residuals should have constant variance&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;   ‚úì Even spread across fitted values&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;   ‚úó Funnel shape = heteroscedasticity (use WLS)&quot;</span><span class=p>)</span>

    <span class=c1># 4. Normality of residuals (Shapiro-Wilk test)</span>
    <span class=n>shapiro_stat</span><span class=p>,</span> <span class=n>shapiro_p</span> <span class=o>=</span> <span class=n>stats</span><span class=o>.</span><span class=n>shapiro</span><span class=p>(</span><span class=n>residuals</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>4. Normality (Shapiro-Wilk p-value): </span><span class=si>{</span><span class=n>shapiro_p</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;   ‚úì p &gt; 0.05 = normal&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;   ‚úó p &lt; 0.05 = non-normal (large n: CLT helps)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Always check assumptions before trusting p-values!&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_multicollinearity_detection</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Detect and Handle Multicollinearity</span>

<span class=sd>    Correlated features cause unstable coefficients</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. Multicollinearity Detection&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Create correlated features</span>
    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>n</span> <span class=o>=</span> <span class=mi>500</span>
    <span class=n>x1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
    <span class=n>x2</span> <span class=o>=</span> <span class=n>x1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>)</span> <span class=o>*</span> <span class=mf>0.1</span>  <span class=c1># Highly correlated with x1!</span>
    <span class=n>x3</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
    <span class=n>y</span> <span class=o>=</span> <span class=mi>2</span><span class=o>*</span><span class=n>x1</span> <span class=o>+</span> <span class=mi>3</span><span class=o>*</span><span class=n>x3</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>

    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>x1</span><span class=p>,</span> <span class=n>x2</span><span class=p>,</span> <span class=n>x3</span><span class=p>])</span>

    <span class=c1># Compute VIF (Variance Inflation Factor)</span>
    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LinearRegression</span> <span class=k>as</span> <span class=n>LR_VIF</span>

    <span class=n>vifs</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]):</span>
        <span class=n>X_temp</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>i</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
        <span class=n>y_temp</span> <span class=o>=</span> <span class=n>X</span><span class=p>[:,</span> <span class=n>i</span><span class=p>]</span>

        <span class=n>lr_vif</span> <span class=o>=</span> <span class=n>LR_VIF</span><span class=p>()</span>
        <span class=n>lr_vif</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_temp</span><span class=p>,</span> <span class=n>y_temp</span><span class=p>)</span>
        <span class=n>r2</span> <span class=o>=</span> <span class=n>lr_vif</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_temp</span><span class=p>,</span> <span class=n>y_temp</span><span class=p>)</span>

        <span class=n>vif</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>r2</span><span class=p>)</span> <span class=k>if</span> <span class=n>r2</span> <span class=o>&lt;</span> <span class=mf>0.9999</span> <span class=k>else</span> <span class=nb>float</span><span class=p>(</span><span class=s1>&#39;inf&#39;</span><span class=p>)</span>
        <span class=n>vifs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>vif</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Variance Inflation Factor (VIF):&quot;</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>vif</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>vifs</span><span class=p>):</span>
        <span class=n>status</span> <span class=o>=</span> <span class=s2>&quot;üî¥ HIGH&quot;</span> <span class=k>if</span> <span class=n>vif</span> <span class=o>&gt;</span> <span class=mi>10</span> <span class=k>else</span> <span class=s2>&quot;üü° MEDIUM&quot;</span> <span class=k>if</span> <span class=n>vif</span> <span class=o>&gt;</span> <span class=mi>5</span> <span class=k>else</span> <span class=s2>&quot;üü¢ LOW&quot;</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Feature </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>: VIF = </span><span class=si>{</span><span class=n>vif</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>status</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  VIF &lt; 5: ‚úÖ No multicollinearity&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  VIF 5-10: ‚ö†Ô∏è Moderate multicollinearity&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  VIF &gt; 10: üî¥ High multicollinearity (remove or use Ridge)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Use Ridge/Lasso when VIF &gt; 10&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_cross_validation</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Cross-Validation for Robust Evaluation</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Cross-Validation (Robust Evaluation)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Generate dataset</span>
    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>300</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
    <span class=n>y</span> <span class=o>=</span> <span class=n>X</span> <span class=o>@</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>])</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>300</span><span class=p>)</span> <span class=o>*</span> <span class=mf>0.5</span>

    <span class=n>lr</span> <span class=o>=</span> <span class=n>LinearRegression</span><span class=p>()</span>

    <span class=c1># 5-fold CV</span>
    <span class=n>cv_scores</span> <span class=o>=</span> <span class=n>cross_val_score</span><span class=p>(</span><span class=n>lr</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;r2&#39;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>5-Fold Cross-Validation R¬≤ Scores:&quot;</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>score</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>cv_scores</span><span class=p>,</span> <span class=mi>1</span><span class=p>):</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Fold </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>score</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Mean R¬≤: </span><span class=si>{</span><span class=n>cv_scores</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> (+/- </span><span class=si>{</span><span class=n>cv_scores</span><span class=o>.</span><span class=n>std</span><span class=p>()</span><span class=o>*</span><span class=mi>2</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;‚úÖ Use CV to avoid overfitting to single train/test split&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_comparison</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Compare Linear Regression vs Baselines</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. Comparison with Baselines&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Generate dataset</span>
    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>500</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
    <span class=n>y</span> <span class=o>=</span> <span class=n>X</span> <span class=o>@</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>500</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.dummy</span><span class=w> </span><span class=kn>import</span> <span class=n>DummyRegressor</span>

    <span class=n>models</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;Mean Baseline&#39;</span><span class=p>:</span> <span class=n>DummyRegressor</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;mean&#39;</span><span class=p>),</span>
        <span class=s1>&#39;Linear Regression&#39;</span><span class=p>:</span> <span class=n>LinearRegression</span><span class=p>()</span>
    <span class=p>}</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Model&#39;</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;R¬≤&#39;</span><span class=si>:</span><span class=s2>&gt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;RMSE&#39;</span><span class=si>:</span><span class=s2>&gt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Time (ms)&#39;</span><span class=si>:</span><span class=s2>&gt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>models</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
        <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>train_time</span> <span class=o>=</span> <span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>*</span> <span class=mi>1000</span>

        <span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
        <span class=n>r2</span> <span class=o>=</span> <span class=n>r2_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
        <span class=n>rmse</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>mean_squared_error</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>))</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>r2</span><span class=si>:</span><span class=s2>&gt;8.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>rmse</span><span class=si>:</span><span class=s2>&gt;10.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_time</span><span class=si>:</span><span class=s2>&gt;12.2f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Always compare to baseline (DummyRegressor)&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_basic_linear_regression</span><span class=p>()</span>
    <span class=n>demo_assumption_checking</span><span class=p>()</span>
    <span class=n>demo_multicollinearity_detection</span><span class=p>()</span>
    <span class=n>demo_cross_validation</span><span class=p>()</span>
    <span class=n>demo_comparison</span><span class=p>()</span>
</code></pre></div> <h2 id=linear-regression-comparison>Linear Regression Comparison</h2> <table> <thead> <tr> <th>Aspect</th> <th>Linear Regression</th> <th>When to Use</th> </tr> </thead> <tbody> <tr> <td><strong>Speed</strong></td> <td>‚ö° Very Fast (closed-form solution)</td> <td>Always start here</td> </tr> <tr> <td><strong>Interpretability</strong></td> <td>‚úÖ Excellent (coefficients = feature importance)</td> <td>Need explainability</td> </tr> <tr> <td><strong>Assumptions</strong></td> <td>‚ö†Ô∏è Strong (linearity, independence, etc.)</td> <td>Check before using</td> </tr> <tr> <td><strong>Overfitting</strong></td> <td>üî¥ High risk (no regularization)</td> <td>Use Ridge/Lasso if p ‚âà n</td> </tr> <tr> <td><strong>Scalability</strong></td> <td>‚úÖ Excellent (works on millions of rows)</td> <td>Large datasets</td> </tr> </tbody> </table> <h2 id=when-to-use-linear-regression-vs-alternatives>When to Use Linear Regression vs Alternatives</h2> <table> <thead> <tr> <th>Scenario</th> <th>Recommendation</th> <th>Reason</th> </tr> </thead> <tbody> <tr> <td><strong>p &lt;&lt; n</strong> (few features)</td> <td>Linear Regression</td> <td>No overfitting risk</td> </tr> <tr> <td><strong>p ‚âà n</strong> (many features)</td> <td>Ridge/Lasso</td> <td>Regularization needed</td> </tr> <tr> <td><strong>Multicollinearity</strong></td> <td>Ridge Regression</td> <td>Stabilizes coefficients</td> </tr> <tr> <td><strong>Need feature selection</strong></td> <td>Lasso Regression</td> <td>L1 drives weights to 0</td> </tr> <tr> <td><strong>Non-linear relationships</strong></td> <td>Polynomial features + Ridge</td> <td>Capture non-linearity</td> </tr> </tbody> </table> <h2 id=real-world-performance_4>Real-World Performance</h2> <table> <thead> <tr> <th>Company</th> <th>Use Case</th> <th>Scale</th> <th>Performance</th> </tr> </thead> <tbody> <tr> <td><strong>Zillow</strong></td> <td>House price prediction</td> <td>1M+ properties</td> <td>R¬≤=0.82, &lt;10ms</td> </tr> <tr> <td><strong>Airbnb</strong></td> <td>Nightly pricing</td> <td>7M+ listings</td> <td>MAE=$15, &lt;5ms</td> </tr> <tr> <td><strong>Tesla</strong></td> <td>Battery range forecast</td> <td>Real-time</td> <td>R¬≤=0.91, &lt;1ms</td> </tr> <tr> <td><strong>Weather.com</strong></td> <td>Temperature prediction</td> <td>Hourly updates</td> <td>RMSE=2.1¬∞F</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>OLS formula</strong> <span class=arithmatex>\((X^TX)^{-1}X^Ty\)</span> and when it fails (multicollinearity)</li> <li><strong>Checks assumptions</strong> (linearity, independence, homoscedasticity, normality)</li> <li>Uses <strong>VIF &gt; 10</strong> as multicollinearity threshold (switch to Ridge)</li> <li>Knows <strong>closed-form solution</strong> makes it very fast (no iterative optimization)</li> <li>Real-world: <strong>Zillow uses Linear Regression for house prices (R¬≤=0.82, 1M+ predictions/day)</strong></li> </ul> </div> </details> <hr> <h3 id=what-is-ridge-regression-and-when-to-use-it-google-amazon-interview-question>What is Ridge Regression and when to use it? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Regularization</code>, <code>Ridge</code>, <code>L2</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>Ridge Regression</strong> adds <strong>L2 penalty</strong> <span class=arithmatex>\(\alpha \sum w^2\)</span> to prevent overfitting. It <strong>shrinks all coefficients</strong> toward zero but never exactly to zero (unlike Lasso). Best for <strong>multicollinearity</strong> and when you want to keep all features.</p> <p><strong>Formula:</strong> <span class=arithmatex>\(\min_{w} ||Xw - y||^2 + \alpha \sum w_i^2\)</span></p> <p><strong>Real-World Context:</strong> - <strong>Google:</strong> Ridge for ad CTR prediction (10K+ correlated features, stable coefficients) - <strong>Spotify:</strong> Audio feature modeling (100+ correlated spectral features, Œ±=1.0) - <strong>JPMorgan:</strong> Stock return prediction (prevents overfitting on correlated assets)</p> <h2 id=ridge-vs-no-regularization>Ridge vs No Regularization</h2> <div class=highlight><pre><span></span><code>No Regularization          Ridge (L2)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ          ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
     Features                  Features
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ w‚ÇÅ = 10.5    ‚îÇ          ‚îÇ w‚ÇÅ = 3.2     ‚îÇ ‚Üê Shrunk
‚îÇ w‚ÇÇ = -8.3    ‚îÇ    ‚Üí     ‚îÇ w‚ÇÇ = -2.1    ‚îÇ ‚Üê Shrunk
‚îÇ w‚ÇÉ = 15.7    ‚îÇ          ‚îÇ w‚ÇÉ = 4.5     ‚îÇ ‚Üê Shrunk
‚îÇ w‚ÇÑ = -12.1   ‚îÇ          ‚îÇ w‚ÇÑ = -3.8    ‚îÇ ‚Üê Shrunk
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
Overfit!                   Stable!
High variance              Low variance
</code></pre></div> <h2 id=production-implementation-165-lines>Production Implementation (165 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># ridge_regression_complete.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>Ridge</span><span class=p>,</span> <span class=n>LinearRegression</span><span class=p>,</span> <span class=n>RidgeCV</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>cross_val_score</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>mean_squared_error</span><span class=p>,</span> <span class=n>r2_score</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_ridge_vs_ols</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Ridge vs Ordinary Least Squares</span>

<span class=sd>    Show Ridge stabilizes coefficients with multicollinearity</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Ridge vs OLS - Multicollinearity&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Create highly correlated features</span>
    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>n</span> <span class=o>=</span> <span class=mi>300</span>
    <span class=n>x1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
    <span class=n>x2</span> <span class=o>=</span> <span class=n>x1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>)</span> <span class=o>*</span> <span class=mf>0.05</span>  <span class=c1># Highly correlated!</span>
    <span class=n>x3</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>([</span><span class=n>x1</span><span class=p>,</span> <span class=n>x2</span><span class=p>,</span> <span class=n>x3</span><span class=p>])</span>
    <span class=n>y</span> <span class=o>=</span> <span class=mi>2</span><span class=o>*</span><span class=n>x1</span> <span class=o>+</span> <span class=mi>3</span><span class=o>*</span><span class=n>x3</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>)</span> <span class=o>*</span> <span class=mf>0.5</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Scale features (important for Ridge!)</span>
    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Train models</span>
    <span class=n>ols</span> <span class=o>=</span> <span class=n>LinearRegression</span><span class=p>()</span>
    <span class=n>ridge</span> <span class=o>=</span> <span class=n>Ridge</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span>

    <span class=n>ols</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>ridge</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># Compare coefficients</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Coefficients:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Feature&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;OLS&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Ridge (Œ±=1.0)&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>45</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>c_ols</span><span class=p>,</span> <span class=n>c_ridge</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>ols</span><span class=o>.</span><span class=n>coef_</span><span class=p>,</span> <span class=n>ridge</span><span class=o>.</span><span class=n>coef_</span><span class=p>)):</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Feature </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>c_ols</span><span class=si>:</span><span class=s2>&gt;14.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>c_ridge</span><span class=si>:</span><span class=s2>&gt;14.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Evaluate</span>
    <span class=n>y_pred_ols</span> <span class=o>=</span> <span class=n>ols</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>)</span>
    <span class=n>y_pred_ridge</span> <span class=o>=</span> <span class=n>ridge</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Test R¬≤ - OLS: </span><span class=si>{</span><span class=n>r2_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred_ols</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Test R¬≤ - Ridge: </span><span class=si>{</span><span class=n>r2_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred_ridge</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Ridge stabilizes coefficients with correlated features&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_alpha_tuning</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Tune Œ± (Regularization Strength)</span>

<span class=sd>    Œ± controls bias-variance tradeoff</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. Alpha Tuning (Regularization Strength)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Generate dataset</span>
    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>200</span><span class=p>,</span> <span class=mi>50</span><span class=p>)</span>  <span class=c1># High-dimensional</span>
    <span class=n>y</span> <span class=o>=</span> <span class=n>X</span> <span class=o>@</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>50</span><span class=p>)</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>200</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Try different alphas</span>
    <span class=n>alphas</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.001</span><span class=p>,</span> <span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>10.0</span><span class=p>,</span> <span class=mf>100.0</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Alpha&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train R¬≤&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test R¬≤&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Overfit Gap&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>alpha</span> <span class=ow>in</span> <span class=n>alphas</span><span class=p>:</span>
        <span class=n>ridge</span> <span class=o>=</span> <span class=n>Ridge</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=n>alpha</span><span class=p>)</span>
        <span class=n>ridge</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_r2</span> <span class=o>=</span> <span class=n>ridge</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_r2</span> <span class=o>=</span> <span class=n>ridge</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>gap</span> <span class=o>=</span> <span class=n>train_r2</span> <span class=o>-</span> <span class=n>test_r2</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>alpha</span><span class=si>:</span><span class=s2>&lt;10.3f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_r2</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_r2</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>gap</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Œ± interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  Œ± ‚Üí 0: Less regularization (risk overfit)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  Œ± ‚Üí ‚àû: More regularization (risk underfit)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  Optimal Œ±: Minimizes test error&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Use RidgeCV to auto-tune Œ± with cross-validation&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_ridgecv</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    RidgeCV: Automatic Alpha Selection</span>

<span class=sd>    Use built-in CV for efficient tuning</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. RidgeCV - Automatic Alpha Selection&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Generate dataset</span>
    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>500</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
    <span class=n>y</span> <span class=o>=</span> <span class=n>X</span> <span class=o>@</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>500</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># RidgeCV automatically tests multiple alphas</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
    <span class=n>ridge_cv</span> <span class=o>=</span> <span class=n>RidgeCV</span><span class=p>(</span><span class=n>alphas</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>logspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>20</span><span class=p>),</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
    <span class=n>ridge_cv</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>cv_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Best Œ± found: </span><span class=si>{</span><span class=n>ridge_cv</span><span class=o>.</span><span class=n>alpha_</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CV Time: </span><span class=si>{</span><span class=n>cv_time</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Test R¬≤: </span><span class=si>{</span><span class=n>ridge_cv</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span><span class=w> </span><span class=n>y_test</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ RidgeCV is efficient (no manual GridSearchCV needed)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_performance_comparison</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Speed Comparison: Ridge vs LinearRegression</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Performance Comparison&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>sizes</span> <span class=o>=</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>1000</span><span class=p>,</span> <span class=mi>5000</span><span class=p>]</span>
    <span class=n>n_features</span> <span class=o>=</span> <span class=mi>50</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;n_samples&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;LinearReg (ms)&#39;</span><span class=si>:</span><span class=s2>&lt;18</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Ridge (ms)&#39;</span><span class=si>:</span><span class=s2>&lt;18</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Ratio&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>65</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>sizes</span><span class=p>:</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>n_features</span><span class=p>)</span>
        <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>

        <span class=c1># LinearRegression</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
        <span class=n>lr</span> <span class=o>=</span> <span class=n>LinearRegression</span><span class=p>()</span>
        <span class=n>lr</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
        <span class=n>lr_time</span> <span class=o>=</span> <span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>*</span> <span class=mi>1000</span>

        <span class=c1># Ridge</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
        <span class=n>ridge</span> <span class=o>=</span> <span class=n>Ridge</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span>
        <span class=n>ridge</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
        <span class=n>ridge_time</span> <span class=o>=</span> <span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>*</span> <span class=mi>1000</span>

        <span class=n>ratio</span> <span class=o>=</span> <span class=n>ridge_time</span> <span class=o>/</span> <span class=n>lr_time</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>n</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>lr_time</span><span class=si>:</span><span class=s2>&lt;18.2f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>ridge_time</span><span class=si>:</span><span class=s2>&lt;18.2f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>ratio</span><span class=si>:</span><span class=s2>&lt;10.2f</span><span class=si>}</span><span class=s2>x&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Ridge is slightly slower but comparable to OLS&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_ridge_vs_ols</span><span class=p>()</span>
    <span class=n>demo_alpha_tuning</span><span class=p>()</span>
    <span class=n>demo_ridgecv</span><span class=p>()</span>
    <span class=n>demo_performance_comparison</span><span class=p>()</span>
</code></pre></div> <h2 id=ridge-regression-properties>Ridge Regression Properties</h2> <table> <thead> <tr> <th>Property</th> <th>Ridge (L2)</th> <th>Impact</th> </tr> </thead> <tbody> <tr> <td><strong>Penalty</strong></td> <td><span class=arithmatex>\(\alpha \sum w^2\)</span></td> <td>Smooth shrinkage</td> </tr> <tr> <td><strong>Coefficients</strong></td> <td>Small, non-zero</td> <td>Keeps all features</td> </tr> <tr> <td><strong>Feature Selection</strong></td> <td>‚ùå No</td> <td>All features retained</td> </tr> <tr> <td><strong>Multicollinearity</strong></td> <td>‚úÖ Excellent</td> <td>Stabilizes coefficients</td> </tr> <tr> <td><strong>Speed</strong></td> <td>‚ö° Fast (closed-form with regularization)</td> <td>Similar to OLS</td> </tr> </tbody> </table> <h2 id=when-to-use-ridge>When to Use Ridge</h2> <table> <thead> <tr> <th>Scenario</th> <th>Use Ridge?</th> <th>Reason</th> </tr> </thead> <tbody> <tr> <td><strong>Multicollinearity</strong> (VIF &gt; 10)</td> <td>‚úÖ Yes</td> <td>Stabilizes coefficients</td> </tr> <tr> <td><strong>p ‚âà n</strong> (many features)</td> <td>‚úÖ Yes</td> <td>Prevents overfitting</td> </tr> <tr> <td><strong>Need feature selection</strong></td> <td>‚ùå No (use Lasso)</td> <td>Ridge keeps all features</td> </tr> <tr> <td><strong>Interpretability needed</strong></td> <td>‚úÖ Yes</td> <td>Coefficients still meaningful</td> </tr> <tr> <td><strong>Very large p</strong> (p &gt; n)</td> <td>‚úÖ Yes</td> <td>But consider Lasso too</td> </tr> </tbody> </table> <h2 id=real-world-applications_3>Real-World Applications</h2> <table> <thead> <tr> <th>Company</th> <th>Use Case</th> <th>Œ± Value</th> <th>Result</th> </tr> </thead> <tbody> <tr> <td><strong>Google</strong></td> <td>Ad CTR prediction</td> <td>Œ±=1.0</td> <td>10K+ features, stable predictions</td> </tr> <tr> <td><strong>Spotify</strong></td> <td>Audio features</td> <td>Œ±=0.5</td> <td>100+ correlated spectral features</td> </tr> <tr> <td><strong>JPMorgan</strong></td> <td>Portfolio optimization</td> <td>Œ±=10.0</td> <td>Correlated asset returns</td> </tr> <tr> <td><strong>Netflix</strong></td> <td>User rating prediction</td> <td>Œ±=0.1</td> <td>Prevents overfitting on sparse data</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>L2 penalty shrinks but never zeros</strong> coefficients (vs Lasso)</li> <li>Uses <strong>RidgeCV</strong> for automatic Œ± tuning (no manual GridSearchCV)</li> <li><strong>Scales features first</strong> (Ridge is sensitive to scale)</li> <li>Understands <strong>bias-variance tradeoff</strong> (Œ± controls this)</li> <li>Real-world: <strong>Google uses Ridge for ad CTR with 10K+ correlated features (stable predictions)</strong></li> </ul> </div> </details> <hr> <h3 id=what-is-lasso-regression-and-when-to-use-it-google-amazon-interview-question>What is Lasso Regression and when to use it? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Regularization</code>, <code>Lasso</code>, <code>L1</code>, <code>Feature Selection</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>Lasso Regression</strong> adds <strong>L1 penalty</strong> <span class=arithmatex>\(\alpha \sum |w|\)</span> that drives coefficients to <strong>exactly zero</strong>, enabling <strong>automatic feature selection</strong>. Unlike Ridge, Lasso creates <strong>sparse models</strong> (many zero coefficients).</p> <p><strong>Formula:</strong> <span class=arithmatex>\(\min_{w} ||Xw - y||^2 + \alpha \sum |w_i|\)</span></p> <p><strong>Real-World Context:</strong> - <strong>Netflix:</strong> Feature selection for recommendations (10K+ features ‚Üí 100 selected, 95% R¬≤ retained) - <strong>Google Ads:</strong> Sparse models for CTR prediction (interpretability, fast inference) - <strong>Genomics:</strong> Gene selection (p=20K genes, n=100 samples ‚Üí 50 important genes)</p> <h2 id=lasso-feature-selection-process>Lasso Feature Selection Process</h2> <div class=highlight><pre><span></span><code>All Features (p features)
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Lasso with Œ±           ‚îÇ
‚îÇ  Penalty: Œ± Œ£|w|        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Shrinkage Process      ‚îÇ
‚îÇ                         ‚îÇ
‚îÇ  w‚ÇÅ = 5.2  ‚Üí  w‚ÇÅ = 3.1  ‚îÇ
‚îÇ  w‚ÇÇ = 0.3  ‚Üí  w‚ÇÇ = 0.0  ‚îÇ ‚Üê ZERO!
‚îÇ  w‚ÇÉ = 8.1  ‚Üí  w‚ÇÉ = 5.7  ‚îÇ
‚îÇ  w‚ÇÑ = 0.1  ‚Üí  w‚ÇÑ = 0.0  ‚îÇ ‚Üê ZERO!
‚îÇ  ...                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì
Selected Features (sparse model)
</code></pre></div> <h2 id=production-implementation-175-lines>Production Implementation (175 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># lasso_regression_complete.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>Lasso</span><span class=p>,</span> <span class=n>LassoCV</span><span class=p>,</span> <span class=n>LinearRegression</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>r2_score</span><span class=p>,</span> <span class=n>mean_squared_error</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_regression</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_lasso_feature_selection</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Lasso&#39;s Key Feature: Automatic Feature Selection</span>

<span class=sd>    Drives irrelevant features to exactly zero</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Lasso Feature Selection - Sparse Solutions&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Dataset: only 10 of 100 features are truly informative</span>
    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>  <span class=c1># Only 10 matter!</span>
        <span class=n>n_redundant</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
        <span class=n>noise</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span>
        <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=c1># Scale features (critical for Lasso!)</span>
    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Compare different alpha values</span>
    <span class=n>alphas</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.001</span><span class=p>,</span> <span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>10.0</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Alpha&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train R¬≤&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test R¬≤&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Non-zero&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Sparsity %&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>alpha</span> <span class=ow>in</span> <span class=n>alphas</span><span class=p>:</span>
        <span class=n>lasso</span> <span class=o>=</span> <span class=n>Lasso</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=n>alpha</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>)</span>
        <span class=n>lasso</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_r2</span> <span class=o>=</span> <span class=n>lasso</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_r2</span> <span class=o>=</span> <span class=n>lasso</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=c1># Count exactly zero coefficients</span>
        <span class=n>non_zero</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>lasso</span><span class=o>.</span><span class=n>coef_</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mf>1e-10</span><span class=p>)</span>
        <span class=n>sparsity</span> <span class=o>=</span> <span class=mi>100</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>non_zero</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>lasso</span><span class=o>.</span><span class=n>coef_</span><span class=p>))</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>alpha</span><span class=si>:</span><span class=s2>&lt;10.3f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_r2</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_r2</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>non_zero</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>sparsity</span><span class=si>:</span><span class=s2>&lt;12.1f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Lasso drives coefficients to EXACTLY zero&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Higher Œ± ‚Üí more features eliminated ‚Üí sparser model&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_lasso_path</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Lasso Path: How coefficients shrink with increasing Œ±</span>

<span class=sd>    Visualize coefficient trajectories</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. Lasso Path - Coefficient Trajectories&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>200</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>

    <span class=c1># Compute coefficients for different alphas</span>
    <span class=n>alphas</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>logspace</span><span class=p>(</span><span class=o>-</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>50</span><span class=p>)</span>
    <span class=n>coefs</span> <span class=o>=</span> <span class=p>[]</span>

    <span class=k>for</span> <span class=n>alpha</span> <span class=ow>in</span> <span class=n>alphas</span><span class=p>:</span>
        <span class=n>lasso</span> <span class=o>=</span> <span class=n>Lasso</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=n>alpha</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>)</span>
        <span class=n>lasso</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_scaled</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
        <span class=n>coefs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>lasso</span><span class=o>.</span><span class=n>coef_</span><span class=p>)</span>

    <span class=n>coefs</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>coefs</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Coefficient evolution (Œ±: 0.01 ‚Üí 100):&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Œ± = 0.01: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>coefs</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>1e-5</span><span class=p>)</span><span class=si>}</span><span class=s2> non-zero features&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Œ± = 0.10: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>coefs</span><span class=p>[</span><span class=mi>10</span><span class=p>])</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>1e-5</span><span class=p>)</span><span class=si>}</span><span class=s2> non-zero features&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Œ± = 1.00: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>coefs</span><span class=p>[</span><span class=mi>25</span><span class=p>])</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>1e-5</span><span class=p>)</span><span class=si>}</span><span class=s2> non-zero features&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Œ± = 10.0: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>coefs</span><span class=p>[</span><span class=mi>40</span><span class=p>])</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>1e-5</span><span class=p>)</span><span class=si>}</span><span class=s2> non-zero features&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ As Œ± increases, more coefficients ‚Üí 0&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Features dropped in order of importance&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_lasso_cv</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    LassoCV: Automatic Œ± Selection via Cross-Validation</span>

<span class=sd>    No manual tuning needed!</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. LassoCV - Automatic Alpha Selection&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># LassoCV tries many alphas automatically</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
    <span class=n>lasso_cv</span> <span class=o>=</span> <span class=n>LassoCV</span><span class=p>(</span>
        <span class=n>alphas</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>logspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>50</span><span class=p>),</span>
        <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
        <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>
    <span class=n>lasso_cv</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>cv_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

    <span class=c1># Get selected features</span>
    <span class=n>selected_mask</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>lasso_cv</span><span class=o>.</span><span class=n>coef_</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mf>1e-5</span>
    <span class=n>n_selected</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>selected_mask</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Best Œ± found: </span><span class=si>{</span><span class=n>lasso_cv</span><span class=o>.</span><span class=n>alpha_</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Features selected: </span><span class=si>{</span><span class=n>n_selected</span><span class=si>}</span><span class=s2> / </span><span class=si>{</span><span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Test R¬≤: </span><span class=si>{</span><span class=n>lasso_cv</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span><span class=w> </span><span class=n>y_test</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CV time: </span><span class=si>{</span><span class=n>cv_time</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>

    <span class=c1># Show top features</span>
    <span class=n>feature_importance</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>lasso_cv</span><span class=o>.</span><span class=n>coef_</span><span class=p>)</span>
    <span class=n>top5_idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>feature_importance</span><span class=p>)[</span><span class=o>-</span><span class=mi>5</span><span class=p>:][::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 5 selected features:&quot;</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>idx</span> <span class=ow>in</span> <span class=n>top5_idx</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Feature </span><span class=si>{</span><span class=n>idx</span><span class=si>}</span><span class=s2>: coefficient = </span><span class=si>{</span><span class=n>lasso_cv</span><span class=o>.</span><span class=n>coef_</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ LassoCV automatically finds best Œ± via CV&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Use in production (no manual tuning)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_lasso_vs_ridge</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Direct Comparison: Lasso vs Ridge</span>

<span class=sd>    Sparsity vs Shrinkage</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Lasso vs Ridge - Sparsity Comparison&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>400</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>Ridge</span>

    <span class=n>models</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;Linear (no regularization)&#39;</span><span class=p>:</span> <span class=n>LinearRegression</span><span class=p>(),</span>
        <span class=s1>&#39;Ridge (Œ±=1.0)&#39;</span><span class=p>:</span> <span class=n>Ridge</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>1.0</span><span class=p>),</span>
        <span class=s1>&#39;Lasso (Œ±=1.0)&#39;</span><span class=p>:</span> <span class=n>Lasso</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>)</span>
    <span class=p>}</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Model&#39;</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train R¬≤&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test R¬≤&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Non-zero&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>models</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_r2</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_r2</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=s1>&#39;coef_&#39;</span><span class=p>):</span>
            <span class=n>non_zero</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>coef_</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mf>1e-5</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>non_zero</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_r2</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_r2</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>non_zero</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Ridge shrinks all, Lasso selects features&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Lasso better for interpretability (fewer features)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_coordinate_descent</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Lasso Algorithm: Coordinate Descent</span>

<span class=sd>    Unlike Ridge (closed-form), Lasso needs iterative solver</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. Lasso Algorithm - Coordinate Descent&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>sizes</span> <span class=o>=</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>1000</span><span class=p>,</span> <span class=mi>5000</span><span class=p>]</span>
    <span class=n>n_features</span> <span class=o>=</span> <span class=mi>50</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;n_samples&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Ridge (ms)&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Lasso (ms)&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Ratio&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>Ridge</span>

    <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>sizes</span><span class=p>:</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>n_features</span><span class=p>)</span>
        <span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>

        <span class=c1># Ridge (closed-form, fast)</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
        <span class=n>ridge</span> <span class=o>=</span> <span class=n>Ridge</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span>
        <span class=n>ridge</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
        <span class=n>ridge_time</span> <span class=o>=</span> <span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>*</span> <span class=mi>1000</span>

        <span class=c1># Lasso (coordinate descent, slower)</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
        <span class=n>lasso</span> <span class=o>=</span> <span class=n>Lasso</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
        <span class=n>lasso</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
        <span class=n>lasso_time</span> <span class=o>=</span> <span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>*</span> <span class=mi>1000</span>

        <span class=n>ratio</span> <span class=o>=</span> <span class=n>lasso_time</span> <span class=o>/</span> <span class=n>ridge_time</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>n</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>ridge_time</span><span class=si>:</span><span class=s2>&lt;15.2f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>lasso_time</span><span class=si>:</span><span class=s2>&lt;15.2f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>ratio</span><span class=si>:</span><span class=s2>&lt;10.2f</span><span class=si>}</span><span class=s2>x&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Lasso slower than Ridge (iterative vs closed-form)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ But still fast for most applications&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_lasso_feature_selection</span><span class=p>()</span>
    <span class=n>demo_lasso_path</span><span class=p>()</span>
    <span class=n>demo_lasso_cv</span><span class=p>()</span>
    <span class=n>demo_lasso_vs_ridge</span><span class=p>()</span>
    <span class=n>demo_coordinate_descent</span><span class=p>()</span>
</code></pre></div> <h2 id=lasso-vs-ridge-comparison>Lasso vs Ridge Comparison</h2> <table> <thead> <tr> <th>Property</th> <th>Lasso (L1)</th> <th>Ridge (L2)</th> </tr> </thead> <tbody> <tr> <td><strong>Penalty</strong></td> <td>$\alpha \sum</td> <td>w</td> </tr> <tr> <td><strong>Coefficients</strong></td> <td>Many exactly zero</td> <td>Small, non-zero</td> </tr> <tr> <td><strong>Feature Selection</strong></td> <td>‚úÖ Automatic</td> <td>‚ùå No</td> </tr> <tr> <td><strong>Interpretability</strong></td> <td>‚úÖ Excellent (few features)</td> <td>üü° Good (all features)</td> </tr> <tr> <td><strong>Algorithm</strong></td> <td>Coordinate descent (iterative)</td> <td>Closed-form (fast)</td> </tr> <tr> <td><strong>Speed</strong></td> <td>üü° Slower</td> <td>‚ö° Faster</td> </tr> </tbody> </table> <h2 id=when-to-use-lasso>When to Use Lasso</h2> <table> <thead> <tr> <th>Scenario</th> <th>Use Lasso?</th> <th>Reason</th> </tr> </thead> <tbody> <tr> <td><strong>Need feature selection</strong></td> <td>‚úÖ Yes</td> <td>Automatic via L1 penalty</td> </tr> <tr> <td><strong>High-dimensional (p &gt;&gt; n)</strong></td> <td>‚úÖ Yes</td> <td>Handles curse of dimensionality</td> </tr> <tr> <td><strong>Interpretability critical</strong></td> <td>‚úÖ Yes</td> <td>Sparse model, few features</td> </tr> <tr> <td><strong>Multicollinearity</strong></td> <td>‚ö†Ô∏è Unstable</td> <td>Randomly picks one feature (use ElasticNet)</td> </tr> <tr> <td><strong>All features relevant</strong></td> <td>‚ùå No (use Ridge)</td> <td>Lasso will drop important features</td> </tr> </tbody> </table> <h2 id=real-world-applications_4>Real-World Applications</h2> <table> <thead> <tr> <th>Company</th> <th>Use Case</th> <th>Result</th> <th>Impact</th> </tr> </thead> <tbody> <tr> <td><strong>Netflix</strong></td> <td>Recommendation features</td> <td>10K ‚Üí 100 features</td> <td>95% R¬≤, 10√ó faster</td> </tr> <tr> <td><strong>Google Ads</strong></td> <td>Sparse CTR models</td> <td>50K ‚Üí 500 features</td> <td>Interpretable, fast</td> </tr> <tr> <td><strong>Genomics</strong></td> <td>Gene selection</td> <td>20K ‚Üí 50 genes</td> <td>Identifies pathways</td> </tr> <tr> <td><strong>Zillow</strong></td> <td>Home price features</td> <td>200 ‚Üí 30 features</td> <td>$10 MAE, explainable</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>L1 creates exact zeros</strong> (feature selection) vs <strong>L2 shrinkage</strong></li> <li>Uses <strong>LassoCV</strong> for automatic Œ± selection (efficient CV)</li> <li>Understands <strong>coordinate descent</strong> (iterative, slower than Ridge)</li> <li><strong>Scales features first</strong> (Lasso sensitive to scale)</li> <li>Knows <strong>Lasso unstable with correlated features</strong> (use ElasticNet)</li> <li>Real-world: <strong>Netflix uses Lasso for feature selection (10K ‚Üí 100 features, 95% R¬≤ retained)</strong></li> </ul> </div> </details> <hr> <h3 id=what-is-elasticnet-regression-google-amazon-interview-question>What is ElasticNet regression? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Regularization</code>, <code>ElasticNet</code>, <code>L1+L2</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>ElasticNet</strong> combines <strong>L1 (Lasso) + L2 (Ridge)</strong> penalties to get <strong>best of both worlds</strong>: feature selection (L1) + stability (L2). Best for <strong>correlated features</strong> where Lasso is unstable.</p> <p><strong>Formula:</strong> <span class=arithmatex>\(\min_{w} ||Xw - y||^2 + \alpha \left( \rho ||w||_1 + \frac{1-\rho}{2} ||w||_2^2 \right)\)</span></p> <p>Where: - <span class=arithmatex>\(\alpha\)</span>: overall regularization strength - <span class=arithmatex>\(\rho\)</span>: L1 ratio (0 = Ridge, 1 = Lasso, 0.5 = equal mix)</p> <p><strong>Real-World Context:</strong> - <strong>Genomics:</strong> Gene expression (correlated genes, need grouped selection) - <strong>Uber:</strong> Pricing with correlated features (time, weather, events) - <strong>Finance:</strong> Stock prediction (correlated assets, stable selection)</p> <h2 id=elasticnet-decision-flow>ElasticNet Decision Flow</h2> <div class=highlight><pre><span></span><code>Data with Correlated Features
          ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Q: Correlated features?  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì YES
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Lasso Problem:           ‚îÇ
‚îÇ Randomly picks one       ‚îÇ
‚îÇ feature from group       ‚îÇ
‚îÇ (UNSTABLE!)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ElasticNet Solution:     ‚îÇ
‚îÇ                          ‚îÇ
‚îÇ L1 (œÅ=0.5): Sparsity    ‚îÇ
‚îÇ      +                   ‚îÇ
‚îÇ L2 (1-œÅ=0.5): Stability ‚îÇ
‚îÇ                          ‚îÇ
‚îÇ Result: Grouped          ‚îÇ
‚îÇ         selection        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</code></pre></div> <h2 id=production-implementation-155-lines>Production Implementation (155 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># elasticnet_complete.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>ElasticNet</span><span class=p>,</span> <span class=n>ElasticNetCV</span><span class=p>,</span> <span class=n>Lasso</span><span class=p>,</span> <span class=n>Ridge</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>r2_score</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_regression</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_correlated_features_problem</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Why ElasticNet? Lasso Unstable with Correlated Features</span>

<span class=sd>    Lasso picks one randomly, ElasticNet selects groups</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Correlated Features - Lasso vs ElasticNet&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>n</span> <span class=o>=</span> <span class=mi>300</span>

    <span class=c1># Create groups of correlated features</span>
    <span class=n>X1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
    <span class=n>X2</span> <span class=o>=</span> <span class=n>X1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=mf>0.01</span>  <span class=c1># Highly correlated with X1</span>
    <span class=n>X3</span> <span class=o>=</span> <span class=n>X1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=mf>0.01</span>  <span class=c1># Also correlated with X1</span>

    <span class=n>X_uncorrelated</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=mi>7</span><span class=p>)</span>
    <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>([</span><span class=n>X1</span><span class=p>,</span> <span class=n>X2</span><span class=p>,</span> <span class=n>X3</span><span class=p>,</span> <span class=n>X_uncorrelated</span><span class=p>])</span>

    <span class=c1># True relationship: all first 3 features matter equally</span>
    <span class=n>y</span> <span class=o>=</span> <span class=n>X1</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span> <span class=o>+</span> <span class=n>X2</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span> <span class=o>+</span> <span class=n>X3</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n</span><span class=p>)</span> <span class=o>*</span> <span class=mf>0.1</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Compare Lasso vs ElasticNet</span>
    <span class=n>models</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;Lasso (Œ±=0.1)&#39;</span><span class=p>:</span> <span class=n>Lasso</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>),</span>
        <span class=s1>&#39;ElasticNet (Œ±=0.1, œÅ=0.5)&#39;</span><span class=p>:</span> <span class=n>ElasticNet</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>l1_ratio</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>)</span>
    <span class=p>}</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Model&#39;</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test R¬≤&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Features 0-2 Selected&#39;</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>models</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_r2</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=c1># Check which of first 3 (correlated) features are selected</span>
        <span class=n>selected</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>coef_</span><span class=p>[:</span><span class=mi>3</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mf>1e-3</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_r2</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>selected</span><span class=p>)</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  Lasso: Randomly picks ONE from correlated group (unstable)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  ElasticNet: Selects ALL or NONE from group (stable)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ ElasticNet for correlated features (grouped selection)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_l1_ratio_tuning</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    l1_ratio: Balance between L1 and L2</span>

<span class=sd>    œÅ = 0 (Ridge), œÅ = 1 (Lasso), œÅ = 0.5 (balanced)</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. L1 Ratio Tuning (œÅ: L1 vs L2 mix)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Try different l1_ratio values</span>
    <span class=n>l1_ratios</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.7</span><span class=p>,</span> <span class=mf>0.9</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;l1_ratio&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Behavior&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test R¬≤&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Non-zero&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>l1_ratio</span> <span class=ow>in</span> <span class=n>l1_ratios</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>l1_ratio</span> <span class=o>==</span> <span class=mf>1.0</span><span class=p>:</span>
            <span class=n>model</span> <span class=o>=</span> <span class=n>Lasso</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>)</span>
            <span class=n>behavior</span> <span class=o>=</span> <span class=s2>&quot;Pure Lasso&quot;</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>model</span> <span class=o>=</span> <span class=n>ElasticNet</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>l1_ratio</span><span class=o>=</span><span class=n>l1_ratio</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>)</span>
            <span class=n>l2_pct</span> <span class=o>=</span> <span class=nb>int</span><span class=p>((</span><span class=mi>1</span> <span class=o>-</span> <span class=n>l1_ratio</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span><span class=p>)</span>
            <span class=n>behavior</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=n>l1_ratio</span><span class=o>*</span><span class=mi>100</span><span class=p>)</span><span class=si>}</span><span class=s2>% L1, </span><span class=si>{</span><span class=n>l2_pct</span><span class=si>}</span><span class=s2>% L2&quot;</span>

        <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_r2</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>non_zero</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>coef_</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mf>1e-5</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>l1_ratio</span><span class=si>:</span><span class=s2>&lt;12.1f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>behavior</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_r2</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>non_zero</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  œÅ ‚Üí 0: More L2 (Ridge-like, less sparse)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  œÅ ‚Üí 1: More L1 (Lasso-like, more sparse)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  œÅ = 0.5: Balanced (typical starting point)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Tune l1_ratio based on sparsity needs&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_elasticnet_cv</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    ElasticNetCV: Auto-tune both Œ± and l1_ratio</span>

<span class=sd>    Efficient 2D search</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. ElasticNetCV - Auto-tune Œ± and l1_ratio&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>400</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># ElasticNetCV searches both parameters</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
    <span class=n>enet_cv</span> <span class=o>=</span> <span class=n>ElasticNetCV</span><span class=p>(</span>
        <span class=n>l1_ratio</span><span class=o>=</span><span class=p>[</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.7</span><span class=p>,</span> <span class=mf>0.9</span><span class=p>],</span>
        <span class=n>alphas</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>logspace</span><span class=p>(</span><span class=o>-</span><span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>30</span><span class=p>),</span>
        <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
        <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>
    <span class=n>enet_cv</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>cv_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

    <span class=n>n_selected</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>enet_cv</span><span class=o>.</span><span class=n>coef_</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mf>1e-5</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Best Œ±: </span><span class=si>{</span><span class=n>enet_cv</span><span class=o>.</span><span class=n>alpha_</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Best l1_ratio: </span><span class=si>{</span><span class=n>enet_cv</span><span class=o>.</span><span class=n>l1_ratio_</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Features selected: </span><span class=si>{</span><span class=n>n_selected</span><span class=si>}</span><span class=s2> / </span><span class=si>{</span><span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Test R¬≤: </span><span class=si>{</span><span class=n>enet_cv</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span><span class=w> </span><span class=n>y_test</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CV time: </span><span class=si>{</span><span class=n>cv_time</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ ElasticNetCV auto-tunes both hyperparameters&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_comparison_table</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Ridge vs Lasso vs ElasticNet - Complete Comparison</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Complete Comparison: Ridge vs Lasso vs ElasticNet&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>models</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;Ridge&#39;</span><span class=p>:</span> <span class=n>Ridge</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>1.0</span><span class=p>),</span>
        <span class=s1>&#39;Lasso&#39;</span><span class=p>:</span> <span class=n>Lasso</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>),</span>
        <span class=s1>&#39;ElasticNet&#39;</span><span class=p>:</span> <span class=n>ElasticNet</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>l1_ratio</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>10000</span><span class=p>)</span>
    <span class=p>}</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Method&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test R¬≤&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Non-zero&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Sparsity %&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Time (ms)&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>models</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
        <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>fit_time</span> <span class=o>=</span> <span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span><span class=p>)</span> <span class=o>*</span> <span class=mi>1000</span>

        <span class=n>test_r2</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>non_zero</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>coef_</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mf>1e-5</span><span class=p>)</span>
        <span class=n>sparsity</span> <span class=o>=</span> <span class=mi>100</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>non_zero</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>coef_</span><span class=p>))</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_r2</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>non_zero</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>sparsity</span><span class=si>:</span><span class=s2>&lt;12.1f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>fit_time</span><span class=si>:</span><span class=s2>&lt;12.2f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ ElasticNet balances Ridge stability + Lasso sparsity&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_correlated_features_problem</span><span class=p>()</span>
    <span class=n>demo_l1_ratio_tuning</span><span class=p>()</span>
    <span class=n>demo_elasticnet_cv</span><span class=p>()</span>
    <span class=n>demo_comparison_table</span><span class=p>()</span>
</code></pre></div> <h2 id=elasticnet-properties>ElasticNet Properties</h2> <table> <thead> <tr> <th>Property</th> <th>ElasticNet</th> <th>Advantage</th> </tr> </thead> <tbody> <tr> <td><strong>Penalty</strong></td> <td><span class=arithmatex>\(\alpha(\rho L1 + \frac{1-\rho}{2} L2)\)</span></td> <td>Combines L1 + L2</td> </tr> <tr> <td><strong>Feature Selection</strong></td> <td>‚úÖ Yes (from L1)</td> <td>Sparse solutions</td> </tr> <tr> <td><strong>Grouped Selection</strong></td> <td>‚úÖ Yes (from L2)</td> <td>Stable with correlated features</td> </tr> <tr> <td><strong>Interpretability</strong></td> <td>‚úÖ Good</td> <td>Fewer features than Ridge</td> </tr> <tr> <td><strong>Stability</strong></td> <td>‚úÖ Better than Lasso</td> <td>L2 component stabilizes</td> </tr> </tbody> </table> <h2 id=ridge-vs-lasso-vs-elasticnet-decision-guide>Ridge vs Lasso vs ElasticNet Decision Guide</h2> <table> <thead> <tr> <th>Scenario</th> <th>Best Choice</th> <th>Reason</th> </tr> </thead> <tbody> <tr> <td><strong>All features relevant</strong></td> <td>Ridge</td> <td>No feature selection needed</td> </tr> <tr> <td><strong>Many irrelevant features</strong></td> <td>Lasso</td> <td>Automatic feature selection</td> </tr> <tr> <td><strong>Correlated features</strong></td> <td>ElasticNet</td> <td>Grouped selection (stable)</td> </tr> <tr> <td><strong>p &gt;&gt; n</strong> (high-dim)</td> <td>Lasso or ElasticNet</td> <td>Handles many features</td> </tr> <tr> <td><strong>p &gt; n with correlation</strong></td> <td>ElasticNet</td> <td>Best for genomics, finance</td> </tr> </tbody> </table> <h2 id=real-world-applications_5>Real-World Applications</h2> <table> <thead> <tr> <th>Domain</th> <th>Use Case</th> <th>Why ElasticNet</th> </tr> </thead> <tbody> <tr> <td><strong>Genomics</strong></td> <td>Gene expression (n=100, p=20K)</td> <td>Correlated genes, grouped pathways</td> </tr> <tr> <td><strong>Finance</strong></td> <td>Portfolio optimization</td> <td>Correlated assets, stable selection</td> </tr> <tr> <td><strong>Uber</strong></td> <td>Pricing (time/weather/events)</td> <td>Correlated temporal features</td> </tr> <tr> <td><strong>Climate</strong></td> <td>Weather prediction</td> <td>Correlated spatial/temporal features</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>ElasticNet for correlated features</strong> (Lasso unstable, picks randomly)</li> <li>Understands <strong>l1_ratio</strong>: 0=Ridge, 1=Lasso, 0.5=balanced</li> <li>Uses <strong>ElasticNetCV</strong> to auto-tune both Œ± and l1_ratio</li> <li>Knows <strong>grouped selection</strong> property (selects correlated features together)</li> <li>Real-world: <strong>Genomics uses ElasticNet for gene selection (p=20K, n=100, correlated genes)</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-implement-logistic-regression-most-tech-companies-interview-question>How to implement Logistic Regression? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Logistic Regression</code>, <code>Classification</code> | <strong>Asked by:</strong> Most Tech Companies</p> <details class=success> <summary>View Answer</summary> <p><strong>Logistic Regression</strong> models the probability of binary outcomes using the <strong>sigmoid function</strong>: <span class=arithmatex>\(P(y=1|x) = \frac{1}{1 + e^{-(\beta_0 + \beta^T x)}}\)</span>. Despite the name, it's a <strong>classification</strong> algorithm, not regression.</p> <p><strong>Real-World Context:</strong> - <strong>Stripe:</strong> Fraud detection (95%+ recall, processes 10K+ transactions/sec) - <strong>Gmail:</strong> Spam classification (99.9% accuracy, &lt;10ms latency) - <strong>Medical:</strong> Disease prediction (interpretable probabilities for doctors)</p> <h2 id=logistic-regression-workflow>Logistic Regression Workflow</h2> <div class=highlight><pre><span></span><code>Input Features (X)
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Linear Combination     ‚îÇ
‚îÇ z = Œ≤‚ÇÄ + Œ≤‚ÇÅx‚ÇÅ + ...   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Sigmoid Function       ‚îÇ
‚îÇ œÉ(z) = 1/(1 + e^(-z)) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Probability [0, 1]     ‚îÇ
‚îÇ P(y=1|x)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Decision (threshold)   ‚îÇ
‚îÇ ≈∑ = 1 if P ‚â• 0.5      ‚îÇ
‚îÇ ≈∑ = 0 if P &lt; 0.5      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</code></pre></div> <h2 id=production-implementation-180-lines_3>Production Implementation (180 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># logistic_regression_complete.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LogisticRegression</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>cross_val_score</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span><span class=n>accuracy_score</span><span class=p>,</span> <span class=n>precision_score</span><span class=p>,</span> <span class=n>recall_score</span><span class=p>,</span> 
                             <span class=n>f1_score</span><span class=p>,</span> <span class=n>roc_auc_score</span><span class=p>,</span> <span class=n>classification_report</span><span class=p>,</span>
                             <span class=n>confusion_matrix</span><span class=p>)</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_basic_logistic_regression</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Basic Logistic Regression: Binary Classification</span>

<span class=sd>    Use Case: Customer churn prediction</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Basic Logistic Regression - Customer Churn&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Realistic churn dataset</span>
    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span>
        <span class=n>n_redundant</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
        <span class=n>n_classes</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
        <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.7</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>],</span>  <span class=c1># Imbalanced (30% churn)</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span>
        <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>stratify</span><span class=o>=</span><span class=n>y</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=c1># Scale features (important for LogisticRegression!)</span>
    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Train model</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
    <span class=n>lr</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>lr</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>train_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

    <span class=c1># Predictions</span>
    <span class=n>y_pred</span> <span class=o>=</span> <span class=n>lr</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>)</span>
    <span class=n>y_proba</span> <span class=o>=</span> <span class=n>lr</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>]</span>

    <span class=c1># Metrics</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Performance Metrics:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Accuracy:  </span><span class=si>{</span><span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Precision: </span><span class=si>{</span><span class=n>precision_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Recall:    </span><span class=si>{</span><span class=n>recall_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  F1 Score:  </span><span class=si>{</span><span class=n>f1_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_pred</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  ROC-AUC:   </span><span class=si>{</span><span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span><span class=w> </span><span class=n>y_proba</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Speed:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Training: </span><span class=si>{</span><span class=n>train_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Inference: </span><span class=si>{</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>start</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>1000</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>ms per prediction&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Logistic Regression: Fast, interpretable, probabilistic&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_probability_calibration</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Probability Output: Well-Calibrated</span>

<span class=sd>    Logistic Regression outputs true probabilities</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. Probability Calibration - Reliable Probabilities&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>lr</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>lr</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># Get probabilities</span>
    <span class=n>y_proba</span> <span class=o>=</span> <span class=n>lr</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>]</span>

    <span class=c1># Check calibration (group by predicted probability)</span>
    <span class=n>bins</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.2</span><span class=p>,</span> <span class=mf>0.4</span><span class=p>,</span> <span class=mf>0.6</span><span class=p>,</span> <span class=mf>0.8</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Predicted P&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Actual Rate&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Count&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>bins</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>):</span>
        <span class=n>mask</span> <span class=o>=</span> <span class=p>(</span><span class=n>y_proba</span> <span class=o>&gt;=</span> <span class=n>bins</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>y_proba</span> <span class=o>&lt;</span> <span class=n>bins</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>])</span>
        <span class=k>if</span> <span class=n>mask</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
            <span class=n>actual_rate</span> <span class=o>=</span> <span class=n>y_test</span><span class=p>[</span><span class=n>mask</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>bins</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2> - </span><span class=si>{</span><span class=n>bins</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>        </span><span class=si>{</span><span class=n>actual_rate</span><span class=si>:</span><span class=s2>&lt;15.3f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>mask</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Well-calibrated: predicted probabilities match true rates&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Unlike SVM/Random Forest (need calibration)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_regularization</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Regularization: C Parameter (Inverse of Œ±)</span>

<span class=sd>    C = 1/Œ± (smaller C = more regularization)</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. Regularization - C Parameter&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Try different C values</span>
    <span class=n>C_values</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.001</span><span class=p>,</span> <span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>10.0</span><span class=p>,</span> <span class=mf>100.0</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;C (regularization)&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Overfit Gap&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>C</span> <span class=ow>in</span> <span class=n>C_values</span><span class=p>:</span>
        <span class=n>lr</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>C</span><span class=o>=</span><span class=n>C</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>lr</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>lr</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>lr</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>gap</span> <span class=o>=</span> <span class=n>train_acc</span> <span class=o>-</span> <span class=n>test_acc</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>C</span><span class=si>:</span><span class=s2>&lt;20.3f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>gap</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  C ‚Üí 0: Strong regularization (high bias, low variance)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  C ‚Üí ‚àû: Weak regularization (low bias, high variance)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  C = 1.0: Default (good starting point)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Tune C to balance bias-variance tradeoff&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_multi_class</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Multi-Class Classification: One-vs-Rest</span>

<span class=sd>    Extends binary to multiple classes</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Multi-Class Classification (One-vs-Rest)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>600</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
        <span class=n>n_classes</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span>  <span class=c1># 4 classes</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># multi_class=&#39;ovr&#39; (One-vs-Rest, default)</span>
    <span class=n>lr_ovr</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>multi_class</span><span class=o>=</span><span class=s1>&#39;ovr&#39;</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>lr_ovr</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># multi_class=&#39;multinomial&#39; (Softmax)</span>
    <span class=n>lr_multi</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>multi_class</span><span class=o>=</span><span class=s1>&#39;multinomial&#39;</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>lr_multi</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>One-vs-Rest Accuracy: </span><span class=si>{</span><span class=n>lr_ovr</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span><span class=w> </span><span class=n>y_test</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Multinomial Accuracy: </span><span class=si>{</span><span class=n>lr_multi</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span><span class=w> </span><span class=n>y_test</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Strategies:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  One-vs-Rest (OvR): Train k binary classifiers&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  Multinomial: Single model with softmax (better for multi-class)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Use multi_class=&#39;multinomial&#39; for better performance&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_class_imbalance</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Handle Class Imbalance: class_weight=&#39;balanced&#39;</span>

<span class=sd>    Automatically adjusts for imbalanced classes</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. Class Imbalance Handling&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
        <span class=n>n_classes</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
        <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>],</span>  <span class=c1># Severe imbalance (10% positive)</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>stratify</span><span class=o>=</span><span class=n>y</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Without class_weight</span>
    <span class=n>lr_default</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>lr_default</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># With class_weight=&#39;balanced&#39;</span>
    <span class=n>lr_balanced</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>class_weight</span><span class=o>=</span><span class=s1>&#39;balanced&#39;</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>lr_balanced</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Model&#39;</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Accuracy&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Recall&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;F1&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>model</span> <span class=ow>in</span> <span class=p>[(</span><span class=s1>&#39;Default&#39;</span><span class=p>,</span> <span class=n>lr_default</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Balanced&#39;</span><span class=p>,</span> <span class=n>lr_balanced</span><span class=p>)]:</span>
        <span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>)</span>
        <span class=n>acc</span> <span class=o>=</span> <span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
        <span class=n>recall</span> <span class=o>=</span> <span class=n>recall_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
        <span class=n>f1</span> <span class=o>=</span> <span class=n>f1_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>recall</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>f1</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ class_weight=&#39;balanced&#39; improves recall on minority class&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_coefficients_interpretation</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Interpret Coefficients: Feature Importance</span>

<span class=sd>    Positive coef = increases P(y=1), Negative = decreases</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;6. Coefficient Interpretation&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>lr</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>lr</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 5 Positive Features (increase P(y=1)):&quot;</span><span class=p>)</span>
    <span class=n>pos_idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>lr</span><span class=o>.</span><span class=n>coef_</span><span class=p>[</span><span class=mi>0</span><span class=p>])[</span><span class=o>-</span><span class=mi>5</span><span class=p>:][::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
    <span class=k>for</span> <span class=n>idx</span> <span class=ow>in</span> <span class=n>pos_idx</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Feature </span><span class=si>{</span><span class=n>idx</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>lr</span><span class=o>.</span><span class=n>coef_</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>idx</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 5 Negative Features (decrease P(y=1)):&quot;</span><span class=p>)</span>
    <span class=n>neg_idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>lr</span><span class=o>.</span><span class=n>coef_</span><span class=p>[</span><span class=mi>0</span><span class=p>])[:</span><span class=mi>5</span><span class=p>]</span>
    <span class=k>for</span> <span class=n>idx</span> <span class=ow>in</span> <span class=n>neg_idx</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Feature </span><span class=si>{</span><span class=n>idx</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>lr</span><span class=o>.</span><span class=n>coef_</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>idx</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Coefficients show feature importance and direction&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_basic_logistic_regression</span><span class=p>()</span>
    <span class=n>demo_probability_calibration</span><span class=p>()</span>
    <span class=n>demo_regularization</span><span class=p>()</span>
    <span class=n>demo_multi_class</span><span class=p>()</span>
    <span class=n>demo_class_imbalance</span><span class=p>()</span>
    <span class=n>demo_coefficients_interpretation</span><span class=p>()</span>
</code></pre></div> <h2 id=logistic-regression-properties>Logistic Regression Properties</h2> <table> <thead> <tr> <th>Property</th> <th>Logistic Regression</th> <th>Details</th> </tr> </thead> <tbody> <tr> <td><strong>Output</strong></td> <td>Probabilities [0, 1]</td> <td>Well-calibrated</td> </tr> <tr> <td><strong>Speed</strong></td> <td>‚ö° Very Fast</td> <td>Similar to Linear Regression</td> </tr> <tr> <td><strong>Interpretability</strong></td> <td>‚úÖ Excellent</td> <td>Coefficients = log-odds ratios</td> </tr> <tr> <td><strong>Multi-class</strong></td> <td>‚úÖ Yes</td> <td>One-vs-Rest or Multinomial</td> </tr> <tr> <td><strong>Regularization</strong></td> <td>L1, L2, ElasticNet</td> <td>Controlled by C parameter</td> </tr> </tbody> </table> <h2 id=when-to-use-logistic-regression>When to Use Logistic Regression</h2> <table> <thead> <tr> <th>Scenario</th> <th>Use LogisticRegression?</th> <th>Reason</th> </tr> </thead> <tbody> <tr> <td><strong>Need probabilities</strong></td> <td>‚úÖ Yes</td> <td>Well-calibrated outputs</td> </tr> <tr> <td><strong>Interpretability critical</strong></td> <td>‚úÖ Yes</td> <td>Clear coefficient interpretation</td> </tr> <tr> <td><strong>Large dataset (&gt;1M rows)</strong></td> <td>‚úÖ Yes</td> <td>Very fast training</td> </tr> <tr> <td><strong>Baseline model</strong></td> <td>‚úÖ Always</td> <td>Start here before complex models</td> </tr> <tr> <td><strong>Non-linear relationships</strong></td> <td>‚ùå No</td> <td>Use kernel SVM, trees, or neural nets</td> </tr> </tbody> </table> <h2 id=real-world-applications_6>Real-World Applications</h2> <table> <thead> <tr> <th>Company</th> <th>Use Case</th> <th>Scale</th> <th>Performance</th> </tr> </thead> <tbody> <tr> <td><strong>Stripe</strong></td> <td>Fraud detection</td> <td>10K+ TPS</td> <td>95%+ recall, &lt;5ms</td> </tr> <tr> <td><strong>Gmail</strong></td> <td>Spam classification</td> <td>Billions/day</td> <td>99.9% accuracy</td> </tr> <tr> <td><strong>LinkedIn</strong></td> <td>Job recommendation</td> <td>Real-time</td> <td>85% CTR improvement</td> </tr> <tr> <td><strong>Medical</strong></td> <td>Disease prediction</td> <td>Interpretable</td> <td>FDA-approved (explainable)</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>sigmoid function</strong> <span class=arithmatex>\(\sigma(z) = \frac{1}{1+e^{-z}}\)</span> outputs probabilities</li> <li>Understands <strong>C parameter</strong> (C = 1/Œ±, smaller C = more regularization)</li> <li>Uses <strong>class_weight='balanced'</strong> for imbalanced data</li> <li>Knows <strong>well-calibrated probabilities</strong> (vs SVM/RF need calibration)</li> <li>Real-world: <strong>Stripe uses LogisticRegression for fraud (95%+ recall, 10K+ transactions/sec)</strong></li> </ul> </div> </details> <hr> <h3 id=explain-the-solver-options-in-logistic-regression-google-amazon-interview-question>Explain the solver options in Logistic Regression - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Optimization</code>, <code>Solvers</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Solvers</strong> are optimization algorithms that find the best coefficients. <strong>Key solvers</strong>: <code>lbfgs</code> (default, L2 only), <code>liblinear</code> (small data, L1/L2), <code>saga</code> (large data, all penalties), <code>sag</code> (large data, L2 only).</p> <p><strong>Real-World Context:</strong> - <strong>Google:</strong> Uses <code>saga</code> for large-scale ad CTR models (billions of examples) - <strong>Startups:</strong> Use <code>lbfgs</code> (default, works well for most cases) - <strong>Sparse data:</strong> Use <code>liblinear</code> or <code>saga</code> with L1 for text classification</p> <h2 id=solver-decision-tree>Solver Decision Tree</h2> <div class=highlight><pre><span></span><code>Dataset Size &amp; Penalty Type
          ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Small data (&lt;10K rows)? ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ YES
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Use: liblinear          ‚îÇ
‚îÇ Fast for small data     ‚îÇ
‚îÇ Supports: L1, L2        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ NO
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Need L1 (sparsity)?     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ YES
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Use: saga               ‚îÇ
‚îÇ Large data + L1/L2/EN   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ NO
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Use: lbfgs (default)    ‚îÇ
‚îÇ Large data + L2         ‚îÇ
‚îÇ Fastest for L2 only     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</code></pre></div> <h2 id=production-implementation-140-lines>Production Implementation (140 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># logistic_solvers_complete.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LogisticRegression</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_solver_comparison</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Compare All Solvers: Speed and Use Cases</span>

<span class=sd>    Different solvers for different scenarios</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Solver Comparison - Speed and Penalties&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Medium-sized dataset</span>
    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>5000</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>solvers</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;lbfgs&#39;</span><span class=p>,</span> <span class=s1>&#39;liblinear&#39;</span><span class=p>,</span> <span class=s1>&#39;saga&#39;</span><span class=p>,</span> <span class=s1>&#39;sag&#39;</span><span class=p>,</span> <span class=s1>&#39;newton-cg&#39;</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Solver&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Time (s)&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Accuracy&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Supports&#39;</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>75</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>solver</span> <span class=ow>in</span> <span class=n>solvers</span><span class=p>:</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
            <span class=n>lr</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>solver</span><span class=o>=</span><span class=n>solver</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
            <span class=n>lr</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
            <span class=n>fit_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

            <span class=n>acc</span> <span class=o>=</span> <span class=n>lr</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

            <span class=c1># Penalties supported</span>
            <span class=k>if</span> <span class=n>solver</span> <span class=o>==</span> <span class=s1>&#39;liblinear&#39;</span><span class=p>:</span>
                <span class=n>supports</span> <span class=o>=</span> <span class=s1>&#39;L1, L2&#39;</span>
            <span class=k>elif</span> <span class=n>solver</span> <span class=o>==</span> <span class=s1>&#39;saga&#39;</span><span class=p>:</span>
                <span class=n>supports</span> <span class=o>=</span> <span class=s1>&#39;L1, L2, ElasticNet&#39;</span>
            <span class=k>elif</span> <span class=n>solver</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;lbfgs&#39;</span><span class=p>,</span> <span class=s1>&#39;newton-cg&#39;</span><span class=p>,</span> <span class=s1>&#39;sag&#39;</span><span class=p>]:</span>
                <span class=n>supports</span> <span class=o>=</span> <span class=s1>&#39;L2 only&#39;</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>supports</span> <span class=o>=</span> <span class=s1>&#39;L2&#39;</span>

            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>solver</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>fit_time</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>supports</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>solver</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> FAILED: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)[:</span><span class=mi>40</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ lbfgs: Default, good for most cases (L2 only)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ saga: Large data, all penalties (L1/L2/ElasticNet)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ liblinear: Small data, L1/L2&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_large_dataset_solvers</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Large Dataset: SAG vs SAGA</span>

<span class=sd>    Stochastic methods for big data</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. Large Dataset - SAG vs SAGA&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>sizes</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1000</span><span class=p>,</span> <span class=mi>5000</span><span class=p>,</span> <span class=mi>10000</span><span class=p>,</span> <span class=mi>50000</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;n_samples&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;lbfgs (s)&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;saga (s)&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Speedup&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>sizes</span><span class=p>:</span>
        <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=n>n</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

        <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

        <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
        <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>

        <span class=c1># lbfgs (default)</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
        <span class=n>lr_lbfgs</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>solver</span><span class=o>=</span><span class=s1>&#39;lbfgs&#39;</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>lr_lbfgs</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>lbfgs_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

        <span class=c1># saga (stochastic)</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
        <span class=n>lr_saga</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>solver</span><span class=o>=</span><span class=s1>&#39;saga&#39;</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>lr_saga</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>saga_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

        <span class=n>speedup</span> <span class=o>=</span> <span class=n>lbfgs_time</span> <span class=o>/</span> <span class=n>saga_time</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>n</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>lbfgs_time</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>saga_time</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>speedup</span><span class=si>:</span><span class=s2>&lt;12.2f</span><span class=si>}</span><span class=s2>x&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ saga faster on very large datasets (&gt;10K samples)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ saga converges faster per iteration (stochastic)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_l1_penalty_solvers</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    L1 Penalty: Feature Selection</span>

<span class=sd>    Only saga and liblinear support L1</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. L1 Penalty - Feature Selection&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># L1 penalty for feature selection</span>
    <span class=n>solvers_l1</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;liblinear&#39;</span><span class=p>,</span> <span class=s1>&#39;saga&#39;</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Solver&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Accuracy&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Non-zero Features&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>solver</span> <span class=ow>in</span> <span class=n>solvers_l1</span><span class=p>:</span>
        <span class=n>lr</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span>
            <span class=n>penalty</span><span class=o>=</span><span class=s1>&#39;l1&#39;</span><span class=p>,</span>
            <span class=n>solver</span><span class=o>=</span><span class=n>solver</span><span class=p>,</span>
            <span class=n>C</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span>  <span class=c1># Strong regularization</span>
            <span class=n>max_iter</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span>
            <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
        <span class=p>)</span>
        <span class=n>lr</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>acc</span> <span class=o>=</span> <span class=n>lr</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>non_zero</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>lr</span><span class=o>.</span><span class=n>coef_</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mf>1e-5</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>solver</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>non_zero</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ L1 penalty creates sparse models (feature selection)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Use liblinear (small data) or saga (large data)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_convergence_warnings</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Convergence: max_iter Parameter</span>

<span class=sd>    Increase max_iter if you see warnings</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Convergence - max_iter Tuning&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>

    <span class=n>max_iters</span> <span class=o>=</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>1000</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;max_iter&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Converged?&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Accuracy&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>45</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>max_iter</span> <span class=ow>in</span> <span class=n>max_iters</span><span class=p>:</span>
        <span class=n>lr</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>solver</span><span class=o>=</span><span class=s1>&#39;lbfgs&#39;</span><span class=p>,</span> <span class=n>max_iter</span><span class=o>=</span><span class=n>max_iter</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

        <span class=kn>import</span><span class=w> </span><span class=nn>warnings</span>
        <span class=k>with</span> <span class=n>warnings</span><span class=o>.</span><span class=n>catch_warnings</span><span class=p>(</span><span class=n>record</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span> <span class=k>as</span> <span class=n>w</span><span class=p>:</span>
            <span class=n>warnings</span><span class=o>.</span><span class=n>simplefilter</span><span class=p>(</span><span class=s2>&quot;always&quot;</span><span class=p>)</span>
            <span class=n>lr</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

            <span class=n>converged</span> <span class=o>=</span> <span class=s2>&quot;Yes&quot;</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>w</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=s2>&quot;No (warning)&quot;</span>
            <span class=n>acc</span> <span class=o>=</span> <span class=n>lr</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>max_iter</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>converged</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Increase max_iter if you see convergence warnings&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Default max_iter=100 usually sufficient&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_solver_comparison</span><span class=p>()</span>
    <span class=n>demo_large_dataset_solvers</span><span class=p>()</span>
    <span class=n>demo_l1_penalty_solvers</span><span class=p>()</span>
    <span class=n>demo_convergence_warnings</span><span class=p>()</span>
</code></pre></div> <h2 id=solver-comparison-table>Solver Comparison Table</h2> <table> <thead> <tr> <th>Solver</th> <th>Penalties</th> <th>Best For</th> <th>Speed</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td><strong>lbfgs</strong></td> <td>L2 only</td> <td>Default choice</td> <td>‚ö° Fast</td> <td>Quasi-Newton method</td> </tr> <tr> <td><strong>liblinear</strong></td> <td>L1, L2</td> <td>Small data (&lt;10K)</td> <td>‚ö° Very Fast</td> <td>Coordinate descent</td> </tr> <tr> <td><strong>saga</strong></td> <td>L1, L2, ElasticNet</td> <td>Large data + L1</td> <td>üü° Medium</td> <td>Stochastic, all penalties</td> </tr> <tr> <td><strong>sag</strong></td> <td>L2 only</td> <td>Large data + L2</td> <td>‚ö° Fast</td> <td>Stochastic (L2 only)</td> </tr> <tr> <td><strong>newton-cg</strong></td> <td>L2 only</td> <td>Rarely used</td> <td>üü° Slower</td> <td>Newton method</td> </tr> </tbody> </table> <h2 id=solver-selection-guide>Solver Selection Guide</h2> <table> <thead> <tr> <th>Scenario</th> <th>Best Solver</th> <th>Reason</th> </tr> </thead> <tbody> <tr> <td><strong>Default (most cases)</strong></td> <td>lbfgs</td> <td>Fast, robust, L2 penalty</td> </tr> <tr> <td><strong>Small data (&lt;10K)</strong></td> <td>liblinear</td> <td>Fastest for small datasets</td> </tr> <tr> <td><strong>Large data (&gt;100K)</strong></td> <td>saga or sag</td> <td>Stochastic methods scale better</td> </tr> <tr> <td><strong>Need L1 (feature selection)</strong></td> <td>saga or liblinear</td> <td>Only ones supporting L1</td> </tr> <tr> <td><strong>Need ElasticNet</strong></td> <td>saga</td> <td>Only solver supporting ElasticNet</td> </tr> <tr> <td><strong>Multi-class + large data</strong></td> <td>saga</td> <td>Handles multinomial efficiently</td> </tr> </tbody> </table> <h2 id=real-world-solver-usage>Real-World Solver Usage</h2> <table> <thead> <tr> <th>Company</th> <th>Solver</th> <th>Reason</th> <th>Scale</th> </tr> </thead> <tbody> <tr> <td><strong>Google</strong></td> <td>saga</td> <td>Large data (billions), L1 for sparsity</td> <td>&gt;1B samples</td> </tr> <tr> <td><strong>Startups</strong></td> <td>lbfgs</td> <td>Default, works well for most</td> <td>&lt;1M samples</td> </tr> <tr> <td><strong>Text classification</strong></td> <td>saga + L1</td> <td>Sparse features, feature selection</td> <td>Millions of features</td> </tr> <tr> <td><strong>Real-time systems</strong></td> <td>liblinear</td> <td>Fast inference, small models</td> <td>&lt;10K samples</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>lbfgs is default</strong> (good for most cases, L2 only)</li> <li>Uses <strong>saga for large data or L1 penalty</strong> (stochastic, all penalties)</li> <li>Uses <strong>liblinear for small data</strong> (&lt;10K samples, fast)</li> <li>Understands <strong>stochastic methods</strong> (saga/sag) converge faster on large data</li> <li>Knows <strong>only saga and liblinear support L1</strong> for feature selection</li> <li>Real-world: <strong>Google uses saga for large-scale CTR prediction (billions of samples, L1 for sparsity)</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-implement-decision-trees-most-tech-companies-interview-question>How to implement Decision Trees? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Decision Trees</code>, <code>Classification</code>, <code>Regression</code> | <strong>Asked by:</strong> Most Tech Companies</p> <details class=success> <summary>View Answer</summary> <p><strong>Decision Trees</strong> recursively split data based on features to create a tree structure. They use <strong>impurity measures</strong> (Gini for classification, MSE for regression) to find optimal splits. Highly <strong>interpretable</strong> but prone to <strong>overfitting</strong>.</p> <p><strong>Real-World Context:</strong> - <strong>Credit Scoring:</strong> Loan approval decisions (interpretable for regulators) - <strong>Medical:</strong> Disease diagnosis (doctors can follow decision paths) - <strong>Customer Service:</strong> Support ticket routing (clear rules)</p> <h2 id=decision-tree-structure>Decision Tree Structure</h2> <div class=highlight><pre><span></span><code>Root Node (all data)
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Feature: Age &lt; 30?   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ          ‚îÇ
   YES‚îÇ          ‚îÇNO
      ‚Üì          ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇIncome   ‚îÇ  ‚îÇEducation ‚îÇ
‚îÇ&lt; 50K?   ‚îÇ  ‚îÇ= College?‚îÇ
‚îî‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îò
   ‚îÇ  ‚îÇ          ‚îÇ  ‚îÇ
  ...  ...      ...  ...
   ‚Üì    ‚Üì        ‚Üì    ‚Üì
[Leaf] [Leaf] [Leaf] [Leaf]
Predict Predict Predict Predict
</code></pre></div> <h2 id=production-implementation-170-lines_1>Production Implementation (170 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># decision_tree_complete.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.tree</span><span class=w> </span><span class=kn>import</span> <span class=n>DecisionTreeClassifier</span><span class=p>,</span> <span class=n>DecisionTreeRegressor</span><span class=p>,</span> <span class=n>plot_tree</span><span class=p>,</span> <span class=n>export_text</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>cross_val_score</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>accuracy_score</span><span class=p>,</span> <span class=n>mean_squared_error</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span><span class=p>,</span> <span class=n>make_regression</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_basic_decision_tree</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Basic Decision Tree Classifier</span>

<span class=sd>    Simple, interpretable model</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Basic Decision Tree - Classification&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
        <span class=n>n_classes</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Train tree</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
    <span class=n>dt</span> <span class=o>=</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>dt</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>train_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

    <span class=c1># Evaluate</span>
    <span class=n>train_acc</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>test_acc</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Performance:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Train Accuracy: </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Test Accuracy:  </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Overfit Gap:    </span><span class=si>{</span><span class=n>train_acc</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>test_acc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Tree Statistics:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Depth: </span><span class=si>{</span><span class=n>dt</span><span class=o>.</span><span class=n>get_depth</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Leaves: </span><span class=si>{</span><span class=n>dt</span><span class=o>.</span><span class=n>get_n_leaves</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Training time: </span><span class=si>{</span><span class=n>train_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚ö†Ô∏è  Notice high train accuracy (overfitting common)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Interpretable: Can visualize decision rules&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_gini_vs_entropy</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Splitting Criteria: Gini vs Entropy</span>

<span class=sd>    Gini faster, Entropy slightly more balanced trees</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. Splitting Criteria - Gini vs Entropy&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>criteria</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;gini&#39;</span><span class=p>,</span> <span class=s1>&#39;entropy&#39;</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Criterion&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Depth&#39;</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Leaves&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>65</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>criterion</span> <span class=ow>in</span> <span class=n>criteria</span><span class=p>:</span>
        <span class=n>dt</span> <span class=o>=</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>criterion</span><span class=o>=</span><span class=n>criterion</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>dt</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>depth</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>get_depth</span><span class=p>()</span>
        <span class=n>leaves</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>get_n_leaves</span><span class=p>()</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>criterion</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>depth</span><span class=si>:</span><span class=s2>&lt;8</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>leaves</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Gini: $Gini = 1 - </span><span class=se>\\</span><span class=s2>sum p_i^2$ (default, faster)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Entropy: $H = -</span><span class=se>\\</span><span class=s2>sum p_i </span><span class=se>\\</span><span class=s2>log(p_i)$ (information gain)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Use gini (default, faster, similar performance)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_pruning_max_depth</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Prevent Overfitting: max_depth Parameter</span>

<span class=sd>    Critical hyperparameter for generalization</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. Pruning - max_depth Parameter&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>max_depths</span> <span class=o>=</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;max_depth&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Overfit Gap&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>55</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>max_depth</span> <span class=ow>in</span> <span class=n>max_depths</span><span class=p>:</span>
        <span class=n>dt</span> <span class=o>=</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>max_depth</span><span class=o>=</span><span class=n>max_depth</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>dt</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>gap</span> <span class=o>=</span> <span class=n>train_acc</span> <span class=o>-</span> <span class=n>test_acc</span>

        <span class=n>depth_str</span> <span class=o>=</span> <span class=s2>&quot;None&quot;</span> <span class=k>if</span> <span class=n>max_depth</span> <span class=ow>is</span> <span class=kc>None</span> <span class=k>else</span> <span class=nb>str</span><span class=p>(</span><span class=n>max_depth</span><span class=p>)</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>depth_str</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>gap</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  max_depth=None: Full tree, overfits (gap &gt; 0.1)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  max_depth=5-10: Usually optimal (balance bias-variance)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  max_depth=2-3: Underfits (low train accuracy)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Tune max_depth to prevent overfitting&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_min_samples_split</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Another Pruning Method: min_samples_split</span>

<span class=sd>    Minimum samples required to split node</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Pruning - min_samples_split Parameter&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>min_samples_splits</span> <span class=o>=</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;min_samples&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Leaves&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>55</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>min_samples</span> <span class=ow>in</span> <span class=n>min_samples_splits</span><span class=p>:</span>
        <span class=n>dt</span> <span class=o>=</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>min_samples_split</span><span class=o>=</span><span class=n>min_samples</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>dt</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>leaves</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>get_n_leaves</span><span class=p>()</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>min_samples</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>leaves</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Higher min_samples_split ‚Üí fewer leaves ‚Üí less overfit&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_feature_importance</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Feature Importance: Which features matter?</span>

<span class=sd>    Based on impurity reduction</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. Feature Importance Extraction&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>dt</span> <span class=o>=</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>max_depth</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>dt</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># Get feature importances</span>
    <span class=n>importances</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>feature_importances_</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Feature Importances:&quot;</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>imp</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>importances</span><span class=p>):</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Feature </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>imp</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;***&#39;</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>imp</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>0.1</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ feature_importances_ shows which features split best&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Based on Gini/Entropy reduction&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_regression_tree</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Decision Tree Regression</span>

<span class=sd>    Predicts continuous values</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;6. Decision Tree Regression&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>noise</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Regression tree</span>
    <span class=n>dt_reg</span> <span class=o>=</span> <span class=n>DecisionTreeRegressor</span><span class=p>(</span><span class=n>max_depth</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>dt_reg</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=n>y_pred</span> <span class=o>=</span> <span class=n>dt_reg</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>rmse</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>mean_squared_error</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>))</span>
    <span class=n>r2</span> <span class=o>=</span> <span class=n>dt_reg</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Regression Performance:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  R¬≤ Score: </span><span class=si>{</span><span class=n>r2</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  RMSE: </span><span class=si>{</span><span class=n>rmse</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Tree Depth: </span><span class=si>{</span><span class=n>dt_reg</span><span class=o>.</span><span class=n>get_depth</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Uses MSE for splitting (not Gini/Entropy)&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_basic_decision_tree</span><span class=p>()</span>
    <span class=n>demo_gini_vs_entropy</span><span class=p>()</span>
    <span class=n>demo_pruning_max_depth</span><span class=p>()</span>
    <span class=n>demo_min_samples_split</span><span class=p>()</span>
    <span class=n>demo_feature_importance</span><span class=p>()</span>
    <span class=n>demo_regression_tree</span><span class=p>()</span>
</code></pre></div> <h2 id=decision-tree-hyperparameters>Decision Tree Hyperparameters</h2> <table> <thead> <tr> <th>Parameter</th> <th>Effect</th> <th>Typical Values</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td><strong>max_depth</strong></td> <td>Limits tree depth</td> <td>3-10 (tune!)</td> <td>Prevent overfitting</td> </tr> <tr> <td><strong>min_samples_split</strong></td> <td>Min samples to split</td> <td>2-50</td> <td>Prevent tiny splits</td> </tr> <tr> <td><strong>min_samples_leaf</strong></td> <td>Min samples in leaf</td> <td>1-20</td> <td>Smoother predictions</td> </tr> <tr> <td><strong>max_features</strong></td> <td>Features per split</td> <td>'sqrt', 'log2'</td> <td>Add randomness (for RF)</td> </tr> <tr> <td><strong>criterion</strong></td> <td>Split quality</td> <td>'gini', 'entropy'</td> <td>Splitting rule</td> </tr> </tbody> </table> <h2 id=advantages-vs-disadvantages>Advantages vs Disadvantages</h2> <table> <thead> <tr> <th>Advantages ‚úÖ</th> <th>Disadvantages ‚ùå</th> </tr> </thead> <tbody> <tr> <td>Highly interpretable</td> <td>Prone to overfitting</td> </tr> <tr> <td>No feature scaling needed</td> <td>High variance (small data changes ‚Üí big tree changes)</td> </tr> <tr> <td>Handles non-linear relationships</td> <td>Not great for extrapolation</td> </tr> <tr> <td>Fast training and prediction</td> <td>Biased toward high-cardinality features</td> </tr> <tr> <td>Handles missing values (some implementations)</td> <td>Needs pruning for generalization</td> </tr> </tbody> </table> <h2 id=real-world-applications_7>Real-World Applications</h2> <table> <thead> <tr> <th>Domain</th> <th>Use Case</th> <th>Why Decision Trees</th> </tr> </thead> <tbody> <tr> <td><strong>Finance</strong></td> <td>Loan approval</td> <td>Interpretable (regulatory)</td> </tr> <tr> <td><strong>Medical</strong></td> <td>Diagnosis</td> <td>Doctors follow tree logic</td> </tr> <tr> <td><strong>Customer Service</strong></td> <td>Ticket routing</td> <td>Clear decision rules</td> </tr> <tr> <td><strong>E-commerce</strong></td> <td>Product recommendations</td> <td>Fast, explainable</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>Gini vs Entropy</strong> (Gini faster, similar performance)</li> <li><strong>Always prunes</strong> (max_depth, min_samples_split) to prevent overfitting</li> <li>Understands <strong>high variance</strong> problem (use Random Forest to stabilize)</li> <li>Uses <strong>feature_importances_</strong> to understand model</li> <li>Knows <strong>no scaling needed</strong> (unlike linear models, SVM, KNN)</li> <li>Real-world: <strong>Credit scoring uses Decision Trees for interpretability (regulatory compliance)</strong></li> </ul> </div> </details> <hr> <h3 id=what-are-the-hyperparameters-for-decision-trees-google-amazon-interview-question>What are the hyperparameters for Decision Trees? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Hyperparameters</code>, <code>Tuning</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>Key hyperparameters</strong>: <code>max_depth</code> (tree depth), <code>min_samples_split</code> (min to split), <code>min_samples_leaf</code> (min in leaf), <code>max_features</code> (features per split), <code>criterion</code> (Gini/entropy). <strong>Most critical: max_depth</strong> to prevent overfitting.</p> <p><strong>Real-World Context:</strong> - <strong>Netflix:</strong> max_depth=8, min_samples_leaf=50 (prevents overfitting on sparse user data) - <strong>Uber:</strong> max_depth=10, max_features='sqrt' (balance accuracy and speed) - <strong>Credit scoring:</strong> max_depth=5 (regulatory interpretability)</p> <h2 id=hyperparameter-impact-flow>Hyperparameter Impact Flow</h2> <div class=highlight><pre><span></span><code>Raw Tree (no constraints)
          ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Problem: Overfits!     ‚îÇ
‚îÇ - Train: 100% accuracy ‚îÇ
‚îÇ - Test:  75% accuracy  ‚îÇ
‚îÇ - Depth: 25+           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì
Apply Constraints:

max_depth=10  ‚îÄ‚îÄ‚Üí  Limits depth
min_samples_split=20 ‚îÄ‚îÄ‚Üí Won&#39;t split small nodes
min_samples_leaf=10 ‚îÄ‚îÄ‚Üí Leaves must have ‚â•10 samples
max_features=&#39;sqrt&#39; ‚îÄ‚îÄ‚Üí Random feature subset
           ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Pruned Tree            ‚îÇ
‚îÇ - Train: 88% accuracy  ‚îÇ
‚îÇ - Test:  85% accuracy  ‚îÇ
‚îÇ - Depth: 10            ‚îÇ
‚îÇ - Better generalization‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</code></pre></div> <h2 id=production-implementation-160-lines>Production Implementation (160 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># decision_tree_hyperparameters.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.tree</span><span class=w> </span><span class=kn>import</span> <span class=n>DecisionTreeClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>GridSearchCV</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_max_depth_impact</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    max_depth: Most Important Hyperparameter</span>

<span class=sd>    Controls complexity and overfitting</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. max_depth - Tree Complexity Control&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>800</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.25</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>depths</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;max_depth&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Gap&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Leaves&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>65</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>depth</span> <span class=ow>in</span> <span class=n>depths</span><span class=p>:</span>
        <span class=n>dt</span> <span class=o>=</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>max_depth</span><span class=o>=</span><span class=n>depth</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>dt</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>gap</span> <span class=o>=</span> <span class=n>train_acc</span> <span class=o>-</span> <span class=n>test_acc</span>
        <span class=n>leaves</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>get_n_leaves</span><span class=p>()</span>

        <span class=n>depth_str</span> <span class=o>=</span> <span class=s2>&quot;None&quot;</span> <span class=k>if</span> <span class=n>depth</span> <span class=ow>is</span> <span class=kc>None</span> <span class=k>else</span> <span class=nb>str</span><span class=p>(</span><span class=n>depth</span><span class=p>)</span>
        <span class=n>status</span> <span class=o>=</span> <span class=s2>&quot;üî¥ Overfit&quot;</span> <span class=k>if</span> <span class=n>gap</span> <span class=o>&gt;</span> <span class=mf>0.1</span> <span class=k>else</span> <span class=s2>&quot;üü¢ Good&quot;</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>depth_str</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>gap</span><span class=si>:</span><span class=s2>&lt;10.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>leaves</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>status</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ max_depth=5-10 typically optimal (balance complexity/generalization)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_min_samples_parameters</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    min_samples_split &amp; min_samples_leaf</span>

<span class=sd>    Control minimum node sizes</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. min_samples_split &amp; min_samples_leaf&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Vary min_samples_split</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>min_samples_split (min to split a node):&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Value&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Leaves&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>55</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>min_split</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>]:</span>
        <span class=n>dt</span> <span class=o>=</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>min_samples_split</span><span class=o>=</span><span class=n>min_split</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>dt</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>leaves</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>get_n_leaves</span><span class=p>()</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>min_split</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>leaves</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Vary min_samples_leaf</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>min_samples_leaf (min samples in leaf):&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Value&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Leaves&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>55</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>min_leaf</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>50</span><span class=p>]:</span>
        <span class=n>dt</span> <span class=o>=</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>min_samples_leaf</span><span class=o>=</span><span class=n>min_leaf</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>dt</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>leaves</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>get_n_leaves</span><span class=p>()</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>min_leaf</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>leaves</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Higher values ‚Üí fewer leaves ‚Üí less overfitting&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_max_features</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    max_features: Random Feature Selection</span>

<span class=sd>    Adds randomness, useful for ensembles</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. max_features - Feature Sampling&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>600</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>max_features_options</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>,</span> <span class=s1>&#39;sqrt&#39;</span><span class=p>,</span> <span class=s1>&#39;log2&#39;</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;max_features&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Features Used&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>max_feat</span> <span class=ow>in</span> <span class=n>max_features_options</span><span class=p>:</span>
        <span class=n>dt</span> <span class=o>=</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>max_features</span><span class=o>=</span><span class=n>max_feat</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>dt</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>max_feat</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>feat_str</span> <span class=o>=</span> <span class=s2>&quot;30 (all)&quot;</span>
        <span class=k>elif</span> <span class=n>max_feat</span> <span class=o>==</span> <span class=s1>&#39;sqrt&#39;</span><span class=p>:</span>
            <span class=n>feat_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>30</span><span class=p>))</span><span class=si>}</span><span class=s2> (‚àö30)&quot;</span>
        <span class=k>elif</span> <span class=n>max_feat</span> <span class=o>==</span> <span class=s1>&#39;log2&#39;</span><span class=p>:</span>
            <span class=n>feat_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>log2</span><span class=p>(</span><span class=mi>30</span><span class=p>))</span><span class=si>}</span><span class=s2> (log‚ÇÇ30)&quot;</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>feat_str</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>max_feat</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>max_feat</span><span class=p>)</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>feat_str</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ max_features=&#39;sqrt&#39; common for Random Forest&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Adds randomness, prevents overfitting&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_class_weight</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    class_weight: Handle Imbalanced Data</span>

<span class=sd>    Automatically balance classes</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. class_weight - Imbalanced Data&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
        <span class=n>n_classes</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
        <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>],</span>  <span class=c1># Severe imbalance</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>stratify</span><span class=o>=</span><span class=n>y</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>precision_score</span><span class=p>,</span> <span class=n>recall_score</span>

    <span class=n>configs</span> <span class=o>=</span> <span class=p>[</span>
        <span class=p>(</span><span class=s1>&#39;None&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>),</span>
        <span class=p>(</span><span class=s1>&#39;Balanced&#39;</span><span class=p>,</span> <span class=s1>&#39;balanced&#39;</span><span class=p>)</span>
    <span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;class_weight&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Accuracy&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Precision&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Recall&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>class_weight</span> <span class=ow>in</span> <span class=n>configs</span><span class=p>:</span>
        <span class=n>dt</span> <span class=o>=</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>class_weight</span><span class=o>=</span><span class=n>class_weight</span><span class=p>,</span> <span class=n>max_depth</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>dt</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>y_pred</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

        <span class=n>acc</span> <span class=o>=</span> <span class=p>(</span><span class=n>y_pred</span> <span class=o>==</span> <span class=n>y_test</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
        <span class=n>prec</span> <span class=o>=</span> <span class=n>precision_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
        <span class=n>rec</span> <span class=o>=</span> <span class=n>recall_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>prec</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>rec</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ class_weight=&#39;balanced&#39; improves minority class recall&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_gridsearch_tuning</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    GridSearchCV: Automatic Hyperparameter Tuning</span>

<span class=sd>    Find optimal combination</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. GridSearchCV - Automatic Tuning&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Parameter grid</span>
    <span class=n>param_grid</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;max_depth&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>10</span><span class=p>],</span>
        <span class=s1>&#39;min_samples_split&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>],</span>
        <span class=s1>&#39;min_samples_leaf&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>]</span>
    <span class=p>}</span>

    <span class=n>dt</span> <span class=o>=</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>grid</span> <span class=o>=</span> <span class=n>GridSearchCV</span><span class=p>(</span><span class=n>dt</span><span class=p>,</span> <span class=n>param_grid</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;accuracy&#39;</span><span class=p>,</span> <span class=n>n_jobs</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span>
    <span class=n>grid</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Best Parameters:&quot;</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>param</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>grid</span><span class=o>.</span><span class=n>best_params_</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>param</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Best CV Score: </span><span class=si>{</span><span class=n>grid</span><span class=o>.</span><span class=n>best_score_</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Test Score: </span><span class=si>{</span><span class=n>grid</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span><span class=w> </span><span class=n>y_test</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ GridSearchCV finds optimal hyperparameter combination&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_max_depth_impact</span><span class=p>()</span>
    <span class=n>demo_min_samples_parameters</span><span class=p>()</span>
    <span class=n>demo_max_features</span><span class=p>()</span>
    <span class=n>demo_class_weight</span><span class=p>()</span>
    <span class=n>demo_gridsearch_tuning</span><span class=p>()</span>
</code></pre></div> <h2 id=hyperparameter-tuning-guide>Hyperparameter Tuning Guide</h2> <table> <thead> <tr> <th>Parameter</th> <th>Range to Try</th> <th>Impact</th> <th>Priority</th> </tr> </thead> <tbody> <tr> <td><strong>max_depth</strong></td> <td>[3, 5, 7, 10, 15]</td> <td>Controls overfitting</td> <td>üî¥ Critical</td> </tr> <tr> <td><strong>min_samples_split</strong></td> <td>[2, 10, 20, 50]</td> <td>Prevents small splits</td> <td>üü° Important</td> </tr> <tr> <td><strong>min_samples_leaf</strong></td> <td>[1, 5, 10, 20]</td> <td>Smooths predictions</td> <td>üü° Important</td> </tr> <tr> <td><strong>max_features</strong></td> <td>['sqrt', 'log2', None]</td> <td>Adds randomness</td> <td>üü¢ For RF</td> </tr> <tr> <td><strong>criterion</strong></td> <td>['gini', 'entropy']</td> <td>Split quality</td> <td>üü¢ Minor</td> </tr> </tbody> </table> <h2 id=common-hyperparameter-combinations>Common Hyperparameter Combinations</h2> <table> <thead> <tr> <th>Use Case</th> <th>Configuration</th> <th>Reason</th> </tr> </thead> <tbody> <tr> <td><strong>Default (baseline)</strong></td> <td>max_depth=None, min_samples_split=2</td> <td>Full tree, likely overfits</td> </tr> <tr> <td><strong>Prevent overfitting</strong></td> <td>max_depth=5-7, min_samples_leaf=10</td> <td>Pruned, generalizes better</td> </tr> <tr> <td><strong>Large dataset</strong></td> <td>max_depth=10, min_samples_split=50</td> <td>Can handle deeper trees</td> </tr> <tr> <td><strong>Imbalanced data</strong></td> <td>class_weight='balanced'</td> <td>Adjust for class imbalance</td> </tr> <tr> <td><strong>Random Forest prep</strong></td> <td>max_features='sqrt'</td> <td>Adds diversity for ensemble</td> </tr> </tbody> </table> <h2 id=real-world-configurations>Real-World Configurations</h2> <table> <thead> <tr> <th>Company</th> <th>Configuration</th> <th>Why</th> </tr> </thead> <tbody> <tr> <td><strong>Netflix</strong></td> <td>max_depth=8, min_samples_leaf=50</td> <td>Sparse user data, prevent overfit</td> </tr> <tr> <td><strong>Uber</strong></td> <td>max_depth=10, max_features='sqrt'</td> <td>Large data, fast inference</td> </tr> <tr> <td><strong>Credit Scoring</strong></td> <td>max_depth=5, min_samples_leaf=20</td> <td>Interpretability, regulatory</td> </tr> <tr> <td><strong>Medical</strong></td> <td>max_depth=4, min_samples_leaf=30</td> <td>Very interpretable, conservative</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li><strong>Always tunes max_depth</strong> (most critical, controls overfitting)</li> <li>Uses <strong>min_samples_split and min_samples_leaf</strong> together for pruning</li> <li>Knows <strong>max_features='sqrt'</strong> used in Random Forest (adds randomness)</li> <li>Uses <strong>GridSearchCV</strong> to find optimal combination systematically</li> <li>Sets <strong>class_weight='balanced'</strong> for imbalanced data</li> <li>Real-world: <strong>Netflix uses max_depth=8, min_samples_leaf=50 (prevents overfitting on sparse user data)</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-implement-random-forest-most-tech-companies-interview-question>How to implement Random Forest? - Most Tech Companies Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Random Forest</code>, <code>Ensemble</code>, <code>Bagging</code> | <strong>Asked by:</strong> Most Tech Companies</p> <details class=success> <summary>View Answer</summary> <p><strong>Random Forest</strong> is an ensemble of Decision Trees trained on <strong>bootstrap samples</strong> with <strong>random feature selection</strong>. It combines predictions via <strong>voting (classification)</strong> or <strong>averaging (regression)</strong>. Reduces variance compared to single trees.</p> <p><strong>Formula:</strong> <span class=arithmatex>\(\hat{y} = \frac{1}{n_{trees}} \sum_{i=1}^{n_{trees}} f_i(x)\)</span> (regression) or majority vote (classification)</p> <p><strong>Real-World Context:</strong> - <strong>Kaggle:</strong> Most popular algorithm (wins many competitions) - <strong>Airbnb:</strong> Price prediction (R¬≤=0.87, robust to outliers) - <strong>Banking:</strong> Credit risk (interpretable via feature importance)</p> <h2 id=random-forest-architecture>Random Forest Architecture</h2> <div class=highlight><pre><span></span><code>Training Data (n samples)
        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Bootstrap Sampling          ‚îÇ
‚îÇ (sample with replacement)   ‚îÇ
‚îî‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îò
   ‚îÇ        ‚îÇ        ‚îÇ     ‚îÇ
   ‚Üì        ‚Üì        ‚Üì     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ...  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇTree 1‚îÇ ‚îÇTree 2‚îÇ ‚îÇTree 3‚îÇ      ‚îÇTree n‚îÇ
‚îÇ      ‚îÇ ‚îÇ      ‚îÇ ‚îÇ      ‚îÇ      ‚îÇ      ‚îÇ
‚îÇmax_  ‚îÇ ‚îÇmax_  ‚îÇ ‚îÇmax_  ‚îÇ      ‚îÇmax_  ‚îÇ
‚îÇfeat  ‚îÇ ‚îÇfeat  ‚îÇ ‚îÇfeat  ‚îÇ      ‚îÇfeat  ‚îÇ
‚îÇ=&#39;sqrt‚îÇ ‚îÇ=&#39;sqrt‚îÇ ‚îÇ=&#39;sqrt‚îÇ      ‚îÇ=&#39;sqrt‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îò
    ‚îÇ        ‚îÇ        ‚îÇ            ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚Üì
      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
      ‚îÇ  Aggregate:     ‚îÇ
      ‚îÇ  - Classification:‚îÇ
      ‚îÇ    Majority Vote ‚îÇ
      ‚îÇ  - Regression:   ‚îÇ
      ‚îÇ    Average       ‚îÇ
      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</code></pre></div> <h2 id=production-implementation-175-lines_1>Production Implementation (175 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># random_forest_complete.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span><span class=p>,</span> <span class=n>RandomForestRegressor</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.tree</span><span class=w> </span><span class=kn>import</span> <span class=n>DecisionTreeClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>cross_val_score</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>accuracy_score</span><span class=p>,</span> <span class=n>mean_squared_error</span><span class=p>,</span> <span class=n>r2_score</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span><span class=p>,</span> <span class=n>make_regression</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_rf_vs_single_tree</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Random Forest vs Single Decision Tree</span>

<span class=sd>    Ensemble reduces variance</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Random Forest vs Single Tree - Variance Reduction&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Single tree</span>
    <span class=n>dt</span> <span class=o>=</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>dt</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># Random Forest</span>
    <span class=n>rf</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>rf</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Model&#39;</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Overfit Gap&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=n>models</span> <span class=o>=</span> <span class=p>[(</span><span class=s1>&#39;Single Decision Tree&#39;</span><span class=p>,</span> <span class=n>dt</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Random Forest (100 trees)&#39;</span><span class=p>,</span> <span class=n>rf</span><span class=p>)]</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>models</span><span class=p>:</span>
        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>gap</span> <span class=o>=</span> <span class=n>train_acc</span> <span class=o>-</span> <span class=n>test_acc</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>gap</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Random Forest reduces overfitting (lower gap)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Ensemble of trees more stable than single tree&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_n_estimators_tuning</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    n_estimators: Number of Trees</span>

<span class=sd>    More trees ‚Üí better performance (diminishing returns)</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. n_estimators - Number of Trees&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>800</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>n_trees</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>500</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;n_estimators&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Time (s)&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>n_trees</span><span class=p>:</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
        <span class=n>rf</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=n>n</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>n_jobs</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span>
        <span class=n>rf</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>fit_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>rf</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>rf</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>n</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>fit_time</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  n=1: Just a single tree (high variance)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  n=100: Good default (diminishing returns after)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  n=500+: Marginal improvement, much slower&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ n_estimators=100-200 typically sufficient&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_max_features</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    max_features: Random Feature Selection</span>

<span class=sd>    Key to ensemble diversity</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. max_features - Feature Sampling (Critical!)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>600</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>max_features_options</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;sqrt&#39;</span><span class=p>,</span> <span class=s1>&#39;log2&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;max_features&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Features/Split&#39;</span><span class=si>:</span><span class=s2>&lt;18</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Tree Diversity&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>75</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>max_feat</span> <span class=ow>in</span> <span class=n>max_features_options</span><span class=p>:</span>
        <span class=n>rf</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>max_features</span><span class=o>=</span><span class=n>max_feat</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>rf</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>rf</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>max_feat</span> <span class=o>==</span> <span class=s1>&#39;sqrt&#39;</span><span class=p>:</span>
            <span class=n>feat_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>30</span><span class=p>))</span><span class=si>}</span><span class=s2> (‚àöp)&quot;</span>
        <span class=k>elif</span> <span class=n>max_feat</span> <span class=o>==</span> <span class=s1>&#39;log2&#39;</span><span class=p>:</span>
            <span class=n>feat_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>log2</span><span class=p>(</span><span class=mi>30</span><span class=p>))</span><span class=si>}</span><span class=s2> (log‚ÇÇp)&quot;</span>
        <span class=k>elif</span> <span class=n>max_feat</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>feat_str</span> <span class=o>=</span> <span class=s2>&quot;30 (all)&quot;</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>feat_str</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>max_feat</span><span class=p>)</span>

        <span class=n>diversity</span> <span class=o>=</span> <span class=s2>&quot;High&quot;</span> <span class=k>if</span> <span class=n>max_feat</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;sqrt&#39;</span><span class=p>,</span> <span class=s1>&#39;log2&#39;</span><span class=p>]</span> <span class=k>else</span> <span class=s2>&quot;Low&quot;</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>max_feat</span><span class=p>)</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>feat_str</span><span class=si>:</span><span class=s2>&lt;18</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>diversity</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ max_features=&#39;sqrt&#39; (default): Good diversity&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Smaller max_features ‚Üí more diverse trees ‚Üí better ensemble&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_feature_importance</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Feature Importance: Aggregated from All Trees</span>

<span class=sd>    More reliable than single tree</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Feature Importance (Aggregated)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Single tree</span>
    <span class=n>dt</span> <span class=o>=</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>dt</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># Random Forest</span>
    <span class=n>rf</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>rf</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 5 Features (Single Tree vs Random Forest):&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Feature&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Single Tree&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Random Forest&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>

    <span class=c1># Top 5 from single tree</span>
    <span class=n>dt_top5</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>dt</span><span class=o>.</span><span class=n>feature_importances_</span><span class=p>)[</span><span class=o>-</span><span class=mi>5</span><span class=p>:][::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
    <span class=n>rf_top5</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>rf</span><span class=o>.</span><span class=n>feature_importances_</span><span class=p>)[</span><span class=o>-</span><span class=mi>5</span><span class=p>:][::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>

    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>):</span>
        <span class=n>dt_feat</span> <span class=o>=</span> <span class=n>dt_top5</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
        <span class=n>rf_feat</span> <span class=o>=</span> <span class=n>rf_top5</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
        <span class=n>dt_imp</span> <span class=o>=</span> <span class=n>dt</span><span class=o>.</span><span class=n>feature_importances_</span><span class=p>[</span><span class=n>dt_feat</span><span class=p>]</span>
        <span class=n>rf_imp</span> <span class=o>=</span> <span class=n>rf</span><span class=o>.</span><span class=n>feature_importances_</span><span class=p>[</span><span class=n>rf_feat</span><span class=p>]</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Rank </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>:</span><span class=s2>&lt;6</span><span class=si>}</span><span class=s2> F</span><span class=si>{</span><span class=n>dt_feat</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>dt_imp</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>      F</span><span class=si>{</span><span class=n>rf_feat</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>rf_imp</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Random Forest importance more stable (averaged over trees)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_oob_score</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Out-of-Bag (OOB) Score: Free Validation</span>

<span class=sd>    Uses bootstrap samples not seen by each tree</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. Out-of-Bag (OOB) Score - Free Validation&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Enable OOB scoring</span>
    <span class=n>rf</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span>
        <span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
        <span class=n>oob_score</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>  <span class=c1># Enable OOB</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>
    <span class=n>rf</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=n>oob_score</span> <span class=o>=</span> <span class=n>rf</span><span class=o>.</span><span class=n>oob_score_</span>
    <span class=n>test_score</span> <span class=o>=</span> <span class=n>rf</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>OOB Score (train): </span><span class=si>{</span><span class=n>oob_score</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Test Score:        </span><span class=si>{</span><span class=n>test_score</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Difference:        </span><span class=si>{</span><span class=nb>abs</span><span class=p>(</span><span class=n>oob_score</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>test_score</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ OOB score ‚âà test score (free validation estimate)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ No need for separate validation set (saves data)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_rf_regression</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Random Forest Regression</span>

<span class=sd>    Averages predictions from trees</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;6. Random Forest Regression&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>noise</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Compare different configurations</span>
    <span class=n>configs</span> <span class=o>=</span> <span class=p>[</span>
        <span class=p>(</span><span class=s1>&#39;RF (10 trees)&#39;</span><span class=p>,</span> <span class=n>RandomForestRegressor</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)),</span>
        <span class=p>(</span><span class=s1>&#39;RF (50 trees)&#39;</span><span class=p>,</span> <span class=n>RandomForestRegressor</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)),</span>
        <span class=p>(</span><span class=s1>&#39;RF (100 trees)&#39;</span><span class=p>,</span> <span class=n>RandomForestRegressor</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>))</span>
    <span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Configuration&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train R¬≤&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test R¬≤&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;RMSE&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>65</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>configs</span><span class=p>:</span>
        <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_r2</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_r2</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
        <span class=n>rmse</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>mean_squared_error</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>))</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_r2</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_r2</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>rmse</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ More trees ‚Üí better R¬≤, lower RMSE&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_rf_vs_single_tree</span><span class=p>()</span>
    <span class=n>demo_n_estimators_tuning</span><span class=p>()</span>
    <span class=n>demo_max_features</span><span class=p>()</span>
    <span class=n>demo_feature_importance</span><span class=p>()</span>
    <span class=n>demo_oob_score</span><span class=p>()</span>
    <span class=n>demo_rf_regression</span><span class=p>()</span>
</code></pre></div> <h2 id=random-forest-key-parameters>Random Forest Key Parameters</h2> <table> <thead> <tr> <th>Parameter</th> <th>Default</th> <th>Typical Range</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td><strong>n_estimators</strong></td> <td>100</td> <td>50-500</td> <td>Number of trees (more = better, slower)</td> </tr> <tr> <td><strong>max_features</strong></td> <td>'sqrt'</td> <td>'sqrt', 'log2', int</td> <td>Features per split (diversity)</td> </tr> <tr> <td><strong>max_depth</strong></td> <td>None</td> <td>10-30</td> <td>Tree depth (prevent overfit)</td> </tr> <tr> <td><strong>min_samples_split</strong></td> <td>2</td> <td>2-20</td> <td>Min samples to split node</td> </tr> <tr> <td><strong>min_samples_leaf</strong></td> <td>1</td> <td>1-10</td> <td>Min samples in leaf</td> </tr> <tr> <td><strong>n_jobs</strong></td> <td>1</td> <td>-1 (all CPUs)</td> <td>Parallel training</td> </tr> </tbody> </table> <h2 id=random-forest-advantages>Random Forest Advantages</h2> <table> <thead> <tr> <th>Advantage ‚úÖ</th> <th>Explanation</th> </tr> </thead> <tbody> <tr> <td><strong>Reduced overfitting</strong></td> <td>Ensemble averages out variance</td> </tr> <tr> <td><strong>Feature importance</strong></td> <td>Aggregated importance scores</td> </tr> <tr> <td><strong>Robust to outliers</strong></td> <td>Individual trees handle outliers differently</td> </tr> <tr> <td><strong>Parallelizable</strong></td> <td>Trees train independently (set n_jobs=-1)</td> </tr> <tr> <td><strong>OOB validation</strong></td> <td>Free validation estimate (no separate set needed)</td> </tr> <tr> <td><strong>Works out-of-box</strong></td> <td>Few hyperparameters to tune</td> </tr> </tbody> </table> <h2 id=random-forest-vs-gradient-boosting>Random Forest vs Gradient Boosting</h2> <table> <thead> <tr> <th>Aspect</th> <th>Random Forest</th> <th>Gradient Boosting</th> </tr> </thead> <tbody> <tr> <td><strong>Training</strong></td> <td>Parallel (fast)</td> <td>Sequential (slow)</td> </tr> <tr> <td><strong>Overfitting</strong></td> <td>Less prone</td> <td>More prone (needs tuning)</td> </tr> <tr> <td><strong>Accuracy</strong></td> <td>Good (85-90%)</td> <td>Better (90-95%)</td> </tr> <tr> <td><strong>Hyperparameters</strong></td> <td>Few to tune</td> <td>Many to tune</td> </tr> <tr> <td><strong>Use Case</strong></td> <td>Default choice</td> <td>Competitions, need max accuracy</td> </tr> </tbody> </table> <h2 id=real-world-applications_8>Real-World Applications</h2> <table> <thead> <tr> <th>Company</th> <th>Use Case</th> <th>Configuration</th> <th>Result</th> </tr> </thead> <tbody> <tr> <td><strong>Airbnb</strong></td> <td>Price prediction</td> <td>n=200, max_depth=15</td> <td>R¬≤=0.87, robust</td> </tr> <tr> <td><strong>Kaggle</strong></td> <td>Competitions</td> <td>n=500, max_features='sqrt'</td> <td>Top 10% solutions</td> </tr> <tr> <td><strong>Banking</strong></td> <td>Credit risk</td> <td>n=100, max_depth=10</td> <td>Interpretable, accurate</td> </tr> <tr> <td><strong>E-commerce</strong></td> <td>Churn prediction</td> <td>n=150, max_features='log2'</td> <td>88% accuracy</td> </tr> </tbody> </table> <h2 id=when-to-use-random-forest>When to Use Random Forest</h2> <table> <thead> <tr> <th>Scenario</th> <th>Use RF?</th> <th>Reason</th> </tr> </thead> <tbody> <tr> <td><strong>Baseline model</strong></td> <td>‚úÖ Always</td> <td>Fast, works well out-of-box</td> </tr> <tr> <td><strong>Need interpretability</strong></td> <td>‚úÖ Yes</td> <td>Feature importance available</td> </tr> <tr> <td><strong>Tabular data</strong></td> <td>‚úÖ Excellent</td> <td>One of best for structured data</td> </tr> <tr> <td><strong>Need max accuracy</strong></td> <td>üü° Use GBM</td> <td>Boosting slightly better</td> </tr> <tr> <td><strong>Real-time prediction</strong></td> <td>‚ö†Ô∏è Consider</td> <td>Can be slow with many trees</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>bootstrap sampling + random features</strong> create ensemble diversity</li> <li>Uses <strong>n_estimators=100-200</strong> (diminishing returns after)</li> <li>Keeps <strong>max_features='sqrt'</strong> (default, good diversity)</li> <li>Uses <strong>n_jobs=-1</strong> for parallel training (faster)</li> <li>Understands <strong>OOB score</strong> (free validation estimate, ‚âà test score)</li> <li>Knows <strong>parallel training</strong> (vs GBM sequential) makes it faster</li> <li>Real-world: <strong>Airbnb uses Random Forest for price prediction (R¬≤=0.87, 200 trees, robust to outliers)</strong></li> </ul> </div> </details> <hr> <h3 id=difference-between-bagging-and-boosting-google-amazon-interview-question>Difference between Bagging and Boosting? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Ensemble</code>, <code>Bagging</code>, <code>Boosting</code> | <strong>Asked by:</strong> Google, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>Bagging (Bootstrap Aggregating)</strong>: Train models <strong>in parallel</strong> on <strong>random subsets</strong> (bootstrap samples). Reduce <strong>variance</strong>. Example: Random Forest.</p> <p><strong>Boosting</strong>: Train models <strong>sequentially</strong>, each <strong>correcting previous errors</strong>. Reduce <strong>bias</strong>. Example: Gradient Boosting, AdaBoost, XGBoost.</p> <p><strong>Key Difference:</strong> Bagging = parallel, independent | Boosting = sequential, dependent</p> <p><strong>Real-World Context:</strong> - <strong>Random Forest (Bagging):</strong> Airbnb price prediction (parallel training, fast) - <strong>XGBoost (Boosting):</strong> Kaggle wins (sequential, higher accuracy)</p> <h2 id=bagging-vs-boosting-visual>Bagging vs Boosting Visual</h2> <div class=highlight><pre><span></span><code>BAGGING (Random Forest)
========================
Training Data
     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Sample 1‚îÇSample 2‚îÇSample 3‚îÇ  (bootstrap)
‚îÇ  (60%)  ‚îÇ (60%)  ‚îÇ (60%)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ        ‚îÇ        ‚îÇ
     ‚Üì        ‚Üì        ‚Üì
  [Tree 1] [Tree 2] [Tree 3]  PARALLEL
     ‚îÇ        ‚îÇ        ‚îÇ
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚Üì
       Voting/Average

Reduces: VARIANCE
Speed: FAST (parallel)


BOOSTING (Gradient Boosting)
==============================
Training Data
     ‚Üì
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇTree 1‚îÇ (weak learner)
  ‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îò
      ‚Üì
Calculate Residuals (errors)
      ‚Üì
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇTree 2‚îÇ (fits residuals)  SEQUENTIAL
  ‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îò
      ‚Üì
Calculate Residuals again
      ‚Üì
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇTree 3‚îÇ (fits residuals)
  ‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îò
      ‚Üì
Weighted Sum (all trees)

Reduces: BIAS
Speed: SLOWER (sequential)
</code></pre></div> <h2 id=production-implementation-140-lines_1>Production Implementation (140 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># bagging_vs_boosting.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>BaggingClassifier</span><span class=p>,</span> <span class=n>AdaBoostClassifier</span><span class=p>,</span> <span class=n>GradientBoostingClassifier</span><span class=p>,</span> <span class=n>RandomForestClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.tree</span><span class=w> </span><span class=kn>import</span> <span class=n>DecisionTreeClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>cross_val_score</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>accuracy_score</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_bagging_vs_boosting</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Bagging vs Boosting: Parallel vs Sequential</span>

<span class=sd>    Key difference in training paradigm</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Bagging vs Boosting - Training Paradigm&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>models</span> <span class=o>=</span> <span class=p>[</span>
        <span class=p>(</span><span class=s1>&#39;Single Tree&#39;</span><span class=p>,</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)),</span>
        <span class=p>(</span><span class=s1>&#39;Bagging (RF)&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)),</span>
        <span class=p>(</span><span class=s1>&#39;Boosting (AdaBoost)&#39;</span><span class=p>,</span> <span class=n>AdaBoostClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)),</span>
        <span class=p>(</span><span class=s1>&#39;Boosting (GBM)&#39;</span><span class=p>,</span> <span class=n>GradientBoostingClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>))</span>
    <span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Model&#39;</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Time (s)&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>model</span> <span class=ow>in</span> <span class=n>models</span><span class=p>:</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
        <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>fit_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>fit_time</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Bagging (RF): Fast (parallel), reduces variance&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Boosting (GBM): Slower (sequential), reduces bias, higher accuracy&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_variance_vs_bias</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Bagging reduces VARIANCE</span>
<span class=sd>    Boosting reduces BIAS</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. Variance vs Bias Reduction&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>600</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># High variance model (deep tree)</span>
    <span class=n>deep_tree</span> <span class=o>=</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>max_depth</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>deep_tree</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># Bagging reduces variance</span>
    <span class=n>bagging</span> <span class=o>=</span> <span class=n>BaggingClassifier</span><span class=p>(</span>
        <span class=n>estimator</span><span class=o>=</span><span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>max_depth</span><span class=o>=</span><span class=mi>20</span><span class=p>),</span>
        <span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>
    <span class=n>bagging</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># High bias model (shallow tree)</span>
    <span class=n>shallow_tree</span> <span class=o>=</span> <span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>max_depth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>shallow_tree</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># Boosting reduces bias</span>
    <span class=n>boosting</span> <span class=o>=</span> <span class=n>AdaBoostClassifier</span><span class=p>(</span>
        <span class=n>estimator</span><span class=o>=</span><span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>max_depth</span><span class=o>=</span><span class=mi>2</span><span class=p>),</span>
        <span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>
    <span class=n>boosting</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>HIGH VARIANCE (Overfitting):&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Model&#39;</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Gap&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>model</span> <span class=ow>in</span> <span class=p>[(</span><span class=s1>&#39;Deep Tree (max_depth=20)&#39;</span><span class=p>,</span> <span class=n>deep_tree</span><span class=p>),</span> 
                        <span class=p>(</span><span class=s1>&#39;Bagging (50 deep trees)&#39;</span><span class=p>,</span> <span class=n>bagging</span><span class=p>)]:</span>
        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>gap</span> <span class=o>=</span> <span class=n>train_acc</span> <span class=o>-</span> <span class=n>test_acc</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>gap</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Bagging REDUCES variance (smaller gap)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>HIGH BIAS (Underfitting):&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Model&#39;</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>model</span> <span class=ow>in</span> <span class=p>[(</span><span class=s1>&#39;Shallow Tree (max_depth=2)&#39;</span><span class=p>,</span> <span class=n>shallow_tree</span><span class=p>),</span>
                        <span class=p>(</span><span class=s1>&#39;Boosting (50 shallow trees)&#39;</span><span class=p>,</span> <span class=n>boosting</span><span class=p>)]:</span>
        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Boosting REDUCES bias (higher accuracy)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_parallel_vs_sequential</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Bagging: Parallel (fast)</span>
<span class=sd>    Boosting: Sequential (slow)</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. Parallel vs Sequential Training&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>n_estimators_list</span> <span class=o>=</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>BAGGING (Parallel with n_jobs=-1):&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;n_estimators&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Fit Time (s)&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>35</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>n_estimators_list</span><span class=p>:</span>
        <span class=n>bagging</span> <span class=o>=</span> <span class=n>BaggingClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=n>n</span><span class=p>,</span> <span class=n>n_jobs</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
        <span class=n>bagging</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>fit_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>n</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>fit_time</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>BOOSTING (Sequential, no parallelization):&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;n_estimators&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Fit Time (s)&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>35</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>n_estimators_list</span><span class=p>:</span>
        <span class=n>boosting</span> <span class=o>=</span> <span class=n>AdaBoostClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=n>n</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
        <span class=n>boosting</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>fit_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>n</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>fit_time</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Bagging: Nearly constant time (parallelized)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Boosting: Linear increase (sequential)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_sample_weights</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Bagging: Uniform sample weights</span>
<span class=sd>    Boosting: Reweights samples based on errors</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Sample Weighting Strategy&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># AdaBoost shows sample weights evolution</span>
    <span class=n>ada</span> <span class=o>=</span> <span class=n>AdaBoostClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>ada</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>AdaBoost Estimator Weights (sequential focus on errors):&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Estimator&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Weight&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>30</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>weight</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>ada</span><span class=o>.</span><span class=n>estimator_weights_</span><span class=p>,</span> <span class=mi>1</span><span class=p>):</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Tree </span><span class=si>{</span><span class=n>i</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>weight</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - Each tree focuses on misclassified samples&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - Higher weight = better tree performance&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - Bagging: All trees have equal weight (1.0)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Boosting: Adaptive sample weighting&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Bagging: Uniform sampling (bootstrap)&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_bagging_vs_boosting</span><span class=p>()</span>
    <span class=n>demo_variance_vs_bias</span><span class=p>()</span>
    <span class=n>demo_parallel_vs_sequential</span><span class=p>()</span>
    <span class=n>demo_sample_weights</span><span class=p>()</span>
</code></pre></div> <h2 id=bagging-vs-boosting-comparison>Bagging vs Boosting Comparison</h2> <table> <thead> <tr> <th>Aspect</th> <th>Bagging</th> <th>Boosting</th> </tr> </thead> <tbody> <tr> <td><strong>Training</strong></td> <td>Parallel (independent)</td> <td>Sequential (dependent)</td> </tr> <tr> <td><strong>Goal</strong></td> <td>Reduce variance</td> <td>Reduce bias</td> </tr> <tr> <td><strong>Sampling</strong></td> <td>Bootstrap (with replacement)</td> <td>Adaptive (reweighting)</td> </tr> <tr> <td><strong>Speed</strong></td> <td>Fast (parallelizable)</td> <td>Slower (sequential)</td> </tr> <tr> <td><strong>Overfitting</strong></td> <td>Less prone</td> <td>More prone (needs tuning)</td> </tr> <tr> <td><strong>Accuracy</strong></td> <td>Good</td> <td>Better</td> </tr> <tr> <td><strong>Example</strong></td> <td>Random Forest</td> <td>AdaBoost, GBM, XGBoost</td> </tr> </tbody> </table> <h2 id=when-to-use-each>When to Use Each</h2> <table> <thead> <tr> <th>Scenario</th> <th>Use Bagging</th> <th>Use Boosting</th> </tr> </thead> <tbody> <tr> <td><strong>Need speed</strong></td> <td>‚úÖ Yes (parallel)</td> <td>‚ùå No (sequential)</td> </tr> <tr> <td><strong>High variance model</strong></td> <td>‚úÖ Yes (reduces variance)</td> <td>üü° Maybe</td> </tr> <tr> <td><strong>High bias model</strong></td> <td>‚ùå No</td> <td>‚úÖ Yes (reduces bias)</td> </tr> <tr> <td><strong>Need max accuracy</strong></td> <td>üü° Good</td> <td>‚úÖ Better</td> </tr> <tr> <td><strong>Avoid overfitting</strong></td> <td>‚úÖ Robust</td> <td>‚ö†Ô∏è Careful tuning</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>Bagging = parallel, Boosting = sequential</strong></li> <li>Understands <strong>Bagging reduces variance</strong> (Random Forest)</li> <li>Understands <strong>Boosting reduces bias</strong> (fits residuals)</li> <li>Can explain <strong>bootstrap sampling</strong> (Bagging) vs <strong>adaptive reweighting</strong> (Boosting)</li> <li>Knows <strong>Bagging faster</strong> (n_jobs=-1) vs <strong>Boosting slower</strong> (no parallelization)</li> <li>Uses <strong>Random Forest for speed</strong>, <strong>GBM/XGBoost for max accuracy</strong></li> <li>Real-world: <strong>Airbnb uses Random Forest (fast, parallel, R¬≤=0.87)</strong>, <strong>Kaggle uses XGBoost (sequential, but wins competitions)</strong></li> </ul> </div> </details> <hr> <h3 id=how-does-gradient-boosting-work-senior-dsml-engineer-question>How does Gradient Boosting work? - Senior DS/ML Engineer Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Gradient Boosting</code>, <code>Ensemble</code>, <code>Boosting</code> | <strong>Asked by:</strong> Most FAANG</p> <details class=success> <summary>View Answer</summary> <p><strong>Gradient Boosting</strong> trains trees <strong>sequentially</strong>, each fitting the <strong>residuals (errors)</strong> of the previous ensemble. Uses <strong>gradient descent</strong> in function space to minimize loss.</p> <p><strong>Formula:</strong> <span class=arithmatex>\(F_m(x) = F_{m-1}(x) + \eta \cdot h_m(x)\)</span> where <span class=arithmatex>\(h_m\)</span> fits <span class=arithmatex>\(-\nabla L\)</span></p> <p><strong>Real-World Context:</strong> - <strong>Kaggle:</strong> XGBoost/LightGBM win most competitions (90-95% accuracy) - <strong>Google:</strong> RankNet (learning to rank with GBM) - <strong>Uber:</strong> ETA prediction (RMSE reduced by 30% vs linear models)</p> <h2 id=gradient-boosting-algorithm-flow>Gradient Boosting Algorithm Flow</h2> <div class=highlight><pre><span></span><code>Initialize: F‚ÇÄ(x) = mean(y)  (constant prediction)
          ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FOR m = 1 to M (iterations)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. Compute residuals (pseudo-residuals)‚îÇ
‚îÇ    r_i = y_i - F_{m-1}(x_i)           ‚îÇ
‚îÇ    (what current model gets wrong)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. Fit weak learner h_m(x) to residuals‚îÇ
‚îÇ    (decision tree on r_i)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. Update model:                       ‚îÇ
‚îÇ    F_m(x) = F_{m-1}(x) + Œ∑¬∑h_m(x)     ‚îÇ
‚îÇ    Œ∑ = learning_rate (typically 0.1)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚Üì
          (repeat M times)
               ‚Üì
Final Model: F_M(x) = F‚ÇÄ + Œ∑¬∑Œ£h_m(x)
</code></pre></div> <h2 id=production-implementation-160-lines_1>Production Implementation (160 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># gradient_boosting_complete.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>GradientBoostingClassifier</span><span class=p>,</span> <span class=n>GradientBoostingRegressor</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>learning_curve</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span><span class=p>,</span> <span class=n>make_regression</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>mean_squared_error</span><span class=p>,</span> <span class=n>accuracy_score</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_gbm_iterative_fitting</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Gradient Boosting: Iterative Residual Fitting</span>

<span class=sd>    Each tree corrects previous errors</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Gradient Boosting - Iterative Residual Fitting&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>200</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>noise</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Track predictions at each stage</span>
    <span class=n>stages</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;n_estimators&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train RMSE&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test RMSE&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Improvement&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=n>prev_rmse</span> <span class=o>=</span> <span class=kc>None</span>

    <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>stages</span><span class=p>:</span>
        <span class=n>gbm</span> <span class=o>=</span> <span class=n>GradientBoostingRegressor</span><span class=p>(</span>
            <span class=n>n_estimators</span><span class=o>=</span><span class=n>n</span><span class=p>,</span>
            <span class=n>learning_rate</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span>
            <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
        <span class=p>)</span>
        <span class=n>gbm</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_pred</span> <span class=o>=</span> <span class=n>gbm</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
        <span class=n>test_pred</span> <span class=o>=</span> <span class=n>gbm</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

        <span class=n>train_rmse</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>mean_squared_error</span><span class=p>(</span><span class=n>y_train</span><span class=p>,</span> <span class=n>train_pred</span><span class=p>))</span>
        <span class=n>test_rmse</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>mean_squared_error</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>test_pred</span><span class=p>))</span>

        <span class=n>improvement</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span> <span class=k>if</span> <span class=n>prev_rmse</span> <span class=ow>is</span> <span class=kc>None</span> <span class=k>else</span> <span class=sa>f</span><span class=s2>&quot;-</span><span class=si>{</span><span class=n>prev_rmse</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>test_rmse</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>&quot;</span>
        <span class=n>prev_rmse</span> <span class=o>=</span> <span class=n>test_rmse</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>n</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_rmse</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_rmse</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>improvement</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Each iteration reduces error (fits residuals)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_learning_rate</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Learning Rate: Shrinkage Factor</span>

<span class=sd>    Lower LR ‚Üí more trees needed, but better generalization</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. Learning Rate (Shrinkage)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>800</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>learning_rates</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Learning Rate&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;n_estimators&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>65</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>lr</span> <span class=ow>in</span> <span class=n>learning_rates</span><span class=p>:</span>
        <span class=n>gbm</span> <span class=o>=</span> <span class=n>GradientBoostingClassifier</span><span class=p>(</span>
            <span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
            <span class=n>learning_rate</span><span class=o>=</span><span class=n>lr</span><span class=p>,</span>
            <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
        <span class=p>)</span>
        <span class=n>gbm</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>gbm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>gbm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>lr</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=mi>100</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  lr=0.01: Slow learning (needs more trees)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  lr=0.1:  Good default (balance)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  lr=1.0:  Too fast (overfitting)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ learning_rate=0.1 typically best&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Lower LR + more trees ‚Üí better generalization&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_max_depth</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    max_depth: Weak Learners</span>

<span class=sd>    Shallow trees (max_depth=3-5) are typical</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. max_depth - Weak Learners (Critical!)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>600</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>max_depths</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;max_depth&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Overfit Gap&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>depth</span> <span class=ow>in</span> <span class=n>max_depths</span><span class=p>:</span>
        <span class=n>gbm</span> <span class=o>=</span> <span class=n>GradientBoostingClassifier</span><span class=p>(</span>
            <span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
            <span class=n>max_depth</span><span class=o>=</span><span class=n>depth</span><span class=p>,</span>
            <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
        <span class=p>)</span>
        <span class=n>gbm</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>gbm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>gbm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>gap</span> <span class=o>=</span> <span class=n>train_acc</span> <span class=o>-</span> <span class=n>test_acc</span>

        <span class=n>depth_str</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>depth</span><span class=p>)</span> <span class=k>if</span> <span class=n>depth</span> <span class=k>else</span> <span class=s2>&quot;None&quot;</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>depth_str</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>gap</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ max_depth=3-5 (weak learners) prevent overfitting&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Boosting works with weak learners (unlike Random Forest)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_subsample</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    subsample: Stochastic Gradient Boosting</span>

<span class=sd>    Use fraction of data per tree (reduces variance)</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. subsample - Stochastic GBM&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>subsamples</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.7</span><span class=p>,</span> <span class=mf>0.8</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;subsample&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Fit Time (s)&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>sub</span> <span class=ow>in</span> <span class=n>subsamples</span><span class=p>:</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
        <span class=n>gbm</span> <span class=o>=</span> <span class=n>GradientBoostingClassifier</span><span class=p>(</span>
            <span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
            <span class=n>subsample</span><span class=o>=</span><span class=n>sub</span><span class=p>,</span>
            <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
        <span class=p>)</span>
        <span class=n>gbm</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>fit_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>gbm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>gbm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>sub</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>fit_time</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ subsample&lt;1.0 adds randomness (reduces overfitting)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ subsample=0.8 typical (stochastic GBM)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_feature_importance</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Feature Importance: Aggregated Gain</span>

<span class=sd>    More reliable than single tree</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. Feature Importance (Aggregated)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>gbm</span> <span class=o>=</span> <span class=n>GradientBoostingClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>gbm</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># Top 5 features</span>
    <span class=n>top5_idx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>gbm</span><span class=o>.</span><span class=n>feature_importances_</span><span class=p>)[</span><span class=o>-</span><span class=mi>5</span><span class=p>:][::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 5 Features:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Feature&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Importance&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>30</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>idx</span> <span class=ow>in</span> <span class=n>top5_idx</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Feature </span><span class=si>{</span><span class=n>idx</span><span class=si>:</span><span class=s2>&lt;4</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>gbm</span><span class=o>.</span><span class=n>feature_importances_</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Feature importance from total gain across all trees&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_gbm_iterative_fitting</span><span class=p>()</span>
    <span class=n>demo_learning_rate</span><span class=p>()</span>
    <span class=n>demo_max_depth</span><span class=p>()</span>
    <span class=n>demo_subsample</span><span class=p>()</span>
    <span class=n>demo_feature_importance</span><span class=p>()</span>
</code></pre></div> <h2 id=gradient-boosting-key-parameters>Gradient Boosting Key Parameters</h2> <table> <thead> <tr> <th>Parameter</th> <th>Default</th> <th>Typical Range</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td><strong>n_estimators</strong></td> <td>100</td> <td>100-1000</td> <td>Number of boosting stages</td> </tr> <tr> <td><strong>learning_rate</strong></td> <td>0.1</td> <td>0.01-0.3</td> <td>Shrinkage (lower = more trees needed)</td> </tr> <tr> <td><strong>max_depth</strong></td> <td>3</td> <td>3-8</td> <td>Tree depth (weak learners: 3-5)</td> </tr> <tr> <td><strong>subsample</strong></td> <td>1.0</td> <td>0.5-1.0</td> <td>Fraction of samples per tree</td> </tr> <tr> <td><strong>min_samples_split</strong></td> <td>2</td> <td>2-20</td> <td>Min samples to split node</td> </tr> <tr> <td><strong>max_features</strong></td> <td>None</td> <td>'sqrt', int</td> <td>Features per split</td> </tr> </tbody> </table> <h2 id=gbm-vs-random-forest>GBM vs Random Forest</h2> <table> <thead> <tr> <th>Aspect</th> <th>Gradient Boosting</th> <th>Random Forest</th> </tr> </thead> <tbody> <tr> <td><strong>Training</strong></td> <td>Sequential (slow)</td> <td>Parallel (fast)</td> </tr> <tr> <td><strong>Overfitting</strong></td> <td>More prone</td> <td>Less prone</td> </tr> <tr> <td><strong>Accuracy</strong></td> <td>Higher (90-95%)</td> <td>Good (85-90%)</td> </tr> <tr> <td><strong>Hyperparameters</strong></td> <td>Many to tune</td> <td>Few to tune</td> </tr> <tr> <td><strong>Weak learners</strong></td> <td>Yes (max_depth=3-5)</td> <td>No (deep trees)</td> </tr> <tr> <td><strong>Learning rate</strong></td> <td>Yes (0.1)</td> <td>No (not applicable)</td> </tr> </tbody> </table> <h2 id=real-world-applications_9>Real-World Applications</h2> <table> <thead> <tr> <th>Company</th> <th>Use Case</th> <th>Configuration</th> <th>Result</th> </tr> </thead> <tbody> <tr> <td><strong>Kaggle</strong></td> <td>Competitions</td> <td>XGBoost/LightGBM, n=1000</td> <td>Top 10% solutions</td> </tr> <tr> <td><strong>Google</strong></td> <td>RankNet (search)</td> <td>GBM, max_depth=5</td> <td>15% improvement</td> </tr> <tr> <td><strong>Uber</strong></td> <td>ETA prediction</td> <td>LightGBM, n=500</td> <td>RMSE reduced 30%</td> </tr> <tr> <td><strong>Airbnb</strong></td> <td>Price optimization</td> <td>XGBoost, n=800</td> <td>R¬≤=0.91</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>sequential training</strong> (each tree fits residuals of previous)</li> <li>Understands <strong>learning_rate</strong> (shrinkage, 0.1 typical)</li> <li>Uses <strong>weak learners</strong> (max_depth=3-5, unlike Random Forest)</li> <li>Knows <strong>subsample&lt;1.0</strong> (stochastic GBM, reduces overfitting)</li> <li>Understands <strong>n_estimators vs learning_rate tradeoff</strong> (lower LR ‚Üí more trees)</li> <li>Can explain <strong>gradient descent in function space</strong></li> <li>Real-world: <strong>Uber uses LightGBM for ETA prediction (RMSE reduced 30%, 500 trees, max_depth=5)</strong></li> </ul> </div> </details> <hr> <h3 id=how-does-adaboost-work-meta-apple-interview-question>How does AdaBoost work? - Meta, Apple Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>AdaBoost</code>, <code>Boosting</code>, <code>Ensemble</code> | <strong>Asked by:</strong> Meta, Apple</p> <details class=success> <summary>View Answer</summary> <p><strong>AdaBoost (Adaptive Boosting)</strong> trains weak learners <strong>sequentially</strong>, increasing <strong>weights of misclassified samples</strong>. Final prediction is <strong>weighted vote</strong> of all learners.</p> <p><strong>Formula:</strong> <span class=arithmatex>\(F(x) = sign(\sum_{m=1}^{M} \alpha_m h_m(x))\)</span> where <span class=arithmatex>\(\alpha_m\)</span> = learner weight</p> <p><strong>Real-World Context:</strong> - <strong>Face Detection:</strong> Viola-Jones algorithm (real-time, 95% accuracy) - <strong>Click Prediction:</strong> Yahoo search ads (improved CTR by 12%)</p> <h2 id=adaboost-algorithm-flow>AdaBoost Algorithm Flow</h2> <div class=highlight><pre><span></span><code>Initialize: w_i = 1/n (equal weights)
          ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FOR m = 1 to M (iterations)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. Train weak learner h_m(x)        ‚îÇ
‚îÇ    on weighted samples              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. Compute error rate:              ‚îÇ
‚îÇ    Œµ_m = Œ£ w_i ¬∑ I(y_i ‚â† h_m(x_i)) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. Compute learner weight:          ‚îÇ
‚îÇ    Œ±_m = 0.5 ¬∑ ln((1-Œµ_m)/Œµ_m)     ‚îÇ
‚îÇ    (higher if error lower)          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 4. Update sample weights:           ‚îÇ
‚îÇ    w_i ‚Üê w_i ¬∑ exp(Œ±_m ¬∑ I(error)) ‚îÇ
‚îÇ    (increase if misclassified)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 5. Normalize weights:               ‚îÇ
‚îÇ    w_i ‚Üê w_i / Œ£ w_j               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚Üì
          (repeat M times)
                ‚Üì
Final: F(x) = sign(Œ£ Œ±_m ¬∑ h_m(x))
</code></pre></div> <h2 id=production-implementation-145-lines>Production Implementation (145 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># adaboost_complete.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>AdaBoostClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.tree</span><span class=w> </span><span class=kn>import</span> <span class=n>DecisionTreeClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>accuracy_score</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_adaboost_sequential</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    AdaBoost: Sequential Weight Adjustment</span>

<span class=sd>    Each learner focuses on previous mistakes</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. AdaBoost - Sequential Weight Adjustment&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Track performance at each stage</span>
    <span class=n>n_estimators_list</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;n_estimators&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>n_estimators_list</span><span class=p>:</span>
        <span class=n>ada</span> <span class=o>=</span> <span class=n>AdaBoostClassifier</span><span class=p>(</span>
            <span class=n>estimator</span><span class=o>=</span><span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>max_depth</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>  <span class=c1># stumps</span>
            <span class=n>n_estimators</span><span class=o>=</span><span class=n>n</span><span class=p>,</span>
            <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
        <span class=p>)</span>
        <span class=n>ada</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>ada</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>ada</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>n</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Performance improves with more learners&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Each learner corrects previous mistakes&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_weak_learners</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    AdaBoost with Weak Learners (Stumps)</span>

<span class=sd>    max_depth=1 (decision stumps) typical</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. Weak Learners - Decision Stumps&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>600</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>max_depths</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Base Learner&#39;</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>depth</span> <span class=ow>in</span> <span class=n>max_depths</span><span class=p>:</span>
        <span class=n>ada</span> <span class=o>=</span> <span class=n>AdaBoostClassifier</span><span class=p>(</span>
            <span class=n>estimator</span><span class=o>=</span><span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>max_depth</span><span class=o>=</span><span class=n>depth</span><span class=p>)</span> <span class=k>if</span> <span class=n>depth</span> <span class=k>else</span> <span class=n>DecisionTreeClassifier</span><span class=p>(),</span>
            <span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
            <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
        <span class=p>)</span>
        <span class=n>ada</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>ada</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>ada</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=n>name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;max_depth=</span><span class=si>{</span><span class=n>depth</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>if</span> <span class=n>depth</span> <span class=k>else</span> <span class=s2>&quot;max_depth=None&quot;</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  max_depth=1: Decision stumps (weakest, best for AdaBoost)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  max_depth=None: Too strong (overfitting risk)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ AdaBoost works best with WEAK learners (stumps)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_estimator_weights</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Estimator Weights: Better Learners Have Higher Weight</span>

<span class=sd>    Œ±_m = 0.5 * ln((1-Œµ_m)/Œµ_m)</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. Estimator Weights (Œ±_m)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>400</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>ada</span> <span class=o>=</span> <span class=n>AdaBoostClassifier</span><span class=p>(</span>
        <span class=n>estimator</span><span class=o>=</span><span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>max_depth</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
        <span class=n>n_estimators</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>
    <span class=n>ada</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Estimator Weights (first 10 learners):&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Estimator&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Weight (Œ±_m)&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Error Rate&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>weight</span><span class=p>,</span> <span class=n>error</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>ada</span><span class=o>.</span><span class=n>estimator_weights_</span><span class=p>,</span> <span class=n>ada</span><span class=o>.</span><span class=n>estimator_errors_</span><span class=p>),</span> <span class=mi>1</span><span class=p>):</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Learner </span><span class=si>{</span><span class=n>i</span><span class=si>:</span><span class=s2>&lt;4</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>weight</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>error</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - Lower error ‚Üí higher weight&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - Œ±_m = 0.5 * ln((1-Œµ)/Œµ)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - Final prediction: sign(Œ£ Œ±_m ¬∑ h_m(x))&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Better learners contribute more to final prediction&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_sample_weights_evolution</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Sample Weights Evolution</span>

<span class=sd>    Misclassified samples get higher weights</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Sample Weights Evolution&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Train AdaBoost and track sample weights (conceptual)</span>
    <span class=n>ada</span> <span class=o>=</span> <span class=n>AdaBoostClassifier</span><span class=p>(</span>
        <span class=n>estimator</span><span class=o>=</span><span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>max_depth</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
        <span class=n>n_estimators</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>
    <span class=n>ada</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=c1># Get predictions from each stage</span>
    <span class=n>y_pred_train</span> <span class=o>=</span> <span class=n>ada</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>

    <span class=c1># Count misclassifications</span>
    <span class=n>misclassified</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>y_pred_train</span> <span class=o>!=</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Total Training Samples: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>y_train</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Misclassified Samples: </span><span class=si>{</span><span class=n>misclassified</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Final Train Accuracy: </span><span class=si>{</span><span class=n>ada</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span><span class=w> </span><span class=n>y_train</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Final Test Accuracy: </span><span class=si>{</span><span class=n>ada</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span><span class=w> </span><span class=n>y_test</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Sample Weight Update Rule:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - Correct prediction: w_i ‚Üê w_i ¬∑ exp(-Œ±_m)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - Wrong prediction:   w_i ‚Üê w_i ¬∑ exp(+Œ±_m)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - Normalize: w_i ‚Üê w_i / Œ£ w_j&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Hard samples get higher weights over iterations&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_learning_rate</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Learning Rate: Shrinkage</span>

<span class=sd>    Reduces overfitting</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. Learning Rate (Shrinkage)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>800</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>learning_rates</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>1.5</span><span class=p>,</span> <span class=mf>2.0</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Learning Rate&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>lr</span> <span class=ow>in</span> <span class=n>learning_rates</span><span class=p>:</span>
        <span class=n>ada</span> <span class=o>=</span> <span class=n>AdaBoostClassifier</span><span class=p>(</span>
            <span class=n>estimator</span><span class=o>=</span><span class=n>DecisionTreeClassifier</span><span class=p>(</span><span class=n>max_depth</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
            <span class=n>n_estimators</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span>
            <span class=n>learning_rate</span><span class=o>=</span><span class=n>lr</span><span class=p>,</span>
            <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
        <span class=p>)</span>
        <span class=n>ada</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>ada</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>ada</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>lr</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ learning_rate=1.0 typically best (default)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Lower LR reduces overfitting (needs more estimators)&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_adaboost_sequential</span><span class=p>()</span>
    <span class=n>demo_weak_learners</span><span class=p>()</span>
    <span class=n>demo_estimator_weights</span><span class=p>()</span>
    <span class=n>demo_sample_weights_evolution</span><span class=p>()</span>
    <span class=n>demo_learning_rate</span><span class=p>()</span>
</code></pre></div> <h2 id=adaboost-key-parameters>AdaBoost Key Parameters</h2> <table> <thead> <tr> <th>Parameter</th> <th>Default</th> <th>Typical Range</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td><strong>n_estimators</strong></td> <td>50</td> <td>50-500</td> <td>Number of weak learners</td> </tr> <tr> <td><strong>learning_rate</strong></td> <td>1.0</td> <td>0.1-2.0</td> <td>Shrinkage factor</td> </tr> <tr> <td><strong>estimator</strong></td> <td>DecisionTree(max_depth=1)</td> <td>Stumps</td> <td>Base weak learner</td> </tr> </tbody> </table> <h2 id=adaboost-vs-gradient-boosting>AdaBoost vs Gradient Boosting</h2> <table> <thead> <tr> <th>Aspect</th> <th>AdaBoost</th> <th>Gradient Boosting</th> </tr> </thead> <tbody> <tr> <td><strong>Weight adjustment</strong></td> <td>Sample reweighting</td> <td>Fit residuals</td> </tr> <tr> <td><strong>Loss function</strong></td> <td>Exponential</td> <td>Any differentiable</td> </tr> <tr> <td><strong>Weak learners</strong></td> <td>Stumps (max_depth=1)</td> <td>Shallow trees (max_depth=3-5)</td> </tr> <tr> <td><strong>Speed</strong></td> <td>Faster</td> <td>Slower</td> </tr> <tr> <td><strong>Accuracy</strong></td> <td>Good</td> <td>Better</td> </tr> <tr> <td><strong>Sensitive to noise</strong></td> <td>Yes (outliers get high weights)</td> <td>Less sensitive</td> </tr> </tbody> </table> <h2 id=real-world-applications_10>Real-World Applications</h2> <table> <thead> <tr> <th>Company</th> <th>Use Case</th> <th>Configuration</th> <th>Result</th> </tr> </thead> <tbody> <tr> <td><strong>Viola-Jones</strong></td> <td>Face detection</td> <td>AdaBoost, stumps</td> <td>Real-time, 95% accuracy</td> </tr> <tr> <td><strong>Yahoo</strong></td> <td>Click prediction</td> <td>AdaBoost, n=200</td> <td>CTR +12%</td> </tr> <tr> <td><strong>Financial</strong></td> <td>Fraud detection</td> <td>AdaBoost, stumps</td> <td>Fast, interpretable</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>sample reweighting</strong> (increase weight of misclassified)</li> <li>Understands <strong>estimator weights</strong> (Œ±_m = 0.5¬∑ln((1-Œµ)/Œµ))</li> <li>Uses <strong>weak learners</strong> (decision stumps, max_depth=1)</li> <li>Knows <strong>sequential training</strong> (each learner focuses on mistakes)</li> <li>Understands <strong>final prediction</strong> (weighted vote: sign(Œ£ Œ±_m¬∑h_m(x)))</li> <li>Knows <strong>sensitive to outliers</strong> (noisy samples get high weights)</li> <li>Real-world: <strong>Viola-Jones face detection uses AdaBoost (real-time, 95% accuracy, decision stumps)</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-implement-svm-microsoft-nvidia-interview-question>How to implement SVM? - Microsoft, NVIDIA Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>SVM</code>, <code>Classification</code>, <code>Kernel Methods</code> | <strong>Asked by:</strong> Microsoft, NVIDIA</p> <details class=success> <summary>View Answer</summary> <p><strong>SVM (Support Vector Machine)</strong> finds the <strong>hyperplane</strong> that <strong>maximizes the margin</strong> between classes. Uses <strong>support vectors</strong> (samples closest to decision boundary). Can handle <strong>non-linear</strong> data via <strong>kernel trick</strong>.</p> <p><strong>Formula:</strong> <span class=arithmatex>\(f(x) = sign(w^T x + b)\)</span> where <span class=arithmatex>\(||w|| = 1\)</span>, maximize margin <span class=arithmatex>\(\frac{2}{||w||}\)</span></p> <p><strong>Real-World Context:</strong> - <strong>Text Classification:</strong> Spam detection (90% accuracy, high-dim data) - <strong>Image Recognition:</strong> Handwritten digits (MNIST, 98% accuracy) - <strong>Bioinformatics:</strong> Protein classification (handles high-dim features)</p> <h2 id=svm-margin-maximization>SVM Margin Maximization</h2> <div class=highlight><pre><span></span><code>Binary Classification (Linear SVM)
===================================

        Class +1          Decision Boundary          Class -1
                          (Hyperplane: w^T¬∑x + b = 0)

     ‚óè                           ‚îÇ                        ‚óã
       ‚óè                         ‚îÇ                      ‚óã
         ‚óè                       ‚îÇ                    ‚óã
     ‚óè     ‚óè Support Vector      ‚îÇ      Support Vector  ‚óã   ‚óã
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[‚óè]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[‚óã]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
     ‚óè     ‚óè   ‚Üë                 ‚îÇ                ‚Üë   ‚óã   ‚óã
       ‚óè       ‚îÇ                 ‚îÇ                ‚îÇ     ‚óã
     ‚óè     Margin (w^T¬∑x+b=+1)   ‚îÇ   Margin (w^T¬∑x+b=-1)  ‚óã

               ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Margin = 2/||w|| ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí

Objective: Maximize margin = minimize ||w||¬≤
Subject to: y_i(w^T¬∑x_i + b) ‚â• 1  (all points correctly classified)


Non-Linear SVM (Kernel Trick)
==============================

Original Space (not linearly separable):
     ‚óã  ‚óè  ‚óã
   ‚óã  ‚óè  ‚óè  ‚óã
     ‚óã  ‚óè  ‚óã

          ‚Üì Kernel Function œÜ(x)

Higher-Dimensional Space (linearly separable):
     ‚óã              ‚óã
       ‚óã          ‚óã
         ‚óè  ‚óè  ‚óè
       ‚óã          ‚óã
     ‚óã              ‚óã
</code></pre></div> <h2 id=production-implementation-155-lines_1>Production Implementation (155 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># svm_complete.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.svm</span><span class=w> </span><span class=kn>import</span> <span class=n>SVC</span><span class=p>,</span> <span class=n>LinearSVC</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>GridSearchCV</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span><span class=p>,</span> <span class=n>make_circles</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>accuracy_score</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_linear_svm</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Linear SVM: Linearly Separable Data</span>

<span class=sd>    Maximize margin between classes</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Linear SVM - Margin Maximization&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span>
        <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Standardize (important for SVM!)</span>
    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Linear SVM</span>
    <span class=n>svm</span> <span class=o>=</span> <span class=n>SVC</span><span class=p>(</span><span class=n>kernel</span><span class=o>=</span><span class=s1>&#39;linear&#39;</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>svm</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=n>train_acc</span> <span class=o>=</span> <span class=n>svm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>test_acc</span> <span class=o>=</span> <span class=n>svm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Linear SVM:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Train Accuracy: </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Test Accuracy:  </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Support Vectors: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>svm</span><span class=o>.</span><span class=n>support_vectors_</span><span class=p>)</span><span class=si>}</span><span class=s2> / </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Support Vector Ratio: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>svm</span><span class=o>.</span><span class=n>support_vectors_</span><span class=p>)</span><span class=o>/</span><span class=nb>len</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span><span class=si>:</span><span class=s2>.2%</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Support vectors define the decision boundary&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Fewer support vectors ‚Üí simpler model&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_c_parameter</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    C: Regularization Parameter</span>

<span class=sd>    C large ‚Üí hard margin (low bias, high variance)</span>
<span class=sd>    C small ‚Üí soft margin (high bias, low variance)</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. C Parameter - Margin Trade-off&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>600</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>C_values</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>100</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;C&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Support Vectors&#39;</span><span class=si>:</span><span class=s2>&lt;18</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>C</span> <span class=ow>in</span> <span class=n>C_values</span><span class=p>:</span>
        <span class=n>svm</span> <span class=o>=</span> <span class=n>SVC</span><span class=p>(</span><span class=n>kernel</span><span class=o>=</span><span class=s1>&#39;linear&#39;</span><span class=p>,</span> <span class=n>C</span><span class=o>=</span><span class=n>C</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>svm</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>svm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>svm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>n_support</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>svm</span><span class=o>.</span><span class=n>support_vectors_</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>C</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>n_support</span><span class=si>:</span><span class=s2>&lt;18</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  C=0.01:  Soft margin (more support vectors, regularized)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  C=1.0:   Good default&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  C=100:   Hard margin (fewer support vectors, may overfit)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ C=1.0 typically good default&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Smaller C ‚Üí more regularization ‚Üí more support vectors&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_kernel_comparison</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Kernel Functions: Handle Non-Linear Data</span>

<span class=sd>    RBF most popular for non-linear</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. Kernel Comparison (Linear vs Non-Linear)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=c1># Non-linearly separable data (circles)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_circles</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>noise</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>factor</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>kernels</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;linear&#39;</span><span class=p>,</span> <span class=s1>&#39;rbf&#39;</span><span class=p>,</span> <span class=s1>&#39;poly&#39;</span><span class=p>,</span> <span class=s1>&#39;sigmoid&#39;</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Kernel&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Support Vectors&#39;</span><span class=si>:</span><span class=s2>&lt;18</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>65</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>kernel</span> <span class=ow>in</span> <span class=n>kernels</span><span class=p>:</span>
        <span class=n>svm</span> <span class=o>=</span> <span class=n>SVC</span><span class=p>(</span><span class=n>kernel</span><span class=o>=</span><span class=n>kernel</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>svm</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>svm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>svm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>n_support</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>svm</span><span class=o>.</span><span class=n>support_vectors_</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>kernel</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>n_support</span><span class=si>:</span><span class=s2>&lt;18</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ RBF kernel best for non-linear data (circles)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Linear kernel fails on non-linear problems&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_scaling_importance</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Feature Scaling: Critical for SVM</span>

<span class=sd>    SVM sensitive to feature scales</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Feature Scaling (CRITICAL for SVM!)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Add feature with large scale</span>
    <span class=n>X</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>X</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>1000</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Without scaling</span>
    <span class=n>svm_no_scale</span> <span class=o>=</span> <span class=n>SVC</span><span class=p>(</span><span class=n>kernel</span><span class=o>=</span><span class=s1>&#39;linear&#39;</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
    <span class=n>svm_no_scale</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>time_no_scale</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
    <span class=n>acc_no_scale</span> <span class=o>=</span> <span class=n>svm_no_scale</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=c1># With scaling</span>
    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>svm_scaled</span> <span class=o>=</span> <span class=n>SVC</span><span class=p>(</span><span class=n>kernel</span><span class=o>=</span><span class=s1>&#39;linear&#39;</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
    <span class=n>svm_scaled</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>time_scaled</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
    <span class=n>acc_scaled</span> <span class=o>=</span> <span class=n>svm_scaled</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Approach&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Fit Time (s)&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>55</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Without Scaling&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>acc_no_scale</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>time_no_scale</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;With Scaling&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>acc_scaled</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>time_scaled</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ ALWAYS scale features for SVM (StandardScaler)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Scaling improves convergence and accuracy&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_multiclass_svm</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Multiclass SVM: One-vs-One or One-vs-Rest</span>

<span class=sd>    sklearn uses One-vs-One by default</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. Multiclass SVM (One-vs-One)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>600</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span>
        <span class=n>n_classes</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>svm</span> <span class=o>=</span> <span class=n>SVC</span><span class=p>(</span><span class=n>kernel</span><span class=o>=</span><span class=s1>&#39;rbf&#39;</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>svm</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=n>n_classes</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span><span class=n>y</span><span class=p>))</span>
    <span class=n>n_classifiers</span> <span class=o>=</span> <span class=n>n_classes</span> <span class=o>*</span> <span class=p>(</span><span class=n>n_classes</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Multiclass SVM (4 classes):&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Number of binary classifiers: </span><span class=si>{</span><span class=n>n_classifiers</span><span class=si>}</span><span class=s2> (One-vs-One)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Train Accuracy: </span><span class=si>{</span><span class=n>svm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span><span class=w> </span><span class=n>y_train</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Test Accuracy:  </span><span class=si>{</span><span class=n>svm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span><span class=w> </span><span class=n>y_test</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ One-vs-One: n(n-1)/2 binary classifiers&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Final prediction: majority vote&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_linear_svm</span><span class=p>()</span>
    <span class=n>demo_c_parameter</span><span class=p>()</span>
    <span class=n>demo_kernel_comparison</span><span class=p>()</span>
    <span class=n>demo_scaling_importance</span><span class=p>()</span>
    <span class=n>demo_multiclass_svm</span><span class=p>()</span>
</code></pre></div> <h2 id=svm-key-parameters>SVM Key Parameters</h2> <table> <thead> <tr> <th>Parameter</th> <th>Default</th> <th>Typical Range</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td><strong>C</strong></td> <td>1.0</td> <td>0.01-100</td> <td>Regularization (smaller = softer margin)</td> </tr> <tr> <td><strong>kernel</strong></td> <td>'rbf'</td> <td>'linear', 'rbf', 'poly'</td> <td>Decision boundary type</td> </tr> <tr> <td><strong>gamma</strong></td> <td>'scale'</td> <td>'scale', 'auto', float</td> <td>RBF kernel width (higher = more complex)</td> </tr> <tr> <td><strong>degree</strong></td> <td>3</td> <td>2-5</td> <td>Polynomial kernel degree</td> </tr> </tbody> </table> <h2 id=svm-vs-logistic-regression>SVM vs Logistic Regression</h2> <table> <thead> <tr> <th>Aspect</th> <th>SVM</th> <th>Logistic Regression</th> </tr> </thead> <tbody> <tr> <td><strong>Loss function</strong></td> <td>Hinge loss</td> <td>Log loss</td> </tr> <tr> <td><strong>Decision boundary</strong></td> <td>Maximum margin</td> <td>Probabilistic</td> </tr> <tr> <td><strong>Outliers</strong></td> <td>Less sensitive (margin)</td> <td>More sensitive</td> </tr> <tr> <td><strong>Probability output</strong></td> <td>No (needs calibration)</td> <td>Yes (native)</td> </tr> <tr> <td><strong>High dimensions</strong></td> <td>Excellent</td> <td>Good</td> </tr> <tr> <td><strong>Large datasets</strong></td> <td>Slower (O(n¬≤))</td> <td>Faster (O(n))</td> </tr> </tbody> </table> <h2 id=real-world-applications_11>Real-World Applications</h2> <table> <thead> <tr> <th>Domain</th> <th>Use Case</th> <th>Kernel</th> <th>Result</th> </tr> </thead> <tbody> <tr> <td><strong>Text</strong></td> <td>Spam detection</td> <td>Linear</td> <td>90% accuracy, high-dim</td> </tr> <tr> <td><strong>Vision</strong></td> <td>Handwritten digits</td> <td>RBF</td> <td>98% accuracy (MNIST)</td> </tr> <tr> <td><strong>Bioinformatics</strong></td> <td>Protein classification</td> <td>RBF</td> <td>Handles high-dim features</td> </tr> <tr> <td><strong>Finance</strong></td> <td>Credit scoring</td> <td>Linear</td> <td>Interpretable, fast</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>margin maximization</strong> (maximize 2/||w||)</li> <li>Understands <strong>support vectors</strong> (samples on margin boundary)</li> <li><strong>ALWAYS scales features</strong> (StandardScaler before SVM)</li> <li>Uses <strong>C parameter</strong> (C=1.0 default, smaller = softer margin)</li> <li>Knows <strong>kernel trick</strong> (map to higher dimension without computing œÜ(x))</li> <li>Uses <strong>RBF kernel</strong> for non-linear, <strong>linear kernel</strong> for high-dim/sparse</li> <li>Knows <strong>One-vs-One</strong> multiclass (n(n-1)/2 classifiers)</li> <li>Real-world: <strong>Spam detection uses linear SVM (90% accuracy, high-dimensional text features, fast)</strong></li> </ul> </div> </details> <hr> <h3 id=what-are-svm-kernels-google-amazon-interview-question>What are SVM kernels? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>SVM</code>, <code>Kernel Methods</code>, <code>Non-Linear</code> | <strong>Asked by:</strong> Google, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>Kernel functions</strong> map data to <strong>higher-dimensional space</strong> where it becomes <strong>linearly separable</strong>, without explicitly computing the transformation. <strong>Kernel trick:</strong> <span class=arithmatex>\(K(x_i, x_j) = \phi(x_i)^T \phi(x_j)\)</span> computed efficiently.</p> <p><strong>Common Kernels:</strong> - <strong>Linear:</strong> <span class=arithmatex>\(K(x, x') = x^T x'\)</span> (no transformation) - <strong>RBF (Gaussian):</strong> <span class=arithmatex>\(K(x, x') = exp(-\gamma ||x - x'||^2)\)</span> (most popular) - <strong>Polynomial:</strong> <span class=arithmatex>\(K(x, x') = (x^T x' + c)^d\)</span> (degree d)</p> <p><strong>Real-World Context:</strong> - <strong>Text:</strong> Linear kernel (high-dim, already separable) - <strong>Images:</strong> RBF kernel (complex, non-linear patterns) - <strong>Genomics:</strong> RBF kernel (non-linear relationships)</p> <h2 id=kernel-decision-tree>Kernel Decision Tree</h2> <div class=highlight><pre><span></span><code>                    Start: Choose Kernel
                             ‚Üì
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ                         ‚îÇ
        Is data linearly separable?      ‚îÇ
                ‚îÇ                         ‚îÇ
            ‚îå‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îê                     ‚îÇ
            ‚îÇ       ‚îÇ                     ‚îÇ
           Yes     No                     ‚îÇ
            ‚îÇ       ‚îÇ                     ‚îÇ
            ‚Üì       ‚Üì                     ‚Üì
     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ LINEAR  ‚îÇ  ‚îÇ Check data type‚îÇ  ‚îÇ               ‚îÇ
     ‚îÇ kernel  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ               ‚îÇ
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ               ‚îÇ               ‚îÇ
          ‚Üë            ‚Üì               ‚îÇ               ‚îÇ
          ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ               ‚îÇ
          ‚îÇ   ‚îÇ                 ‚îÇ      ‚îÇ               ‚îÇ
     High-dim ‚îÇ         Complex ‚îÇ      ‚îÇ               ‚îÇ
     (text)   ‚îÇ         (images,‚îÇ      ‚îÇ               ‚îÇ
          ‚îÇ   ‚îÇ         genomics‚îÇ      ‚îÇ               ‚îÇ
          ‚îÇ   ‚îÇ                )‚îÇ      ‚îÇ               ‚îÇ
          ‚îÇ   ‚Üì                 ‚Üì      ‚Üì               ‚Üì
          ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îî‚îÄ‚î§ LINEAR ‚îÇ    ‚îÇ   RBF   ‚îÇ ‚îÇ  POLY  ‚îÇ  ‚îÇ SIGMOID ‚îÇ
            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          (most popular)  (rarely)    (rarely)

Recommendation:
1. Try LINEAR first (fast, interpretable)
2. If poor performance ‚Üí try RBF
3. Tune gamma (RBF) or C (all)
</code></pre></div> <h2 id=production-implementation-150-lines>Production Implementation (150 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># svm_kernels_complete.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.svm</span><span class=w> </span><span class=kn>import</span> <span class=n>SVC</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>GridSearchCV</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span><span class=p>,</span> <span class=n>make_circles</span><span class=p>,</span> <span class=n>make_moons</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>accuracy_score</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_kernel_comparison</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Kernel Comparison: Linear vs Non-Linear Data</span>

<span class=sd>    Different kernels for different patterns</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Kernel Comparison on Non-Linear Data&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=c1># Non-linearly separable (circles)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_circles</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>noise</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>factor</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>kernels</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;linear&#39;</span><span class=p>:</span> <span class=p>{},</span>
        <span class=s1>&#39;rbf&#39;</span><span class=p>:</span> <span class=p>{},</span>
        <span class=s1>&#39;poly&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;degree&#39;</span><span class=p>:</span> <span class=mi>3</span><span class=p>},</span>
        <span class=s1>&#39;sigmoid&#39;</span><span class=p>:</span> <span class=p>{}</span>
    <span class=p>}</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Kernel&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Fit Time (s)&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>65</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>kernel</span><span class=p>,</span> <span class=n>params</span> <span class=ow>in</span> <span class=n>kernels</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
        <span class=n>svm</span> <span class=o>=</span> <span class=n>SVC</span><span class=p>(</span><span class=n>kernel</span><span class=o>=</span><span class=n>kernel</span><span class=p>,</span> <span class=o>**</span><span class=n>params</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>svm</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>fit_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>svm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>svm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>kernel</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>fit_time</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ RBF kernel best for non-linear patterns (circles)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Linear kernel fails (0.5 accuracy = random)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_rbf_gamma</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    RBF Gamma: Kernel Width</span>

<span class=sd>    gamma high ‚Üí narrow influence (overfitting risk)</span>
<span class=sd>    gamma low ‚Üí wide influence (underfitting risk)</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. RBF Gamma - Kernel Width&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_moons</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>noise</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>gammas</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.001</span><span class=p>,</span> <span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>100</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;gamma&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Overfit Gap&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>gamma</span> <span class=ow>in</span> <span class=n>gammas</span><span class=p>:</span>
        <span class=n>svm</span> <span class=o>=</span> <span class=n>SVC</span><span class=p>(</span><span class=n>kernel</span><span class=o>=</span><span class=s1>&#39;rbf&#39;</span><span class=p>,</span> <span class=n>gamma</span><span class=o>=</span><span class=n>gamma</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>svm</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>svm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>svm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>gap</span> <span class=o>=</span> <span class=n>train_acc</span> <span class=o>-</span> <span class=n>test_acc</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>gamma</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>gap</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  gamma=0.001: Too smooth (underfitting)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  gamma=0.1:   Good default (&#39;scale&#39;)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  gamma=100:   Too complex (overfitting)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ gamma=&#39;scale&#39; (default: 1/(n_features¬∑X.var())) typically best&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_polynomial_degree</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Polynomial Kernel: Degree Parameter</span>

<span class=sd>    Higher degree = more complex boundary</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. Polynomial Kernel - Degree&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>degrees</span> <span class=o>=</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Degree&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Fit Time (s)&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>degree</span> <span class=ow>in</span> <span class=n>degrees</span><span class=p>:</span>
        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
        <span class=n>svm</span> <span class=o>=</span> <span class=n>SVC</span><span class=p>(</span><span class=n>kernel</span><span class=o>=</span><span class=s1>&#39;poly&#39;</span><span class=p>,</span> <span class=n>degree</span><span class=o>=</span><span class=n>degree</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>svm</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>fit_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>svm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>svm</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>degree</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>fit_time</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ degree=3 default (higher degree = slower, overfitting risk)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_kernel_selection_guide</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Kernel Selection: Data-Driven Choice</span>

<span class=sd>    Try linear first, then RBF if needed</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Kernel Selection Guide&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>datasets</span> <span class=o>=</span> <span class=p>[</span>
        <span class=p>(</span><span class=s2>&quot;Linearly Separable&quot;</span><span class=p>,</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>400</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)),</span>
        <span class=p>(</span><span class=s2>&quot;Circles (Non-Linear)&quot;</span><span class=p>,</span> <span class=n>make_circles</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>400</span><span class=p>,</span> <span class=n>noise</span><span class=o>=</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>factor</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)),</span>
        <span class=p>(</span><span class=s2>&quot;High-Dimensional&quot;</span><span class=p>,</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>400</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>80</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>))</span>
    <span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Dataset&#39;</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Best Kernel&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Accuracy&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=ow>in</span> <span class=n>datasets</span><span class=p>:</span>
        <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

        <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
        <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
        <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

        <span class=c1># Try both linear and RBF</span>
        <span class=n>svm_linear</span> <span class=o>=</span> <span class=n>SVC</span><span class=p>(</span><span class=n>kernel</span><span class=o>=</span><span class=s1>&#39;linear&#39;</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>svm_linear</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>acc_linear</span> <span class=o>=</span> <span class=n>svm_linear</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=n>svm_rbf</span> <span class=o>=</span> <span class=n>SVC</span><span class=p>(</span><span class=n>kernel</span><span class=o>=</span><span class=s1>&#39;rbf&#39;</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
        <span class=n>svm_rbf</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>acc_rbf</span> <span class=o>=</span> <span class=n>svm_rbf</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=n>best_kernel</span> <span class=o>=</span> <span class=s1>&#39;Linear&#39;</span> <span class=k>if</span> <span class=n>acc_linear</span> <span class=o>&gt;</span> <span class=n>acc_rbf</span> <span class=k>else</span> <span class=s1>&#39;RBF&#39;</span>
        <span class=n>best_acc</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>acc_linear</span><span class=p>,</span> <span class=n>acc_rbf</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;25</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>best_kernel</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>best_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Recommendation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  1. Try LINEAR first (fast, interpretable)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  2. If accuracy &lt; 80% ‚Üí try RBF&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  3. Tune gamma (RBF) or C (all)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Linear for high-dim/linearly separable&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ RBF for complex non-linear patterns&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_grid_search_kernels</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Grid Search: Find Best Kernel + Hyperparameters</span>

<span class=sd>    Automated kernel selection</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. Grid Search - Best Kernel + Params&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_moons</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>noise</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Grid search over kernels</span>
    <span class=n>param_grid</span> <span class=o>=</span> <span class=p>[</span>
        <span class=p>{</span><span class=s1>&#39;kernel&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;linear&#39;</span><span class=p>],</span> <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>]},</span>
        <span class=p>{</span><span class=s1>&#39;kernel&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;rbf&#39;</span><span class=p>],</span> <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>],</span> <span class=s1>&#39;gamma&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>,</span> <span class=mi>1</span><span class=p>]},</span>
        <span class=p>{</span><span class=s1>&#39;kernel&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;poly&#39;</span><span class=p>],</span> <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>],</span> <span class=s1>&#39;degree&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]}</span>
    <span class=p>]</span>

    <span class=n>grid</span> <span class=o>=</span> <span class=n>GridSearchCV</span><span class=p>(</span><span class=n>SVC</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>),</span> <span class=n>param_grid</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;accuracy&#39;</span><span class=p>)</span>
    <span class=n>grid</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Best Parameters: </span><span class=si>{</span><span class=n>grid</span><span class=o>.</span><span class=n>best_params_</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Best CV Score: </span><span class=si>{</span><span class=n>grid</span><span class=o>.</span><span class=n>best_score_</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Test Accuracy: </span><span class=si>{</span><span class=n>grid</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span><span class=w> </span><span class=n>y_test</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Grid search finds best kernel automatically&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_kernel_comparison</span><span class=p>()</span>
    <span class=n>demo_rbf_gamma</span><span class=p>()</span>
    <span class=n>demo_polynomial_degree</span><span class=p>()</span>
    <span class=n>demo_kernel_selection_guide</span><span class=p>()</span>
    <span class=n>demo_grid_search_kernels</span><span class=p>()</span>
</code></pre></div> <h2 id=kernel-function-formulas>Kernel Function Formulas</h2> <table> <thead> <tr> <th>Kernel</th> <th>Formula</th> <th>Parameters</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>Linear</strong></td> <td><span class=arithmatex>\(K(x, x') = x^T x'\)</span></td> <td>None</td> <td>High-dim, linearly separable</td> </tr> <tr> <td><strong>RBF</strong></td> <td>$K(x, x') = exp(-\gamma</td> <td></td> <td>x - x'</td> </tr> <tr> <td><strong>Polynomial</strong></td> <td><span class=arithmatex>\(K(x, x') = (x^T x' + c)^d\)</span></td> <td>degree, coef0</td> <td>Specific polynomial patterns</td> </tr> <tr> <td><strong>Sigmoid</strong></td> <td><span class=arithmatex>\(K(x, x') = tanh(\gamma x^T x' + c)\)</span></td> <td>gamma, coef0</td> <td>Rarely used</td> </tr> </tbody> </table> <h2 id=kernel-selection-guide>Kernel Selection Guide</h2> <table> <thead> <tr> <th>Data Type</th> <th>Recommended Kernel</th> <th>Reason</th> </tr> </thead> <tbody> <tr> <td><strong>High-dimensional (text)</strong></td> <td>Linear</td> <td>Fast, no overfitting in high-dim</td> </tr> <tr> <td><strong>Non-linear patterns</strong></td> <td>RBF</td> <td>Most flexible, works well</td> </tr> <tr> <td><strong>Linearly separable</strong></td> <td>Linear</td> <td>Simplest, fastest</td> </tr> <tr> <td><strong>Small dataset</strong></td> <td>RBF</td> <td>Can capture complex patterns</td> </tr> <tr> <td><strong>Large dataset</strong></td> <td>Linear</td> <td>Faster (O(n) vs O(n¬≤))</td> </tr> </tbody> </table> <h2 id=rbf-gamma-tuning>RBF Gamma Tuning</h2> <table> <thead> <tr> <th>gamma</th> <th>Behavior</th> <th>Risk</th> </tr> </thead> <tbody> <tr> <td><strong>Very small (0.001)</strong></td> <td>Wide influence (smooth)</td> <td>Underfitting</td> </tr> <tr> <td><strong>'scale' (1/(n¬∑var))</strong></td> <td>Adaptive (good default)</td> <td>Balanced</td> </tr> <tr> <td><strong>Large (10+)</strong></td> <td>Narrow influence (complex)</td> <td>Overfitting</td> </tr> </tbody> </table> <h2 id=real-world-applications_12>Real-World Applications</h2> <table> <thead> <tr> <th>Domain</th> <th>Kernel</th> <th>gamma/C</th> <th>Result</th> </tr> </thead> <tbody> <tr> <td><strong>Text Classification</strong></td> <td>Linear</td> <td>C=1.0</td> <td>90% accuracy, fast</td> </tr> <tr> <td><strong>Image Recognition</strong></td> <td>RBF</td> <td>gamma='scale', C=10</td> <td>98% MNIST</td> </tr> <tr> <td><strong>Genomics</strong></td> <td>RBF</td> <td>gamma=0.1, C=1</td> <td>High-dim, non-linear</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>kernel trick</strong> (compute K(x,x') without œÜ(x))</li> <li>Understands <strong>RBF most popular</strong> (flexible, works well)</li> <li>Uses <strong>linear kernel</strong> for high-dim/text (fast, no overfitting)</li> <li>Tunes <strong>gamma</strong> (RBF width: lower = smoother, higher = complex)</li> <li>Knows <strong>gamma='scale'</strong> default (1/(n_features ¬∑ X.var()))</li> <li>Tries <strong>linear first</strong> (fast), then <strong>RBF</strong> if poor performance</li> <li>Knows <strong>polynomial rarely used</strong> (slower, less flexible than RBF)</li> <li>Real-world: <strong>Text uses linear SVM (high-dim, linearly separable), Images use RBF (complex non-linear patterns)</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-implement-knn-entry-level-interview-question>How to implement KNN? - Entry-Level Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>KNN</code>, <code>Classification</code>, <code>Instance-Based</code> | <strong>Asked by:</strong> Most Companies</p> <details class=success> <summary>View Answer</summary> <p><strong>KNN (K-Nearest Neighbors)</strong> is a <strong>lazy learner</strong> that classifies based on <strong>majority vote</strong> of k nearest neighbors. Distance typically <strong>Euclidean</strong>. No training phase (stores all data).</p> <p><strong>Formula:</strong> <span class=arithmatex>\(\hat{y} = mode(y_1, ..., y_k)\)</span> for classification or <span class=arithmatex>\(\hat{y} = mean(y_1, ..., y_k)\)</span> for regression</p> <p><strong>Real-World Context:</strong> - <strong>Recommendation Systems:</strong> Netflix (similar users ‚Üí similar preferences) - <strong>Medical Diagnosis:</strong> Similar patient profiles (k=5-10) - <strong>Image Recognition:</strong> Handwritten digits (pixel similarity)</p> <h2 id=knn-algorithm-flow>KNN Algorithm Flow</h2> <div class=highlight><pre><span></span><code>Training Phase:
===============
Store all training data (X_train, y_train)
     ‚Üì
No model training! (lazy learner)


Prediction Phase:
=================
New point x_new
     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. Compute distances to ALL      ‚îÇ
‚îÇ    training points               ‚îÇ
‚îÇ    d(x_new, x_i) for all i       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. Sort by distance (ascending)  ‚îÇ
‚îÇ    Find k nearest neighbors      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. Classification:               ‚îÇ
‚îÇ    - Majority vote of k labels   ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ    Regression:                   ‚îÇ
‚îÇ    - Average of k values         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Distance Metrics:
- Euclidean: ‚àö(Œ£(x_i - y_i)¬≤)
- Manhattan: Œ£|x_i - y_i|
- Minkowski: (Œ£|x_i - y_i|^p)^(1/p)
</code></pre></div> <h2 id=production-implementation-145-lines_1>Production Implementation (145 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># knn_complete.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.neighbors</span><span class=w> </span><span class=kn>import</span> <span class=n>KNeighborsClassifier</span><span class=p>,</span> <span class=n>KNeighborsRegressor</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>cross_val_score</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span><span class=p>,</span> <span class=n>make_regression</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>accuracy_score</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_knn_basic</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    KNN: Lazy Learner</span>

<span class=sd>    No training phase, stores all data</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. KNN - Lazy Learner&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>15</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Scaling critical for KNN (distance-based)</span>
    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>knn</span> <span class=o>=</span> <span class=n>KNeighborsClassifier</span><span class=p>(</span><span class=n>n_neighbors</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>

    <span class=c1># &quot;Training&quot; (just stores data)</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
    <span class=n>knn</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>fit_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

    <span class=c1># Prediction (computes distances)</span>
    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
    <span class=n>y_pred</span> <span class=o>=</span> <span class=n>knn</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>)</span>
    <span class=n>pred_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

    <span class=n>acc</span> <span class=o>=</span> <span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>KNN (k=5):&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Fit Time:       </span><span class=si>{</span><span class=n>fit_time</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>s (just stores data)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Predict Time:   </span><span class=si>{</span><span class=n>pred_time</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>s (computes distances)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Test Accuracy:  </span><span class=si>{</span><span class=n>acc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ KNN is lazy learner (no training, fast fit)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Slow prediction (computes all distances)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_k_tuning</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    k: Number of Neighbors</span>

<span class=sd>    k small ‚Üí low bias, high variance</span>
<span class=sd>    k large ‚Üí high bias, low variance</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. k Parameter - Bias-Variance Tradeoff&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>600</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>k_values</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>50</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;k&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Overfit Gap&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=n>k_values</span><span class=p>:</span>
        <span class=n>knn</span> <span class=o>=</span> <span class=n>KNeighborsClassifier</span><span class=p>(</span><span class=n>n_neighbors</span><span class=o>=</span><span class=n>k</span><span class=p>)</span>
        <span class=n>knn</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>knn</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>knn</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>gap</span> <span class=o>=</span> <span class=n>train_acc</span> <span class=o>-</span> <span class=n>test_acc</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>k</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>gap</span><span class=si>:</span><span class=s2>&lt;15.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  k=1:  Overfitting (memorizes training data)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  k=5:  Good default (balance)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  k=50: Underfitting (too smooth)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ k=5-10 typically good default&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Use cross-validation to find optimal k&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_distance_metrics</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Distance Metrics: Euclidean, Manhattan, Minkowski</span>

<span class=sd>    Different metrics for different data types</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. Distance Metrics&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>metrics</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;euclidean&#39;</span><span class=p>:</span> <span class=s1>&#39;Euclidean (L2)&#39;</span><span class=p>,</span>
        <span class=s1>&#39;manhattan&#39;</span><span class=p>:</span> <span class=s1>&#39;Manhattan (L1)&#39;</span><span class=p>,</span>
        <span class=s1>&#39;minkowski&#39;</span><span class=p>:</span> <span class=s1>&#39;Minkowski (p=3)&#39;</span><span class=p>,</span>
        <span class=s1>&#39;chebyshev&#39;</span><span class=p>:</span> <span class=s1>&#39;Chebyshev (L‚àû)&#39;</span>
    <span class=p>}</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Metric&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>40</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>metric</span><span class=p>,</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>metrics</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>knn</span> <span class=o>=</span> <span class=n>KNeighborsClassifier</span><span class=p>(</span><span class=n>n_neighbors</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>metric</span><span class=o>=</span><span class=n>metric</span><span class=p>)</span>
        <span class=n>knn</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>knn</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Euclidean (default) works well for most problems&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_scaling_importance</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Feature Scaling: CRITICAL for KNN</span>

<span class=sd>    KNN uses distances, features must be same scale</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Feature Scaling (CRITICAL!)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Make feature 0 have large scale</span>
    <span class=n>X</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>X</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>1000</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=c1># Without scaling</span>
    <span class=n>knn_no_scale</span> <span class=o>=</span> <span class=n>KNeighborsClassifier</span><span class=p>(</span><span class=n>n_neighbors</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
    <span class=n>knn_no_scale</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>acc_no_scale</span> <span class=o>=</span> <span class=n>knn_no_scale</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=c1># With scaling</span>
    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>knn_scaled</span> <span class=o>=</span> <span class=n>KNeighborsClassifier</span><span class=p>(</span><span class=n>n_neighbors</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
    <span class=n>knn_scaled</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>acc_scaled</span> <span class=o>=</span> <span class=n>knn_scaled</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Approach&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>40</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Without Scaling&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>acc_no_scale</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;With Scaling&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>acc_scaled</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Improvement&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=p>(</span><span class=n>acc_scaled</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>acc_no_scale</span><span class=p>)</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ ALWAYS scale features for KNN (StandardScaler)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_knn_regression</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    KNN Regression: Average of k Nearest Neighbors</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. KNN Regression&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_regression</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>noise</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=n>k_values</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;k&#39;</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train R¬≤&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test R¬≤&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>45</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=n>k_values</span><span class=p>:</span>
        <span class=n>knn</span> <span class=o>=</span> <span class=n>KNeighborsRegressor</span><span class=p>(</span><span class=n>n_neighbors</span><span class=o>=</span><span class=n>k</span><span class=p>)</span>
        <span class=n>knn</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_r2</span> <span class=o>=</span> <span class=n>knn</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_r2</span> <span class=o>=</span> <span class=n>knn</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>k</span><span class=si>:</span><span class=s2>&lt;10</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_r2</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_r2</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ KNN regression: average of k neighbors&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_knn_basic</span><span class=p>()</span>
    <span class=n>demo_k_tuning</span><span class=p>()</span>
    <span class=n>demo_distance_metrics</span><span class=p>()</span>
    <span class=n>demo_scaling_importance</span><span class=p>()</span>
    <span class=n>demo_knn_regression</span><span class=p>()</span>
</code></pre></div> <h2 id=knn-key-parameters>KNN Key Parameters</h2> <table> <thead> <tr> <th>Parameter</th> <th>Default</th> <th>Typical Range</th> <th>Purpose</th> </tr> </thead> <tbody> <tr> <td><strong>n_neighbors</strong></td> <td>5</td> <td>3-15</td> <td>Number of neighbors (k)</td> </tr> <tr> <td><strong>metric</strong></td> <td>'euclidean'</td> <td>'euclidean', 'manhattan'</td> <td>Distance function</td> </tr> <tr> <td><strong>weights</strong></td> <td>'uniform'</td> <td>'uniform', 'distance'</td> <td>Neighbor weights (closer = more)</td> </tr> <tr> <td><strong>algorithm</strong></td> <td>'auto'</td> <td>'ball_tree', 'kd_tree', 'brute'</td> <td>Search algorithm</td> </tr> </tbody> </table> <h2 id=knn-pros-cons>KNN Pros &amp; Cons</h2> <table> <thead> <tr> <th>Pros ‚úÖ</th> <th>Cons ‚ùå</th> </tr> </thead> <tbody> <tr> <td>Simple, no training</td> <td>Slow prediction (O(n))</td> </tr> <tr> <td>No assumptions about data</td> <td>Memory intensive (stores all data)</td> </tr> <tr> <td>Works for multi-class</td> <td>Requires feature scaling</td> </tr> <tr> <td>Non-parametric</td> <td>Curse of dimensionality</td> </tr> <tr> <td>Interpretable</td> <td>Sensitive to irrelevant features</td> </tr> </tbody> </table> <h2 id=distance-metrics>Distance Metrics</h2> <table> <thead> <tr> <th>Metric</th> <th>Formula</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>Euclidean</strong></td> <td><span class=arithmatex>\(\sqrt{\sum(x_i - y_i)^2}\)</span></td> <td>Most problems (default)</td> </tr> <tr> <td><strong>Manhattan</strong></td> <td>$\sum</td> <td>x_i - y_i</td> </tr> <tr> <td><strong>Minkowski</strong></td> <td>$(\sum</td> <td>x_i - y_i</td> </tr> </tbody> </table> <h2 id=real-world-applications_13>Real-World Applications</h2> <table> <thead> <tr> <th>Domain</th> <th>Use Case</th> <th>k</th> <th>Result</th> </tr> </thead> <tbody> <tr> <td><strong>Recommendation</strong></td> <td>Netflix (similar users)</td> <td>10-20</td> <td>Collaborative filtering</td> </tr> <tr> <td><strong>Medical</strong></td> <td>Diagnosis (patient profiles)</td> <td>5-10</td> <td>85% accuracy</td> </tr> <tr> <td><strong>Vision</strong></td> <td>Handwritten digits</td> <td>3-5</td> <td>97% accuracy (MNIST)</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>lazy learner</strong> (no training phase, stores all data)</li> <li>Understands <strong>k tuning</strong> (k=5-10 typical, use CV to find optimal)</li> <li><strong>ALWAYS scales features</strong> (distance-based, critical!)</li> <li>Uses <strong>Euclidean distance</strong> (default, works well)</li> <li>Knows <strong>slow prediction</strong> (O(n) distance computations)</li> <li>Understands <strong>curse of dimensionality</strong> (performance degrades in high-dim)</li> <li>Uses <strong>weights='distance'</strong> (closer neighbors weighted more)</li> <li>Real-world: <strong>Netflix uses KNN for recommendation (k=10-20, similar users ‚Üí similar preferences)</strong></li> </ul> </div> </details> <hr> <h3 id=what-is-the-curse-of-dimensionality-senior-interview-question>What is the curse of dimensionality? - Senior Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>High-Dimensional</code>, <code>KNN</code>, <code>Feature Selection</code> | <strong>Asked by:</strong> Most FAANG</p> <details class=success> <summary>View Answer</summary> <p><strong>Curse of Dimensionality</strong>: As <strong>dimensions increase</strong>, data becomes <strong>sparse</strong>, distances become <strong>less meaningful</strong>, and model performance <strong>degrades</strong>. Volume of space grows exponentially ‚Üí most data at edges.</p> <p><strong>Key Issue:</strong> In high dimensions, <strong>all points are equidistant</strong> (distance metrics fail), especially for KNN.</p> <p><strong>Real-World Context:</strong> - <strong>Genomics:</strong> 20,000+ genes, need dimensionality reduction (PCA) - <strong>Text:</strong> 10,000+ words, sparse high-dim (use feature selection) - <strong>Images:</strong> 784 pixels (MNIST), need CNN or PCA</p> <h2 id=curse-of-dimensionality-visualization>Curse of Dimensionality Visualization</h2> <div class=highlight><pre><span></span><code>Volume Grows Exponentially:
===========================

1D: Line segment (length 1)
    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
    Volume = 1

2D: Square (side 1)
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ         ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    Volume = 1

3D: Cube (side 1)
    Volume = 1

nD: Hypercube (side 1)
    Volume = 1

BUT: Most volume at EDGES!


Distance Convergence:
=====================
Low Dimensions (2D-3D):
    Points clearly separated
    ‚óè           ‚óã
      ‚óè       ‚óã
        ‚óè   ‚óã
    d_min ‚â† d_max (distances meaningful)

High Dimensions (100D+):
    All points equidistant!
    ‚óè‚óã‚óè‚óã‚óè‚óã‚óè‚óã‚óè‚óã
    d_min ‚âà d_max (distances meaningless)

Formula: lim(d‚Üí‚àû) [d_max - d_min] / d_min ‚Üí 0


Impact on KNN:
==============
          Low Dim            High Dim
k=5 ‚Üí   ‚óè   ‚óè   ‚óè       ‚Üí   All points
          ‚Üì   ‚Üì   ‚Üì           equally far!
        Clear neighbors      No clear neighbors
</code></pre></div> <h2 id=production-implementation-135-lines>Production Implementation (135 lines)</h2> <div class=highlight><pre><span></span><code><span class=c1># curse_of_dimensionality.py</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.neighbors</span><span class=w> </span><span class=kn>import</span> <span class=n>KNeighborsClassifier</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.decomposition</span><span class=w> </span><span class=kn>import</span> <span class=n>PCA</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.feature_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>SelectKBest</span><span class=p>,</span> <span class=n>f_classif</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_distance_concentration</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Distance Concentration in High Dimensions</span>

<span class=sd>    Distances become less meaningful</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Distance Concentration - High Dimensions&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>n_samples</span> <span class=o>=</span> <span class=mi>100</span>

    <span class=n>dimensions</span> <span class=o>=</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>1000</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Dimensions&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;d_max&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;d_min&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Ratio&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>d</span> <span class=ow>in</span> <span class=n>dimensions</span><span class=p>:</span>
        <span class=c1># Generate random points</span>
        <span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>n_samples</span><span class=p>,</span> <span class=n>d</span><span class=p>)</span>

        <span class=c1># Compute pairwise distances</span>
        <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics.pairwise</span><span class=w> </span><span class=kn>import</span> <span class=n>euclidean_distances</span>
        <span class=n>distances</span> <span class=o>=</span> <span class=n>euclidean_distances</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>

        <span class=c1># Remove diagonal (self-distances)</span>
        <span class=n>distances</span> <span class=o>=</span> <span class=n>distances</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>triu_indices_from</span><span class=p>(</span><span class=n>distances</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mi>1</span><span class=p>)]</span>

        <span class=n>d_max</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>distances</span><span class=p>)</span>
        <span class=n>d_min</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>min</span><span class=p>(</span><span class=n>distances</span><span class=p>)</span>
        <span class=n>ratio</span> <span class=o>=</span> <span class=p>(</span><span class=n>d_max</span> <span class=o>-</span> <span class=n>d_min</span><span class=p>)</span> <span class=o>/</span> <span class=n>d_min</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>d</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>d_max</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>d_min</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>ratio</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - As dimensions ‚Üë, ratio ‚Üí 0&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - All distances become similar (meaningless)&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ High dimensions: distances lose meaning&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_knn_performance_vs_dimensions</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    KNN Performance Degrades with Dimensions</span>

<span class=sd>    Curse of dimensionality impact</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. KNN Performance vs Dimensionality&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>n_samples</span> <span class=o>=</span> <span class=mi>500</span>

    <span class=n>dimensions</span> <span class=o>=</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>]</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Dimensions&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Train Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Gap&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>d</span> <span class=ow>in</span> <span class=n>dimensions</span><span class=p>:</span>
        <span class=c1># Generate data</span>
        <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
            <span class=n>n_samples</span><span class=o>=</span><span class=n>n_samples</span><span class=p>,</span>
            <span class=n>n_features</span><span class=o>=</span><span class=n>d</span><span class=p>,</span>
            <span class=n>n_informative</span><span class=o>=</span><span class=nb>min</span><span class=p>(</span><span class=n>d</span><span class=p>,</span> <span class=mi>10</span><span class=p>),</span>
            <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
            <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
        <span class=p>)</span>

        <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

        <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
        <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
        <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

        <span class=n>knn</span> <span class=o>=</span> <span class=n>KNeighborsClassifier</span><span class=p>(</span><span class=n>n_neighbors</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
        <span class=n>knn</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>

        <span class=n>train_acc</span> <span class=o>=</span> <span class=n>knn</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
        <span class=n>test_acc</span> <span class=o>=</span> <span class=n>knn</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
        <span class=n>gap</span> <span class=o>=</span> <span class=n>train_acc</span> <span class=o>-</span> <span class=n>test_acc</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>d</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>train_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>test_acc</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>gap</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ Test accuracy degrades as dimensions increase&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ KNN particularly sensitive to curse of dimensionality&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_pca_solution</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    PCA: Reduce Dimensionality</span>

<span class=sd>    Solution to curse of dimensionality</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. PCA - Dimensionality Reduction Solution&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
    <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
        <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span>
        <span class=n>n_features</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
        <span class=n>n_informative</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
    <span class=p>)</span>

    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

    <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
    <span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span>
    <span class=n>X_test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>

    <span class=c1># Without PCA (100 dimensions)</span>
    <span class=n>knn_full</span> <span class=o>=</span> <span class=n>KNeighborsClassifier</span><span class=p>(</span><span class=n>n_neighbors</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
    <span class=n>knn_full</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>acc_full</span> <span class=o>=</span> <span class=n>knn_full</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=c1># With PCA (20 dimensions)</span>
    <span class=n>pca</span> <span class=o>=</span> <span class=n>PCA</span><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=mi>20</span><span class=p>)</span>
    <span class=n>X_train_pca</span> <span class=o>=</span> <span class=n>pca</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train_scaled</span><span class=p>)</span>
    <span class=n>X_test_pca</span> <span class=o>=</span> <span class=n>pca</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_test_scaled</span><span class=p>)</span>

    <span class=n>knn_pca</span> <span class=o>=</span> <span class=n>KNeighborsClassifier</span><span class=p>(</span><span class=n>n_neighbors</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
    <span class=n>knn_pca</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_pca</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
    <span class=n>acc_pca</span> <span class=o>=</span> <span class=n>knn_pca</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test_pca</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Approach&#39;</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Dimensions&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Test Acc&#39;</span><span class=si>:</span><span class=s2>&lt;12</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>65</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Full Features&#39;</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=mi>100</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>acc_full</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;PCA (20 components)&#39;</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=mi>20</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>acc_pca</span><span class=si>:</span><span class=s2>&lt;12.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=s1>&#39;Improvement&#39;</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;-80 features&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>acc_pca</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>acc_full</span><span class=si>:</span><span class=s2>+.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Variance Explained: </span><span class=si>{</span><span class=n>pca</span><span class=o>.</span><span class=n>explained_variance_ratio_</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=si>:</span><span class=s2>.2%</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ PCA reduces dimensions while preserving variance&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úÖ Often improves performance (removes noise)&quot;</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>demo_sample_density</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Sample Density: Sparse in High Dimensions</span>

<span class=sd>    Need exponentially more data</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span> <span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. Sample Density - Exponential Data Requirement&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=&quot;</span><span class=o>*</span><span class=mi>70</span><span class=p>)</span>

    <span class=c1># Samples needed to maintain density</span>
    <span class=n>density</span> <span class=o>=</span> <span class=mi>10</span>  <span class=c1># samples per unit length</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=s1>&#39;Dimensions&#39;</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Samples Needed&#39;</span><span class=si>:</span><span class=s2>&lt;20</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=s1>&#39;Note&#39;</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;-&quot;</span> <span class=o>*</span> <span class=mi>70</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>d</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>]:</span>
        <span class=n>samples_needed</span> <span class=o>=</span> <span class=n>density</span> <span class=o>**</span> <span class=n>d</span>

        <span class=n>note</span> <span class=o>=</span> <span class=s2>&quot;Manageable&quot;</span> <span class=k>if</span> <span class=n>samples_needed</span> <span class=o>&lt;</span> <span class=mi>10000</span> <span class=k>else</span> <span class=s2>&quot;Impractical!&quot;</span>

        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>d</span><span class=si>:</span><span class=s2>&lt;15</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>samples_needed</span><span class=si>:</span><span class=s2>&lt;20,</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>note</span><span class=si>:</span><span class=s2>&lt;30</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Interpretation:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - To maintain same density, need density^d samples&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;  - Grows exponentially with dimensions&quot;</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚úÖ High dimensions require exponentially more data&quot;</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
    <span class=n>demo_distance_concentration</span><span class=p>()</span>
    <span class=n>demo_knn_performance_vs_dimensions</span><span class=p>()</span>
    <span class=n>demo_pca_solution</span><span class=p>()</span>
    <span class=n>demo_sample_density</span><span class=p>()</span>
</code></pre></div> <h2 id=curse-of-dimensionality-effects>Curse of Dimensionality Effects</h2> <table> <thead> <tr> <th>Effect</th> <th>Explanation</th> <th>Impact</th> </tr> </thead> <tbody> <tr> <td><strong>Distance concentration</strong></td> <td>All points equidistant</td> <td>KNN fails (no clear neighbors)</td> </tr> <tr> <td><strong>Sparse data</strong></td> <td>Most space is empty</td> <td>Need exponentially more samples</td> </tr> <tr> <td><strong>Volume at edges</strong></td> <td>Most data at hypercube edges</td> <td>Outliers everywhere</td> </tr> <tr> <td><strong>Overfitting</strong></td> <td>More features than samples</td> <td>Model memorizes noise</td> </tr> </tbody> </table> <h2 id=solutions-to-curse-of-dimensionality>Solutions to Curse of Dimensionality</h2> <table> <thead> <tr> <th>Solution</th> <th>Method</th> <th>When to Use</th> </tr> </thead> <tbody> <tr> <td><strong>Feature Selection</strong></td> <td>SelectKBest, LASSO</td> <td>Remove irrelevant features</td> </tr> <tr> <td><strong>PCA</strong></td> <td>Linear dimensionality reduction</td> <td>Correlated features</td> </tr> <tr> <td><strong>t-SNE</strong></td> <td>Non-linear visualization</td> <td>Visualization only (2D-3D)</td> </tr> <tr> <td><strong>Autoencoders</strong></td> <td>Neural network compression</td> <td>Complex non-linear patterns</td> </tr> <tr> <td><strong>Regularization</strong></td> <td>L1/L2 penalty</td> <td>Prevent overfitting</td> </tr> </tbody> </table> <h2 id=dimensionality-guidelines>Dimensionality Guidelines</h2> <table> <thead> <tr> <th>Algorithm</th> <th>Sensitive to Curse?</th> <th>Recommendation</th> </tr> </thead> <tbody> <tr> <td><strong>KNN</strong></td> <td>‚ö†Ô∏è Very sensitive</td> <td>Use PCA/feature selection (d&lt;20)</td> </tr> <tr> <td><strong>Decision Trees</strong></td> <td>‚úÖ Less sensitive</td> <td>Can handle high-dim well</td> </tr> <tr> <td><strong>SVM (linear)</strong></td> <td>‚úÖ Works well</td> <td>Good for high-dim (text)</td> </tr> <tr> <td><strong>Naive Bayes</strong></td> <td>‚úÖ Less sensitive</td> <td>Assumes independence</td> </tr> <tr> <td><strong>Neural Networks</strong></td> <td>üü° Moderate</td> <td>Needs more data</td> </tr> </tbody> </table> <h2 id=real-world-examples_1>Real-World Examples</h2> <table> <thead> <tr> <th>Domain</th> <th>Original Dim</th> <th>Solution</th> <th>Result Dim</th> </tr> </thead> <tbody> <tr> <td><strong>Genomics</strong></td> <td>20,000 genes</td> <td>PCA</td> <td>50-100</td> </tr> <tr> <td><strong>Text</strong></td> <td>10,000 words</td> <td>TF-IDF + SelectKBest</td> <td>500-1000</td> </tr> <tr> <td><strong>Images</strong></td> <td>784 pixels (MNIST)</td> <td>PCA or CNN</td> <td>50 (PCA)</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>distance concentration</strong> (all points equidistant in high-dim)</li> <li>Understands <strong>exponential data requirement</strong> (need density^d samples)</li> <li>Uses <strong>PCA</strong> (reduce to 20-100 dimensions typically)</li> <li>Knows <strong>KNN most affected</strong> (distance-based methods fail)</li> <li>Uses <strong>feature selection</strong> (remove irrelevant features first)</li> <li>Understands <strong>sparse data</strong> (most hypercube volume at edges)</li> <li>Knows <strong>linear SVM works well</strong> in high-dim (text classification)</li> <li>Real-world: <strong>Genomics uses PCA (20,000 genes ‚Üí 50-100 components, 95% variance explained)</strong></li> </ul> </div> </details> <hr> <h3 id=what-are-naive-bayes-variants-common-interview-question>What are Naive Bayes variants? - Common Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Naive Bayes</code>, <code>Classification</code>, <code>Probabilistic</code> | <strong>Asked by:</strong> Most Companies</p> <details class=success> <summary>View Answer</summary> <p><strong>Naive Bayes</strong> is a probabilistic classifier based on <strong>Bayes' theorem</strong> with <strong>naive independence assumption</strong> (features independent given class). Three main variants for different data types.</p> <p><strong>Formula:</strong> <span class=arithmatex>\(P(y|X) \propto P(y) \prod_{i=1}^{n} P(x_i|y)\)</span> (posterior ‚àù prior √ó likelihood)</p> <p><strong>Variants:</strong> - <strong>GaussianNB:</strong> Continuous features (Gaussian distribution) - <strong>MultinomialNB:</strong> Discrete counts (text, word frequencies) - <strong>BernoulliNB:</strong> Binary features (document presence/absence)</p> <p><strong>Real-World Context:</strong> - <strong>Spam Detection:</strong> MultinomialNB (word counts, 95% accuracy) - <strong>Sentiment Analysis:</strong> MultinomialNB (text classification) - <strong>Medical Diagnosis:</strong> GaussianNB (continuous test results)</p> <h2 id=naive-bayes-variants-decision-tree>Naive Bayes Variants Decision Tree</h2> <div class=highlight><pre><span></span><code>               What type of features?
                       ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ                  ‚îÇ                  ‚îÇ
Continuous         Discrete            Binary
(real values)      (counts)          (0/1, yes/no)
    ‚îÇ                  ‚îÇ                  ‚îÇ
    ‚Üì                  ‚Üì                  ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Gaussian  ‚îÇ    ‚îÇMultinomial‚îÇ    ‚îÇ Bernoulli ‚îÇ
‚îÇ    NB     ‚îÇ    ‚îÇ    NB     ‚îÇ    ‚îÇ    NB     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ                  ‚îÇ                  ‚îÇ
    ‚Üì                  ‚Üì                  ‚Üì
P(x|y) ~ N(Œº,œÉ¬≤)   P(x|y) ~ Mult  P(x|y) ~ Bern

Examples:
- Height, weight      - Word counts     - Word presence
- Temperature         - TF-IDF          - Has feature?
- Medical tests       - Email tokens    - Document contains
</code></pre></div> <h2 id=production-implementation-165-lines_1>Production Implementation (165 lines)</h2> <p>```python</p> <h1 id=naive_bayes_variantspy>naive_bayes_variants.py</h1> <p>import numpy as np from sklearn.naive_bayes import GaussianNB, MultinomialNB, BernoulliNB from sklearn.model_selection import train_test_split from sklearn.datasets import make_classification from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer from sklearn.preprocessing import StandardScaler from sklearn.metrics import accuracy_score</p> <p>def demo_gaussian_nb(): """ GaussianNB: Continuous Features</p> <div class=codehilite><pre><span></span><code><span class=n>Assumes</span><span class=w> </span><span class=n>Gaussian</span><span class=w> </span><span class=p>(</span><span class=n>normal</span><span class=p>)</span><span class=w> </span><span class=n>distribution</span>
<span class=s2>&quot;&quot;&quot;</span>
<span class=s2>print(&quot;=&quot;*70)</span>
<span class=s2>print(&quot;1. GaussianNB - Continuous Features&quot;)</span>
<span class=s2>print(&quot;=&quot;*70)</span>

<span class=s2>np.random.seed(42)</span>
<span class=s2>X, y = make_classification(</span>
<span class=s2>    n_samples=500,</span>
<span class=s2>    n_features=20,</span>
<span class=s2>    n_informative=15,</span>
<span class=s2>    random_state=42</span>
<span class=s2>)</span>

<span class=s2>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)</span>

<span class=s2># GaussianNB (no scaling needed!)</span>
<span class=s2>gnb = GaussianNB()</span>
<span class=s2>gnb.fit(X_train, y_train)</span>

<span class=s2>train_acc = gnb.score(X_train, y_train)</span>
<span class=s2>test_acc = gnb.score(X_test, y_test)</span>

<span class=s2>print(f&quot;</span><span class=se>\n</span><span class=s2>GaussianNB:&quot;)</span>
<span class=s2>print(f&quot;  Train Accuracy: {train_acc:.4f}&quot;)</span>
<span class=s2>print(f&quot;  Test Accuracy:  {test_acc:.4f}&quot;)</span>
<span class=s2>print(f&quot;  Classes: {gnb.classes_}&quot;)</span>
<span class=s2>print(f&quot;  Class Prior: {gnb.class_prior_}&quot;)</span>

<span class=s2># Show learned parameters</span>
<span class=s2>print(f&quot;</span><span class=se>\n</span><span class=s2>  Feature 0 - Class 0: Œº={gnb.theta_[0, 0]:.2f}, œÉ¬≤={gnb.var_[0, 0]:.2f}&quot;)</span>
<span class=s2>print(f&quot;  Feature 0 - Class 1: Œº={gnb.theta_[1, 0]:.2f}, œÉ¬≤={gnb.var_[1, 0]:.2f}&quot;)</span>

<span class=s2>print(&quot;</span><span class=se>\n</span><span class=s2>‚úÖ GaussianNB: For continuous real-valued features&quot;)</span>
<span class=s2>print(&quot;‚úÖ No scaling needed (uses mean and variance)&quot;)</span>
</code></pre></div> <p>def demo_multinomial_nb(): """ MultinomialNB: Discrete Counts (Text)</p> <div class=codehilite><pre><span></span><code>For word counts, TF-IDF
&quot;&quot;&quot;
print(&quot;\n&quot; + &quot;=&quot;*70)
print(&quot;2. MultinomialNB - Text Classification (Word Counts)&quot;)
print(&quot;=&quot;*70)

<span class=gh>#</span> Sample text data
texts = [
    &quot;win free money now&quot;,
    &quot;get rich quick scheme&quot;,
    &quot;limited time offer win&quot;,
    &quot;meeting scheduled tomorrow&quot;,
    &quot;project update deadline&quot;,
    &quot;quarterly report attached&quot;,
    &quot;free prize winner claim&quot;,
    &quot;budget approval needed&quot;,
    &quot;congratulations you won&quot;,
    &quot;status update required&quot;
]

labels = [1, 1, 1, 0, 0, 0, 1, 0, 1, 0]  # 1=spam, 0=ham

<span class=gh>#</span> Convert to word counts
vectorizer = CountVectorizer()
X = vectorizer.fit_transform(texts)

X_train, X_test, y_train, y_test = train_test_split(
    X, labels, test_size=0.3, random_state=42
)

<span class=gh>#</span> MultinomialNB
mnb = MultinomialNB()
mnb.fit(X_train, y_train)

train_acc = mnb.score(X_train, y_train)
test_acc = mnb.score(X_test, y_test)

print(f&quot;\nMultinomialNB (Spam Detection):&quot;)
print(f&quot;  Vocabulary Size: {len(vectorizer.vocabulary_)}&quot;)
print(f&quot;  Train Accuracy: {train_acc:.4f}&quot;)
print(f&quot;  Test Accuracy:  {test_acc:.4f}&quot;)

<span class=gh>#</span> Predict new sample
new_text = [&quot;free money winner&quot;]
new_X = vectorizer.transform(new_text)
pred = mnb.predict(new_X)
proba = mnb.predict_proba(new_X)

print(f&quot;\n  Test: &#39;{new_text[0]}&#39;&quot;)
print(f&quot;  Prediction: {&#39;SPAM&#39; if pred[0] == 1 else &#39;HAM&#39;}&quot;)
print(f&quot;  Probability: P(spam)={proba[0][1]:.2f}, P(ham)={proba[0][0]:.2f}&quot;)

print(&quot;\n‚úÖ MultinomialNB: For discrete counts (text, word frequencies)&quot;)
</code></pre></div> <p>def demo_bernoulli_nb(): """ BernoulliNB: Binary Features (0/1)</p> <div class=codehilite><pre><span></span><code>For presence/absence of features
&quot;&quot;&quot;
print(&quot;\n&quot; + &quot;=&quot;*70)
print(&quot;3. BernoulliNB - Binary Features&quot;)
print(&quot;=&quot;*70)

<span class=gh>#</span> Sample text data (same as before)
texts = [
    &quot;win free money now&quot;,
    &quot;get rich quick scheme&quot;,
    &quot;limited time offer win&quot;,
    &quot;meeting scheduled tomorrow&quot;,
    &quot;project update deadline&quot;,
    &quot;quarterly report attached&quot;,
    &quot;free prize winner claim&quot;,
    &quot;budget approval needed&quot;,
    &quot;congratulations you won&quot;,
    &quot;status update required&quot;
]

labels = [1, 1, 1, 0, 0, 0, 1, 0, 1, 0]

<span class=gh>#</span> Convert to binary (presence/absence)
vectorizer = CountVectorizer(binary=True)
X = vectorizer.fit_transform(texts)

X_train, X_test, y_train, y_test = train_test_split(
    X, labels, test_size=0.3, random_state=42
)

<span class=gh>#</span> BernoulliNB
bnb = BernoulliNB()
bnb.fit(X_train, y_train)

train_acc = bnb.score(X_train, y_train)
test_acc = bnb.score(X_test, y_test)

print(f&quot;\nBernoulliNB:&quot;)
print(f&quot;  Train Accuracy: {train_acc:.4f}&quot;)
print(f&quot;  Test Accuracy:  {test_acc:.4f}&quot;)

print(&quot;\n‚úÖ BernoulliNB: For binary features (presence/absence)&quot;)
print(&quot;‚úÖ Multinomial vs Bernoulli: counts vs binary&quot;)
</code></pre></div> <p>def demo_variant_comparison(): """ Compare All Variants on Same Data """ print("\n" + "="*70) print("4. Variant Comparison") print("="*70)</p> <div class=codehilite><pre><span></span><code><span class=c1># Generate continuous data</span>
<span class=n>np</span><span class=p>.</span><span class=k>random</span><span class=p>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
<span class=n>X_cont</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span><span class=w> </span><span class=n>n_features</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span><span class=w> </span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

<span class=n>X_train</span><span class=p>,</span><span class=w> </span><span class=n>X_test</span><span class=p>,</span><span class=w> </span><span class=n>y_train</span><span class=p>,</span><span class=w> </span><span class=n>y_test</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>train_test_split</span><span class=p>(</span><span class=n>X_cont</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>,</span><span class=w> </span><span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span><span class=w> </span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

<span class=c1># Convert to non-negative for Multinomial/Bernoulli</span>
<span class=n>X_train_pos</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>X_train</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>X_train</span><span class=p>.</span><span class=nf>min</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>0.01</span>
<span class=n>X_test_pos</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>X_test</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>X_test</span><span class=p>.</span><span class=nf>min</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>0.01</span>

<span class=n>models</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>[</span>
<span class=w>    </span><span class=p>(</span><span class=s1>&#39;GaussianNB&#39;</span><span class=p>,</span><span class=w> </span><span class=n>GaussianNB</span><span class=p>(),</span><span class=w> </span><span class=n>X_train</span><span class=p>,</span><span class=w> </span><span class=n>X_test</span><span class=p>),</span>
<span class=w>    </span><span class=p>(</span><span class=s1>&#39;MultinomialNB&#39;</span><span class=p>,</span><span class=w> </span><span class=n>MultinomialNB</span><span class=p>(),</span><span class=w> </span><span class=n>X_train_pos</span><span class=p>,</span><span class=w> </span><span class=n>X_test_pos</span><span class=p>),</span>
<span class=w>    </span><span class=p>(</span><span class=s1>&#39;BernoulliNB&#39;</span><span class=p>,</span><span class=w> </span><span class=n>BernoulliNB</span><span class=p>(),</span><span class=w> </span><span class=n>X_train_pos</span><span class=p>,</span><span class=w> </span><span class=n>X_test_pos</span><span class=p>)</span>
<span class=err>]</span>

<span class=n>print</span><span class=p>(</span><span class=n>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>{&#39;Variant&#39;:&lt;20} {&#39;Train Acc&#39;:&lt;12} {&#39;Test Acc&#39;:&lt;12}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>-</span><span class=se>\&quot;</span><span class=s2> * 55)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        for name, model, X_tr, X_te in models:</span><span class=se>\n</span><span class=s2>            model.fit(X_tr, y_train)</span><span class=se>\n</span><span class=s2>            </span><span class=se>\n</span><span class=s2>            train_acc = model.score(X_tr, y_train)</span><span class=se>\n</span><span class=s2>            test_acc = model.score(X_te, y_test)</span><span class=se>\n</span><span class=s2>            </span><span class=se>\n</span><span class=s2>            print(f</span><span class=se>\&quot;</span><span class=s2>{name:&lt;20} {train_acc:&lt;12.4f} {test_acc:&lt;12.4f}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n‚úÖ GaussianNB best for continuous features</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>‚úÖ MultinomialNB best for counts (text)</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n\n</span><span class=s2>    def demo_naive_assumption():</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        Naive Independence Assumption</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        Features assumed independent (rarely true, but works!)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n</span><span class=se>\&quot;</span><span class=s2> + </span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>5. Naive Independence Assumption</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>nNaive Bayes Formula:</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>  P(y|X) = P(y) ¬∑ P(x‚ÇÅ|y) ¬∑ P(x‚ÇÇ|y) ¬∑ ... ¬∑ P(x‚Çô|y) / P(X)</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>nAssumption:</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>  - Features x‚ÇÅ, x‚ÇÇ, ..., x‚Çô are INDEPENDENT given class y</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>  - P(x‚ÇÅ, x‚ÇÇ|y) = P(x‚ÇÅ|y) ¬∑ P(x‚ÇÇ|y)</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>nReality:</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>  - Features are often correlated (e.g., &#39;free&#39; and &#39;money&#39; in spam)</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>  - But Naive Bayes still works well in practice!</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n‚úÖ &#39;Naive&#39; assumption simplifies computation</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>‚úÖ Works surprisingly well despite violation</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n\n</span><span class=s2>    if __name__ == </span><span class=se>\&quot;</span><span class=s2>__main__</span><span class=se>\&quot;</span><span class=s2>:</span><span class=se>\n</span><span class=s2>        demo_gaussian_nb()</span><span class=se>\n</span><span class=s2>        demo_multinomial_nb()</span><span class=se>\n</span><span class=s2>        demo_bernoulli_nb()</span><span class=se>\n</span><span class=s2>        demo_variant_comparison()</span><span class=se>\n</span><span class=s2>        demo_naive_assumption()</span><span class=se>\n</span><span class=s2>    ```</span><span class=se>\n\n</span><span class=s2>    ## Naive Bayes Variants Comparison</span><span class=se>\n\n</span><span class=s2>    | Variant | Feature Type | Distribution | Use Case |</span><span class=se>\n</span><span class=s2>    |---------|--------------|--------------|----------|</span><span class=se>\n</span><span class=s2>    | **GaussianNB** | Continuous | $P(x</span><span class=se>\\</span><span class=s2>|y) </span><span class=se>\\</span><span class=s2>sim N(</span><span class=se>\\</span><span class=s2>mu, </span><span class=se>\\</span><span class=s2>sigma^2)$ | Medical, sensor data |</span><span class=se>\n</span><span class=s2>    | **MultinomialNB** | Discrete counts | $P(x</span><span class=se>\\</span><span class=s2>|y) </span><span class=se>\\</span><span class=s2>sim Multinomial$ | Text (word counts, TF-IDF) |</span><span class=se>\n</span><span class=s2>    | **BernoulliNB** | Binary (0/1) | $P(x</span><span class=se>\\</span><span class=s2>|y) </span><span class=se>\\</span><span class=s2>sim Bernoulli$ | Document classification (presence) |</span><span class=se>\n\n</span><span class=s2>    ## Key Parameters</span><span class=se>\n\n</span><span class=s2>    | Parameter | Variants | Default | Purpose |</span><span class=se>\n</span><span class=s2>    |-----------|----------|---------|---------|</span><span class=err>\</span><span class=s2> </span><span class=se>\n</span><span class=s2>    | **alpha** | Multinomial, Bernoulli | 1.0 | Laplace smoothing (avoid zero probabilities) |</span><span class=se>\n</span><span class=s2>    | **var_smoothing** | Gaussian | 1e-9 | Variance smoothing (stability) |</span><span class=se>\n</span><span class=s2>    | **fit_prior** | All | True | Learn class prior from data |</span><span class=se>\n\n</span><span class=s2>    ## Naive Bayes Advantages</span><span class=se>\n\n</span><span class=s2>    | Advantage ‚úÖ | Explanation |</span><span class=se>\n</span><span class=s2>    |--------------|-------------|</span><span class=se>\n</span><span class=s2>    | **Fast** | O(nd) training and prediction |</span><span class=se>\n</span><span class=s2>    | **Scalable** | Works with large datasets |</span><span class=se>\n</span><span class=s2>    | **No tuning** | Few hyperparameters |</span><span class=se>\n</span><span class=s2>    | **Probabilistic** | Returns class probabilities |</span><span class=se>\n</span><span class=s2>    | **Works with small data** | Needs less training data |</span><span class=se>\n</span><span class=s2>    | **Handles high-dim** | Text with 10,000+ features |</span><span class=se>\n\n</span><span class=s2>    ## Real-World Applications</span><span class=se>\n\n</span><span class=s2>    | Company | Use Case | Variant | Result |</span><span class=se>\n</span><span class=s2>    |---------|----------|---------|--------|</span><span class=se>\n</span><span class=s2>    | **Gmail** | Spam detection | MultinomialNB | 95% accuracy, real-time |</span><span class=se>\n</span><span class=s2>    | **Twitter** | Sentiment analysis | MultinomialNB | Fast, scalable |</span><span class=se>\n</span><span class=s2>    | **Healthcare** | Disease diagnosis | GaussianNB | Continuous test results |</span><span class=se>\n\n</span><span class=s2>    !!! tip </span><span class=se>\&quot;</span><span class=s2>Interviewer&#39;s Insight</span><span class=se>\&quot;\n</span><span class=s2>        - Knows **three variants** (Gaussian, Multinomial, Bernoulli)</span><span class=se>\n</span><span class=s2>        - Uses **MultinomialNB for text** (word counts, TF-IDF)</span><span class=se>\n</span><span class=s2>        - Uses **GaussianNB for continuous** (assumes normal distribution)</span><span class=se>\n</span><span class=s2>        - Uses **BernoulliNB for binary** (presence/absence)</span><span class=se>\n</span><span class=s2>        - Understands **naive independence assumption** (features independent given class)</span><span class=se>\n</span><span class=s2>        - Knows **alpha=1.0** (Laplace smoothing, avoid zero probabilities)</span><span class=se>\n</span><span class=s2>        - Understands **fast and scalable** (O(nd) complexity)</span><span class=se>\n</span><span class=s2>        - Real-world: **Gmail spam detection uses MultinomialNB (95% accuracy, word counts, fast, real-time)**</span><span class=se>\n\n</span><span class=s2>---</span><span class=se>\n\n</span><span class=s2>### How to implement K-Means? - Most Tech Companies Interview Question</span><span class=se>\n\n</span><span class=s2>**Difficulty:** üü° Medium | **Tags:** `K-Means`, `Clustering`, `Unsupervised` | **Asked by:** Most Tech Companies</span><span class=se>\n\n</span><span class=s2>??? success </span><span class=se>\&quot;</span><span class=s2>View Answer</span><span class=se>\&quot;\n\n</span><span class=s2>    **K-Means** clusters data into **k groups** by **minimizing within-cluster variance**. Iteratively assigns points to **nearest centroid** and updates centroids.</span><span class=se>\n\n</span><span class=s2>    **Algorithm:** 1) Initialize k centroids randomly, 2) Assign points to nearest centroid, 3) Update centroids (mean of points), 4) Repeat until convergence</span><span class=se>\n\n</span><span class=s2>    **Objective:** Minimize $</span><span class=se>\\</span><span class=s2>sum_{i=1}^{k} </span><span class=se>\\</span><span class=s2>sum_{x </span><span class=se>\\</span><span class=s2>in C_i} ||x - </span><span class=se>\\</span><span class=s2>mu_i||^2$ (within-cluster sum of squares)</span><span class=se>\n\n</span><span class=s2>    **Real-World Context:**</span><span class=se>\n</span><span class=s2>    - **Customer Segmentation:** E-commerce (3-5 clusters, targeted marketing)</span><span class=se>\n</span><span class=s2>    - **Image Compression:** Color quantization (reduce colors from 16M to 16)</span><span class=se>\n</span><span class=s2>    - **Anomaly Detection:** Outliers far from all centroids</span><span class=se>\n\n</span><span class=s2>    ## K-Means Algorithm Flow</span><span class=se>\n\n</span><span class=s2>    ```</span><span class=se>\n</span><span class=s2>    Step 1: Initialize k centroids randomly</span><span class=se>\n</span><span class=s2>    ========================================</span><span class=se>\n</span><span class=s2>         ‚ú±         ‚ú±         ‚ú±</span><span class=se>\n</span><span class=s2>       (C1)      (C2)      (C3)</span><span class=se>\n</span><span class=s2>    </span><span class=se>\n</span><span class=s2>    </span><span class=se>\n</span><span class=s2>    Step 2: Assign points to nearest centroid</span><span class=se>\n</span><span class=s2>    ==========================================</span><span class=se>\n</span><span class=s2>         ‚ú±         ‚ú±         ‚ú±</span><span class=se>\n</span><span class=s2>        ‚óè‚óè‚óè       ‚óè‚óè‚óè       ‚óè‚óè‚óè</span><span class=se>\n</span><span class=s2>       ‚óè  ‚óè      ‚óè  ‚óè      ‚óè  ‚óè</span><span class=se>\n</span><span class=s2>        ‚óè‚óè‚óè       ‚óè‚óè‚óè       ‚óè‚óè‚óè</span><span class=se>\n</span><span class=s2>    </span><span class=se>\n</span><span class=s2>    </span><span class=se>\n</span><span class=s2>    Step 3: Update centroids (mean of cluster)</span><span class=se>\n</span><span class=s2>    ==========================================</span><span class=se>\n</span><span class=s2>         ‚ú±&#39;        ‚ú±&#39;        ‚ú±&#39;</span><span class=se>\n</span><span class=s2>        ‚óè‚óè‚óè       ‚óè‚óè‚óè       ‚óè‚óè‚óè</span><span class=se>\n</span><span class=s2>       ‚óè  ‚óè      ‚óè  ‚óè      ‚óè  ‚óè</span><span class=se>\n</span><span class=s2>        ‚óè‚óè‚óè       ‚óè‚óè‚óè       ‚óè‚óè‚óè</span><span class=se>\n</span><span class=s2>    </span><span class=se>\n</span><span class=s2>    </span><span class=se>\n</span><span class=s2>    Step 4: Repeat until convergence</span><span class=se>\n</span><span class=s2>    =================================</span><span class=se>\n</span><span class=s2>    Convergence criteria:</span><span class=se>\n</span><span class=s2>    - Centroids stop moving</span><span class=se>\n</span><span class=s2>    - Assignment unchanged</span><span class=se>\n</span><span class=s2>    - Max iterations reached</span><span class=se>\n</span><span class=s2>    </span><span class=se>\n</span><span class=s2>    </span><span class=se>\n</span><span class=s2>    Objective: Minimize Inertia</span><span class=se>\n</span><span class=s2>    ===========================</span><span class=se>\n</span><span class=s2>    Inertia = Œ£ ||x - centroid||¬≤</span><span class=se>\n</span><span class=s2>              (within-cluster variance)</span><span class=se>\n</span><span class=s2>    ```</span><span class=se>\n\n</span><span class=s2>    ## Production Implementation (155 lines)</span><span class=se>\n\n</span><span class=s2>    ```python</span><span class=se>\n</span><span class=s2>    # kmeans_complete.py</span><span class=se>\n</span><span class=s2>    import numpy as np</span><span class=se>\n</span><span class=s2>    import matplotlib.pyplot as plt</span><span class=se>\n</span><span class=s2>    from sklearn.cluster import KMeans</span><span class=se>\n</span><span class=s2>    from sklearn.datasets import make_blobs</span><span class=se>\n</span><span class=s2>    from sklearn.preprocessing import StandardScaler</span><span class=se>\n</span><span class=s2>    from sklearn.metrics import silhouette_score</span><span class=se>\n</span><span class=s2>    import time</span><span class=se>\n\n</span><span class=s2>    def demo_kmeans_basic():</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        K-Means: Basic Clustering</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        Partitions data into k clusters</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>1. K-Means - Basic Clustering</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        np.random.seed(42)</span><span class=se>\n</span><span class=s2>        # Generate 3 blobs</span><span class=se>\n</span><span class=s2>        X, y_true = make_blobs(n_samples=300, centers=3, random_state=42)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        # K-Means</span><span class=se>\n</span><span class=s2>        kmeans = KMeans(n_clusters=3, random_state=42)</span><span class=se>\n</span><span class=s2>        kmeans.fit(X)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        y_pred = kmeans.labels_</span><span class=se>\n</span><span class=s2>        centroids = kmeans.cluster_centers_</span><span class=se>\n</span><span class=s2>        inertia = kmeans.inertia_</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;\\</span><span class=s2>nK-Means (k=3):</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;</span><span class=s2>  Clusters: {np.unique(y_pred)}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;</span><span class=s2>  Inertia (WCSS): {inertia:.2f}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;</span><span class=s2>  Iterations: {kmeans.n_iter_}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;\\</span><span class=s2>nCentroid locations:</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        for i, centroid in enumerate(centroids):</span><span class=se>\n</span><span class=s2>            print(f</span><span class=se>\&quot;</span><span class=s2>  Cluster {i}: ({centroid[0]:.2f}, {centroid[1]:.2f})</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n‚úÖ K-Means minimizes within-cluster variance (inertia)</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n\n</span><span class=s2>    def demo_k_selection():</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        Choosing k: Elbow Method</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        Plot inertia vs k, look for elbow</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n</span><span class=se>\&quot;</span><span class=s2> + </span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>2. Choosing k - Elbow Method</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        np.random.seed(42)</span><span class=se>\n</span><span class=s2>        X, _ = make_blobs(n_samples=300, centers=4, random_state=42)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        k_values = range(1, 11)</span><span class=se>\n</span><span class=s2>        inertias = []</span><span class=se>\n</span><span class=s2>        silhouettes = []</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;\\</span><span class=s2>n{&#39;k&#39;:&lt;10} {&#39;Inertia&#39;:&lt;15} {&#39;Silhouette&#39;:&lt;15}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>-</span><span class=se>\&quot;</span><span class=s2> * 50)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        for k in k_values:</span><span class=se>\n</span><span class=s2>            kmeans = KMeans(n_clusters=k, random_state=42)</span><span class=se>\n</span><span class=s2>            kmeans.fit(X)</span><span class=se>\n</span><span class=s2>            inertias.append(kmeans.inertia_)</span><span class=se>\n</span><span class=s2>            </span><span class=se>\n</span><span class=s2>            # Silhouette score (skip k=1)</span><span class=se>\n</span><span class=s2>            if k &gt; 1:</span><span class=se>\n</span><span class=s2>                sil = silhouette_score(X, kmeans.labels_)</span><span class=se>\n</span><span class=s2>                silhouettes.append(sil)</span><span class=se>\n</span><span class=s2>                print(f</span><span class=se>\&quot;</span><span class=s2>{k:&lt;10} {kmeans.inertia_:&lt;15.2f} {sil:&lt;15.4f}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>            else:</span><span class=se>\n</span><span class=s2>                print(f</span><span class=se>\&quot;</span><span class=s2>{k:&lt;10} {kmeans.inertia_:&lt;15.2f} {&#39;N/A&#39;:&lt;15}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>nInterpretation:</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>  - Elbow: Point where inertia stops decreasing rapidly</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>  - Silhouette: Higher is better (max at true k)</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n‚úÖ Use Elbow Method + Silhouette to choose k</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n\n</span><span class=s2>    def demo_init_methods():</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        Initialization: k-means++ vs Random</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        k-means++ converges faster, better results</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n</span><span class=se>\&quot;</span><span class=s2> + </span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>3. Initialization - k-means++</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        np.random.seed(42)</span><span class=se>\n</span><span class=s2>        X, _ = make_blobs(n_samples=500, centers=5, random_state=42)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        init_methods = [&#39;k-means++&#39;, &#39;random&#39;]</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;\\</span><span class=s2>n{&#39;Init Method&#39;:&lt;20} {&#39;Inertia&#39;:&lt;15} {&#39;Iterations&#39;:&lt;15} {&#39;Time (s)&#39;:&lt;15}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>-</span><span class=se>\&quot;</span><span class=s2> * 70)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        for init in init_methods:</span><span class=se>\n</span><span class=s2>            start = time.time()</span><span class=se>\n</span><span class=s2>            kmeans = KMeans(n_clusters=5, init=init, n_init=10, random_state=42)</span><span class=se>\n</span><span class=s2>            kmeans.fit(X)</span><span class=se>\n</span><span class=s2>            elapsed = time.time() - start</span><span class=se>\n</span><span class=s2>            </span><span class=se>\n</span><span class=s2>            print(f</span><span class=se>\&quot;</span><span class=s2>{init:&lt;20} {kmeans.inertia_:&lt;15.2f} {kmeans.n_iter_:&lt;15} {elapsed:&lt;15.4f}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n‚úÖ k-means++ (default): Better initialization, faster convergence</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n\n</span><span class=s2>    def demo_scaling_importance():</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        Feature Scaling: Important for K-Means</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        Distance-based, scale matters</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n</span><span class=se>\&quot;</span><span class=s2> + </span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>4. Feature Scaling (Important!)</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        np.random.seed(42)</span><span class=se>\n</span><span class=s2>        X, _ = make_blobs(n_samples=300, centers=3, random_state=42)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        # Add feature with large scale</span><span class=se>\n</span><span class=s2>        X[:, 0] = X[:, 0] * 1000</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        # Without scaling</span><span class=se>\n</span><span class=s2>        kmeans_no_scale = KMeans(n_clusters=3, random_state=42)</span><span class=se>\n</span><span class=s2>        kmeans_no_scale.fit(X)</span><span class=se>\n</span><span class=s2>        sil_no_scale = silhouette_score(X, kmeans_no_scale.labels_)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        # With scaling</span><span class=se>\n</span><span class=s2>        scaler = StandardScaler()</span><span class=se>\n</span><span class=s2>        X_scaled = scaler.fit_transform(X)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        kmeans_scaled = KMeans(n_clusters=3, random_state=42)</span><span class=se>\n</span><span class=s2>        kmeans_scaled.fit(X_scaled)</span><span class=se>\n</span><span class=s2>        sil_scaled = silhouette_score(X_scaled, kmeans_scaled.labels_)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;\\</span><span class=s2>n{&#39;Approach&#39;:&lt;20} {&#39;Silhouette&#39;:&lt;15}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>-</span><span class=se>\&quot;</span><span class=s2> * 40)</span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;</span><span class=s2>{&#39;Without Scaling&#39;:&lt;20} {sil_no_scale:&lt;15.4f}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;</span><span class=s2>{&#39;With Scaling&#39;:&lt;20} {sil_scaled:&lt;15.4f}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n‚úÖ Scale features for better clustering</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n\n</span><span class=s2>    def demo_image_compression():</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        K-Means Application: Image Compression</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        Reduce colors using clustering</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n</span><span class=se>\&quot;</span><span class=s2> + </span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>5. Application: Image Compression (Color Quantization)</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        # Simulate image (100x100, RGB)</span><span class=se>\n</span><span class=s2>        np.random.seed(42)</span><span class=se>\n</span><span class=s2>        image = np.random.randint(0, 256, (100, 100, 3))</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        # Flatten to (n_pixels, 3)</span><span class=se>\n</span><span class=s2>        pixels = image.reshape(-1, 3)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        # Cluster colors</span><span class=se>\n</span><span class=s2>        n_colors = 16</span><span class=se>\n</span><span class=s2>        kmeans = KMeans(n_clusters=n_colors, random_state=42)</span><span class=se>\n</span><span class=s2>        kmeans.fit(pixels)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        # Replace with cluster centers</span><span class=se>\n</span><span class=s2>        compressed = kmeans.cluster_centers_[kmeans.labels_]</span><span class=se>\n</span><span class=s2>        compressed_image = compressed.reshape(image.shape)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        original_size = image.nbytes / 1024  # KB</span><span class=se>\n</span><span class=s2>        compressed_size = (n_colors * 3 + len(kmeans.labels_)) * 4 / 1024  # KB</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;\\</span><span class=s2>nImage Compression:</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;</span><span class=s2>  Original colors: {len(np.unique(pixels, axis=0))}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;</span><span class=s2>  Compressed colors: {n_colors}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;</span><span class=s2>  Original size: {original_size:.2f} KB</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;</span><span class=s2>  Compressed size: {compressed_size:.2f} KB</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;</span><span class=s2>  Compression ratio: {original_size / compressed_size:.2f}x</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n‚úÖ K-Means for color quantization (image compression)</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n\n</span><span class=s2>    if __name__ == </span><span class=se>\&quot;</span><span class=s2>__main__</span><span class=se>\&quot;</span><span class=s2>:</span><span class=se>\n</span><span class=s2>        demo_kmeans_basic()</span><span class=se>\n</span><span class=s2>        demo_k_selection()</span><span class=se>\n</span><span class=s2>        demo_init_methods()</span><span class=se>\n</span><span class=s2>        demo_scaling_importance()</span><span class=se>\n</span><span class=s2>        demo_image_compression()</span><span class=se>\n</span><span class=s2>    ```</span><span class=se>\n\n</span><span class=s2>    ## K-Means Key Parameters</span><span class=se>\n\n</span><span class=s2>    | Parameter | Default | Typical Range | Purpose |</span><span class=se>\n</span><span class=s2>    |-----------|---------|---------------|---------|</span><span class=err>\</span><span class=s2> </span><span class=se>\n</span><span class=s2>    | **n_clusters** | 8 | 2-10 | Number of clusters (k) |</span><span class=se>\n</span><span class=s2>    | **init** | &#39;k-means++&#39; | &#39;k-means++&#39;, &#39;random&#39; | Initialization method |</span><span class=se>\n</span><span class=s2>    | **n_init** | 10 | 10-50 | Number of random starts |</span><span class=se>\n</span><span class=s2>    | **max_iter** | 300 | 100-1000 | Max iterations per run |</span><span class=se>\n\n</span><span class=s2>    ## K-Means Advantages &amp; Disadvantages</span><span class=se>\n\n</span><span class=s2>    | Pros ‚úÖ | Cons ‚ùå |</span><span class=se>\n</span><span class=s2>    |---------|--------|</span><span class=se>\n</span><span class=s2>    | Simple, fast (O(nkd)) | Need to specify k |</span><span class=se>\n</span><span class=s2>    | Scalable to large data | Assumes spherical clusters |</span><span class=se>\n</span><span class=s2>    | Works well for convex shapes | Sensitive to initialization |</span><span class=se>\n</span><span class=s2>    | Easy to interpret | Sensitive to outliers |</span><span class=se>\n</span><span class=s2>    | Guaranteed convergence | Doesn&#39;t work with non-convex |</span><span class=se>\n\n</span><span class=s2>    ## Choosing k (Elbow Method)</span><span class=se>\n\n</span><span class=s2>    | k | Inertia | Silhouette | Interpretation |</span><span class=se>\n</span><span class=s2>    |---|---------|------------|----------------|</span><span class=se>\n</span><span class=s2>    | 1 | High | N/A | All points in one cluster |</span><span class=se>\n</span><span class=s2>    | **3** | **Elbow** | **High** | **Optimal (true k)** |</span><span class=se>\n</span><span class=s2>    | 5 | Lower | Medium | Over-segmentation |</span><span class=se>\n</span><span class=s2>    | 10 | Very low | Low | Too many clusters |</span><span class=se>\n\n</span><span class=s2>    ## Real-World Applications</span><span class=se>\n\n</span><span class=s2>    | Company | Use Case | k | Result |</span><span class=se>\n</span><span class=s2>    |---------|----------|---|--------|</span><span class=se>\n</span><span class=s2>    | **E-commerce** | Customer segmentation | 3-5 | Targeted marketing |</span><span class=se>\n</span><span class=s2>    | **Netflix** | Content clustering | 10-20 | Recommendation |</span><span class=se>\n</span><span class=s2>    | **Image** | Color quantization | 16-256 | Compression |</span><span class=se>\n\n</span><span class=s2>    !!! tip </span><span class=se>\&quot;</span><span class=s2>Interviewer&#39;s Insight</span><span class=se>\&quot;\n</span><span class=s2>        - Knows **k-means++ initialization** (default, better than random)</span><span class=se>\n</span><span class=s2>        - Uses **Elbow Method** to choose k (plot inertia vs k)</span><span class=se>\n</span><span class=s2>        - Understands **inertia** (within-cluster sum of squares, minimize)</span><span class=se>\n</span><span class=s2>        - Uses **Silhouette score** (measure cluster quality, higher = better)</span><span class=se>\n</span><span class=s2>        - Scales features (distance-based, StandardScaler)</span><span class=se>\n</span><span class=s2>        - Knows **n_init=10** (multiple random starts, best result)</span><span class=se>\n</span><span class=s2>        - Understands **limitations** (spherical clusters, need to specify k)</span><span class=se>\n</span><span class=s2>        - Real-world: **E-commerce customer segmentation (k=3-5 clusters, RFM features, targeted marketing campaigns)**</span><span class=se>\n\n</span><span class=s2>---</span><span class=se>\n\n</span><span class=s2>### What is the Elbow Method? - Common Interview Question</span><span class=se>\n\n</span><span class=s2>**Difficulty:** üü¢ Easy | **Tags:** `K-Means`, `Clustering`, `Hyperparameter Tuning` | **Asked by:** Most Companies</span><span class=se>\n\n</span><span class=s2>??? success </span><span class=se>\&quot;</span><span class=s2>View Answer</span><span class=se>\&quot;\n\n</span><span class=s2>    **Elbow Method** determines **optimal k** by plotting **inertia (WCSS)** vs **k** and finding the **elbow point** (where decrease rate slows). Point of diminishing returns.</span><span class=se>\n\n</span><span class=s2>    **Inertia (WCSS):** $</span><span class=se>\\</span><span class=s2>sum_{i=1}^{k} </span><span class=se>\\</span><span class=s2>sum_{x </span><span class=se>\\</span><span class=s2>in C_i} ||x - </span><span class=se>\\</span><span class=s2>mu_i||^2$ (within-cluster sum of squares)</span><span class=se>\n\n</span><span class=s2>    **Real-World Context:**</span><span class=se>\n</span><span class=s2>    - **Customer Segmentation:** k=3-5 clusters (meaningful segments)</span><span class=se>\n</span><span class=s2>    - **Document Clustering:** k=5-10 topics (interpretable)</span><span class=se>\n</span><span class=s2>    - **Image Segmentation:** Visual inspection of elbow</span><span class=se>\n\n</span><span class=s2>    ## Elbow Method Visualization</span><span class=se>\n\n</span><span class=s2>    ```</span><span class=se>\n</span><span class=s2>    Inertia vs k Plot:</span><span class=se>\n</span><span class=s2>    ==================</span><span class=se>\n</span><span class=s2>    </span><span class=se>\n</span><span class=s2>    Inertia</span><span class=se>\n</span><span class=s2>      ‚Üë</span><span class=se>\n</span><span class=s2>    1000‚îÇ‚óè</span><span class=se>\n</span><span class=s2>        ‚îÇ  ‚óè</span><span class=se>\n</span><span class=s2>     800‚îÇ    ‚óè</span><span class=se>\n</span><span class=s2>        ‚îÇ      ‚óè  ‚Üê ELBOW (k=3)</span><span class=se>\n</span><span class=s2>     600‚îÇ        ‚óè___</span><span class=se>\n</span><span class=s2>        ‚îÇ            ‚óè___</span><span class=se>\n</span><span class=s2>     400‚îÇ                ‚óè___</span><span class=se>\n</span><span class=s2>        ‚îÇ                    ‚óè___‚óè___‚óè</span><span class=se>\n</span><span class=s2>     200‚îÇ</span><span class=se>\n</span><span class=s2>        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí k</span><span class=se>\n</span><span class=s2>         1   2   3   4   5   6   7   8</span><span class=se>\n</span><span class=s2>    </span><span class=se>\n</span><span class=s2>    Interpretation:</span><span class=se>\n</span><span class=s2>    - k=1: High inertia (all points in one cluster)</span><span class=se>\n</span><span class=s2>    - k=3: ELBOW (rapid decrease stops)</span><span class=se>\n</span><span class=s2>    - k&gt;3: Marginal improvement (diminishing returns)</span><span class=se>\n</span><span class=s2>    </span><span class=se>\n</span><span class=s2>    </span><span class=se>\n</span><span class=s2>    Complementary: Silhouette Score</span><span class=se>\n</span><span class=s2>    ================================</span><span class=se>\n</span><span class=s2>    </span><span class=se>\n</span><span class=s2>    Silhouette</span><span class=se>\n</span><span class=s2>      ‚Üë</span><span class=se>\n</span><span class=s2>    0.6‚îÇ</span><span class=se>\n</span><span class=s2>       ‚îÇ        ‚óè  ‚Üê Peak (k=3)</span><span class=se>\n</span><span class=s2>    0.5‚îÇ      ‚óè   ‚óè</span><span class=se>\n</span><span class=s2>       ‚îÇ    ‚óè       ‚óè</span><span class=se>\n</span><span class=s2>    0.4‚îÇ  ‚óè           ‚óè</span><span class=se>\n</span><span class=s2>       ‚îÇ‚óè               ‚óè</span><span class=se>\n</span><span class=s2>    0.3‚îÇ</span><span class=se>\n</span><span class=s2>       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí k</span><span class=se>\n</span><span class=s2>        2   3   4   5   6   7</span><span class=se>\n</span><span class=s2>    </span><span class=se>\n</span><span class=s2>    Higher silhouette = better separation</span><span class=se>\n</span><span class=s2>    ```</span><span class=se>\n\n</span><span class=s2>    ## Production Implementation (120 lines)</span><span class=se>\n\n</span><span class=s2>    ```python</span><span class=se>\n</span><span class=s2>    # elbow_method.py</span><span class=se>\n</span><span class=s2>    import numpy as np</span><span class=se>\n</span><span class=s2>    import matplotlib.pyplot as plt</span><span class=se>\n</span><span class=s2>    from sklearn.cluster import KMeans</span><span class=se>\n</span><span class=s2>    from sklearn.datasets import make_blobs</span><span class=se>\n</span><span class=s2>    from sklearn.metrics import silhouette_score, davies_bouldin_score</span><span class=se>\n\n</span><span class=s2>    def demo_elbow_method():</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        Elbow Method: Find Optimal k</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        Plot inertia vs k, look for elbow</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>1. Elbow Method - Optimal k Selection</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        np.random.seed(42)</span><span class=se>\n</span><span class=s2>        # Generate data with true k=4</span><span class=se>\n</span><span class=s2>        X, _ = make_blobs(n_samples=500, centers=4, cluster_std=1.5, random_state=42)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        k_range = range(1, 11)</span><span class=se>\n</span><span class=s2>        inertias = []</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;\\</span><span class=s2>n{&#39;k&#39;:&lt;10} {&#39;Inertia (WCSS)&#39;:&lt;20} {&#39;Decrease&#39;:&lt;15}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>-</span><span class=se>\&quot;</span><span class=s2> * 55)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        prev_inertia = None</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        for k in k_range:</span><span class=se>\n</span><span class=s2>            kmeans = KMeans(n_clusters=k, random_state=42, n_init=10)</span><span class=se>\n</span><span class=s2>            kmeans.fit(X)</span><span class=se>\n</span><span class=s2>            inertia = kmeans.inertia_</span><span class=se>\n</span><span class=s2>            inertias.append(inertia)</span><span class=se>\n</span><span class=s2>            </span><span class=se>\n</span><span class=s2>            decrease = </span><span class=se>\&quot;\&quot;</span><span class=s2> if prev_inertia is None else f</span><span class=se>\&quot;</span><span class=s2>-{prev_inertia - inertia:.2f}</span><span class=se>\&quot;\n</span><span class=s2>            prev_inertia = inertia</span><span class=se>\n</span><span class=s2>            </span><span class=se>\n</span><span class=s2>            print(f</span><span class=se>\&quot;</span><span class=s2>{k:&lt;10} {inertia:&lt;20.2f} {decrease:&lt;15}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        # Find elbow (largest decrease)</span><span class=se>\n</span><span class=s2>        decreases = [inertias[i] - inertias[i+1] for i in range(len(inertias)-1)]</span><span class=se>\n</span><span class=s2>        elbow_idx = np.argmax(decreases[:5]) + 1  # Look in first 5</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;\\</span><span class=s2>nElbow detected at k={elbow_idx+1}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n‚úÖ Elbow: Point where inertia decrease slows</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n\n</span><span class=s2>    def demo_silhouette_method():</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        Silhouette Score: Cluster Quality</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        Measures how similar object is to its cluster vs other clusters</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n</span><span class=se>\&quot;</span><span class=s2> + </span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>2. Silhouette Score - Cluster Quality</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        np.random.seed(42)</span><span class=se>\n</span><span class=s2>        X, _ = make_blobs(n_samples=500, centers=4, cluster_std=1.5, random_state=42)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        k_range = range(2, 11)  # Silhouette needs k&gt;=2</span><span class=se>\n</span><span class=s2>        silhouettes = []</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;\\</span><span class=s2>n{&#39;k&#39;:&lt;10} {&#39;Silhouette&#39;:&lt;15} {&#39;Interpretation&#39;:&lt;20}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>-</span><span class=se>\&quot;</span><span class=s2> * 55)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        for k in k_range:</span><span class=se>\n</span><span class=s2>            kmeans = KMeans(n_clusters=k, random_state=42, n_init=10)</span><span class=se>\n</span><span class=s2>            labels = kmeans.fit_predict(X)</span><span class=se>\n</span><span class=s2>            </span><span class=se>\n</span><span class=s2>            sil = silhouette_score(X, labels)</span><span class=se>\n</span><span class=s2>            silhouettes.append(sil)</span><span class=se>\n</span><span class=s2>            </span><span class=se>\n</span><span class=s2>            interp = </span><span class=se>\&quot;</span><span class=s2>Excellent</span><span class=se>\&quot;</span><span class=s2> if sil &gt; 0.5 else </span><span class=se>\&quot;</span><span class=s2>Good</span><span class=se>\&quot;</span><span class=s2> if sil &gt; 0.4 else </span><span class=se>\&quot;</span><span class=s2>Fair</span><span class=se>\&quot;\n</span><span class=s2>            </span><span class=se>\n</span><span class=s2>            print(f</span><span class=se>\&quot;</span><span class=s2>{k:&lt;10} {sil:&lt;15.4f} {interp:&lt;20}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        best_k = k_range[np.argmax(silhouettes)]</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;\\</span><span class=s2>nBest k by Silhouette: {best_k}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>nSilhouette range:</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>  -1 to 1 (higher = better)</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>  &gt;0.5: Strong structure</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>  &gt;0.3: Reasonable structure</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>  &lt;0.2: Weak structure</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n‚úÖ Silhouette: Higher = better separation</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n\n</span><span class=s2>    def demo_davies_bouldin_index():</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        Davies-Bouldin Index: Another Quality Metric</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        Lower is better (opposite of Silhouette)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n</span><span class=se>\&quot;</span><span class=s2> + </span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>3. Davies-Bouldin Index</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        np.random.seed(42)</span><span class=se>\n</span><span class=s2>        X, _ = make_blobs(n_samples=500, centers=4, cluster_std=1.5, random_state=42)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        k_range = range(2, 11)</span><span class=se>\n</span><span class=s2>        db_scores = []</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;\\</span><span class=s2>n{&#39;k&#39;:&lt;10} {&#39;Davies-Bouldin&#39;:&lt;20}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>-</span><span class=se>\&quot;</span><span class=s2> * 35)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        for k in k_range:</span><span class=se>\n</span><span class=s2>            kmeans = KMeans(n_clusters=k, random_state=42, n_init=10)</span><span class=se>\n</span><span class=s2>            labels = kmeans.fit_predict(X)</span><span class=se>\n</span><span class=s2>            </span><span class=se>\n</span><span class=s2>            db = davies_bouldin_score(X, labels)</span><span class=se>\n</span><span class=s2>            db_scores.append(db)</span><span class=se>\n</span><span class=s2>            </span><span class=se>\n</span><span class=s2>            print(f</span><span class=se>\&quot;</span><span class=s2>{k:&lt;10} {db:&lt;20.4f}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        best_k = k_range[np.argmin(db_scores)]</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;\\</span><span class=s2>nBest k by Davies-Bouldin: {best_k}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n‚úÖ Davies-Bouldin: Lower = better (opposite of Silhouette)</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n\n</span><span class=s2>    def demo_combined_approach():</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        Combined Approach: Elbow + Silhouette</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        Use both methods for confidence</span><span class=se>\n</span><span class=s2>        </span><span class=se>\&quot;\&quot;\&quot;\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n</span><span class=se>\&quot;</span><span class=s2> + </span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>4. Combined Approach - Elbow + Silhouette</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>=</span><span class=se>\&quot;</span><span class=s2>*70)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        np.random.seed(42)</span><span class=se>\n</span><span class=s2>        X, _ = make_blobs(n_samples=500, centers=4, cluster_std=1.5, random_state=42)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        k_range = range(2, 11)</span><span class=se>\n</span><span class=s2>        inertias = []</span><span class=se>\n</span><span class=s2>        silhouettes = []</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(f</span><span class=se>\&quot;\\</span><span class=s2>n{&#39;k&#39;:&lt;10} {&#39;Inertia&#39;:&lt;15} {&#39;Silhouette&#39;:&lt;15} {&#39;Recommendation&#39;:&lt;20}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>-</span><span class=se>\&quot;</span><span class=s2> * 70)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        for k in k_range:</span><span class=se>\n</span><span class=s2>            kmeans = KMeans(n_clusters=k, random_state=42, n_init=10)</span><span class=se>\n</span><span class=s2>            kmeans.fit(X)</span><span class=se>\n</span><span class=s2>            labels = kmeans.labels_</span><span class=se>\n</span><span class=s2>            </span><span class=se>\n</span><span class=s2>            inertia = kmeans.inertia_</span><span class=se>\n</span><span class=s2>            sil = silhouette_score(X, labels)</span><span class=se>\n</span><span class=s2>            </span><span class=se>\n</span><span class=s2>            inertias.append(inertia)</span><span class=se>\n</span><span class=s2>            silhouettes.append(sil)</span><span class=se>\n</span><span class=s2>            </span><span class=se>\n</span><span class=s2>            # Recommend if both metrics good</span><span class=se>\n</span><span class=s2>            recommend = </span><span class=se>\&quot;</span><span class=s2>‚≠ê RECOMMENDED</span><span class=se>\&quot;</span><span class=s2> if (k == 4 and sil &gt; 0.4) else </span><span class=se>\&quot;\&quot;\n</span><span class=s2>            </span><span class=se>\n</span><span class=s2>            print(f</span><span class=se>\&quot;</span><span class=s2>{k:&lt;10} {inertia:&lt;15.2f} {sil:&lt;15.4f} {recommend:&lt;20}</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>nRecommendation:</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>  1. Plot Elbow (inertia vs k)</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>  2. Check Silhouette (higher = better)</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;</span><span class=s2>  3. Choose k where both agree</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n</span><span class=s2>        </span><span class=se>\n</span><span class=s2>        print(</span><span class=se>\&quot;\\</span><span class=s2>n‚úÖ Use both Elbow + Silhouette for confidence</span><span class=se>\&quot;</span><span class=s2>)</span><span class=se>\n\n</span><span class=s2>    if __name__ == </span><span class=se>\&quot;</span><span class=s2>__main__</span><span class=se>\&quot;</span><span class=s2>:</span><span class=se>\n</span><span class=s2>        demo_elbow_method()</span><span class=se>\n</span><span class=s2>        demo_silhouette_method()</span><span class=se>\n</span><span class=s2>        demo_davies_bouldin_index()</span><span class=se>\n</span><span class=s2>        demo_combined_approach()</span><span class=se>\n</span><span class=s2>    ```</span><span class=se>\n\n</span><span class=s2>    ## Elbow Method Steps</span><span class=se>\n\n</span><span class=s2>    | Step | Action | Output |</span><span class=se>\n</span><span class=s2>    |------|--------|--------|</span><span class=se>\n</span><span class=s2>    | 1 | Run K-Means for k=1 to k=10 | Inertia values |</span><span class=se>\n</span><span class=s2>    | 2 | Plot inertia vs k | Elbow curve |</span><span class=se>\n</span><span class=s2>    | 3 | Find elbow (sharp bend) | Optimal k |</span><span class=se>\n</span><span class=s2>    | 4 | Validate with Silhouette | Confirm choice |</span><span class=se>\n\n</span><span class=s2>    ## Cluster Quality Metrics</span><span class=se>\n\n</span><span class=s2>    | Metric | Range | Optimal | Meaning |</span><span class=se>\n</span><span class=s2>    |--------|-------|---------|---------|</span><span class=err>\</span><span class=s2> </span><span class=se>\n</span><span class=s2>    | **Inertia** | [0, ‚àû) | Lower (find elbow) | Within-cluster variance |</span><span class=se>\n</span><span class=s2>    | **Silhouette** | [-1, 1] | Higher (&gt;0.5 good) | Cluster separation |</span><span class=se>\n</span><span class=s2>    | **Davies-Bouldin** | [0, ‚àû) | Lower | Cluster compactness vs separation |</span><span class=se>\n\n</span><span class=s2>    ## Silhouette Score Interpretation</span><span class=se>\n\n</span><span class=s2>    | Score | Interpretation |</span><span class=se>\n</span><span class=s2>    |-------|----------------|</span><span class=se>\n</span><span class=s2>    | **0.7-1.0** | Strong structure (excellent) |</span><span class=se>\n</span><span class=s2>    | **0.5-0.7** | Reasonable structure (good) |</span><span class=se>\n</span><span class=s2>    | **0.25-0.5** | Weak structure (fair) |</span><span class=se>\n</span><span class=s2>    | **&lt;0.25** | No substantial structure |</span><span class=se>\n\n</span><span class=s2>    ## When Elbow Is Unclear</span><span class=se>\n\n</span><span class=s2>    | Scenario | Solution |</span><span class=se>\n</span><span class=s2>    |----------|----------|</span><span class=se>\n</span><span class=s2>    | **No clear elbow** | Use Silhouette score |</span><span class=se>\n</span><span class=s2>    | **Multiple elbows** | Try both, check domain meaning |</span><span class=se>\n</span><span class=s2>    | **Smooth curve** | Use Silhouette + domain knowledge |</span><span class=se>\n</span><span class=s2>    | **Conflicting metrics** | Prioritize interpretability |</span><span class=se>\n\n</span><span class=s2>    ## Real-World Applications</span><span class=se>\n\n</span><span class=s2>    | Domain | Typical k | Method | Result |</span><span class=se>\n</span><span class=s2>    |--------|-----------|--------|--------|</span><span class=se>\n</span><span class=s2>    | **Customer Segmentation** | 3-5 | Elbow + Silhouette | Meaningful segments |</span><span class=se>\n</span><span class=s2>    | **Document Clustering** | 5-10 | Silhouette | Interpretable topics |</span><span class=se>\n</span><span class=s2>    | **Image Segmentation** | 2-8 | Visual inspection | Clear boundaries |</span><span class=se>\n\n</span><span class=s2>    !!! tip </span><span class=se>\&quot;</span><span class=s2>Interviewer&#39;s Insight</span><span class=se>\&quot;\n</span><span class=s2>        - Knows **Elbow Method** (plot inertia vs k, find sharp bend)</span><span class=se>\n</span><span class=s2>        - Uses **Silhouette score** as complement (higher = better)</span><span class=se>\n</span><span class=s2>        - Understands **diminishing returns** (elbow = point where improvement slows)</span><span class=se>\n</span><span class=s2>        - Knows **no single correct k** (elbow gives guidance, not definitive answer)</span><span class=se>\n</span><span class=s2>        - Uses **multiple methods** (Elbow + Silhouette + domain knowledge)</span><span class=se>\n</span><span class=s2>        - Understands **Silhouette range** (-1 to 1, &gt;0.5 good)</span><span class=se>\n</span><span class=s2>        - Knows **Davies-Bouldin** (lower = better, alternative metric)</span><span class=se>\n</span><span class=s2>        - Real-world: **Customer segmentation uses Elbow Method (k=3-5 typical: high-value, medium, low-value customers)**</span><span class=se>\n\n</span><span class=s2>---</span><span class=se>\n\n</span><span class=s2>## Quick Reference: 100+ Interview Questions&quot;</span><span class=err>}]</span>
</code></pre></div> </details> <table> <thead> <tr> <th>Sno</th> <th>Question Title</th> <th>Practice Links</th> <th>Companies Asking</th> <th>Difficulty</th> <th>Topics</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>What is Scikit-Learn and why is it popular?</td> <td><a href=https://scikit-learn.org/stable/getting_started.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Easy</td> <td>Basics, Introduction</td> </tr> <tr> <td>2</td> <td>Explain the Scikit-Learn API design (fit, transform, predict)</td> <td><a href=https://scikit-learn.org/stable/developers/develop.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Microsoft</td> <td>Easy</td> <td>API Design, Estimators</td> </tr> <tr> <td>3</td> <td>What are estimators, transformers, and predictors?</td> <td><a href=https://scikit-learn.org/stable/developers/develop.html#estimators>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Easy</td> <td>Core Concepts</td> </tr> <tr> <td>4</td> <td>How to split data into train and test sets?</td> <td><a href=https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Data Splitting, train_test_split</td> </tr> <tr> <td>5</td> <td>What is cross-validation and why is it important?</td> <td><a href=https://scikit-learn.org/stable/modules/cross_validation.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix, Apple</td> <td>Medium</td> <td>Cross-Validation, Model Evaluation</td> </tr> <tr> <td>6</td> <td>Difference between KFold, StratifiedKFold, GroupKFold</td> <td><a href=https://scikit-learn.org/stable/modules/cross_validation.html#cross-validation-iterators>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Cross-Validation Strategies</td> </tr> <tr> <td>7</td> <td>How to implement GridSearchCV for hyperparameter tuning?</td> <td><a href=https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Hyperparameter Tuning</td> </tr> <tr> <td>8</td> <td>Difference between GridSearchCV and RandomizedSearchCV</td> <td><a href=https://scikit-learn.org/stable/modules/grid_search.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Hyperparameter Tuning</td> </tr> <tr> <td>9</td> <td>What is a Pipeline and why should we use it?</td> <td><a href=https://scikit-learn.org/stable/modules/compose.html#pipeline>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix, Apple</td> <td>Medium</td> <td>Pipeline, Preprocessing</td> </tr> <tr> <td>10</td> <td>How to create a custom transformer?</td> <td><a href=https://scikit-learn.org/stable/modules/preprocessing.html#custom-transformers>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Microsoft</td> <td>Medium</td> <td>Custom Transformers</td> </tr> <tr> <td>11</td> <td>Explain StandardScaler vs MinMaxScaler vs RobustScaler</td> <td><a href=https://scikit-learn.org/stable/modules/preprocessing.html#standardization-or-mean-removal-and-variance-scaling>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Easy</td> <td>Feature Scaling</td> </tr> <tr> <td>12</td> <td>What is feature scaling and when is it necessary?</td> <td><a href=https://scikit-learn.org/stable/modules/preprocessing.html>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Feature Scaling</td> </tr> <tr> <td>13</td> <td>How to handle missing values in Scikit-Learn?</td> <td><a href=https://scikit-learn.org/stable/modules/impute.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Missing Data, Imputation</td> </tr> <tr> <td>14</td> <td>Difference between SimpleImputer and IterativeImputer</td> <td><a href=https://scikit-learn.org/stable/modules/impute.html#iterative-imputer>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Imputation Strategies</td> </tr> <tr> <td>15</td> <td>How to encode categorical variables?</td> <td><a href=https://scikit-learn.org/stable/modules/preprocessing.html#encoding-categorical-features>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Encoding, Categorical Data</td> </tr> <tr> <td>16</td> <td>Difference between LabelEncoder and OneHotEncoder</td> <td><a href=https://scikit-learn.org/stable/modules/preprocessing.html#encoding-categorical-features>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Easy</td> <td>Categorical Encoding</td> </tr> <tr> <td>17</td> <td>What is OrdinalEncoder and when to use it?</td> <td><a href=https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OrdinalEncoder.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Easy</td> <td>Ordinal Encoding</td> </tr> <tr> <td>18</td> <td>How to implement feature selection?</td> <td><a href=https://scikit-learn.org/stable/modules/feature_selection.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Feature Selection</td> </tr> <tr> <td>19</td> <td>Explain SelectKBest and mutual_info_classif</td> <td><a href=https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectKBest.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Feature Selection</td> </tr> <tr> <td>20</td> <td>What is Recursive Feature Elimination (RFE)?</td> <td><a href=https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.RFE.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Microsoft</td> <td>Medium</td> <td>Feature Selection, RFE</td> </tr> <tr> <td>21</td> <td>How to implement Linear Regression?</td> <td><a href=https://scikit-learn.org/stable/modules/linear_model.html#ordinary-least-squares>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Linear Regression</td> </tr> <tr> <td>22</td> <td>What is Ridge Regression and when to use it?</td> <td><a href=https://scikit-learn.org/stable/modules/linear_model.html#ridge-regression>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Regularization, Ridge</td> </tr> <tr> <td>23</td> <td>What is Lasso Regression and when to use it?</td> <td><a href=https://scikit-learn.org/stable/modules/linear_model.html#lasso>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Regularization, Lasso</td> </tr> <tr> <td>24</td> <td>Difference between Ridge (L2) and Lasso (L1)</td> <td><a href=https://scikit-learn.org/stable/modules/linear_model.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix, Apple</td> <td>Medium</td> <td>Regularization</td> </tr> <tr> <td>25</td> <td>What is ElasticNet regression?</td> <td><a href=https://scikit-learn.org/stable/modules/linear_model.html#elastic-net>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>ElasticNet, Regularization</td> </tr> <tr> <td>26</td> <td>How to implement Logistic Regression?</td> <td><a href=https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Logistic Regression, Classification</td> </tr> <tr> <td>27</td> <td>Explain the solver options in Logistic Regression</td> <td><a href=https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Optimization Solvers</td> </tr> <tr> <td>28</td> <td>How to implement Decision Trees?</td> <td><a href=https://scikit-learn.org/stable/modules/tree.html>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Decision Trees</td> </tr> <tr> <td>29</td> <td>What are the hyperparameters for Decision Trees?</td> <td><a href=https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Hyperparameters, Trees</td> </tr> <tr> <td>30</td> <td>How to implement Random Forest?</td> <td><a href=https://scikit-learn.org/stable/modules/ensemble.html#random-forests>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Medium</td> <td>Random Forest, Ensemble</td> </tr> <tr> <td>31</td> <td>Difference between bagging and boosting</td> <td><a href=https://scikit-learn.org/stable/modules/ensemble.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix, Apple</td> <td>Medium</td> <td>Ensemble Methods</td> </tr> <tr> <td>32</td> <td>How to implement Gradient Boosting?</td> <td><a href=https://scikit-learn.org/stable/modules/ensemble.html#gradient-boosting>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Gradient Boosting</td> </tr> <tr> <td>33</td> <td>Difference between GradientBoosting and HistGradientBoosting</td> <td><a href=https://scikit-learn.org/stable/modules/ensemble.html#histogram-based-gradient-boosting>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Gradient Boosting Variants</td> </tr> <tr> <td>34</td> <td>How to implement Support Vector Machines (SVM)?</td> <td><a href=https://scikit-learn.org/stable/modules/svm.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Microsoft</td> <td>Medium</td> <td>SVM, Classification</td> </tr> <tr> <td>35</td> <td>Explain different kernel functions in SVM</td> <td><a href=https://scikit-learn.org/stable/modules/svm.html#kernel-functions>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>SVM Kernels</td> </tr> <tr> <td>36</td> <td>How to implement K-Nearest Neighbors (KNN)?</td> <td><a href=https://scikit-learn.org/stable/modules/neighbors.html>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>KNN, Classification</td> </tr> <tr> <td>37</td> <td>What is the curse of dimensionality?</td> <td><a href=https://scikit-learn.org/stable/modules/neighbors.html#curse-of-dimensionality>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Dimensionality, KNN</td> </tr> <tr> <td>38</td> <td>How to implement Naive Bayes classifiers?</td> <td><a href=https://scikit-learn.org/stable/modules/naive_bayes.html>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Naive Bayes</td> </tr> <tr> <td>39</td> <td>Difference between GaussianNB, MultinomialNB, BernoulliNB</td> <td><a href=https://scikit-learn.org/stable/modules/naive_bayes.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Naive Bayes Variants</td> </tr> <tr> <td>40</td> <td>How to implement K-Means clustering?</td> <td><a href=https://scikit-learn.org/stable/modules/clustering.html#k-means>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>K-Means, Clustering</td> </tr> <tr> <td>41</td> <td>How to determine optimal number of clusters?</td> <td><a href=https://scikit-learn.org/stable/auto_examples/cluster/plot_kmeans_silhouette_analysis.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Elbow Method, Silhouette</td> </tr> <tr> <td>42</td> <td>What is DBSCAN and when to use it?</td> <td><a href=https://scikit-learn.org/stable/modules/clustering.html#dbscan>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>DBSCAN, Clustering</td> </tr> <tr> <td>43</td> <td>Difference between K-Means and DBSCAN</td> <td><a href=https://scikit-learn.org/stable/modules/clustering.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Clustering Comparison</td> </tr> <tr> <td>44</td> <td>How to implement Hierarchical Clustering?</td> <td><a href=https://scikit-learn.org/stable/modules/clustering.html#hierarchical-clustering>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Hierarchical Clustering</td> </tr> <tr> <td>45</td> <td>How to implement PCA (Principal Component Analysis)?</td> <td><a href=https://scikit-learn.org/stable/modules/decomposition.html#pca>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix, Apple</td> <td>Medium</td> <td>PCA, Dimensionality Reduction</td> </tr> <tr> <td>46</td> <td>How to choose number of components in PCA?</td> <td><a href=https://scikit-learn.org/stable/modules/decomposition.html#pca>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>PCA, Variance Explained</td> </tr> <tr> <td>47</td> <td>What is t-SNE and when to use it?</td> <td><a href=https://scikit-learn.org/stable/modules/manifold.html#t-sne>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>t-SNE, Visualization</td> </tr> <tr> <td>48</td> <td>Difference between PCA and t-SNE</td> <td><a href=https://scikit-learn.org/stable/modules/manifold.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Dimensionality Reduction</td> </tr> <tr> <td>49</td> <td>What is accuracy and when is it misleading?</td> <td><a href=https://scikit-learn.org/stable/modules/model_evaluation.html#accuracy-score>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Metrics, Accuracy</td> </tr> <tr> <td>50</td> <td>Explain precision, recall, and F1-score</td> <td><a href=https://scikit-learn.org/stable/modules/model_evaluation.html#precision-recall-f-measure-metrics>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix, Apple</td> <td>Medium</td> <td>Classification Metrics</td> </tr> <tr> <td>51</td> <td>What is the ROC curve and AUC?</td> <td><a href=https://scikit-learn.org/stable/modules/model_evaluation.html#roc-metrics>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix, Apple</td> <td>Medium</td> <td>ROC, AUC</td> </tr> <tr> <td>52</td> <td>When to use precision vs recall?</td> <td><a href=https://scikit-learn.org/stable/auto_examples/model_selection/plot_precision_recall.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Metrics Tradeoff</td> </tr> <tr> <td>53</td> <td>What is the confusion matrix?</td> <td><a href=https://scikit-learn.org/stable/modules/model_evaluation.html#confusion-matrix>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Confusion Matrix</td> </tr> <tr> <td>54</td> <td>What is mean squared error (MSE) and RMSE?</td> <td><a href=https://scikit-learn.org/stable/modules/model_evaluation.html#mean-squared-error>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Regression Metrics</td> </tr> <tr> <td>55</td> <td>What is R¬≤ score (coefficient of determination)?</td> <td><a href=https://scikit-learn.org/stable/modules/model_evaluation.html#r2-score>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Regression Metrics</td> </tr> <tr> <td>56</td> <td>How to handle imbalanced datasets?</td> <td><a href=https://scikit-learn.org/stable/modules/generated/sklearn.utils.class_weight.compute_class_weight.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix, Apple</td> <td>Medium</td> <td>Imbalanced Data, class_weight</td> </tr> <tr> <td>57</td> <td>What is SMOTE and how does it work?</td> <td><a href=https://imbalanced-learn.org/stable/references/generated/imblearn.over_sampling.SMOTE.html>Imbalanced-Learn</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Oversampling, SMOTE</td> </tr> <tr> <td>58</td> <td>How to implement ColumnTransformer?</td> <td><a href=https://scikit-learn.org/stable/modules/compose.html#columntransformer-for-heterogeneous-data>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Column Transformers</td> </tr> <tr> <td>59</td> <td>What is FeatureUnion and when to use it?</td> <td><a href=https://scikit-learn.org/stable/modules/compose.html#featureunion-composite-feature-spaces>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Feature Engineering</td> </tr> <tr> <td>60</td> <td>How to implement polynomial features?</td> <td><a href=https://scikit-learn.org/stable/modules/preprocessing.html#generating-polynomial-features>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Easy</td> <td>Polynomial Features</td> </tr> <tr> <td>61</td> <td>What is learning curve and how to interpret it?</td> <td><a href=https://scikit-learn.org/stable/auto_examples/model_selection/plot_learning_curve.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Learning Curves, Diagnostics</td> </tr> <tr> <td>62</td> <td>What is validation curve?</td> <td><a href=https://scikit-learn.org/stable/auto_examples/model_selection/plot_validation_curve.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Validation Curves</td> </tr> <tr> <td>63</td> <td>How to save and load models with joblib?</td> <td><a href=https://scikit-learn.org/stable/model_persistence.html>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Model Persistence</td> </tr> <tr> <td>64</td> <td>What is calibration and why is it important?</td> <td><a href=https://scikit-learn.org/stable/modules/calibration.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Probability Calibration</td> </tr> <tr> <td>65</td> <td>How to use CalibratedClassifierCV?</td> <td><a href=https://scikit-learn.org/stable/modules/generated/sklearn.calibration.CalibratedClassifierCV.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Calibration</td> </tr> <tr> <td>66</td> <td>What is VotingClassifier?</td> <td><a href=https://scikit-learn.org/stable/modules/ensemble.html#voting-classifier>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Ensemble, Voting</td> </tr> <tr> <td>67</td> <td>What is StackingClassifier?</td> <td><a href=https://scikit-learn.org/stable/modules/ensemble.html#stacked-generalization>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Hard</td> <td>Ensemble, Stacking</td> </tr> <tr> <td>68</td> <td>How to implement AdaBoost?</td> <td><a href=https://scikit-learn.org/stable/modules/ensemble.html#adaboost>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>AdaBoost, Ensemble</td> </tr> <tr> <td>69</td> <td>What is BaggingClassifier?</td> <td><a href=https://scikit-learn.org/stable/modules/ensemble.html#bagging-meta-estimator>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Bagging, Ensemble</td> </tr> <tr> <td>70</td> <td>How to extract feature importances?</td> <td><a href=https://scikit-learn.org/stable/auto_examples/ensemble/plot_forest_importances.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Feature Importance</td> </tr> <tr> <td>71</td> <td>What is permutation importance?</td> <td><a href=https://scikit-learn.org/stable/modules/permutation_importance.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Permutation Importance</td> </tr> <tr> <td>72</td> <td>How to implement multi-class classification?</td> <td><a href=https://scikit-learn.org/stable/modules/multiclass.html>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Medium</td> <td>Multi-class Classification</td> </tr> <tr> <td>73</td> <td>What is One-vs-Rest (OvR) strategy?</td> <td><a href=https://scikit-learn.org/stable/modules/multiclass.html#one-vs-the-rest>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Multiclass Strategies</td> </tr> <tr> <td>74</td> <td>What is One-vs-One (OvO) strategy?</td> <td><a href=https://scikit-learn.org/stable/modules/multiclass.html#one-vs-one>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Multiclass Strategies</td> </tr> <tr> <td>75</td> <td>How to implement multi-label classification?</td> <td><a href=https://scikit-learn.org/stable/modules/multiclass.html#multilabel-classification>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Hard</td> <td>Multi-label Classification</td> </tr> <tr> <td>76</td> <td>What is MultiOutputClassifier?</td> <td><a href=https://scikit-learn.org/stable/modules/generated/sklearn.multioutput.MultiOutputClassifier.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Multi-output</td> </tr> <tr> <td>77</td> <td>How to implement Gaussian Mixture Models (GMM)?</td> <td><a href=https://scikit-learn.org/stable/modules/mixture.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>GMM, Clustering</td> </tr> <tr> <td>78</td> <td>What is Isolation Forest?</td> <td><a href=https://scikit-learn.org/stable/modules/outlier_detection.html#isolation-forest>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Anomaly Detection</td> </tr> <tr> <td>79</td> <td>How to implement One-Class SVM for anomaly detection?</td> <td><a href=https://scikit-learn.org/stable/modules/outlier_detection.html#one-class-svm>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Anomaly Detection</td> </tr> <tr> <td>80</td> <td>What is Local Outlier Factor (LOF)?</td> <td><a href=https://scikit-learn.org/stable/modules/outlier_detection.html#local-outlier-factor>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Anomaly Detection</td> </tr> <tr> <td>81</td> <td>How to implement text classification with TF-IDF?</td> <td><a href=https://scikit-learn.org/stable/modules/feature_extraction.html#text-feature-extraction>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Text Classification, TF-IDF</td> </tr> <tr> <td>82</td> <td>What is CountVectorizer vs TfidfVectorizer?</td> <td><a href=https://scikit-learn.org/stable/modules/feature_extraction.html#text-feature-extraction>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Easy</td> <td>Text Vectorization</td> </tr> <tr> <td>83</td> <td>How to use HashingVectorizer for large datasets?</td> <td><a href=https://scikit-learn.org/stable/modules/feature_extraction.html#vectorizing-a-large-text-corpus-with-the-hashing-trick>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Hard</td> <td>Large-scale Text</td> </tr> <tr> <td>84</td> <td>What is SGDClassifier and when to use it?</td> <td><a href=https://scikit-learn.org/stable/modules/sgd.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Online Learning, SGD</td> </tr> <tr> <td>85</td> <td>How to implement partial_fit for online learning?</td> <td><a href=https://scikit-learn.org/stable/computing/scaling_strategies.html#incremental-learning>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Hard</td> <td>Online Learning</td> </tr> <tr> <td>86</td> <td>What is MLPClassifier for neural networks?</td> <td><a href=https://scikit-learn.org/stable/modules/neural_networks_supervised.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Neural Networks</td> </tr> <tr> <td>87</td> <td>How to set random_state for reproducibility?</td> <td><a href=https://scikit-learn.org/stable/common_pitfalls.html#randomness>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Reproducibility</td> </tr> <tr> <td>88</td> <td>What is make_pipeline vs Pipeline?</td> <td><a href=https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.make_pipeline.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Easy</td> <td>Pipeline</td> </tr> <tr> <td>89</td> <td>How to get prediction probabilities?</td> <td><a href=https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html#sklearn.linear_model.LogisticRegression.predict_proba>Scikit-Learn Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Probabilities</td> </tr> <tr> <td>90</td> <td>What is decision_function vs predict_proba?</td> <td><a href=https://scikit-learn.org/stable/glossary.html#term-decision_function>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Prediction Methods</td> </tr> <tr> <td>91</td> <td><strong>[HARD]</strong> How to implement custom scoring functions for GridSearchCV?</td> <td><a href=https://scikit-learn.org/stable/modules/model_evaluation.html#defining-your-scoring-strategy-from-metric-functions>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Hard</td> <td>Custom Metrics</td> </tr> <tr> <td>92</td> <td><strong>[HARD]</strong> How to implement time series cross-validation (TimeSeriesSplit)?</td> <td><a href=https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.TimeSeriesSplit.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Netflix, Apple</td> <td>Hard</td> <td>Time Series CV</td> </tr> <tr> <td>93</td> <td><strong>[HARD]</strong> How to implement nested cross-validation?</td> <td><a href=https://scikit-learn.org/stable/auto_examples/model_selection/plot_nested_cross_validation_iris.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Hard</td> <td>Nested CV, Model Selection</td> </tr> <tr> <td>94</td> <td><strong>[HARD]</strong> How to optimize memory with sparse matrices?</td> <td><a href=https://scikit-learn.org/stable/modules/feature_extraction.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Hard</td> <td>Sparse Matrices, Memory</td> </tr> <tr> <td>95</td> <td><strong>[HARD]</strong> How to implement custom transformers with TransformerMixin?</td> <td><a href=https://scikit-learn.org/stable/modules/preprocessing.html#custom-transformers>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Microsoft</td> <td>Hard</td> <td>Custom Transformers</td> </tr> <tr> <td>96</td> <td><strong>[HARD]</strong> How to implement custom estimators with BaseEstimator?</td> <td><a href=https://scikit-learn.org/stable/developers/develop.html#rolling-your-own-estimator>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Hard</td> <td>Custom Estimators</td> </tr> <tr> <td>97</td> <td><strong>[HARD]</strong> How to optimize hyperparameters with Bayesian optimization?</td> <td><a href=https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.HalvingGridSearchCV.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Hard</td> <td>Hyperparameter Optimization</td> </tr> <tr> <td>98</td> <td><strong>[HARD]</strong> How to implement stratified sampling for imbalanced regression?</td> <td><a href=https://scikit-learn.org/stable/modules/cross_validation.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Hard</td> <td>Stratified Sampling</td> </tr> <tr> <td>99</td> <td><strong>[HARD]</strong> How to implement target encoding without data leakage?</td> <td><a href=https://contrib.scikit-learn.org/category_encoders/ >Category Encoders</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Hard</td> <td>Target Encoding, Leakage</td> </tr> <tr> <td>100</td> <td><strong>[HARD]</strong> How to implement cross-validation with grouped data?</td> <td><a href=https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GroupKFold.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Hard</td> <td>GroupKFold, Data Leakage</td> </tr> <tr> <td>101</td> <td><strong>[HARD]</strong> How to implement feature selection with embedded methods?</td> <td><a href=https://scikit-learn.org/stable/modules/feature_selection.html#feature-selection-using-selectfrommodel>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta</td> <td>Hard</td> <td>Feature Selection</td> </tr> <tr> <td>102</td> <td><strong>[HARD]</strong> How to handle high-cardinality categorical features?</td> <td><a href=https://stackoverflow.com/questions/62006247/how-to-handle-high-cardinality-categorical-features>Stack Overflow</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Hard</td> <td>High Cardinality</td> </tr> <tr> <td>103</td> <td><strong>[HARD]</strong> How to implement model interpretability with SHAP values?</td> <td><a href=https://shap.readthedocs.io/ >SHAP Docs</a></td> <td>Google, Amazon, Meta, Netflix, Apple</td> <td>Hard</td> <td>Model Interpretability, SHAP</td> </tr> <tr> <td>104</td> <td><strong>[HARD]</strong> How to implement multivariate time series forecasting?</td> <td><a href=https://scikit-learn.org/stable/modules/multioutput.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Netflix</td> <td>Hard</td> <td>Time Series, Multi-output</td> </tr> <tr> <td>105</td> <td><strong>[HARD]</strong> How to handle concept drift in production models?</td> <td><a href=https://towardsdatascience.com/ >Towards Data Science</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Hard</td> <td>Concept Drift, MLOps</td> </tr> <tr> <td>106</td> <td><strong>[HARD]</strong> How to implement model monitoring for production?</td> <td><a href=https://mlflow.org/ >MLflow Docs</a></td> <td>Google, Amazon, Meta, Netflix, Apple</td> <td>Hard</td> <td>Model Monitoring, MLOps</td> </tr> <tr> <td>107</td> <td><strong>[HARD]</strong> How to optimize inference latency for real-time predictions?</td> <td><a href=https://scikit-learn.org/stable/computing/computational_performance.html>Scikit-Learn Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Hard</td> <td>Latency, Performance</td> </tr> <tr> <td>108</td> <td><strong>[HARD]</strong> How to implement A/B testing for model comparison?</td> <td><a href=https://towardsdatascience.com/ >Towards Data Science</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Hard</td> <td>A/B Testing, Experimentation</td> </tr> <tr> <td>109</td> <td><strong>[HARD]</strong> How to handle data leakage in feature engineering?</td> <td><a href=https://www.kaggle.com/learn/feature-engineering>Kaggle</a></td> <td>Google, Amazon, Meta, Netflix, Apple</td> <td>Hard</td> <td>Data Leakage, Feature Engineering</td> </tr> <tr> <td>110</td> <td><strong>[HARD]</strong> How to implement model versioning and tracking?</td> <td><a href=https://mlflow.org/ >MLflow Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Hard</td> <td>Model Versioning, MLOps</td> </tr> </tbody> </table> <hr> <h2 id=code-examples>Code Examples</h2> <h3 id=1-building-a-custom-transformer>1. Building a Custom Transformer</h3> <details class=success> <summary>View Code Example</summary> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Code Example</code> | <strong>Asked by:</strong> Code Pattern <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.base</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span>

<span class=k>class</span><span class=w> </span><span class=nc>OutlierRemover</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>factor</span><span class=o>=</span><span class=mf>1.5</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>factor</span> <span class=o>=</span> <span class=n>factor</span>

    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>Q1</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=mf>0.25</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>Q3</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=mf>0.75</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>IQR</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>Q3</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>Q1</span>
        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
        <span class=k>return</span> <span class=n>X</span><span class=p>[</span><span class=o>~</span><span class=p>((</span><span class=n>X</span> <span class=o>&lt;</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>Q1</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>factor</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>IQR</span><span class=p>))</span> <span class=o>|</span> 
                   <span class=p>(</span><span class=n>X</span> <span class=o>&gt;</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>Q3</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>factor</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>IQR</span><span class=p>)))</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)]</span>
</code></pre></div></p> </details> <h3 id=2-nested-cross-validation>2. Nested Cross-Validation</h3> <details class=success> <summary>View Code Example</summary> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Code Example</code> | <strong>Asked by:</strong> Code Pattern <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>GridSearchCV</span><span class=p>,</span> <span class=n>cross_val_score</span><span class=p>,</span> <span class=n>KFold</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.svm</span><span class=w> </span><span class=kn>import</span> <span class=n>SVC</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># Inner loop for hyperparameter tuning</span>
<span class=n>p_grid</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;C&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span> <span class=s2>&quot;gamma&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>]}</span>
<span class=n>svm</span> <span class=o>=</span> <span class=n>SVC</span><span class=p>(</span><span class=n>kernel</span><span class=o>=</span><span class=s2>&quot;rbf&quot;</span><span class=p>)</span>
<span class=n>inner_cv</span> <span class=o>=</span> <span class=n>KFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=n>clf</span> <span class=o>=</span> <span class=n>GridSearchCV</span><span class=p>(</span><span class=n>estimator</span><span class=o>=</span><span class=n>svm</span><span class=p>,</span> <span class=n>param_grid</span><span class=o>=</span><span class=n>p_grid</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=n>inner_cv</span><span class=p>)</span>

<span class=c1># Outer loop for model evaluation</span>
<span class=n>outer_cv</span> <span class=o>=</span> <span class=n>KFold</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=n>nested_score</span> <span class=o>=</span> <span class=n>cross_val_score</span><span class=p>(</span><span class=n>clf</span><span class=p>,</span> <span class=n>X_iris</span><span class=p>,</span> <span class=n>y_iris</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=n>outer_cv</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Nested CV Score: </span><span class=si>{</span><span class=n>nested_score</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2> +/- </span><span class=si>{</span><span class=n>nested_score</span><span class=o>.</span><span class=n>std</span><span class=p>()</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</code></pre></div></p> </details> <h3 id=3-pipeline-with-columntransformer>3. Pipeline with ColumnTransformer</h3> <details class=success> <summary>View Code Example</summary> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Code Example</code> | <strong>Asked by:</strong> Code Pattern <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.compose</span><span class=w> </span><span class=kn>import</span> <span class=n>ColumnTransformer</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.impute</span><span class=w> </span><span class=kn>import</span> <span class=n>SimpleImputer</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span><span class=p>,</span> <span class=n>OneHotEncoder</span>

<span class=n>numeric_features</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>,</span> <span class=s1>&#39;fare&#39;</span><span class=p>]</span>
<span class=n>numeric_transformer</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>(</span><span class=n>steps</span><span class=o>=</span><span class=p>[</span>
    <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;median&#39;</span><span class=p>)),</span>
    <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>())])</span>

<span class=n>categorical_features</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;embarked&#39;</span><span class=p>,</span> <span class=s1>&#39;sex&#39;</span><span class=p>,</span> <span class=s1>&#39;pclass&#39;</span><span class=p>]</span>
<span class=n>categorical_transformer</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>(</span><span class=n>steps</span><span class=o>=</span><span class=p>[</span>
    <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;constant&#39;</span><span class=p>,</span> <span class=n>fill_value</span><span class=o>=</span><span class=s1>&#39;missing&#39;</span><span class=p>)),</span>
    <span class=p>(</span><span class=s1>&#39;onehot&#39;</span><span class=p>,</span> <span class=n>OneHotEncoder</span><span class=p>(</span><span class=n>handle_unknown</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>))])</span>

<span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>(</span>
    <span class=n>transformers</span><span class=o>=</span><span class=p>[</span>
        <span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>,</span> <span class=n>numeric_transformer</span><span class=p>,</span> <span class=n>numeric_features</span><span class=p>),</span>
        <span class=p>(</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=n>categorical_transformer</span><span class=p>,</span> <span class=n>categorical_features</span><span class=p>)])</span>

<span class=n>clf</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>(</span><span class=n>steps</span><span class=o>=</span><span class=p>[(</span><span class=s1>&#39;preprocessor&#39;</span><span class=p>,</span> <span class=n>preprocessor</span><span class=p>),</span>
                      <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>LogisticRegression</span><span class=p>())])</span>
</code></pre></div></p> </details> <hr> <h2 id=questions-asked-in-google-interview>Questions asked in Google interview</h2> <ul> <li>How would you implement a custom loss function in Scikit-Learn?</li> <li>Explain how to handle data leakage in cross-validation</li> <li>Write code to implement nested cross-validation with hyperparameter tuning</li> <li>How would you optimize a model for minimal inference latency?</li> <li>Explain the bias-variance tradeoff with specific examples</li> <li>How would you implement model calibration for probability estimates?</li> <li>Write code to implement stratified sampling for imbalanced multi-class</li> <li>How would you handle concept drift in production ML systems?</li> <li>Explain how to implement feature importance with SHAP values</li> <li>How would you optimize memory for large sparse datasets?</li> </ul> <h2 id=questions-asked-in-amazon-interview>Questions asked in Amazon interview</h2> <ul> <li>Write code to implement a complete ML pipeline for customer churn</li> <li>How would you handle high-cardinality categorical features?</li> <li>Explain the difference between different cross-validation strategies</li> <li>Write code to implement time series cross-validation</li> <li>How would you implement model monitoring in production?</li> <li>Explain how to handle missing data in production systems</li> <li>Write code to implement custom scoring functions</li> <li>How would you implement A/B testing for model comparison?</li> <li>Explain how to optimize hyperparameters efficiently</li> <li>How would you handle data leakage in feature engineering?</li> </ul> <h2 id=questions-asked-in-meta-interview>Questions asked in Meta interview</h2> <ul> <li>Write code to implement user engagement prediction pipeline</li> <li>How would you implement multi-label classification for content tagging?</li> <li>Explain how to handle extremely imbalanced datasets</li> <li>Write code to implement custom transformers for text features</li> <li>How would you implement feature selection for high-dimensional data?</li> <li>Explain how to implement model interpretability</li> <li>Write code to implement online learning with partial_fit</li> <li>How would you implement model calibration?</li> <li>Explain how to prevent overfitting in ensemble models</li> <li>How would you implement multivariate predictions?</li> </ul> <h2 id=questions-asked-in-microsoft-interview>Questions asked in Microsoft interview</h2> <ul> <li>Explain the Scikit-Learn estimator API design principles</li> <li>Write code to implement custom estimators extending BaseEstimator</li> <li>How would you implement regularization selection?</li> <li>Explain the differences between solver options in LogisticRegression</li> <li>Write code to implement feature engineering pipelines</li> <li>How would you optimize model training time?</li> <li>Explain how to implement model persistence correctly</li> <li>Write code to implement cross-validation with custom folds</li> <li>How would you handle numerical stability issues?</li> <li>Explain how to implement reproducible ML experiments</li> </ul> <h2 id=questions-asked-in-netflix-interview>Questions asked in Netflix interview</h2> <ul> <li>Write code to implement recommendation feature engineering</li> <li>How would you implement content classification at scale?</li> <li>Explain how to handle user behavior data for ML</li> <li>Write code to implement streaming quality prediction</li> <li>How would you implement real-time inference optimization?</li> <li>Explain how to implement model monitoring and retraining</li> <li>Write code to implement cohort-based model evaluation</li> <li>How would you handle seasonality in user data?</li> <li>Explain how to implement A/B testing for ML models</li> <li>How would you implement customer lifetime value prediction?</li> </ul> <h2 id=questions-asked-in-apple-interview>Questions asked in Apple interview</h2> <ul> <li>Write code to implement privacy-preserving ML pipelines</li> <li>How would you implement on-device ML model optimization?</li> <li>Explain how to handle sensor data for ML</li> <li>Write code to implement quality control classification</li> <li>How would you implement model quantization for deployment?</li> <li>Explain best practices for production ML systems</li> <li>Write code to implement automated model retraining</li> <li>How would you handle data versioning?</li> <li>Explain how to implement cross-platform model deployment</li> <li>How would you implement model security?</li> </ul> <hr> <h2 id=additional-resources>Additional Resources</h2> <ul> <li><a href=https://scikit-learn.org/stable/ >Official Scikit-Learn Documentation</a></li> <li><a href=https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/ >Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</a></li> <li><a href=https://jakevdp.github.io/PythonDataScienceHandbook/ >Python Data Science Handbook</a></li> <li><a href=https://www.oreilly.com/library/view/introduction-to-machine/9781449369880/ >Introduction to Machine Learning with Python</a></li> <li><a href=https://github.com/amueller/ml-workshop-1-of-4>Scikit-Learn Course by Andreas Mueller</a></li> </ul> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2020 - <script>document.write(/\d{4}/.exec(Date())[0])</script> ‚Ä¢ <strong>Kuldeep Singh Sidhu</strong> ‚Ä¢ <u><a href=https://choosealicense.com/licenses/agpl-3.0/ target=‚Äù_blank‚Äù>License</a></u> ‚Ä¢ <u><a href=/privacy>Privacy Policy</a></u> ‚Ä¢ <u><a href=/contact>Contact</a></u> ‚Ä¢ </div> </div> <div class=md-social> <a href=https://github.com/singhsidhukuldeep/ target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M8 0c4.42 0 8 3.58 8 8a8.01 8.01 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27s-1.36.09-2 .27c-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8"/></svg> </a> <a href=https://linkedin.com/in/singhsidhukuldeep target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=https://twitter.com/kuldeep_s_s target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg> </a> <a href=https://stackoverflow.com/u/7182350/ target=_blank rel=noopener title=stackoverflow.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M290.7 311 95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"/></svg> </a> <a href=https://huggingface.co/singhsidhukuldeep target=_blank rel=noopener title=huggingface.co class=md-social__link> <svg width=500 height=463 viewbox="0 0 500 463" fill=none xmlns=http://www.w3.org/2000/svg> <path fill=white d="M496.592 369.699C500.563 381.093 499.61 393.227 494.315 403.778C490.503 411.48 485.05 417.441 478.379 422.769C470.331 429.099 460.324 434.48 448.253 439.65C433.852 445.77 416.274 451.52 408.226 453.63C387.63 458.958 367.829 462.334 347.762 462.493C319.066 462.756 294.34 456.004 276.762 438.753C267.656 439.861 258.443 440.494 249.178 440.494C240.389 440.494 231.706 439.967 223.076 438.912C205.445 456.057 180.825 462.756 152.234 462.493C132.168 462.334 112.366 458.958 91.7177 453.63C83.7229 451.52 66.145 445.77 51.7439 439.65C39.6723 434.48 29.6656 429.099 21.6708 422.769C14.9467 417.441 9.49334 411.48 5.68127 403.778C0.439661 393.227 -0.566304 381.093 3.45755 369.699C-0.248631 360.994 -1.20165 351.024 1.71035 339.998C3.03399 334.987 5.20476 330.344 7.95792 326.229C7.37552 324.067 6.89901 321.851 6.58134 319.424C4.56941 304.97 9.59923 291.781 19.0765 281.547C23.7357 276.43 28.7655 272.895 34.0071 270.627C30.1421 254.273 28.1302 237.445 28.1302 220.247C28.1302 98.5969 127.085 0 249.178 0C291.111 0 330.343 11.6058 363.805 31.8633C369.84 35.5561 375.77 39.5126 381.436 43.7329C384.242 45.8431 387.048 48.006 389.748 50.2744C392.501 52.49 395.201 54.8112 397.796 57.1851C405.632 64.3069 412.991 71.9562 419.715 80.133C421.992 82.8235 424.163 85.6194 426.28 88.4681C430.569 94.1128 434.54 99.9685 438.193 106.035C443.752 115.109 448.623 124.604 452.859 134.469C455.665 141.064 458.101 147.816 460.271 154.727C463.501 165.067 465.99 175.723 467.684 186.696C468.213 190.336 468.69 194.028 469.06 197.721C469.802 205.107 470.225 212.598 470.225 220.247C470.225 237.234 468.213 253.904 464.454 269.994C470.278 272.262 475.784 275.955 480.92 281.547C490.397 291.781 495.427 305.022 493.415 319.477C493.098 321.851 492.621 324.067 492.039 326.229C494.792 330.344 496.963 334.987 498.286 339.998C501.198 351.024 500.245 360.994 496.592 369.699Z"/> <path fill=black d="M433.839 221.75C433.839 120.838 351.531 39.0323 250 39.0323C148.469 39.0323 66.1613 120.838 66.1613 221.75C66.1613 322.662 148.469 404.468 250 404.468C351.531 404.468 433.839 322.662 433.839 221.75ZM45 221.75C45 109.222 136.782 18 250 18C363.218 18 455 109.222 455 221.75C455 334.278 363.218 425.5 250 425.5C136.782 425.5 45 334.278 45 221.75Z"/> <path fill=white d="M250 405.5C352.173 405.5 435 323.232 435 221.75C435 120.268 352.173 38 250 38C147.827 38 65 120.268 65 221.75C65 323.232 147.827 405.5 250 405.5Z"/> <path fill=white d="M202.198 404.174C216.789 383.118 215.755 367.316 195.735 347.627C175.715 327.943 164.062 299.145 164.062 299.145C164.062 299.145 159.709 282.419 149.794 283.958C139.88 285.497 132.6 310.492 153.368 325.783C174.135 341.069 149.232 351.456 141.242 337.099C133.252 322.741 111.435 285.831 100.121 278.772C88.8117 271.713 80.8483 275.668 83.5151 290.218C86.182 304.769 133.48 340.036 128.878 347.668C124.276 355.296 108.058 338.7 108.058 338.7C108.058 338.7 57.3079 293.255 46.2587 305.097C35.2096 316.94 54.641 326.863 82.3328 343.359C110.03 359.85 112.177 364.206 108.248 370.446C104.314 376.685 43.1836 325.971 37.4417 347.47C31.705 368.969 99.8291 375.209 95.6247 390.051C91.4203 404.899 47.6372 361.958 38.6823 378.689C29.7221 395.425 100.465 415.088 101.038 415.234C123.889 421.067 181.924 433.426 202.198 404.174Z"/> <path fill=black d="M90.9935 255C82.4744 255 74.8603 258.477 69.551 264.784C66.2675 268.69 62.8367 274.986 62.5578 284.414C58.985 283.394 55.5489 282.824 52.3391 282.824C44.183 282.824 36.8163 285.93 31.6069 291.573C24.9137 298.815 21.9407 307.715 23.2351 316.62C23.8508 320.861 25.2768 324.663 27.4079 328.182C22.9142 331.795 19.6044 336.826 18.0047 342.876C16.7524 347.619 15.4685 357.497 22.1722 367.673C21.746 368.337 21.3461 369.027 20.9725 369.733C16.9418 377.336 16.684 385.927 20.2411 393.928C25.6346 406.054 39.0368 415.608 65.0625 425.863C81.2536 432.242 96.0661 436.321 96.1976 436.357C117.603 441.874 136.962 444.677 153.721 444.677C184.525 444.677 206.578 435.301 219.27 416.811C239.697 387.036 236.776 359.803 210.346 333.552C195.717 319.026 185.993 297.607 183.967 292.906C179.884 278.986 169.086 263.513 151.138 263.513H151.133C149.622 263.513 148.096 263.633 146.592 263.869C138.73 265.097 131.858 269.595 126.949 276.361C121.65 269.814 116.504 264.606 111.847 261.667C104.827 257.243 97.813 255 90.9935 255ZM90.9935 275.917C93.6771 275.917 96.9553 277.051 100.57 279.331C111.794 286.406 133.452 323.403 141.382 337.793C144.039 342.614 148.581 344.654 152.669 344.654C160.783 344.654 167.118 336.638 153.411 326.451C132.8 311.124 140.03 286.072 149.87 284.529C150.301 284.461 150.727 284.43 151.138 284.43C160.083 284.43 164.03 299.751 164.03 299.751C164.03 299.751 175.595 328.616 195.465 348.346C215.334 368.08 216.36 383.919 201.879 405.024C192.002 419.415 173.096 421.292 153.721 421.292C133.626 421.292 112.99 417.772 101.445 414.796C100.877 414.65 30.7019 396.255 39.5946 379.48C41.089 376.661 43.5516 375.532 46.6509 375.532C59.1744 375.532 81.9535 394.054 91.746 394.054C93.935 394.054 95.5662 392.371 96.1976 390.112C100.555 374.522 32.6646 369.738 38.3633 348.189C39.3683 344.377 42.094 342.829 45.9248 342.834C62.4737 342.834 99.6021 371.756 107.385 371.756C107.979 371.756 108.405 371.584 108.637 371.218C112.536 364.964 110.74 359.872 83.257 343.343C55.7738 326.808 36.1428 317.588 47.114 305.718C48.3768 304.347 50.1659 303.741 52.3391 303.741C69.0248 303.746 108.447 339.398 108.447 339.398C108.447 339.398 119.087 350.395 125.523 350.395C127.001 350.395 128.259 349.815 129.111 348.382C133.673 340.737 86.7366 305.388 84.0898 290.804C82.2955 280.921 85.3474 275.917 90.9935 275.917Z"/> <path fill=white d="M296.9 404.174C282.31 383.118 283.343 367.316 303.363 347.627C323.383 327.943 335.037 299.145 335.037 299.145C335.037 299.145 339.39 282.419 349.304 283.958C359.219 285.497 366.498 310.492 345.731 325.783C324.963 341.069 349.866 351.456 357.856 337.099C365.846 322.741 387.663 285.831 398.978 278.772C410.287 271.713 418.25 275.668 415.583 290.218C412.916 304.769 365.618 340.036 370.22 347.668C374.822 355.296 391.041 338.7 391.041 338.7C391.041 338.7 441.791 293.255 452.84 305.097C463.889 316.94 444.457 326.863 416.766 343.359C389.068 359.85 386.921 364.206 390.85 370.446C394.784 376.685 455.915 325.971 461.657 347.47C467.393 368.969 399.269 375.209 403.474 390.051C407.678 404.899 451.461 361.958 460.416 378.689C469.376 395.425 398.633 415.088 398.06 415.234C375.209 421.067 317.175 433.426 296.9 404.174Z"/> <path fill=black d="M408.105 255C416.624 255 424.238 258.477 429.547 264.784C432.831 268.69 436.262 274.986 436.541 284.414C440.113 283.394 443.549 282.824 446.759 282.824C454.915 282.824 462.282 285.93 467.491 291.573C474.185 298.815 477.158 307.715 475.863 316.62C475.248 320.861 473.822 324.663 471.69 328.182C476.184 331.795 479.494 336.826 481.094 342.876C482.346 347.619 483.63 357.497 476.926 367.673C477.352 368.337 477.752 369.027 478.126 369.733C482.157 377.336 482.414 385.927 478.857 393.928C473.464 406.054 460.062 415.608 434.036 425.863C417.845 432.242 403.032 436.321 402.901 436.357C381.495 441.874 362.136 444.677 345.377 444.677C314.573 444.677 292.52 435.301 279.829 416.811C259.402 387.036 262.322 359.803 288.753 333.552C303.381 319.026 313.105 297.607 315.131 292.906C319.214 278.986 330.012 263.513 347.961 263.513H347.966C349.476 263.513 351.002 263.633 352.507 263.869C360.368 265.097 367.24 269.595 372.15 276.361C377.449 269.814 382.595 264.606 387.252 261.667C394.271 257.243 401.285 255 408.105 255ZM408.105 275.917C405.421 275.917 402.143 277.051 398.528 279.331C387.304 286.406 365.646 323.403 357.716 337.793C355.059 342.614 350.518 344.654 346.429 344.654C338.315 344.654 331.98 336.638 345.687 326.451C366.299 311.124 359.069 286.072 349.229 284.529C348.797 284.461 348.371 284.43 347.961 284.43C339.015 284.43 335.069 299.751 335.069 299.751C335.069 299.751 323.503 328.616 303.634 348.346C283.764 368.08 282.738 383.919 297.219 405.024C307.096 419.415 326.002 421.292 345.377 421.292C365.472 421.292 386.108 417.772 397.653 414.796C398.221 414.65 468.397 396.255 459.504 379.48C458.009 376.661 455.547 375.532 452.447 375.532C439.924 375.532 417.145 394.054 407.352 394.054C405.163 394.054 403.532 392.371 402.901 390.112C398.543 374.522 466.434 369.738 460.735 348.189C459.73 344.377 457.004 342.829 453.174 342.834C436.625 342.834 399.496 371.756 391.714 371.756C391.119 371.756 390.693 371.584 390.461 371.218C386.562 364.964 388.358 359.872 415.841 343.343C443.325 326.808 462.956 317.588 451.984 305.718C450.722 304.347 448.932 303.741 446.759 303.741C430.074 303.746 390.651 339.398 390.651 339.398C390.651 339.398 380.011 350.395 373.576 350.395C372.097 350.395 370.84 349.815 369.987 348.382C365.425 340.737 412.362 305.388 415.009 290.804C416.803 280.921 413.751 275.917 408.105 275.917Z"/> <path fill=#0E1116 d="M319.277 228.901C319.277 205.236 288.585 241.304 250.637 241.465C212.692 241.306 182 205.238 182 228.901C182 244.591 189.507 270.109 209.669 285.591C213.681 271.787 235.726 260.729 238.877 262.317C243.364 264.578 243.112 270.844 250.637 276.365C258.163 270.844 257.911 264.58 262.398 262.317C265.551 260.729 287.594 271.787 291.605 285.591C311.767 270.109 319.275 244.591 319.275 228.903L319.277 228.901Z"/> <path fill=#FF323D d="M262.4 262.315C257.913 264.576 258.165 270.842 250.639 276.363C243.114 270.842 243.366 264.578 238.879 262.315C235.726 260.727 213.683 271.785 209.672 285.589C219.866 293.417 233.297 298.678 250.627 298.806C250.631 298.806 250.635 298.806 250.641 298.806C250.646 298.806 250.65 298.806 250.656 298.806C267.986 298.68 281.417 293.417 291.611 285.589C287.6 271.785 265.555 260.727 262.404 262.315H262.4Z"/> <path fill=black d="M373 196C382.389 196 390 188.389 390 179C390 169.611 382.389 162 373 162C363.611 162 356 169.611 356 179C356 188.389 363.611 196 373 196Z"/> <path fill=black d="M128 196C137.389 196 145 188.389 145 179C145 169.611 137.389 162 128 162C118.611 162 111 169.611 111 179C111 188.389 118.611 196 128 196Z"/> <path fill=#0E1116 d="M313.06 171.596C319.796 173.968 322.476 187.779 329.281 184.171C342.167 177.337 347.06 161.377 340.208 148.524C333.356 135.671 317.354 130.792 304.467 137.626C291.58 144.46 286.688 160.419 293.54 173.272C296.774 179.339 307.039 169.475 313.06 171.596Z"/> <path fill=#0E1116 d="M188.554 171.596C181.818 173.968 179.138 187.779 172.334 184.171C159.447 177.337 154.555 161.377 161.407 148.524C168.259 135.671 184.26 130.792 197.147 137.626C210.034 144.46 214.926 160.419 208.074 173.272C204.84 179.339 194.575 169.475 188.554 171.596Z"/> </svg> </a> <a href=http://kuldeepsinghsidhu.com target=_blank rel=noopener title=kuldeepsinghsidhu.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0M5.78 8.75a9.64 9.64 0 0 0 1.363 4.177q.383.64.857 1.215c.245-.296.551-.705.857-1.215A9.64 9.64 0 0 0 10.22 8.75Zm4.44-1.5a9.64 9.64 0 0 0-1.363-4.177c-.307-.51-.612-.919-.857-1.215a10 10 0 0 0-.857 1.215A9.64 9.64 0 0 0 5.78 7.25Zm-5.944 1.5H1.543a6.51 6.51 0 0 0 4.666 5.5q-.184-.271-.352-.552c-.715-1.192-1.437-2.874-1.581-4.948m-2.733-1.5h2.733c.144-2.074.866-3.756 1.58-4.948q.18-.295.353-.552a6.51 6.51 0 0 0-4.666 5.5m10.181 1.5c-.144 2.074-.866 3.756-1.58 4.948q-.18.296-.353.552a6.51 6.51 0 0 0 4.666-5.5Zm2.733-1.5a6.51 6.51 0 0 0-4.666-5.5q.184.272.353.552c.714 1.192 1.436 2.874 1.58 4.948Z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "search.highlight", "search.share", "search.suggest", "content.tooltips", "navigation.instant.progress", "navigation.path", "navigation.top", "toc.follow"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.60a45f97.min.js></script> <script src=../../javascripts/mathjax.js></script> <script src=https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../javascripts/xfile.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>