<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This is a completely open-source platform for maintaining curated list of interview questions and answers for people looking and preparing for data science opportunities."><meta name=author content="Kuldeep Singh Sidhu"><link href=https://singhsidhukuldeep.github.io/Interview-Questions/Pandas/ rel=canonical><link href=../Python/ rel=prev><link href=../NumPy/ rel=next><link rel=icon href=https://repository-images.githubusercontent.com/275878203/13719500-bb75-11ea-8f3a-be2ffb87a6a2><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.50"><title>Pandas - Data Science Interview preparation</title><link rel=stylesheet href=../../assets/stylesheets/main.a40c8224.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-EVGNTG49J7"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-EVGNTG49J7",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-EVGNTG49J7",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#pandas-interview-questions class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <!-- Add announcement here, including arbitrary HTML --> <style>
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
      20%, 40%, 60%, 80% { transform: translateX(2px); }
    }
    @keyframes glow {
      0%, 100% { text-shadow: 0 0 5px rgba(255, 165, 0, 0.5); }
      50% { text-shadow: 0 0 20px rgba(255, 165, 0, 0.8), 0 0 30px rgba(255, 140, 0, 0.6); }
    }
    .shake-text {
      display: inline-block;
      animation: shake 3s ease-in-out infinite;
    }
    .glow-link {
      animation: glow 2s ease-in-out infinite;
      font-weight: bold;
    }
  </style> <span class=shake-text>üöÄ <a href=/flashcards class=glow-link>Flashcards</a> feature is live!</span> <meta name=google-adsense-account content=ca-pub-4988388949365963> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4988388949365963" crossorigin=anonymous></script> </div> </aside> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Data Science Interview preparation" class="md-header__button md-logo" aria-label="Data Science Interview preparation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M9.4 86.6c-12.5-12.5-12.5-32.7 0-45.2s32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L178.7 256zM256 416h288c17.7 0 32 14.3 32 32s-14.3 32-32 32H256c-17.7 0-32-14.3-32-32s14.3-32 32-32"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Data Science Interview preparation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Pandas </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=deep-purple data-md-color-accent=purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=deep-purple data-md-color-accent=purple aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/singhsidhukuldeep/singhsidhukuldeep.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> singhsidhukuldeep/singhsidhukuldeep.github.io </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Data Science Interview preparation" class="md-nav__button md-logo" aria-label="Data Science Interview preparation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M9.4 86.6c-12.5-12.5-12.5-32.7 0-45.2s32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L178.7 256zM256 416h288c17.7 0 32 14.3 32 32s-14.3 32-32 32H256c-17.7 0-32-14.3-32-32s14.3-32 32-32"/></svg> </a> Data Science Interview preparation </label> <div class=md-nav__source> <a href=https://github.com/singhsidhukuldeep/singhsidhukuldeep.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> singhsidhukuldeep/singhsidhukuldeep.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> üè° Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> üë®üèø‚Äçüè´ Interview Questions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> üë®üèø‚Äçüè´ Interview Questions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../flashcards/ class=md-nav__link> <span class=md-ellipsis> üìá Flashcards </span> </a> </li> <li class=md-nav__item> <a href=../data-structures-algorithms/ class=md-nav__link> <span class=md-ellipsis> DSA (Data Structures & Algorithms) </span> </a> </li> <li class=md-nav__item> <a href=../Machine-Learning/ class=md-nav__link> <span class=md-ellipsis> Machine Learning </span> </a> </li> <li class=md-nav__item> <a href=../System-design/ class=md-nav__link> <span class=md-ellipsis> System Design </span> </a> </li> <li class=md-nav__item> <a href=../Natural-Language-Processing/ class=md-nav__link> <span class=md-ellipsis> Natural Language Processing (NLP) </span> </a> </li> <li class=md-nav__item> <a href=../Probability/ class=md-nav__link> <span class=md-ellipsis> Probability </span> </a> </li> <li class=md-nav__item> <a href=../AB-testing/ class=md-nav__link> <span class=md-ellipsis> A/B Testing </span> </a> </li> <li class=md-nav__item> <a href=../SQL-Interview-Questions/ class=md-nav__link> <span class=md-ellipsis> SQL </span> </a> </li> <li class=md-nav__item> <a href=../Python/ class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Pandas </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Pandas </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#premium-interview-questions class=md-nav__link> <span class=md-ellipsis> Premium Interview Questions </span> </a> <nav class=md-nav aria-label="Premium Interview Questions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-loc-vs-iloc-key-difference-google-amazon-meta-interview-question class=md-nav__link> <span class=md-ellipsis> Explain loc vs iloc - Key Difference - Google, Amazon, Meta Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#production-code-130-lines class=md-nav__link> <span class=md-ellipsis> Production Code (130 lines) </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-which class=md-nav__link> <span class=md-ellipsis> When to Use Which </span> </a> </li> <li class=md-nav__item> <a href=#real-world-performance class=md-nav__link> <span class=md-ellipsis> Real-World Performance </span> </a> <nav class=md-nav aria-label="Real-World Performance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-do-you-handle-missing-values-in-pandas-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Handle Missing Values in Pandas? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-groupby-in-pandas-split-apply-combine-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain GroupBy in Pandas - Split-Apply-Combine - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#difference-between-merge-join-and-concat-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Difference Between merge(), join(), and concat() - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-apply-functions-to-dataframes-apply-map-applymap-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Apply Functions to DataFrames? apply(), map(), applymap() - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-optimize-memory-usage-in-pandas-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Optimize Memory Usage in Pandas? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-handle-large-datasets-that-dont-fit-in-memory-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Handle Large Datasets That Don't Fit in Memory? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pivot-tables-in-pandas-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pivot Tables in Pandas - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-work-with-datetime-data-in-pandas-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Work with DateTime Data in Pandas? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-settingwithcopywarning-and-how-to-avoid-it-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is SettingWithCopyWarning and How to Avoid It? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-rolling-windows-for-time-series-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use Rolling Windows for Time Series? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-efficiently-use-query-and-eval-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Efficiently Use Query and Eval? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-work-with-string-data-in-pandas-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Work with String Data in Pandas? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#difference-between-transform-and-apply-in-groupby-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Difference Between transform() and apply() in GroupBy - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-create-bins-and-categories-with-cut-and-qcut-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Create Bins and Categories with cut() and qcut()? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-handle-categorical-data-efficiently-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Handle Categorical Data Efficiently? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-multiindex-hierarchical-indexing-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use MultiIndex (Hierarchical Indexing)? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-profile-and-optimize-pandas-performance-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Profile and Optimize Pandas Performance? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-melt-for-unpivoting-data-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use melt() for Unpivoting Data? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-stack-and-unstack-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use stack() and unstack()? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-cross-tabulate-with-crosstab-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Cross-Tabulate with crosstab()? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-explode-for-list-columns-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use explode() for List Columns? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-handle-json-with-nested-structures-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How to Handle JSON with Nested Structures? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-method-chaining-for-clean-code-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use Method Chaining for Clean Code? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-readwrite-parquet-files-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Read/Write Parquet Files? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-assign-for-creating-new-columns-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use assign() for Creating New Columns? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-calculate-percentage-change-and-cumulative-stats-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Calculate Percentage Change and Cumulative Stats? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-shift-and-lag-data-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Shift and Lag Data? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-sample-data-from-dataframe-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Sample Data from DataFrame? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-detect-and-handle-outliers-google-amazon-meta-interview-question class=md-nav__link> <span class=md-ellipsis> How to Detect and Handle Outliers? - Google, Amazon, Meta Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-normalize-and-standardize-data-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Normalize and Standardize Data? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-where-and-mask-methods-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use where() and mask() Methods? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-rank-values-in-pandas-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Rank Values in Pandas? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-find-firstlast-n-rows-per-group-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Find First/Last N Rows Per Group? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-nsmallest-and-nlargest-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use nsmallest() and nlargest()? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-calculate-weighted-average-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Calculate Weighted Average? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-perform-window-functions-like-sql-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Perform Window Functions Like SQL? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-compare-two-dataframes-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How to Compare Two DataFrames? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-handle-settingwithcopywarning-properly-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Handle SettingWithCopyWarning Properly? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-sparse-data-structures-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use Sparse Data Structures? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-custom-aggregation-functions-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Implement Custom Aggregation Functions? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-perform-asof-joins-nearest-key-join-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Perform Asof Joins (Nearest Key Join)? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-calculate-cohort-metrics-meta-netflix-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Calculate Cohort Metrics? - Meta, Netflix, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-ab-test-analysis-in-pandas-meta-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Implement A/B Test Analysis in Pandas? - Meta, Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-copy-on-write-cow-in-pandas-20-google-meta-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use Copy-on-Write (CoW) in Pandas 2.0+? - Google, Meta Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-pyarrow-backend-for-better-performance-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use PyArrow Backend for Better Performance? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#quick-reference-127-interview-questions class=md-nav__link> <span class=md-ellipsis> Quick Reference: 127+ Interview Questions </span> </a> </li> <li class=md-nav__item> <a href=#code-examples class=md-nav__link> <span class=md-ellipsis> Code Examples </span> </a> <nav class=md-nav aria-label="Code Examples"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-memory-optimization class=md-nav__link> <span class=md-ellipsis> 1. Memory Optimization </span> </a> </li> <li class=md-nav__item> <a href=#2-method-chaining-for-clean-code class=md-nav__link> <span class=md-ellipsis> 2. Method Chaining for Clean Code </span> </a> </li> <li class=md-nav__item> <a href=#3-parallel-processing-with-swifter class=md-nav__link> <span class=md-ellipsis> 3. Parallel Processing with Swifter </span> </a> </li> <li class=md-nav__item> <a href=#explain-multiindex-in-pandas-google-meta-interview-question class=md-nav__link> <span class=md-ellipsis> Explain MultiIndex in Pandas - Google, Meta Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdmerge-parameters-amazon-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.merge() Parameters - Amazon, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-apply-vs-map-vs-applymap-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain apply() vs map() vs applymap() - Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdcut-vs-pdqcut-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.cut() vs pd.qcut() - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-categorical-data-type-meta-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Categorical Data Type - Meta, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-window-functions-rolling-expanding-ewma-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Window Functions (Rolling, Expanding, EWMA) - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-dataframe-indexing-loc-vs-iloc-vs-at-vs-iat-microsoft-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain DataFrame Indexing (.loc vs .iloc vs .at vs .iat) - Microsoft, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdconcat-vs-pdmerge-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.concat() vs pd.merge() - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-groupby-aggregation-functions-google-meta-interview-question class=md-nav__link> <span class=md-ellipsis> Explain GroupBy Aggregation Functions - Google, Meta Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-query-method-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Query Method - Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-memory-usage-optimization-netflix-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Memory Usage Optimization - Netflix, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-eval-method-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Eval Method - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-time-series-resampling-meta-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Time Series Resampling - Meta, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-pivot-tables-microsoft-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Pivot Tables - Microsoft, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdmelt-google-meta-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.melt() - Google, Meta Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdcrosstab-amazon-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.crosstab() - Amazon, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdget_dummies-for-one-hot-encoding-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.get_dummies() for One-Hot Encoding - Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-settingwithcopywarning-meta-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain SettingWithCopyWarning - Meta, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-string-methods-str-accessor-amazon-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas String Methods (.str accessor) - Amazon, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdexplode-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.explode() - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-pipe-method-meta-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Pipe Method - Meta, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdjson_normalize-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.json_normalize() - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdto_datetime-options-microsoft-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.to_datetime() Options - Microsoft, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdread_csv-optimization-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.read_csv() Optimization - Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-style-for-formatting-meta-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Style for Formatting - Meta, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-merge-indicators-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Merge Indicators - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-dataframewhere-and-mask-meta-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> Explain DataFrame.where() and mask() - Meta, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-nlargest-and-nsmallest-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain nlargest() and nsmallest() - Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-rank-method-microsoft-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas rank() Method - Microsoft, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdcut-vs-pdqcut-amazon-google-interview-question_1 class=md-nav__link> <span class=md-ellipsis> Explain pd.cut() vs pd.qcut() - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-cumsum-cumprod-cummax-cummin-meta-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas cumsum(), cumprod(), cummax(), cummin() - Meta, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdconcat-axis-parameter-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.concat() axis Parameter - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-sparse-data-structures-netflix-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Sparse Data Structures - Netflix, Google Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#questions-asked-in-google-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in Google interview </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-amazon-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in Amazon interview </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-meta-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in Meta interview </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-microsoft-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in Microsoft interview </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-netflix-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in Netflix interview </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-apple-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in Apple interview </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-flipkart-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in Flipkart interview </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-linkedin-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in LinkedIn interview </span> </a> </li> <li class=md-nav__item> <a href=#additional-resources class=md-nav__link> <span class=md-ellipsis> Additional Resources </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../NumPy/ class=md-nav__link> <span class=md-ellipsis> NumPy </span> </a> </li> <li class=md-nav__item> <a href=../Scikit-Learn/ class=md-nav__link> <span class=md-ellipsis> Scikit-Learn </span> </a> </li> <li class=md-nav__item> <a href=../LangChain/ class=md-nav__link> <span class=md-ellipsis> LangChain </span> </a> </li> <li class=md-nav__item> <a href=../LangGraph/ class=md-nav__link> <span class=md-ellipsis> LangGraph </span> </a> </li> <li class=md-nav__item> <a href=../Interview-Question-Resources/ class=md-nav__link> <span class=md-ellipsis> Interview Question Resources </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> üìù Cheat Sheets </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> üìù Cheat Sheets </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Cheat-Sheets/Django/ class=md-nav__link> <span class=md-ellipsis> Django </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Flask/ class=md-nav__link> <span class=md-ellipsis> Flask </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Hypothesis-Tests/ class=md-nav__link> <span class=md-ellipsis> Hypothesis Tests </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Keras/ class=md-nav__link> <span class=md-ellipsis> Keras </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/LangChain-LangGraph/ class=md-nav__link> <span class=md-ellipsis> LangChain & LangGraph </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/NumPy/ class=md-nav__link> <span class=md-ellipsis> NumPy </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Pandas/ class=md-nav__link> <span class=md-ellipsis> Pandas </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/PySpark/ class=md-nav__link> <span class=md-ellipsis> PySpark </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/PyTorch/ class=md-nav__link> <span class=md-ellipsis> PyTorch </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Python/ class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/RegEx/ class=md-nav__link> <span class=md-ellipsis> Regular Expressions (RegEx) </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/Sk-learn/ class=md-nav__link> <span class=md-ellipsis> Scikit Learn </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/SQL/ class=md-nav__link> <span class=md-ellipsis> SQL </span> </a> </li> <li class=md-nav__item> <a href=../../Cheat-Sheets/tensorflow/ class=md-nav__link> <span class=md-ellipsis> TensorFlow </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> ‚Äçüéì ML Topics </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> ‚Äçüéì ML Topics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Machine-Learning/ARIMA/ class=md-nav__link> <span class=md-ellipsis> ARIMA </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Activation%20functions/ class=md-nav__link> <span class=md-ellipsis> Activation functions </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Collaborative%20Filtering/ class=md-nav__link> <span class=md-ellipsis> Collaborative Filtering </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Confusion%20Matrix/ class=md-nav__link> <span class=md-ellipsis> Confusion Matrix </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/DBSCAN/ class=md-nav__link> <span class=md-ellipsis> DBSCAN </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Decision%20Trees/ class=md-nav__link> <span class=md-ellipsis> Decision Trees </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Gradient%20Boosting/ class=md-nav__link> <span class=md-ellipsis> Gradient Boosting </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/K-means%20clustering/ class=md-nav__link> <span class=md-ellipsis> K-means clustering </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Linear%20Regression/ class=md-nav__link> <span class=md-ellipsis> Linear Regression </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Logistic%20Regression/ class=md-nav__link> <span class=md-ellipsis> Logistic Regression </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Loss%20Function%20MAE%2C%20RMSE/ class=md-nav__link> <span class=md-ellipsis> Loss Function MAE, RMSE </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Neural%20Networks/ class=md-nav__link> <span class=md-ellipsis> Neural Networks </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Normal%20Distribution/ class=md-nav__link> <span class=md-ellipsis> Normal Distribution </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Normalization%20Regularisation/ class=md-nav__link> <span class=md-ellipsis> Normalization Regularisation </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Overfitting%2C%20Underfitting/ class=md-nav__link> <span class=md-ellipsis> Overfitting, Underfitting </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/PCA/ class=md-nav__link> <span class=md-ellipsis> PCA </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Random%20Forest/ class=md-nav__link> <span class=md-ellipsis> Random Forest </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Support%20Vector%20Machines/ class=md-nav__link> <span class=md-ellipsis> Support Vector Machines </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/Unbalanced%2C%20Skewed%20data/ class=md-nav__link> <span class=md-ellipsis> Unbalanced, Skewed data </span> </a> </li> <li class=md-nav__item> <a href=../../Machine-Learning/kNN/ class=md-nav__link> <span class=md-ellipsis> kNN </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> üë®üèæ‚Äçüíª Online Resources </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> üë®üèæ‚Äçüíª Online Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Online-Material/Online-Material-for-Learning/ class=md-nav__link> <span class=md-ellipsis> Online Study Material </span> </a> </li> <li class=md-nav__item> <a href=../../Online-Material/popular-resources/ class=md-nav__link> <span class=md-ellipsis> Popular Blogs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../Contribute/ class=md-nav__link> <span class=md-ellipsis> ü§ù Contribute </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#premium-interview-questions class=md-nav__link> <span class=md-ellipsis> Premium Interview Questions </span> </a> <nav class=md-nav aria-label="Premium Interview Questions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#explain-loc-vs-iloc-key-difference-google-amazon-meta-interview-question class=md-nav__link> <span class=md-ellipsis> Explain loc vs iloc - Key Difference - Google, Amazon, Meta Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#production-code-130-lines class=md-nav__link> <span class=md-ellipsis> Production Code (130 lines) </span> </a> </li> <li class=md-nav__item> <a href=#when-to-use-which class=md-nav__link> <span class=md-ellipsis> When to Use Which </span> </a> </li> <li class=md-nav__item> <a href=#real-world-performance class=md-nav__link> <span class=md-ellipsis> Real-World Performance </span> </a> <nav class=md-nav aria-label="Real-World Performance"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-do-you-handle-missing-values-in-pandas-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How Do You Handle Missing Values in Pandas? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-groupby-in-pandas-split-apply-combine-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain GroupBy in Pandas - Split-Apply-Combine - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#difference-between-merge-join-and-concat-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Difference Between merge(), join(), and concat() - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-apply-functions-to-dataframes-apply-map-applymap-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Apply Functions to DataFrames? apply(), map(), applymap() - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-optimize-memory-usage-in-pandas-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Optimize Memory Usage in Pandas? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-handle-large-datasets-that-dont-fit-in-memory-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Handle Large Datasets That Don't Fit in Memory? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pivot-tables-in-pandas-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pivot Tables in Pandas - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-work-with-datetime-data-in-pandas-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Work with DateTime Data in Pandas? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#what-is-settingwithcopywarning-and-how-to-avoid-it-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> What is SettingWithCopyWarning and How to Avoid It? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-rolling-windows-for-time-series-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use Rolling Windows for Time Series? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-efficiently-use-query-and-eval-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Efficiently Use Query and Eval? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-work-with-string-data-in-pandas-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Work with String Data in Pandas? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#difference-between-transform-and-apply-in-groupby-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Difference Between transform() and apply() in GroupBy - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-create-bins-and-categories-with-cut-and-qcut-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Create Bins and Categories with cut() and qcut()? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-handle-categorical-data-efficiently-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Handle Categorical Data Efficiently? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-multiindex-hierarchical-indexing-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use MultiIndex (Hierarchical Indexing)? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-profile-and-optimize-pandas-performance-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Profile and Optimize Pandas Performance? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-melt-for-unpivoting-data-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use melt() for Unpivoting Data? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-stack-and-unstack-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use stack() and unstack()? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-cross-tabulate-with-crosstab-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Cross-Tabulate with crosstab()? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-explode-for-list-columns-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use explode() for List Columns? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-handle-json-with-nested-structures-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How to Handle JSON with Nested Structures? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-method-chaining-for-clean-code-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use Method Chaining for Clean Code? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-readwrite-parquet-files-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Read/Write Parquet Files? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-assign-for-creating-new-columns-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use assign() for Creating New Columns? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-calculate-percentage-change-and-cumulative-stats-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Calculate Percentage Change and Cumulative Stats? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-shift-and-lag-data-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Shift and Lag Data? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-sample-data-from-dataframe-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Sample Data from DataFrame? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-detect-and-handle-outliers-google-amazon-meta-interview-question class=md-nav__link> <span class=md-ellipsis> How to Detect and Handle Outliers? - Google, Amazon, Meta Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-normalize-and-standardize-data-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Normalize and Standardize Data? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-where-and-mask-methods-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use where() and mask() Methods? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-rank-values-in-pandas-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Rank Values in Pandas? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-find-firstlast-n-rows-per-group-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Find First/Last N Rows Per Group? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-nsmallest-and-nlargest-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use nsmallest() and nlargest()? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-calculate-weighted-average-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Calculate Weighted Average? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-perform-window-functions-like-sql-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Perform Window Functions Like SQL? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-compare-two-dataframes-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> How to Compare Two DataFrames? - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-handle-settingwithcopywarning-properly-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Handle SettingWithCopyWarning Properly? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-sparse-data-structures-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use Sparse Data Structures? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-custom-aggregation-functions-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Implement Custom Aggregation Functions? - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-perform-asof-joins-nearest-key-join-google-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Perform Asof Joins (Nearest Key Join)? - Google, Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-calculate-cohort-metrics-meta-netflix-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Calculate Cohort Metrics? - Meta, Netflix, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-implement-ab-test-analysis-in-pandas-meta-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> How to Implement A/B Test Analysis in Pandas? - Meta, Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-copy-on-write-cow-in-pandas-20-google-meta-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use Copy-on-Write (CoW) in Pandas 2.0+? - Google, Meta Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#how-to-use-pyarrow-backend-for-better-performance-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> How to Use PyArrow Backend for Better Performance? - Google, Amazon Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#quick-reference-127-interview-questions class=md-nav__link> <span class=md-ellipsis> Quick Reference: 127+ Interview Questions </span> </a> </li> <li class=md-nav__item> <a href=#code-examples class=md-nav__link> <span class=md-ellipsis> Code Examples </span> </a> <nav class=md-nav aria-label="Code Examples"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-memory-optimization class=md-nav__link> <span class=md-ellipsis> 1. Memory Optimization </span> </a> </li> <li class=md-nav__item> <a href=#2-method-chaining-for-clean-code class=md-nav__link> <span class=md-ellipsis> 2. Method Chaining for Clean Code </span> </a> </li> <li class=md-nav__item> <a href=#3-parallel-processing-with-swifter class=md-nav__link> <span class=md-ellipsis> 3. Parallel Processing with Swifter </span> </a> </li> <li class=md-nav__item> <a href=#explain-multiindex-in-pandas-google-meta-interview-question class=md-nav__link> <span class=md-ellipsis> Explain MultiIndex in Pandas - Google, Meta Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdmerge-parameters-amazon-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.merge() Parameters - Amazon, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-apply-vs-map-vs-applymap-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain apply() vs map() vs applymap() - Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdcut-vs-pdqcut-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.cut() vs pd.qcut() - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-categorical-data-type-meta-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Categorical Data Type - Meta, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-window-functions-rolling-expanding-ewma-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Window Functions (Rolling, Expanding, EWMA) - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-dataframe-indexing-loc-vs-iloc-vs-at-vs-iat-microsoft-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain DataFrame Indexing (.loc vs .iloc vs .at vs .iat) - Microsoft, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdconcat-vs-pdmerge-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.concat() vs pd.merge() - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-groupby-aggregation-functions-google-meta-interview-question class=md-nav__link> <span class=md-ellipsis> Explain GroupBy Aggregation Functions - Google, Meta Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-query-method-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Query Method - Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-memory-usage-optimization-netflix-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Memory Usage Optimization - Netflix, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-eval-method-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Eval Method - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-time-series-resampling-meta-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Time Series Resampling - Meta, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-pivot-tables-microsoft-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Pivot Tables - Microsoft, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdmelt-google-meta-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.melt() - Google, Meta Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdcrosstab-amazon-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.crosstab() - Amazon, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdget_dummies-for-one-hot-encoding-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.get_dummies() for One-Hot Encoding - Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-settingwithcopywarning-meta-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain SettingWithCopyWarning - Meta, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-string-methods-str-accessor-amazon-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas String Methods (.str accessor) - Amazon, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdexplode-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.explode() - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-pipe-method-meta-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Pipe Method - Meta, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdjson_normalize-amazon-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.json_normalize() - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdto_datetime-options-microsoft-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.to_datetime() Options - Microsoft, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdread_csv-optimization-google-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.read_csv() Optimization - Google, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-style-for-formatting-meta-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Style for Formatting - Meta, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-merge-indicators-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Merge Indicators - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-dataframewhere-and-mask-meta-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> Explain DataFrame.where() and mask() - Meta, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-nlargest-and-nsmallest-amazon-netflix-interview-question class=md-nav__link> <span class=md-ellipsis> Explain nlargest() and nsmallest() - Amazon, Netflix Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-rank-method-microsoft-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas rank() Method - Microsoft, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdcut-vs-pdqcut-amazon-google-interview-question_1 class=md-nav__link> <span class=md-ellipsis> Explain pd.cut() vs pd.qcut() - Amazon, Google Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-cumsum-cumprod-cummax-cummin-meta-microsoft-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas cumsum(), cumprod(), cummax(), cummin() - Meta, Microsoft Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pdconcat-axis-parameter-google-amazon-interview-question class=md-nav__link> <span class=md-ellipsis> Explain pd.concat() axis Parameter - Google, Amazon Interview Question </span> </a> </li> <li class=md-nav__item> <a href=#explain-pandas-sparse-data-structures-netflix-google-interview-question class=md-nav__link> <span class=md-ellipsis> Explain Pandas Sparse Data Structures - Netflix, Google Interview Question </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#questions-asked-in-google-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in Google interview </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-amazon-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in Amazon interview </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-meta-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in Meta interview </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-microsoft-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in Microsoft interview </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-netflix-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in Netflix interview </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-apple-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in Apple interview </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-flipkart-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in Flipkart interview </span> </a> </li> <li class=md-nav__item> <a href=#questions-asked-in-linkedin-interview class=md-nav__link> <span class=md-ellipsis> Questions asked in LinkedIn interview </span> </a> </li> <li class=md-nav__item> <a href=#additional-resources class=md-nav__link> <span class=md-ellipsis> Additional Resources </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/singhsidhukuldeep/singhsidhukuldeep.github.io/edit/master/docs/Interview-Questions/Pandas.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/singhsidhukuldeep/singhsidhukuldeep.github.io/raw/master/docs/Interview-Questions/Pandas.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1 id=pandas-interview-questions>Pandas Interview Questions</h1> <!-- [TOC] --> <p>This document provides a curated list of Pandas interview questions commonly asked in technical interviews for Data Science, Data Analysis, Machine Learning, and Python Developer roles. It covers fundamental concepts to advanced data manipulation techniques, including rigorous "brutally difficult" questions for senior roles.</p> <p>This is updated frequently but right now this is the most exhaustive list of type of questions being asked.</p> <hr> <h2 id=premium-interview-questions>Premium Interview Questions</h2> <h3 id=explain-loc-vs-iloc-key-difference-google-amazon-meta-interview-question>Explain loc vs iloc - Key Difference - Google, Amazon, Meta Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Indexing</code>, <code>Selection</code>, <code>Core</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Apple, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>loc:</strong> Label-based indexing (uses row/column names). <strong>iloc:</strong> Integer position-based (uses 0, 1, 2...). <strong>Key difference:</strong> loc is <strong>inclusive</strong>, iloc is <strong>exclusive</strong> on end of slice.</p> <p><strong>Real-World:</strong> Netflix uses loc for time-series data (datetime index), iloc for positional slicing in ETL pipelines.</p> <table> <thead> <tr> <th>Method</th> <th>Indexing Type</th> <th>Slicing Behavior</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>loc</strong></td> <td>Label-based</td> <td><strong>Inclusive</strong> end</td> <td>Named rows/cols, datetime index, boolean filtering</td> </tr> <tr> <td><strong>iloc</strong></td> <td>Integer position</td> <td><strong>Exclusive</strong> end</td> <td>First N rows, every Nth row, CSV-like access</td> </tr> <tr> <td><strong>at</strong></td> <td>Label (scalar)</td> <td>Single value</td> <td>Fastest for single cell (10√ó faster)</td> </tr> <tr> <td><strong>iat</strong></td> <td>Position (scalar)</td> <td>Single value</td> <td>Fastest for position-based access</td> </tr> </tbody> </table> <h2 id=production-code-130-lines>Production Code (130 lines)</h2> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># Sample DataFrame</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>,</span> <span class=s1>&#39;David&#39;</span><span class=p>,</span> <span class=s1>&#39;Eve&#39;</span><span class=p>],</span>
    <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>25</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>28</span><span class=p>,</span> <span class=mi>32</span><span class=p>],</span>
    <span class=s1>&#39;salary&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>50000</span><span class=p>,</span> <span class=mi>60000</span><span class=p>,</span> <span class=mi>70000</span><span class=p>,</span> <span class=mi>55000</span><span class=p>,</span> <span class=mi>65000</span><span class=p>],</span>
    <span class=s1>&#39;city&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;NY&#39;</span><span class=p>,</span> <span class=s1>&#39;LA&#39;</span><span class=p>,</span> <span class=s1>&#39;SF&#39;</span><span class=p>,</span> <span class=s1>&#39;NY&#39;</span><span class=p>,</span> <span class=s1>&#39;LA&#39;</span><span class=p>]</span>
<span class=p>},</span> <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;emp_001&#39;</span><span class=p>,</span> <span class=s1>&#39;emp_002&#39;</span><span class=p>,</span> <span class=s1>&#39;emp_003&#39;</span><span class=p>,</span> <span class=s1>&#39;emp_004&#39;</span><span class=p>,</span> <span class=s1>&#39;emp_005&#39;</span><span class=p>])</span>

<span class=c1># ===== loc (Label-based) =====</span>
<span class=c1># Single cell</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;emp_001&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>])</span>  <span class=c1># &#39;Alice&#39;</span>

<span class=c1># Multiple rows/cols</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;emp_001&#39;</span><span class=p>:</span><span class=s1>&#39;emp_003&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span><span class=s1>&#39;salary&#39;</span><span class=p>])</span>
<span class=c1># IMPORTANT: &#39;emp_003&#39; IS INCLUDED (inclusive slicing)</span>

<span class=c1># Boolean filtering (VERY COMMON in production)</span>
<span class=n>high_earners</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;salary&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>60000</span><span class=p>]</span>
<span class=nb>print</span><span class=p>(</span><span class=n>high_earners</span><span class=p>)</span>

<span class=c1># Multiple conditions</span>
<span class=n>ny_high_earners</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;city&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;NY&#39;</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;salary&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>50000</span><span class=p>)]</span>

<span class=c1># ===== iloc (Integer position) =====</span>
<span class=c1># Single cell</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span>  <span class=c1># &#39;Alice&#39; (first row, first col)</span>

<span class=c1># Multiple rows/cols</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>])</span>  <span class=c1># First 3 rows, first 2 cols</span>
<span class=c1># IMPORTANT: Row 3 is EXCLUDED (0, 1, 2 only)</span>

<span class=c1># Every Nth row (common in sampling)</span>
<span class=n>every_2nd_row</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[::</span><span class=mi>2</span><span class=p>]</span>  <span class=c1># Rows 0, 2, 4</span>

<span class=c1># Last N rows</span>
<span class=n>last_3_rows</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>3</span><span class=p>:]</span>

<span class=c1># ===== at/iat (Scalar access - FASTEST) =====</span>
<span class=c1># 10√ó faster for single cell than loc/iloc</span>
<span class=n>name</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>at</span><span class=p>[</span><span class=s1>&#39;emp_001&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>]</span>  <span class=c1># Use at for labels</span>
<span class=n>age</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>iat</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>                <span class=c1># Use iat for positions</span>

<span class=c1># ===== Common Mistakes =====</span>
<span class=c1># ‚ùå WRONG: Using loc with integer on non-integer index</span>
<span class=k>try</span><span class=p>:</span>
    <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>  <span class=c1># KeyError! Index is [&#39;emp_001&#39;, &#39;emp_002&#39;, ...]</span>
<span class=k>except</span> <span class=ne>KeyError</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Error: loc expects labels, not positions&quot;</span><span class=p>)</span>

<span class=c1># ‚úÖ CORRECT</span>
<span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>  <span class=c1># Always works</span>

<span class=c1># ‚ùå WRONG: Assuming iloc is inclusive like loc</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>])</span>  <span class=c1># Only rows 0, 1 (NOT 0, 1, 2)</span>

<span class=c1># ‚úÖ CORRECT: Use loc for inclusive slicing</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;emp_001&#39;</span><span class=p>:</span><span class=s1>&#39;emp_002&#39;</span><span class=p>])</span>  <span class=c1># Includes both endpoints</span>
</code></pre></div> <h2 id=when-to-use-which>When to Use Which</h2> <table> <thead> <tr> <th>Scenario</th> <th>Use</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>Named index (datetime, strings)</strong></td> <td>loc</td> <td><code>df.loc['2024-01-01':'2024-12-31']</code></td> </tr> <tr> <td><strong>First N rows</strong></td> <td>iloc</td> <td><code>df.iloc[:100]</code></td> </tr> <tr> <td><strong>Boolean filtering</strong></td> <td>loc</td> <td><code>df.loc[df['age'] &gt; 30]</code></td> </tr> <tr> <td><strong>CSV-like access (row 5, col 3)</strong></td> <td>iloc</td> <td><code>df.iloc[5, 3]</code></td> </tr> <tr> <td><strong>Single cell (performance critical)</strong></td> <td>at/iat</td> <td><code>df.at['row', 'col']</code></td> </tr> </tbody> </table> <h2 id=real-world-performance>Real-World Performance</h2> <table> <thead> <tr> <th>Company</th> <th>Use Case</th> <th>Method</th> <th>Why</th> </tr> </thead> <tbody> <tr> <td><strong>Netflix</strong></td> <td>Time-series (datetime index)</td> <td>loc</td> <td><code>df.loc['2024-01-01':'2024-01-31']</code></td> </tr> <tr> <td><strong>Airbnb</strong></td> <td>First 1000 listings (pagination)</td> <td>iloc</td> <td><code>df.iloc[:1000]</code></td> </tr> <tr> <td><strong>Uber</strong></td> <td>High-frequency trading (1M+ ops/sec)</td> <td>at/iat</td> <td>10√ó faster for scalar access</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>loc is inclusive, iloc is exclusive</strong> (classic gotcha!)</li> <li>Uses <strong>at/iat for scalar access</strong> (10√ó faster than loc/iloc)</li> <li>Mentions <strong>boolean filtering with loc</strong> (most common production use)</li> <li>Avoids <strong>loc with integers on non-integer index</strong> (KeyError)</li> <li>Real-world: <strong>Netflix uses loc for datetime slicing in recommendation ETL</strong></li> </ul> </div> </details> <hr> <h3 id=how-do-you-handle-missing-values-in-pandas-google-amazon-netflix-interview-question>How Do You Handle Missing Values in Pandas? - Google, Amazon, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Missing Data</code>, <code>Data Cleaning</code>, <code>fillna</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix, Apple</p> <details class=success> <summary>View Answer</summary> <p><strong>Detecting Missing Values:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>,</span> <span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=s1>&#39;z&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Detection</span>
<span class=n>df</span><span class=o>.</span><span class=n>isnull</span><span class=p>()</span>              <span class=c1># Boolean mask</span>
<span class=n>df</span><span class=o>.</span><span class=n>isnull</span><span class=p>()</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>        <span class=c1># Count per column</span>
<span class=n>df</span><span class=o>.</span><span class=n>isnull</span><span class=p>()</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>  <span class=c1># Total count</span>
<span class=n>df</span><span class=o>.</span><span class=n>isna</span><span class=p>()</span><span class=o>.</span><span class=n>any</span><span class=p>()</span>          <span class=c1># Any missing per column</span>
</code></pre></div> <p><strong>Handling Strategies:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># 1. Drop rows with any missing</span>
<span class=n>df</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>

<span class=c1># 2. Drop rows where specific columns are missing</span>
<span class=n>df</span><span class=o>.</span><span class=n>dropna</span><span class=p>(</span><span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>])</span>

<span class=c1># 3. Drop only if all values missing</span>
<span class=n>df</span><span class=o>.</span><span class=n>dropna</span><span class=p>(</span><span class=n>how</span><span class=o>=</span><span class=s1>&#39;all&#39;</span><span class=p>)</span>

<span class=c1># 4. Fill with constant</span>
<span class=n>df</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<span class=n>df</span><span class=o>.</span><span class=n>fillna</span><span class=p>({</span><span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=s1>&#39;unknown&#39;</span><span class=p>})</span>

<span class=c1># 5. Fill with statistics</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>median</span><span class=p>())</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mode</span><span class=p>()[</span><span class=mi>0</span><span class=p>])</span>

<span class=c1># 6. Forward/backward fill (time series)</span>
<span class=n>df</span><span class=o>.</span><span class=n>ffill</span><span class=p>()</span>  <span class=c1># Forward fill</span>
<span class=n>df</span><span class=o>.</span><span class=n>bfill</span><span class=p>()</span>  <span class=c1># Backward fill</span>

<span class=c1># 7. Interpolation</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>interpolate</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s1>&#39;linear&#39;</span><span class=p>)</span>
</code></pre></div> <p><strong>Strategy Selection:</strong></p> <table> <thead> <tr> <th>Scenario</th> <th>Strategy</th> <th>When to Use</th> </tr> </thead> <tbody> <tr> <td><strong>&lt; 5% missing</strong></td> <td>Drop rows (<code>dropna()</code>)</td> <td>Minimal data loss</td> </tr> <tr> <td><strong>Numeric, random</strong></td> <td>Mean/median (<code>fillna</code>)</td> <td>MCAR (missing completely at random)</td> </tr> <tr> <td><strong>Time series</strong></td> <td>Forward/backward fill (<code>ffill/bfill</code>)</td> <td>Sequential data</td> </tr> <tr> <td><strong>Categorical</strong></td> <td>Mode or 'Unknown'</td> <td>Preserves categories</td> </tr> <tr> <td><strong>&gt; 50% missing</strong></td> <td>Drop column</td> <td>Too much missing data</td> </tr> </tbody> </table> <p><strong>Real-World:</strong> - <strong>Airbnb:</strong> Uses median for price (robust to outliers), mode for amenities - <strong>Netflix:</strong> Forward fill for user viewing history (time-series) - <strong>Uber:</strong> Drops rows with missing trip_id (&lt; 1% of data)</p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Chooses <strong>strategy by data type</strong> (mean for numeric, mode for categorical)</li> <li>Uses <strong>ffill for time-series</strong> (preserves temporal patterns)</li> <li>Knows <strong>dropna vs fillna tradeoffs</strong> (&lt; 5% missing ‚Üí drop, &gt; 5% ‚Üí fill)</li> <li>Checks <strong>missingness pattern</strong> (MCAR vs MAR vs MNAR)</li> <li>Real-world: <strong>Airbnb fills missing amenities with 'Not Available' (preserves info)</strong></li> </ul> </div> </details> <hr> <h3 id=explain-groupby-in-pandas-split-apply-combine-google-amazon-interview-question>Explain GroupBy in Pandas - Split-Apply-Combine - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>GroupBy</code>, <code>Aggregation</code>, <code>Split-Apply-Combine</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix, Apple</p> <details class=success> <summary>View Answer</summary> <p><strong>GroupBy Concept:</strong></p> <ol> <li><strong>Split</strong>: Divide data into groups</li> <li><strong>Apply</strong>: Apply function to each group</li> <li><strong>Combine</strong>: Combine results</li> </ol> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>],</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=s1>&#39;x&#39;</span><span class=p>],</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>250</span><span class=p>,</span> <span class=mi>120</span><span class=p>],</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>12</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Basic groupby</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>

<span class=c1># Multiple columns</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=s1>&#39;category&#39;</span><span class=p>,</span> <span class=s1>&#39;product&#39;</span><span class=p>])[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>

<span class=c1># Multiple aggregations</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>({</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>],</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=s1>&#39;sum&#39;</span>
<span class=p>})</span>

<span class=c1># Named aggregations (cleaner output)</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>(</span>
    <span class=n>total_sales</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;sum&#39;</span><span class=p>),</span>
    <span class=n>avg_sales</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>),</span>
    <span class=n>order_count</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>)</span>
<span class=p>)</span>

<span class=c1># Custom functions</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>min</span><span class=p>())</span>
</code></pre></div> <p><strong>Transform vs Apply:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Transform: returns same shape (broadcast back)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_normalized&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span>
    <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span> <span class=o>/</span> <span class=n>x</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
<span class=p>)</span>

<span class=c1># Apply: returns any shape</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>g</span><span class=p>:</span> <span class=n>g</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;sales&#39;</span><span class=p>))</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Explains <strong>split-apply-combine</strong> pattern clearly</li> <li>Uses <strong>named aggregations</strong> (<code>agg(total_sales=('sales', 'sum'))</code> - cleaner output)</li> <li>Knows <strong>transform vs apply</strong> (transform keeps shape, apply reduces)</li> <li>Real-world: <strong>Netflix uses groupby for user engagement metrics (daily/weekly aggregations)</strong></li> </ul> </div> </details> <hr> <h3 id=difference-between-merge-join-and-concat-google-amazon-interview-question>Difference Between merge(), join(), and concat() - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Merging</code>, <code>Joining</code>, <code>Concatenation</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Comparison:</strong></p> <table> <thead> <tr> <th>Method</th> <th>Use Case</th> <th>Key Difference</th> </tr> </thead> <tbody> <tr> <td><code>merge()</code></td> <td>SQL-like joins on columns</td> <td>Column-based</td> </tr> <tr> <td><code>join()</code></td> <td>Join on index</td> <td>Index-based</td> </tr> <tr> <td><code>concat()</code></td> <td>Stack DataFrames</td> <td>No key matching</td> </tr> </tbody> </table> <p><strong>Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;key&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>],</span> <span class=s1>&#39;val1&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]})</span>
<span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;key&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;D&#39;</span><span class=p>],</span> <span class=s1>&#39;val2&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]})</span>

<span class=c1># MERGE - column-based joining</span>
<span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;key&#39;</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;inner&#39;</span><span class=p>)</span>  <span class=c1># Only A, B</span>
<span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;key&#39;</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;left&#39;</span><span class=p>)</span>   <span class=c1># Keep all from df1</span>
<span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;key&#39;</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>)</span>  <span class=c1># Keep all</span>
<span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>left_on</span><span class=o>=</span><span class=s1>&#39;key&#39;</span><span class=p>,</span> <span class=n>right_on</span><span class=o>=</span><span class=s1>&#39;key&#39;</span><span class=p>)</span>  <span class=c1># Different column names</span>

<span class=c1># JOIN - index-based (set index first)</span>
<span class=n>df1</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s1>&#39;key&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>df2</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s1>&#39;key&#39;</span><span class=p>))</span>

<span class=c1># CONCAT - stacking</span>
<span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>])</span>              <span class=c1># Vertical (default axis=0)</span>
<span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>      <span class=c1># Horizontal</span>
<span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>],</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>  <span class=c1># Reset index</span>
</code></pre></div> <p><strong>Join Types:</strong></p> <div class=highlight><pre><span></span><code>Inner: Only matching keys
Left:  All from left + matching from right
Right: All from right + matching from left
Outer: All from both (union)
</code></pre></div> <p><strong>Indicator for debugging:</strong></p> <div class=highlight><pre><span></span><code><span class=n>result</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;key&#39;</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span> <span class=n>indicator</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=c1># _merge column shows: &#39;left_only&#39;, &#39;right_only&#39;, &#39;both&#39;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Knows <strong>when to use each</strong>: merge (columns), join (index), concat (stacking)</li> <li>Explains <strong>join types</strong> (inner/left/right/outer) with use cases</li> <li>Uses <strong>indicator=True</strong> for debugging (shows merge source)</li> <li>Real-world: <strong>Uber merges trip data + driver data on driver_id (billions/day)</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-apply-functions-to-dataframes-apply-map-applymap-google-amazon-interview-question>How to Apply Functions to DataFrames? apply(), map(), applymap() - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Data Transformation</code>, <code>Functions</code> | <strong>Asked by:</strong> Google, Amazon, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>Method Comparison:</strong></p> <table> <thead> <tr> <th>Method</th> <th>Scope</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><code>apply()</code></td> <td>Row/Column</td> <td>Complex transformations</td> </tr> <tr> <td><code>map()</code></td> <td>Series only</td> <td>Element-wise mapping</td> </tr> <tr> <td><code>applymap()</code></td> <td>Element-wise</td> <td>Simple element ops (deprecated, use <code>map</code>)</td> </tr> </tbody> </table> <p><strong>Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span>
    <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=s1>&#39;y&#39;</span><span class=p>,</span> <span class=s1>&#39;z&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># apply() - works on columns or rows</span>
<span class=n>df</span><span class=p>[[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>)</span>           <span class=c1># Sum each column</span>
<span class=n>df</span><span class=p>[[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>   <span class=c1># Sum each row</span>
<span class=n>df</span><span class=p>[[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>min</span><span class=p>())</span>  <span class=c1># Custom function</span>

<span class=c1># map() - Series only, element-wise</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;C&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>map</span><span class=p>({</span><span class=s1>&#39;x&#39;</span><span class=p>:</span> <span class=s1>&#39;X&#39;</span><span class=p>,</span> <span class=s1>&#39;y&#39;</span><span class=p>:</span> <span class=s1>&#39;Y&#39;</span><span class=p>,</span> <span class=s1>&#39;z&#39;</span><span class=p>:</span> <span class=s1>&#39;Z&#39;</span><span class=p>})</span>  <span class=c1># Dictionary mapping</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span>                 <span class=c1># Lambda function</span>

<span class=c1># For DataFrames, use apply with axis</span>
<span class=n>df</span><span class=p>[[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span>  <span class=c1># Each column</span>

<span class=c1># In Pandas 2.1+, use map() instead of applymap()</span>
<span class=n>df</span><span class=p>[[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span>
</code></pre></div> <p><strong>Performance Tip:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># SLOW - apply with lambda</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span>

<span class=c1># FAST - vectorized operation</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>**</span> <span class=mi>2</span>

<span class=c1># Use apply only when vectorization isn&#39;t possible</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li><strong>Prefers vectorized operations</strong> (100√ó faster than apply)</li> <li>Knows <strong>applymap deprecated in Pandas 2.1+</strong> (use map instead)</li> <li>Uses <strong>map for Series, apply for DataFrame</strong></li> <li>Real-world: <strong>Airbnb vectorizes price calculations (10M+ listings, &lt;1s)</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-optimize-memory-usage-in-pandas-google-amazon-netflix-interview-question>How to Optimize Memory Usage in Pandas? - Google, Amazon, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Memory Optimization</code>, <code>Performance</code> | <strong>Asked by:</strong> Google, Amazon, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>Check Memory Usage:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;large_file.csv&#39;</span><span class=p>)</span>

<span class=c1># Memory per column</span>
<span class=n>df</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Total memory in MB</span>
<span class=n>df</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>
</code></pre></div> <p><strong>Optimization Techniques:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># 1. Use appropriate dtypes on read</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;file.csv&#39;</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=p>{</span>
    <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=s1>&#39;int32&#39;</span><span class=p>,</span>           <span class=c1># Instead of int64</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=s1>&#39;float32&#39;</span><span class=p>,</span>      <span class=c1># Instead of float64</span>
    <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=s1>&#39;category&#39;</span>   <span class=c1># Instead of object</span>
<span class=p>})</span>

<span class=c1># 2. Convert existing columns</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span>

<span class=c1># 3. Downcast numeric types</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;int_col&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_numeric</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;int_col&#39;</span><span class=p>],</span> <span class=n>downcast</span><span class=o>=</span><span class=s1>&#39;integer&#39;</span><span class=p>)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;float_col&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_numeric</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;float_col&#39;</span><span class=p>],</span> <span class=n>downcast</span><span class=o>=</span><span class=s1>&#39;float&#39;</span><span class=p>)</span>

<span class=c1># 4. Use sparse dtypes for mostly-empty columns</span>
<span class=n>sparse_col</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>arrays</span><span class=o>.</span><span class=n>SparseArray</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span>
</code></pre></div> <p><strong>Memory Reduction Example:</strong></p> <div class=highlight><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>reduce_memory</span><span class=p>(</span><span class=n>df</span><span class=p>):</span>
    <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
        <span class=n>col_type</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>dtype</span>

        <span class=k>if</span> <span class=n>col_type</span> <span class=o>==</span> <span class=s1>&#39;object&#39;</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>df</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>nunique</span><span class=p>()</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mf>0.5</span><span class=p>:</span>  <span class=c1># Low cardinality</span>
                <span class=n>df</span><span class=p>[</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span>

        <span class=k>elif</span> <span class=n>col_type</span> <span class=o>==</span> <span class=s1>&#39;int64&#39;</span><span class=p>:</span>
            <span class=n>df</span><span class=p>[</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_numeric</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=n>col</span><span class=p>],</span> <span class=n>downcast</span><span class=o>=</span><span class=s1>&#39;integer&#39;</span><span class=p>)</span>

        <span class=k>elif</span> <span class=n>col_type</span> <span class=o>==</span> <span class=s1>&#39;float64&#39;</span><span class=p>:</span>
            <span class=n>df</span><span class=p>[</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_numeric</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=n>col</span><span class=p>],</span> <span class=n>downcast</span><span class=o>=</span><span class=s1>&#39;float&#39;</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>df</span>
</code></pre></div> <p><strong>Savings:</strong></p> <table> <thead> <tr> <th>From</th> <th>To</th> <th>Reduction</th> </tr> </thead> <tbody> <tr> <td>int64</td> <td>int32</td> <td>50%</td> </tr> <tr> <td>float64</td> <td>float32</td> <td>50%</td> </tr> <tr> <td>object (strings)</td> <td>category</td> <td>90%+</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Uses <strong>category dtype for low-cardinality strings</strong> (90% memory reduction)</li> <li>Knows <strong>int64‚Üíint32, float64‚Üífloat32</strong> (50% reduction each)</li> <li>Checks <strong>memory_usage(deep=True)</strong> before/after optimization</li> <li>Real-world: <strong>Netflix reduced 50GB DataFrame to 5GB using category dtype</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-handle-large-datasets-that-dont-fit-in-memory-google-amazon-netflix-interview-question>How to Handle Large Datasets That Don't Fit in Memory? - Google, Amazon, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Large Data</code>, <code>Chunking</code>, <code>Performance</code> | <strong>Asked by:</strong> Google, Amazon, Netflix, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Chunked Processing:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=c1># Process file in chunks</span>
<span class=n>chunk_size</span> <span class=o>=</span> <span class=mi>100_000</span>
<span class=n>chunks</span> <span class=o>=</span> <span class=p>[]</span>

<span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;huge_file.csv&#39;</span><span class=p>,</span> <span class=n>chunksize</span><span class=o>=</span><span class=n>chunk_size</span><span class=p>):</span>
    <span class=c1># Process each chunk</span>
    <span class=n>processed</span> <span class=o>=</span> <span class=n>chunk</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
    <span class=n>chunks</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>processed</span><span class=p>)</span>

<span class=c1># Combine results</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span><span class=n>chunks</span><span class=p>)</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</code></pre></div> <p><strong>Use Efficient File Formats:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Parquet - columnar, compressed</span>
<span class=n>df</span><span class=o>.</span><span class=n>to_parquet</span><span class=p>(</span><span class=s1>&#39;data.parquet&#39;</span><span class=p>,</span> <span class=n>compression</span><span class=o>=</span><span class=s1>&#39;snappy&#39;</span><span class=p>)</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>(</span><span class=s1>&#39;data.parquet&#39;</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;col1&#39;</span><span class=p>,</span> <span class=s1>&#39;col2&#39;</span><span class=p>])</span>  <span class=c1># Read subset</span>

<span class=c1># Feather - fast read/write</span>
<span class=n>df</span><span class=o>.</span><span class=n>to_feather</span><span class=p>(</span><span class=s1>&#39;data.feather&#39;</span><span class=p>)</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_feather</span><span class=p>(</span><span class=s1>&#39;data.feather&#39;</span><span class=p>)</span>
</code></pre></div> <p><strong>Dask for Out-of-Core Computing:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>dask.dataframe</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>dd</span>

<span class=c1># Lazy loading - doesn&#39;t load into memory</span>
<span class=n>ddf</span> <span class=o>=</span> <span class=n>dd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;huge_file.csv&#39;</span><span class=p>)</span>

<span class=c1># Same Pandas API</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>ddf</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=o>.</span><span class=n>compute</span><span class=p>()</span>
</code></pre></div> <p><strong>PyArrow Backend (Pandas 2.0+):</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Use PyArrow for better memory efficiency</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;file.csv&#39;</span><span class=p>,</span> <span class=n>dtype_backend</span><span class=o>=</span><span class=s1>&#39;pyarrow&#39;</span><span class=p>)</span>

<span class=c1># Or convert existing</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>convert_dtypes</span><span class=p>(</span><span class=n>dtype_backend</span><span class=o>=</span><span class=s1>&#39;pyarrow&#39;</span><span class=p>)</span>
</code></pre></div> <p><strong>Comparison:</strong></p> <table> <thead> <tr> <th>Approach</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td>Chunking</td> <td>Simple aggregations</td> </tr> <tr> <td>Parquet</td> <td>Columnar queries</td> </tr> <tr> <td>Dask</td> <td>Complex operations</td> </tr> <tr> <td>Polars</td> <td>Speed-critical</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Uses <strong>chunksize</strong> for simple aggregations (100K-1M rows/chunk)</li> <li>Knows <strong>Parquet &gt; CSV</strong> (10√ó smaller, 100√ó faster column access)</li> <li>Mentions <strong>Dask for out-of-core</strong> (scales beyond RAM)</li> <li>Real-world: <strong>Uber processes 100TB+ trip data daily using Parquet + Dask</strong></li> </ul> </div> </details> <hr> <h3 id=explain-pivot-tables-in-pandas-amazon-google-interview-question>Explain Pivot Tables in Pandas - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Pivot Tables</code>, <code>Reshaping</code> | <strong>Asked by:</strong> Amazon, Google, Microsoft, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>pivot_table() - Flexible Reshaping:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;2023-01&#39;</span><span class=p>,</span> <span class=s1>&#39;2023-01&#39;</span><span class=p>,</span> <span class=s1>&#39;2023-02&#39;</span><span class=p>,</span> <span class=s1>&#39;2023-02&#39;</span><span class=p>],</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>],</span>
    <span class=s1>&#39;region&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;East&#39;</span><span class=p>,</span> <span class=s1>&#39;East&#39;</span><span class=p>,</span> <span class=s1>&#39;West&#39;</span><span class=p>,</span> <span class=s1>&#39;West&#39;</span><span class=p>],</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>250</span><span class=p>],</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>25</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Basic pivot table</span>
<span class=n>pt</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>df</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;date&#39;</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;product&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;sum&#39;</span>
<span class=p>)</span>

<span class=c1># Multiple aggregations</span>
<span class=n>pt</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>df</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;quantity&#39;</span><span class=p>],</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;date&#39;</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;product&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=s1>&#39;mean&#39;</span><span class=p>}</span>
<span class=p>)</span>

<span class=c1># With totals</span>
<span class=n>pt</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>df</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;date&#39;</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;product&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span>
    <span class=n>margins</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>margins_name</span><span class=o>=</span><span class=s1>&#39;Total&#39;</span>
<span class=p>)</span>
</code></pre></div> <p><strong>pivot() vs pivot_table():</strong></p> <table> <thead> <tr> <th></th> <th>pivot()</th> <th>pivot_table()</th> </tr> </thead> <tbody> <tr> <td>Duplicates</td> <td>Error</td> <td>Handles with aggfunc</td> </tr> <tr> <td>Aggregation</td> <td>No</td> <td>Yes</td> </tr> <tr> <td>Fill value</td> <td>No</td> <td>Yes</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><span class=c1># pivot() - simple reshape (no duplicates allowed)</span>
<span class=n>df</span><span class=o>.</span><span class=n>pivot</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=s1>&#39;date&#39;</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;product&#39;</span><span class=p>,</span> <span class=n>values</span><span class=o>=</span><span class=s1>&#39;sales&#39;</span><span class=p>)</span>

<span class=c1># pivot_table() - handles duplicates</span>
<span class=n>df</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=s1>&#39;date&#39;</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;product&#39;</span><span class=p>,</span> <span class=n>values</span><span class=o>=</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;mean&#39;</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Uses <strong>pivot_table() for aggregation</strong> (handles duplicates, pivot() errors)</li> <li>Knows <strong>margins=True</strong> for row/column totals</li> <li>Can <strong>reverse with melt()</strong> (unpivot)</li> <li>Real-world: <strong>Airbnb uses pivot_table for daily revenue reports by region</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-work-with-datetime-data-in-pandas-google-amazon-netflix-interview-question>How to Work with DateTime Data in Pandas? - Google, Amazon, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>DateTime</code>, <code>Time Series</code> | <strong>Asked by:</strong> Google, Amazon, Netflix, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Creating DateTime:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=c1># Parse strings to datetime</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;date_string&#39;</span><span class=p>])</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;date_string&#39;</span><span class=p>],</span> <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1>&#39;</span><span class=p>)</span>

<span class=c1># Create date range</span>
<span class=n>dates</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=n>start</span><span class=o>=</span><span class=s1>&#39;2023-01-01&#39;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39;2023-12-31&#39;</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>)</span>
<span class=n>dates</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=n>start</span><span class=o>=</span><span class=s1>&#39;2023-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;ME&#39;</span><span class=p>)</span>
</code></pre></div> <p><strong>DateTime Accessors (.dt):</strong></p> <div class=highlight><pre><span></span><code><span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>])</span>

<span class=c1># Extract components</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>year</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;month&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>month</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;day&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>day</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;dayofweek&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>dayofweek</span>  <span class=c1># 0=Monday</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;quarter&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>quarter</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;is_weekend&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>dayofweek</span> <span class=o>&gt;=</span> <span class=mi>5</span>

<span class=c1># Formatting</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;month_name&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>month_name</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;formatted&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y-%m&#39;</span><span class=p>)</span>
</code></pre></div> <p><strong>Time Zone Handling:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Localize (no timezone -&gt; timezone)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>tz_localize</span><span class=p>(</span><span class=s1>&#39;UTC&#39;</span><span class=p>)</span>

<span class=c1># Convert between timezones</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;date_est&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>tz_convert</span><span class=p>(</span><span class=s1>&#39;US/Eastern&#39;</span><span class=p>)</span>
</code></pre></div> <p><strong>Resampling:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Resample time series</span>
<span class=n>df</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s1>&#39;date&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;M&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>  <span class=c1># Monthly</span>
<span class=n>df</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s1>&#39;date&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;Q&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>  <span class=c1># Quarterly</span>
<span class=n>df</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s1>&#39;date&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;W&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>agg</span><span class=p>([</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>])</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Uses <strong>.dt accessor</strong> for datetime components (year, month, dayofweek)</li> <li>Handles <strong>timezones</strong> (tz_localize, tz_convert)</li> <li>Knows <strong>resample()</strong> for aggregation (D, W, M, Q, Y frequencies)</li> <li>Real-world: <strong>Netflix uses resample('D') for daily user engagement metrics</strong></li> </ul> </div> </details> <hr> <h3 id=what-is-settingwithcopywarning-and-how-to-avoid-it-google-amazon-interview-question>What is SettingWithCopyWarning and How to Avoid It? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Common Errors</code>, <code>Best Practices</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>The Problem:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]})</span>

<span class=c1># This triggers warning</span>
<span class=n>filtered</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>]</span>
<span class=n>filtered</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>  <span class=c1># Warning: setting on copy</span>
</code></pre></div> <p><strong>Why It Happens:</strong></p> <p>Pandas can't always tell if you're working with a view or a copy. Modifying a view might not update the original (or might unexpectedly).</p> <p><strong>Solutions:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Solution 1: Explicit copy</span>
<span class=n>filtered</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=n>filtered</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>  <span class=c1># Safe</span>

<span class=c1># Solution 2: Use .loc for assignment</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>  <span class=c1># Modifies original</span>

<span class=c1># Solution 3: Chain in one line</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>assign</span><span class=p>(</span><span class=n>B</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span>

<span class=c1># Pandas 2.0+ with Copy-on-Write</span>
<span class=n>pd</span><span class=o>.</span><span class=n>options</span><span class=o>.</span><span class=n>mode</span><span class=o>.</span><span class=n>copy_on_write</span> <span class=o>=</span> <span class=kc>True</span>
<span class=n>filtered</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>]</span>
<span class=n>filtered</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>  <span class=c1># Creates copy automatically</span>
</code></pre></div> <p><strong>Best Practices:</strong></p> <table> <thead> <tr> <th>Want to...</th> <th>Use</th> </tr> </thead> <tbody> <tr> <td>Modify original</td> <td><code>df.loc[condition, 'col'] = value</code></td> </tr> <tr> <td>Create new DataFrame</td> <td><code>df[condition].copy()</code></td> </tr> <tr> <td>Chain operations</td> <td><code>.assign()</code> method</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Explains <strong>view vs copy</strong> concept (chained indexing creates ambiguity)</li> <li>Uses <strong>.loc for in-place</strong> modification (safe)</li> <li>Uses <strong>.copy() when creating new</strong> DataFrame</li> <li>Knows <strong>Copy-on-Write in Pandas 2.0+</strong> (eliminates warning)</li> <li>Real-world: <strong>Google enforces .copy() in code reviews to avoid bugs</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-use-rolling-windows-for-time-series-google-amazon-netflix-interview-question>How to Use Rolling Windows for Time Series? - Google, Amazon, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Rolling Windows</code>, <code>Time Series</code>, <code>Finance</code> | <strong>Asked by:</strong> Google, Amazon, Netflix, Apple</p> <details class=success> <summary>View Answer</summary> <p><strong>Rolling Window Calculations:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2023-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>100</span><span class=p>),</span>
    <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span><span class=o>.</span><span class=n>cumsum</span><span class=p>()</span> <span class=o>+</span> <span class=mi>100</span>
<span class=p>})</span>
<span class=n>df</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s1>&#39;date&#39;</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Moving averages</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;MA_7&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;MA_30&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>30</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>

<span class=c1># Other statistics</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;rolling_std&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;rolling_max&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;rolling_sum&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>

<span class=c1># Minimum periods (handle NaN at start)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;MA_7_min3&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>7</span><span class=p>,</span> <span class=n>min_periods</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>

<span class=c1># Centered window</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;MA_centered&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>7</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</code></pre></div> <p><strong>Custom Rolling Functions:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Custom function with apply</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;rolling_range&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span>
    <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>min</span><span class=p>()</span>
<span class=p>)</span>

<span class=c1># Faster with raw=True (NumPy array)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;rolling_custom&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span>
    <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=mi>75</span><span class=p>),</span> <span class=n>raw</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>
</code></pre></div> <p><strong>Exponential Weighted Average:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># EMA - more weight to recent values</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;EMA_7&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>ewm</span><span class=p>(</span><span class=n>span</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;EMA_decay&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>ewm</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Uses <strong>min_periods</strong> for edge cases (avoids NaN at start)</li> <li>Knows <strong>ewm() for exponential weighting</strong> (more weight to recent)</li> <li>Uses <strong>raw=True for performance</strong> (NumPy array, 3√ó faster)</li> <li>Real-world: <strong>Trading firms use rolling(20).mean() for moving averages</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-efficiently-use-query-and-eval-google-amazon-interview-question>How to Efficiently Use Query and Eval? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Filtering</code>, <code>Query</code>, <code>Performance</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>query() - String-Based Filtering:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>],</span>
    <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>25</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>35</span><span class=p>],</span>
    <span class=s1>&#39;department&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Sales&#39;</span><span class=p>,</span> <span class=s1>&#39;IT&#39;</span><span class=p>,</span> <span class=s1>&#39;Sales&#39;</span><span class=p>],</span>
    <span class=s1>&#39;salary&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>50000</span><span class=p>,</span> <span class=mi>60000</span><span class=p>,</span> <span class=mi>55000</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Standard filtering (verbose)</span>
<span class=n>df</span><span class=p>[(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>25</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;department&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;Sales&#39;</span><span class=p>)]</span>

<span class=c1># query() - cleaner syntax</span>
<span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;age &gt; 25 and department == &quot;Sales&quot;&#39;</span><span class=p>)</span>

<span class=c1># Using variables with @</span>
<span class=n>min_age</span> <span class=o>=</span> <span class=mi>25</span>
<span class=n>dept</span> <span class=o>=</span> <span class=s1>&#39;Sales&#39;</span>
<span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;age &gt; @min_age and department == @dept&#39;</span><span class=p>)</span>

<span class=c1># Column names with spaces</span>
<span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;`Column Name` &gt; 10&#39;</span><span class=p>)</span>
</code></pre></div> <p><strong>eval() - Efficient Expression Evaluation:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Create new column without intermediate copies</span>
<span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;bonus = salary * 0.1&#39;</span><span class=p>)</span>

<span class=c1># Multiple expressions</span>
<span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;&#39;&#39;</span>
<span class=s1>    bonus = salary * 0.1</span>
<span class=s1>    total_comp = salary + bonus</span>
<span class=s1>    age_group = age // 10 * 10</span>
<span class=s1>&#39;&#39;&#39;</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Conditional expressions</span>
<span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;is_senior = age &gt;= 30&#39;</span><span class=p>)</span>
</code></pre></div> <p><strong>Performance:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># eval uses numexpr for large DataFrames</span>
<span class=c1># Faster for: large datasets, complex expressions</span>
<span class=c1># Similar for: small datasets, simple operations</span>

<span class=c1># Check if numexpr is available</span>
<span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=nb>print</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>get_option</span><span class=p>(</span><span class=s1>&#39;compute.use_numexpr&#39;</span><span class=p>))</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>Uses <strong>query() for readable filters</strong> (SQL-like syntax)</li> <li>Uses <strong>@ for variable interpolation</strong> (dynamic filters)</li> <li>Knows <strong>eval() faster for large data</strong> (uses numexpr, avoids copies)</li> <li>Real-world: <strong>Airbnb uses query() for dynamic filters in analytics dashboards</strong></li> </ul> </div> </details> <hr> <h3 id=how-to-work-with-string-data-in-pandas-google-amazon-interview-question>How to Work with String Data in Pandas? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>String Operations</code>, <code>Text Processing</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>String Accessor (.str):</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;John Smith&#39;</span><span class=p>,</span> <span class=s1>&#39;Jane Doe&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob Johnson&#39;</span><span class=p>],</span>
    <span class=s1>&#39;email&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;john@example.com&#39;</span><span class=p>,</span> <span class=s1>&#39;jane@test.com&#39;</span><span class=p>,</span> <span class=s1>&#39;bob@sample.org&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Case transformations</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>title</span><span class=p>()</span>

<span class=c1># String matching</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>contains</span><span class=p>(</span><span class=s1>&#39;John&#39;</span><span class=p>)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;J&#39;</span><span class=p>)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s1>&#39;.com&#39;</span><span class=p>)</span>

<span class=c1># Extraction</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;first_name&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)</span><span class=o>.</span><span class=n>str</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;domain&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>extract</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;@(\w+\.\w+)&#39;</span><span class=p>)</span>

<span class=c1># Replacement</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;John&#39;</span><span class=p>,</span> <span class=s1>&#39;Jonathan&#39;</span><span class=p>)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;@\w+&#39;</span><span class=p>,</span> <span class=s1>&#39;@company&#39;</span><span class=p>,</span> <span class=n>regex</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Length and padding</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>len</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>pad</span><span class=p>(</span><span class=n>width</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>side</span><span class=o>=</span><span class=s1>&#39;right&#39;</span><span class=p>,</span> <span class=n>fillchar</span><span class=o>=</span><span class=s1>&#39;.&#39;</span><span class=p>)</span>
</code></pre></div> <p><strong>Split and Expand:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Split into multiple columns</span>
<span class=n>df</span><span class=p>[[</span><span class=s1>&#39;first&#39;</span><span class=p>,</span> <span class=s1>&#39;last&#39;</span><span class=p>]]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span> <span class=n>expand</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Split into list (no expand)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;name_parts&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
</code></pre></div> <p><strong>Regular Expressions:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Extract groups</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;phone&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=s1>&#39;123-456-7890&#39;</span><span class=p>,</span> <span class=s1>&#39;987-654-3210&#39;</span><span class=p>])</span>
<span class=n>df</span><span class=p>[[</span><span class=s1>&#39;area&#39;</span><span class=p>,</span> <span class=s1>&#39;exchange&#39;</span><span class=p>,</span> <span class=s1>&#39;number&#39;</span><span class=p>]]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;phone&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>extract</span><span class=p>(</span>
    <span class=sa>r</span><span class=s1>&#39;(\d</span><span class=si>{3}</span><span class=s1>)-(\d</span><span class=si>{3}</span><span class=s1>)-(\d</span><span class=si>{4}</span><span class=s1>)&#39;</span>
<span class=p>)</span>

<span class=c1># Find all matches</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;numbers&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;phone&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;\d+&#39;</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Text data handling.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses .str accessor consistently</li> <li>Knows expand parameter for split</li> <li>Can write regex patterns</li> <li>Handles edge cases (NaN, empty)</li> </ul> </div> </details> <hr> <h3 id=difference-between-transform-and-apply-in-groupby-google-amazon-interview-question>Difference Between transform() and apply() in GroupBy - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>GroupBy</code>, <code>Data Transformation</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Key Difference:</strong></p> <table> <thead> <tr> <th>Method</th> <th>Output Shape</th> <th>Broadcast</th> </tr> </thead> <tbody> <tr> <td><code>transform()</code></td> <td>Same as input</td> <td>Yes</td> </tr> <tr> <td><code>apply()</code></td> <td>Any shape</td> <td>No</td> </tr> </tbody> </table> <p><strong>transform() - Broadcasts Back:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;group&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>],</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Normalize within groups</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;normalized&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;group&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span>
    <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span> <span class=o>/</span> <span class=n>x</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
<span class=p>)</span>

<span class=c1># Add group statistics as new column</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;group_mean&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;group&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=s1>&#39;mean&#39;</span><span class=p>)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;group_sum&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;group&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=s1>&#39;sum&#39;</span><span class=p>)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;pct_of_group&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;group&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=s1>&#39;sum&#39;</span><span class=p>)</span>

<span class=c1># Result: same number of rows as original</span>
</code></pre></div> <p><strong>apply() - Flexible Output:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Return aggregated result</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;group&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>sum</span><span class=p>())</span>

<span class=c1># Return different shape per group</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;group&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>g</span><span class=p>:</span> <span class=n>g</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;value&#39;</span><span class=p>))</span>

<span class=c1># Return multiple values per group</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;group&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>({</span>
    <span class=s1>&#39;mean&#39;</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>mean</span><span class=p>(),</span>
    <span class=s1>&#39;range&#39;</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>min</span><span class=p>()</span>
<span class=p>}))</span>
</code></pre></div> <p><strong>When to Use Each:</strong></p> <table> <thead> <tr> <th>Use Case</th> <th>Method</th> </tr> </thead> <tbody> <tr> <td>Add group stat as column</td> <td><code>transform()</code></td> </tr> <tr> <td>Normalize within groups</td> <td><code>transform()</code></td> </tr> <tr> <td>Filter/rank within groups</td> <td><code>transform()</code></td> </tr> <tr> <td>Custom aggregation</td> <td><code>apply()</code></td> </tr> <tr> <td>Return subset of rows</td> <td><code>apply()</code></td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> GroupBy internals.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Explains broadcast behavior</li> <li>Uses transform for normalization</li> <li>Knows performance difference</li> <li>Can implement ranking within groups</li> </ul> </div> </details> <hr> <h3 id=how-to-create-bins-and-categories-with-cut-and-qcut-google-amazon-interview-question>How to Create Bins and Categories with cut() and qcut()? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Discretization</code>, <code>Binning</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>cut() - Fixed-Width Bins:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>ages</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>5</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>55</span><span class=p>,</span> <span class=mi>65</span><span class=p>,</span> <span class=mi>75</span><span class=p>,</span> <span class=mi>85</span><span class=p>])</span>

<span class=c1># Explicit bin edges</span>
<span class=n>bins</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>65</span><span class=p>,</span> <span class=mi>100</span><span class=p>]</span>
<span class=n>labels</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Child&#39;</span><span class=p>,</span> <span class=s1>&#39;Young Adult&#39;</span><span class=p>,</span> <span class=s1>&#39;Adult&#39;</span><span class=p>,</span> <span class=s1>&#39;Middle Aged&#39;</span><span class=p>,</span> <span class=s1>&#39;Senior&#39;</span><span class=p>]</span>

<span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>ages</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=n>bins</span><span class=p>,</span> <span class=n>labels</span><span class=o>=</span><span class=n>labels</span><span class=p>)</span>

<span class=c1># Equal-width bins</span>
<span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>ages</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>  <span class=c1># 5 equal-width bins</span>

<span class=c1># Include lowest value</span>
<span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>ages</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=n>bins</span><span class=p>,</span> <span class=n>labels</span><span class=o>=</span><span class=n>labels</span><span class=p>,</span> <span class=n>include_lowest</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Return bin boundaries</span>
<span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>ages</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>retbins</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <p><strong>qcut() - Quantile-Based Bins:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Equal-sized bins (same number of items)</span>
<span class=n>values</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>100</span><span class=p>])</span>

<span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>values</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>  <span class=c1># Quartiles</span>
<span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>values</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>,</span> <span class=s1>&#39;Q3&#39;</span><span class=p>,</span> <span class=s1>&#39;Q4&#39;</span><span class=p>])</span>
<span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>values</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.25</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.75</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span>  <span class=c1># Custom quantiles</span>

<span class=c1># Handle duplicates</span>
<span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>values</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>duplicates</span><span class=o>=</span><span class=s1>&#39;drop&#39;</span><span class=p>)</span>
</code></pre></div> <p><strong>Comparison:</strong></p> <table> <thead> <tr> <th>Method</th> <th>Bin Size</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><code>cut()</code></td> <td>Fixed width</td> <td>Age groups, price ranges</td> </tr> <tr> <td><code>qcut()</code></td> <td>Equal count</td> <td>Percentiles, balanced groups</td> </tr> </tbody> </table> <p><strong>Example:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># cut: bins by value range</span>
<span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span> <span class=n>bins</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
<span class=c1># (0.9, 34], (0.9, 34], (0.9, 34], (34, 67], (67, 100]</span>

<span class=c1># qcut: bins by count</span>
<span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span> <span class=n>q</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
<span class=c1># (0.99, 7.5], (0.99, 7.5], (7.5, 30], (30, 100], (30, 100]</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Data discretization.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows when to use each method</li> <li>Uses meaningful labels</li> <li>Handles edge cases (duplicates)</li> <li>Explains equal-width vs equal-count</li> </ul> </div> </details> <hr> <h3 id=how-to-handle-categorical-data-efficiently-google-amazon-interview-question>How to Handle Categorical Data Efficiently? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Categorical Data</code>, <code>Memory</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>Creating Categorical:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=c1># Convert to categorical</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;active&#39;</span><span class=p>,</span> <span class=s1>&#39;inactive&#39;</span><span class=p>,</span> <span class=s1>&#39;active&#39;</span><span class=p>,</span> <span class=s1>&#39;pending&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>10000</span><span class=p>})</span>

<span class=c1># Memory before</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>())</span>  <span class=c1># ~360KB</span>

<span class=c1># Convert</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span>

<span class=c1># Memory after</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>())</span>  <span class=c1># ~40KB (90% reduction!)</span>
</code></pre></div> <p><strong>Ordered Categories:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>pandas.api.types</span><span class=w> </span><span class=kn>import</span> <span class=n>CategoricalDtype</span>

<span class=c1># Define ordered category</span>
<span class=n>size_type</span> <span class=o>=</span> <span class=n>CategoricalDtype</span><span class=p>(</span>
    <span class=n>categories</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;small&#39;</span><span class=p>,</span> <span class=s1>&#39;medium&#39;</span><span class=p>,</span> <span class=s1>&#39;large&#39;</span><span class=p>,</span> <span class=s1>&#39;xlarge&#39;</span><span class=p>],</span>
    <span class=n>ordered</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>

<span class=n>df</span><span class=p>[</span><span class=s1>&#39;size&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;size&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>size_type</span><span class=p>)</span>

<span class=c1># Now comparisons work</span>
<span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;size&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=s1>&#39;medium&#39;</span><span class=p>]</span>  <span class=c1># Returns &#39;large&#39; and &#39;xlarge&#39;</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;size&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>(),</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;size&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
</code></pre></div> <p><strong>get_dummies() for One-Hot Encoding:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># One-hot encoding</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;color&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=s1>&#39;green&#39;</span><span class=p>,</span> <span class=s1>&#39;red&#39;</span><span class=p>]})</span>

<span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;color&#39;</span><span class=p>])</span>
<span class=c1># Result: color_blue, color_green, color_red columns</span>

<span class=c1># Drop first to avoid multicollinearity</span>
<span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;color&#39;</span><span class=p>],</span> <span class=n>drop_first</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Prefix</span>
<span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;color&#39;</span><span class=p>],</span> <span class=n>prefix</span><span class=o>=</span><span class=s1>&#39;c&#39;</span><span class=p>)</span>
</code></pre></div> <p><strong>Category Operations:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Add/remove categories</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cat</span><span class=o>.</span><span class=n>add_categories</span><span class=p>([</span><span class=s1>&#39;new_status&#39;</span><span class=p>])</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cat</span><span class=o>.</span><span class=n>remove_unused_categories</span><span class=p>()</span>

<span class=c1># Rename categories</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cat</span><span class=o>.</span><span class=n>rename_categories</span><span class=p>({</span><span class=s1>&#39;active&#39;</span><span class=p>:</span> <span class=s1>&#39;ACTIVE&#39;</span><span class=p>})</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Efficient data handling.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses category for memory savings</li> <li>Knows ordered categories for comparisons</li> <li>Uses get_dummies for ML</li> <li>Understands when to use category type</li> </ul> </div> </details> <hr> <h3 id=how-to-use-multiindex-hierarchical-indexing-google-amazon-interview-question>How to Use MultiIndex (Hierarchical Indexing)? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>MultiIndex</code>, <code>Hierarchical Data</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Creating MultiIndex:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=c1># From tuples</span>
<span class=n>index</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>MultiIndex</span><span class=o>.</span><span class=n>from_tuples</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=mi>2021</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=mi>2022</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=mi>2021</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=mi>2022</span><span class=p>)</span>
<span class=p>],</span> <span class=n>names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>,</span> <span class=s1>&#39;year&#39;</span><span class=p>])</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>250</span><span class=p>]},</span> <span class=n>index</span><span class=o>=</span><span class=n>index</span><span class=p>)</span>

<span class=c1># From product (all combinations)</span>
<span class=n>index</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>MultiIndex</span><span class=o>.</span><span class=n>from_product</span><span class=p>(</span>
    <span class=p>[[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>],</span> <span class=p>[</span><span class=mi>2021</span><span class=p>,</span> <span class=mi>2022</span><span class=p>,</span> <span class=mi>2023</span><span class=p>]],</span>
    <span class=n>names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>,</span> <span class=s1>&#39;year&#39;</span><span class=p>]</span>
<span class=p>)</span>

<span class=c1># From GroupBy</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>],</span>
    <span class=s1>&#39;year&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>2021</span><span class=p>,</span> <span class=mi>2022</span><span class=p>,</span> <span class=mi>2021</span><span class=p>,</span> <span class=mi>2022</span><span class=p>],</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>250</span><span class=p>]</span>
<span class=p>})</span>
<span class=n>df_multi</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>set_index</span><span class=p>([</span><span class=s1>&#39;category&#39;</span><span class=p>,</span> <span class=s1>&#39;year&#39;</span><span class=p>])</span>
</code></pre></div> <p><strong>Selecting with MultiIndex:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Select outer level</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span>  <span class=c1># All years for category A</span>

<span class=c1># Select specific combination</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[(</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=mi>2021</span><span class=p>)]</span>

<span class=c1># Cross-section</span>
<span class=n>df</span><span class=o>.</span><span class=n>xs</span><span class=p>(</span><span class=mi>2021</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=s1>&#39;year&#39;</span><span class=p>)</span>  <span class=c1># All categories for 2021</span>

<span class=c1># Slice</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>:</span><span class=s1>&#39;B&#39;</span><span class=p>]</span>  <span class=c1># Range of outer index</span>
</code></pre></div> <p><strong>Flatten MultiIndex:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Reset to regular columns</span>
<span class=n>df</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>

<span class=c1># Flatten column MultiIndex</span>
<span class=n>df</span><span class=o>.</span><span class=n>columns</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;_&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>col</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>values</span><span class=p>]</span>
</code></pre></div> <p><strong>Stack/Unstack:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Wide to long (stack)</span>
<span class=n>df</span><span class=o>.</span><span class=n>stack</span><span class=p>()</span>

<span class=c1># Long to wide (unstack)</span>
<span class=n>df</span><span class=o>.</span><span class=n>unstack</span><span class=p>()</span>
<span class=n>df</span><span class=o>.</span><span class=n>unstack</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=s1>&#39;year&#39;</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Complex data structures.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Creates MultiIndex efficiently</li> <li>Uses xs for cross-sections</li> <li>Knows stack/unstack</li> <li>Can flatten when needed</li> </ul> </div> </details> <hr> <h3 id=how-to-profile-and-optimize-pandas-performance-google-amazon-netflix-interview-question>How to Profile and Optimize Pandas Performance? - Google, Amazon, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Performance</code>, <code>Profiling</code>, <code>Optimization</code> | <strong>Asked by:</strong> Google, Amazon, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>Profiling Tools:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>100000</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span>

<span class=c1># Time operations</span>
<span class=o>%</span><span class=n>timeit</span> <span class=n>df</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>

<span class=c1># Line-by-line profiling</span>
<span class=o>%</span><span class=n>lprun</span> <span class=o>-</span><span class=n>f</span> <span class=n>function_name</span> <span class=n>function_name</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># Memory profiling</span>
<span class=o>%</span><span class=n>memit</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</code></pre></div> <p><strong>Common Optimizations:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># 1. Avoid loops - use vectorization</span>
<span class=c1># SLOW</span>
<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>)):</span>
    <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=s1>&#39;new_col&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span>

<span class=c1># FAST</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;new_col&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span>

<span class=c1># 2. Use NumPy for complex operations</span>
<span class=c1># SLOW</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;result&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>row</span><span class=p>:</span> <span class=n>complex_function</span><span class=p>(</span><span class=n>row</span><span class=p>),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>

<span class=c1># FAST</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;result&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span><span class=p>,</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>3</span><span class=p>)</span>

<span class=c1># 3. Use categorical for strings</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span>

<span class=c1># 4. Read only needed columns</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;file.csv&#39;</span><span class=p>,</span> <span class=n>usecols</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;col1&#39;</span><span class=p>,</span> <span class=s1>&#39;col2&#39;</span><span class=p>])</span>

<span class=c1># 5. Use query() for complex filters</span>
<span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;A &gt; 0 and B &lt; 100&#39;</span><span class=p>)</span>  <span class=c1># Faster than boolean indexing</span>
</code></pre></div> <p><strong>Advanced Techniques:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Numba JIT compilation</span>
<span class=kn>from</span><span class=w> </span><span class=nn>numba</span><span class=w> </span><span class=kn>import</span> <span class=n>jit</span>

<span class=nd>@jit</span><span class=p>(</span><span class=n>nopython</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=k>def</span><span class=w> </span><span class=nf>fast_calculation</span><span class=p>(</span><span class=n>arr</span><span class=p>):</span>
    <span class=n>result</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>empty</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>arr</span><span class=p>))</span>
    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>arr</span><span class=p>)):</span>
        <span class=n>result</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>arr</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>**</span> <span class=mi>2</span> <span class=o>+</span> <span class=n>arr</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span>
    <span class=k>return</span> <span class=n>result</span>

<span class=n>df</span><span class=p>[</span><span class=s1>&#39;result&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>fast_calculation</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>)</span>

<span class=c1># Swifter for automatic parallelization</span>
<span class=kn>import</span><span class=w> </span><span class=nn>swifter</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;result&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>swifter</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>complex_function</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Production optimization skills.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Profiles before optimizing</li> <li>Prefers vectorization over loops</li> <li>Uses NumPy for speed</li> <li>Knows Numba/Swifter for edge cases</li> </ul> </div> </details> <hr> <h3 id=how-to-use-melt-for-unpivoting-data-google-amazon-interview-question>How to Use melt() for Unpivoting Data? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Reshaping</code>, <code>Unpivoting</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>melt() - Wide to Long Format:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=c1># Wide format</span>
<span class=n>df_wide</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>],</span>
    <span class=s1>&#39;2021_sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>],</span>
    <span class=s1>&#39;2022_sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>150</span><span class=p>,</span> <span class=mi>250</span><span class=p>],</span>
    <span class=s1>&#39;2023_sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>180</span><span class=p>,</span> <span class=mi>300</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Convert to long format</span>
<span class=n>df_long</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span>
    <span class=n>df_wide</span><span class=p>,</span>
    <span class=n>id_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>],</span>
    <span class=n>value_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;2021_sales&#39;</span><span class=p>,</span> <span class=s1>&#39;2022_sales&#39;</span><span class=p>,</span> <span class=s1>&#39;2023_sales&#39;</span><span class=p>],</span>
    <span class=n>var_name</span><span class=o>=</span><span class=s1>&#39;year&#39;</span><span class=p>,</span>
    <span class=n>value_name</span><span class=o>=</span><span class=s1>&#39;sales&#39;</span>
<span class=p>)</span>

<span class=c1># Result:</span>
<span class=c1>#    name        year  sales</span>
<span class=c1># 0  Alice  2021_sales    100</span>
<span class=c1># 1    Bob  2021_sales    200</span>
<span class=c1># ...</span>
</code></pre></div> <p><strong>Clean up melted data:</strong></p> <div class=highlight><pre><span></span><code><span class=n>df_long</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_long</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;_sales&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Data reshaping skills.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows melt reverses pivot</li> <li>Uses id_vars for fixed columns</li> <li>Cleans variable names after melting</li> </ul> </div> </details> <hr> <h3 id=how-to-use-stack-and-unstack-google-amazon-interview-question>How to Use stack() and unstack()? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Reshaping</code>, <code>MultiIndex</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>stack() - Pivot columns to rows:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]</span>
<span class=p>},</span> <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;row1&#39;</span><span class=p>,</span> <span class=s1>&#39;row2&#39;</span><span class=p>])</span>

<span class=c1># Stack columns into rows</span>
<span class=n>stacked</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>stack</span><span class=p>()</span>
<span class=c1># Result: MultiIndex Series</span>
<span class=c1># row1  A    1</span>
<span class=c1>#       B    3</span>
<span class=c1># row2  A    2</span>
<span class=c1>#       B    4</span>
</code></pre></div> <p><strong>unstack() - Pivot rows to columns:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Reverse operation</span>
<span class=n>unstacked</span> <span class=o>=</span> <span class=n>stacked</span><span class=o>.</span><span class=n>unstack</span><span class=p>()</span>

<span class=c1># Unstack specific level</span>
<span class=n>df_multi</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>set_index</span><span class=p>([[</span><span class=s1>&#39;cat1&#39;</span><span class=p>,</span> <span class=s1>&#39;cat1&#39;</span><span class=p>,</span> <span class=s1>&#39;cat2&#39;</span><span class=p>,</span> <span class=s1>&#39;cat2&#39;</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]])</span>
<span class=n>df_multi</span><span class=o>.</span><span class=n>unstack</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>  <span class=c1># Unstack first level</span>
<span class=n>df_multi</span><span class=o>.</span><span class=n>unstack</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># Unstack second level</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> MultiIndex manipulation.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Understands stack/unstack relationship</li> <li>Can specify which level to unstack</li> <li>Uses for reshaping complex data</li> </ul> </div> </details> <hr> <h3 id=how-to-cross-tabulate-with-crosstab-google-amazon-interview-question>How to Cross-Tabulate with crosstab()? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Cross Tabulation</code>, <code>Analysis</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>crosstab() - Frequency Tables:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;gender&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;F&#39;</span><span class=p>,</span> <span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;F&#39;</span><span class=p>,</span> <span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;F&#39;</span><span class=p>],</span>
    <span class=s1>&#39;department&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Sales&#39;</span><span class=p>,</span> <span class=s1>&#39;Sales&#39;</span><span class=p>,</span> <span class=s1>&#39;IT&#39;</span><span class=p>,</span> <span class=s1>&#39;IT&#39;</span><span class=p>,</span> <span class=s1>&#39;Sales&#39;</span><span class=p>,</span> <span class=s1>&#39;HR&#39;</span><span class=p>],</span>
    <span class=s1>&#39;salary&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>50000</span><span class=p>,</span> <span class=mi>55000</span><span class=p>,</span> <span class=mi>60000</span><span class=p>,</span> <span class=mi>65000</span><span class=p>,</span> <span class=mi>52000</span><span class=p>,</span> <span class=mi>48000</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Simple frequency table</span>
<span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;department&#39;</span><span class=p>])</span>

<span class=c1># With margins (totals)</span>
<span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;department&#39;</span><span class=p>],</span> <span class=n>margins</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># With aggregation</span>
<span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span> 
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;department&#39;</span><span class=p>],</span> 
    <span class=n>values</span><span class=o>=</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;salary&#39;</span><span class=p>],</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;mean&#39;</span>
<span class=p>)</span>

<span class=c1># Normalize to percentages</span>
<span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;department&#39;</span><span class=p>],</span> <span class=n>normalize</span><span class=o>=</span><span class=s1>&#39;all&#39;</span><span class=p>)</span>  <span class=c1># All cells</span>
<span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;department&#39;</span><span class=p>],</span> <span class=n>normalize</span><span class=o>=</span><span class=s1>&#39;index&#39;</span><span class=p>)</span>  <span class=c1># By row</span>
<span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;department&#39;</span><span class=p>],</span> <span class=n>normalize</span><span class=o>=</span><span class=s1>&#39;columns&#39;</span><span class=p>)</span>  <span class=c1># By column</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Contingency table creation.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses normalize for percentages</li> <li>Knows margins for totals</li> <li>Can aggregate with values/aggfunc</li> </ul> </div> </details> <hr> <h3 id=how-to-use-explode-for-list-columns-google-amazon-interview-question>How to Use explode() for List Columns? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>List Operations</code>, <code>Data Preprocessing</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>explode() - Unnest Lists:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>],</span>
    <span class=s1>&#39;skills&#39;</span><span class=p>:</span> <span class=p>[[</span><span class=s1>&#39;Python&#39;</span><span class=p>,</span> <span class=s1>&#39;SQL&#39;</span><span class=p>,</span> <span class=s1>&#39;ML&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;Java&#39;</span><span class=p>,</span> <span class=s1>&#39;Scala&#39;</span><span class=p>]]</span>
<span class=p>})</span>

<span class=c1># Explode list column</span>
<span class=n>df_exploded</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>explode</span><span class=p>(</span><span class=s1>&#39;skills&#39;</span><span class=p>)</span>

<span class=c1># Result:</span>
<span class=c1>#    name  skills</span>
<span class=c1># 0  Alice  Python</span>
<span class=c1># 0  Alice     SQL</span>
<span class=c1># 0  Alice      ML</span>
<span class=c1># 1    Bob    Java</span>
<span class=c1># 1    Bob   Scala</span>

<span class=c1># Reset index after explode</span>
<span class=n>df_exploded</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>explode</span><span class=p>(</span><span class=s1>&#39;skills&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>drop</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Explode multiple columns (same length)</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span>
    <span class=s1>&#39;values&#39;</span><span class=p>:</span> <span class=p>[[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]],</span>
    <span class=s1>&#39;labels&#39;</span><span class=p>:</span> <span class=p>[[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>]]</span>
<span class=p>})</span>
<span class=n>df</span><span class=o>.</span><span class=n>explode</span><span class=p>([</span><span class=s1>&#39;values&#39;</span><span class=p>,</span> <span class=s1>&#39;labels&#39;</span><span class=p>])</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Nested data handling.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Resets index after explode</li> <li>Handles multiple list columns</li> <li>Knows reverse: groupby + list aggregation</li> </ul> </div> </details> <hr> <h3 id=how-to-handle-json-with-nested-structures-amazon-google-interview-question>How to Handle JSON with Nested Structures? - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>JSON Processing</code>, <code>Nested Data</code> | <strong>Asked by:</strong> Amazon, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>json_normalize() - Flatten Nested JSON:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>from</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=kn>import</span> <span class=n>json_normalize</span>

<span class=n>data</span> <span class=o>=</span> <span class=p>[</span>
    <span class=p>{</span>
        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
        <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Alice&#39;</span><span class=p>,</span>
        <span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=p>{</span>
            <span class=s1>&#39;city&#39;</span><span class=p>:</span> <span class=s1>&#39;NYC&#39;</span><span class=p>,</span>
            <span class=s1>&#39;zip&#39;</span><span class=p>:</span> <span class=s1>&#39;10001&#39;</span>
        <span class=p>},</span>
        <span class=s1>&#39;orders&#39;</span><span class=p>:</span> <span class=p>[{</span><span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>101</span><span class=p>,</span> <span class=s1>&#39;amount&#39;</span><span class=p>:</span> <span class=mi>50</span><span class=p>},</span> <span class=p>{</span><span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>102</span><span class=p>,</span> <span class=s1>&#39;amount&#39;</span><span class=p>:</span> <span class=mi>75</span><span class=p>}]</span>
    <span class=p>}</span>
<span class=p>]</span>

<span class=c1># Flatten top level</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>json_normalize</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>

<span class=c1># Flatten with nested paths</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>json_normalize</span><span class=p>(</span>
    <span class=n>data</span><span class=p>,</span>
    <span class=n>record_path</span><span class=o>=</span><span class=s1>&#39;orders&#39;</span><span class=p>,</span>  <span class=c1># Explode this array</span>
    <span class=n>meta</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;address&#39;</span><span class=p>,</span> <span class=s1>&#39;city&#39;</span><span class=p>]],</span>  <span class=c1># Include these fields</span>
    <span class=n>meta_prefix</span><span class=o>=</span><span class=s1>&#39;user_&#39;</span>
<span class=p>)</span>

<span class=c1># Read JSON file</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_json</span><span class=p>(</span><span class=s1>&#39;data.json&#39;</span><span class=p>)</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_json</span><span class=p>(</span><span class=s1>&#39;data.json&#39;</span><span class=p>,</span> <span class=n>orient</span><span class=o>=</span><span class=s1>&#39;records&#39;</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Real-world data handling.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses json_normalize for nested</li> <li>Knows record_path and meta</li> <li>Handles different JSON orientations</li> </ul> </div> </details> <hr> <h3 id=how-to-use-method-chaining-for-clean-code-google-amazon-interview-question>How to Use Method Chaining for Clean Code? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Method Chaining</code>, <code>Clean Code</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Method Chaining Pattern:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=c1># Instead of multiple intermediate variables</span>
<span class=n>df</span> <span class=o>=</span> <span class=p>(</span>
    <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;data.csv&#39;</span><span class=p>)</span>
    <span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;status == &quot;active&quot;&#39;</span><span class=p>)</span>
    <span class=o>.</span><span class=n>assign</span><span class=p>(</span>
        <span class=n>year</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>year</span><span class=p>,</span>
        <span class=n>total</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span>
    <span class=p>)</span>
    <span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=s1>&#39;year&#39;</span><span class=p>,</span> <span class=s1>&#39;region&#39;</span><span class=p>])</span>
    <span class=o>.</span><span class=n>agg</span><span class=p>(</span><span class=n>revenue</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;total&#39;</span><span class=p>,</span> <span class=s1>&#39;sum&#39;</span><span class=p>))</span>
    <span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
    <span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;revenue&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=p>)</span>
</code></pre></div> <p><strong>pipe() for Custom Functions:</strong></p> <div class=highlight><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>add_features</span><span class=p>(</span><span class=n>df</span><span class=p>):</span>
    <span class=k>return</span> <span class=n>df</span><span class=o>.</span><span class=n>assign</span><span class=p>(</span>
        <span class=n>log_value</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>log1p</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]),</span>
        <span class=n>is_high</span><span class=o>=</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>median</span><span class=p>()</span>
    <span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>filter_outliers</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>column</span><span class=p>,</span> <span class=n>n_std</span><span class=o>=</span><span class=mi>3</span><span class=p>):</span>
    <span class=n>mean</span><span class=p>,</span> <span class=n>std</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>column</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>(),</span> <span class=n>df</span><span class=p>[</span><span class=n>column</span><span class=p>]</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
    <span class=k>return</span> <span class=n>df</span><span class=p>[(</span><span class=n>df</span><span class=p>[</span><span class=n>column</span><span class=p>]</span> <span class=o>-</span> <span class=n>mean</span><span class=p>)</span><span class=o>.</span><span class=n>abs</span><span class=p>()</span> <span class=o>&lt;=</span> <span class=n>n_std</span> <span class=o>*</span> <span class=n>std</span><span class=p>]</span>

<span class=n>result</span> <span class=o>=</span> <span class=p>(</span>
    <span class=n>df</span>
    <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>add_features</span><span class=p>)</span>
    <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>filter_outliers</span><span class=p>,</span> <span class=s1>&#39;value&#39;</span><span class=p>,</span> <span class=n>n_std</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Clean, maintainable code.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses parentheses for multi-line chains</li> <li>Uses pipe() for custom functions</li> <li>Avoids intermediate variables</li> </ul> </div> </details> <hr> <h3 id=how-to-readwrite-parquet-files-google-amazon-netflix-interview-question>How to Read/Write Parquet Files? - Google, Amazon, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>File I/O</code>, <code>Big Data</code>, <code>Parquet</code> | <strong>Asked by:</strong> Google, Amazon, Netflix, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Parquet - Columnar Format:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=c1># Write to Parquet</span>
<span class=n>df</span><span class=o>.</span><span class=n>to_parquet</span><span class=p>(</span><span class=s1>&#39;data.parquet&#39;</span><span class=p>)</span>
<span class=n>df</span><span class=o>.</span><span class=n>to_parquet</span><span class=p>(</span><span class=s1>&#39;data.parquet&#39;</span><span class=p>,</span> <span class=n>compression</span><span class=o>=</span><span class=s1>&#39;snappy&#39;</span><span class=p>)</span>  <span class=c1># Default</span>
<span class=n>df</span><span class=o>.</span><span class=n>to_parquet</span><span class=p>(</span><span class=s1>&#39;data.parquet&#39;</span><span class=p>,</span> <span class=n>compression</span><span class=o>=</span><span class=s1>&#39;gzip&#39;</span><span class=p>)</span>    <span class=c1># Smaller</span>

<span class=c1># Read Parquet</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>(</span><span class=s1>&#39;data.parquet&#39;</span><span class=p>)</span>

<span class=c1># Read only specific columns (fast!)</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>(</span><span class=s1>&#39;data.parquet&#39;</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;col1&#39;</span><span class=p>,</span> <span class=s1>&#39;col2&#39;</span><span class=p>])</span>

<span class=c1># With filters (predicate pushdown)</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>(</span>
    <span class=s1>&#39;data.parquet&#39;</span><span class=p>,</span>
    <span class=n>filters</span><span class=o>=</span><span class=p>[(</span><span class=s1>&#39;year&#39;</span><span class=p>,</span> <span class=s1>&#39;==&#39;</span><span class=p>,</span> <span class=mi>2023</span><span class=p>)]</span>
<span class=p>)</span>
</code></pre></div> <p><strong>Parquet vs CSV:</strong></p> <table> <thead> <tr> <th>Feature</th> <th>Parquet</th> <th>CSV</th> </tr> </thead> <tbody> <tr> <td>Size</td> <td>~10x smaller</td> <td>Larger</td> </tr> <tr> <td>Read speed</td> <td>Faster</td> <td>Slower</td> </tr> <tr> <td>Column selection</td> <td>Fast</td> <td>Must read all</td> </tr> <tr> <td>Data types</td> <td>Preserved</td> <td>Lost</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Efficient data storage.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses Parquet for large datasets</li> <li>Reads only needed columns</li> <li>Knows compression options</li> </ul> </div> </details> <hr> <h3 id=how-to-use-assign-for-creating-new-columns-google-amazon-interview-question>How to Use assign() for Creating New Columns? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Column Creation</code>, <code>Method Chaining</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>assign() - Create Columns in Chain:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>300</span><span class=p>],</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Create multiple columns</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>assign</span><span class=p>(</span>
    <span class=n>total</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>],</span>
    <span class=n>discounted</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;total&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mf>0.9</span><span class=p>,</span>
    <span class=n>tax</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;total&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mf>0.1</span>
<span class=p>)</span>

<span class=c1># Reference previous assignments</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>assign</span><span class=p>(</span>
    <span class=n>subtotal</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>],</span>
    <span class=n>tax</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;subtotal&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mf>0.1</span><span class=p>,</span>
    <span class=n>total</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;subtotal&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;tax&#39;</span><span class=p>]</span>
<span class=p>)</span>
</code></pre></div> <p><strong>assign() vs direct assignment:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Direct assignment (modifies in place)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;new_col&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span>

<span class=c1># assign() (returns new DataFrame, original unchanged)</span>
<span class=n>df_new</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>assign</span><span class=p>(</span><span class=n>new_col</span><span class=o>=</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Functional programming style.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses lambda for dependent columns</li> <li>Prefers assign for method chaining</li> <li>Knows it returns new DataFrame</li> </ul> </div> </details> <hr> <h3 id=how-to-calculate-percentage-change-and-cumulative-stats-google-amazon-netflix-interview-question>How to Calculate Percentage Change and Cumulative Stats? - Google, Amazon, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Time Series</code>, <code>Finance</code> | <strong>Asked by:</strong> Google, Amazon, Netflix, Apple</p> <details class=success> <summary>View Answer</summary> <p><strong>Percentage Change:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2023-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>5</span><span class=p>),</span>
    <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>105</span><span class=p>,</span> <span class=mi>102</span><span class=p>,</span> <span class=mi>110</span><span class=p>,</span> <span class=mi>108</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Daily percentage change</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;pct_change&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>pct_change</span><span class=p>()</span>

<span class=c1># Percentage change over N periods</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;pct_change_3&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>pct_change</span><span class=p>(</span><span class=n>periods</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>

<span class=c1># Fill first NaN</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;pct_change&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>pct_change</span><span class=p>()</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</code></pre></div> <p><strong>Cumulative Statistics:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Cumulative sum</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;cumsum&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cumsum</span><span class=p>()</span>

<span class=c1># Cumulative product (for returns)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;cumulative_return&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;pct_change&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>cumprod</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span>

<span class=c1># Cumulative max/min</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;cummax&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cummax</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;cummin&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cummin</span><span class=p>()</span>

<span class=c1># Drawdown</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;drawdown&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cummax</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Financial calculations.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses pct_change for returns</li> <li>Knows cumprod for cumulative returns</li> <li>Can calculate drawdowns</li> </ul> </div> </details> <hr> <h3 id=how-to-shift-and-lag-data-google-amazon-netflix-interview-question>How to Shift and Lag Data? - Google, Amazon, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Time Series</code>, <code>Lag Features</code> | <strong>Asked by:</strong> Google, Amazon, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>shift() - Create Lag/Lead Features:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2023-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>5</span><span class=p>),</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>50</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Previous value (lag)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;prev_value&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>shift</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;prev_2&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>shift</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>

<span class=c1># Next value (lead)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;next_value&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>shift</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>

<span class=c1># Calculate difference from previous</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;diff&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>shift</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
<span class=c1># Same as: df[&#39;value&#39;].diff()</span>

<span class=c1># Shift with fill</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;prev_filled&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>shift</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>fill_value</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</code></pre></div> <p><strong>Use Cases:</strong></p> <table> <thead> <tr> <th>Operation</th> <th>Formula</th> </tr> </thead> <tbody> <tr> <td>Lag-1</td> <td><code>df['col'].shift(1)</code></td> </tr> <tr> <td>Difference</td> <td><code>df['col'].diff()</code></td> </tr> <tr> <td>% Change</td> <td><code>df['col'].pct_change()</code></td> </tr> <tr> <td>Rolling difference</td> <td><code>df['col'] - df['col'].shift(n)</code></td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Feature engineering for time series.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Creates lag features for ML</li> <li>Knows shift vs diff vs pct_change</li> <li>Handles NaN from shifting</li> </ul> </div> </details> <hr> <h3 id=how-to-sample-data-from-dataframe-google-amazon-interview-question>How to Sample Data from DataFrame? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Sampling</code>, <code>Data Exploration</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>sample() - Random Sampling:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1000</span><span class=p>)})</span>

<span class=c1># Sample n rows</span>
<span class=n>sample</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>sample</span><span class=p>(</span><span class=n>n</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span>

<span class=c1># Sample fraction</span>
<span class=n>sample</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>sample</span><span class=p>(</span><span class=n>frac</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>  <span class=c1># 10%</span>

<span class=c1># With replacement (bootstrap)</span>
<span class=n>bootstrap</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>sample</span><span class=p>(</span><span class=n>n</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>replace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Reproducible sampling</span>
<span class=n>sample</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>sample</span><span class=p>(</span><span class=n>n</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>

<span class=c1># Weighted sampling</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;weight&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.1</span><span class=p>]</span> <span class=o>*</span> <span class=mi>500</span> <span class=o>+</span> <span class=p>[</span><span class=mf>0.9</span><span class=p>]</span> <span class=o>*</span> <span class=mi>500</span>
<span class=n>sample</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>sample</span><span class=p>(</span><span class=n>n</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>weights</span><span class=o>=</span><span class=s1>&#39;weight&#39;</span><span class=p>)</span>
</code></pre></div> <p><strong>Stratified Sampling:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Sample within groups</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sample</span><span class=p>(</span><span class=n>n</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sample</span><span class=p>(</span><span class=n>frac</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>

<span class=c1># Stratified with sklearn</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
<span class=n>train</span><span class=p>,</span> <span class=n>test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>stratify</span><span class=o>=</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>],</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Data sampling techniques.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses random_state for reproducibility</li> <li>Knows weighted sampling</li> <li>Uses stratified for imbalanced data</li> </ul> </div> </details> <hr> <h3 id=how-to-detect-and-handle-outliers-google-amazon-meta-interview-question>How to Detect and Handle Outliers? - Google, Amazon, Meta Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Outlier Detection</code>, <code>Data Cleaning</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>Detection Methods:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=o>-</span><span class=mi>50</span><span class=p>,</span> <span class=mi>6</span><span class=p>]})</span>

<span class=c1># Z-score method</span>
<span class=n>z_scores</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span> <span class=o>/</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
<span class=n>outliers</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=nb>abs</span><span class=p>(</span><span class=n>z_scores</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>]</span>

<span class=c1># IQR method</span>
<span class=n>Q1</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=mf>0.25</span><span class=p>)</span>
<span class=n>Q3</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=mf>0.75</span><span class=p>)</span>
<span class=n>IQR</span> <span class=o>=</span> <span class=n>Q3</span> <span class=o>-</span> <span class=n>Q1</span>
<span class=n>lower</span> <span class=o>=</span> <span class=n>Q1</span> <span class=o>-</span> <span class=mf>1.5</span> <span class=o>*</span> <span class=n>IQR</span>
<span class=n>upper</span> <span class=o>=</span> <span class=n>Q3</span> <span class=o>+</span> <span class=mf>1.5</span> <span class=o>*</span> <span class=n>IQR</span>
<span class=n>outliers</span> <span class=o>=</span> <span class=n>df</span><span class=p>[(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>lower</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>upper</span><span class=p>)]</span>

<span class=c1># Percentile method</span>
<span class=n>outliers</span> <span class=o>=</span> <span class=n>df</span><span class=p>[(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=mf>0.01</span><span class=p>))</span> <span class=o>|</span> 
              <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=mf>0.99</span><span class=p>))]</span>
</code></pre></div> <p><strong>Handling Outliers:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Remove</span>
<span class=n>df_clean</span> <span class=o>=</span> <span class=n>df</span><span class=p>[(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>lower</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>upper</span><span class=p>)]</span>

<span class=c1># Cap (winsorize)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;value_capped&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>lower</span><span class=o>=</span><span class=n>lower</span><span class=p>,</span> <span class=n>upper</span><span class=o>=</span><span class=n>upper</span><span class=p>)</span>

<span class=c1># Replace with NaN</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=nb>abs</span><span class=p>(</span><span class=n>z_scores</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Data quality handling.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows IQR and Z-score methods</li> <li>Chooses method based on distribution</li> <li>Considers domain knowledge</li> </ul> </div> </details> <hr> <h3 id=how-to-normalize-and-standardize-data-google-amazon-interview-question>How to Normalize and Standardize Data? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Feature Engineering</code>, <code>ML Preprocessing</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>Normalization (Min-Max Scaling):</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>50</span><span class=p>]})</span>

<span class=c1># Scale to [0, 1]</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;normalized&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>())</span> <span class=o>/</span> \
                   <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>-</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>())</span>

<span class=c1># Using sklearn</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>MinMaxScaler</span>
<span class=n>scaler</span> <span class=o>=</span> <span class=n>MinMaxScaler</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;normalized&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;value&#39;</span><span class=p>]])</span>
</code></pre></div> <p><strong>Standardization (Z-score):</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Scale to mean=0, std=1</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;standardized&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span> <span class=o>/</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>

<span class=c1># Using sklearn</span>
<span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;standardized&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;value&#39;</span><span class=p>]])</span>
</code></pre></div> <p><strong>When to Use:</strong></p> <table> <thead> <tr> <th>Method</th> <th>Use When</th> </tr> </thead> <tbody> <tr> <td>Min-Max</td> <td>Bounded range needed, no outliers</td> </tr> <tr> <td>Z-score</td> <td>Normal distribution, has outliers</td> </tr> <tr> <td>Robust</td> <td>Many outliers (uses median/IQR)</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> ML preprocessing.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows difference between methods</li> <li>Uses sklearn for production</li> <li>Considers outliers in choice</li> </ul> </div> </details> <hr> <h3 id=how-to-use-where-and-mask-methods-google-amazon-interview-question>How to Use where() and mask() Methods? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Conditional Operations</code>, <code>Data Transformation</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>where() - Keep values where True:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>]})</span>

<span class=c1># Keep values &gt;= 3, replace others with NaN</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>3</span><span class=p>)</span>
<span class=c1># Result: [NaN, NaN, 3, 4, 5]</span>

<span class=c1># Replace with specific value</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>3</span><span class=p>,</span> <span class=n>other</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=c1># Result: [0, 0, 3, 4, 5]</span>
</code></pre></div> <p><strong>mask() - Replace values where True:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Opposite of where</span>
<span class=c1># Replace values &gt;= 3 with NaN</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mask</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>3</span><span class=p>)</span>
<span class=c1># Result: [1, 2, NaN, NaN, NaN]</span>

<span class=c1># Replace with specific value</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mask</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>3</span><span class=p>,</span> <span class=n>other</span><span class=o>=</span><span class=mi>999</span><span class=p>)</span>
<span class=c1># Result: [1, 2, 999, 999, 999]</span>
</code></pre></div> <p><strong>vs np.where:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># np.where for if-else</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;result&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;high&#39;</span><span class=p>,</span> <span class=s1>&#39;low&#39;</span><span class=p>)</span>

<span class=c1># Multiple conditions: np.select</span>
<span class=n>conditions</span> <span class=o>=</span> <span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>,</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>]</span>
<span class=n>choices</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;low&#39;</span><span class=p>,</span> <span class=s1>&#39;medium&#39;</span><span class=p>]</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>conditions</span><span class=p>,</span> <span class=n>choices</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=s1>&#39;high&#39;</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Conditional data manipulation.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows where keeps, mask replaces</li> <li>Uses np.where for if-else</li> <li>Uses np.select for multiple conditions</li> </ul> </div> </details> <hr> <h3 id=how-to-rank-values-in-pandas-google-amazon-interview-question>How to Rank Values in Pandas? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Ranking</code>, <code>Analysis</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>rank() Method:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>,</span> <span class=s1>&#39;David&#39;</span><span class=p>],</span>
    <span class=s1>&#39;score&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>85</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>85</span><span class=p>,</span> <span class=mi>95</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Default: average rank for ties</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;rank&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;score&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>()</span>
<span class=c1># [1.5, 3, 1.5, 4] - tied scores get average</span>

<span class=c1># Rank methods for ties</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;rank_min&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;score&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s1>&#39;min&#39;</span><span class=p>)</span>    <span class=c1># [1, 3, 1, 4]</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;rank_max&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;score&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s1>&#39;max&#39;</span><span class=p>)</span>    <span class=c1># [2, 3, 2, 4]</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;rank_first&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;score&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s1>&#39;first&#39;</span><span class=p>)</span> <span class=c1># [1, 3, 2, 4]</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;rank_dense&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;score&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s1>&#39;dense&#39;</span><span class=p>)</span> <span class=c1># [1, 2, 1, 3]</span>

<span class=c1># Descending rank</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;rank_desc&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;score&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

<span class=c1># Rank within groups</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;rank_in_group&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;score&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>()</span>

<span class=c1># Percentile rank</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;percentile&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;score&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>pct</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Data ranking skills.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows different tie-breaking methods</li> <li>Uses dense for no gaps</li> <li>Can rank within groups</li> </ul> </div> </details> <hr> <h3 id=how-to-find-firstlast-n-rows-per-group-google-amazon-interview-question>How to Find First/Last N Rows Per Group? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>GroupBy</code>, <code>Selection</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>nlargest/nsmallest per Group:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>],</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>50</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Top 2 per group using nlargest</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;value&#39;</span><span class=p>))</span>

<span class=c1># Top N using head after sort</span>
<span class=n>df</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;value&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>

<span class=c1># First/last row per group</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>last</span><span class=p>()</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>nth</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>  <span class=c1># First row</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>nth</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># Last row</span>
</code></pre></div> <p><strong>Using rank:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># More efficient for large data</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;rank&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s1>&#39;first&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=n>top_2</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;rank&#39;</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=mi>2</span><span class=p>]</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Efficient group operations.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses nlargest/nsmallest for simplicity</li> <li>Uses rank for large data</li> <li>Knows first(), last(), nth()</li> </ul> </div> </details> <hr> <h3 id=how-to-use-nsmallest-and-nlargest-google-amazon-interview-question>How to Use nsmallest() and nlargest()? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Selection</code>, <code>Performance</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>nlargest/nsmallest - Efficient Selection:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;D&#39;</span><span class=p>,</span> <span class=s1>&#39;E&#39;</span><span class=p>],</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>800</span><span class=p>,</span> <span class=mi>300</span><span class=p>],</span>
    <span class=s1>&#39;profit&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>70</span><span class=p>,</span> <span class=mi>20</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Top 3 by sales</span>
<span class=n>df</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;sales&#39;</span><span class=p>)</span>

<span class=c1># Bottom 3 by profit</span>
<span class=n>df</span><span class=o>.</span><span class=n>nsmallest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;profit&#39;</span><span class=p>)</span>

<span class=c1># By multiple columns (tiebreaker)</span>
<span class=n>df</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;profit&#39;</span><span class=p>])</span>

<span class=c1># Keep=&#39;first&#39; (default), &#39;last&#39;, &#39;all&#39;</span>
<span class=n>df</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=n>keep</span><span class=o>=</span><span class=s1>&#39;all&#39;</span><span class=p>)</span>  <span class=c1># Include all ties</span>
</code></pre></div> <p><strong>Performance:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># nlargest is O(n log k) - faster than full sort</span>
<span class=n>df</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=s1>&#39;value&#39;</span><span class=p>)</span>  <span class=c1># Faster</span>

<span class=c1># Full sort is O(n log n)</span>
<span class=n>df</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;value&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>  <span class=c1># Slower</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Efficient data selection.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows nlargest is faster than sort+head</li> <li>Uses keep='all' for ties</li> <li>Applies to Series and DataFrame</li> </ul> </div> </details> <hr> <h3 id=how-to-calculate-weighted-average-google-amazon-netflix-interview-question>How to Calculate Weighted Average? - Google, Amazon, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Aggregation</code>, <code>Finance</code> | <strong>Asked by:</strong> Google, Amazon, Netflix, Apple</p> <details class=success> <summary>View Answer</summary> <p><strong>Weighted Average:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>],</span>
    <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>],</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>25</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Weighted average price</span>
<span class=n>weighted_avg</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>average</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>],</span> <span class=n>weights</span><span class=o>=</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>])</span>
<span class=c1># or</span>
<span class=n>weighted_avg</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>

<span class=c1># Weighted average per group</span>
<span class=k>def</span><span class=w> </span><span class=nf>weighted_avg_func</span><span class=p>(</span><span class=n>group</span><span class=p>,</span> <span class=n>value_col</span><span class=p>,</span> <span class=n>weight_col</span><span class=p>):</span>
    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>average</span><span class=p>(</span><span class=n>group</span><span class=p>[</span><span class=n>value_col</span><span class=p>],</span> <span class=n>weights</span><span class=o>=</span><span class=n>group</span><span class=p>[</span><span class=n>weight_col</span><span class=p>])</span>

<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span>
    <span class=n>weighted_avg_func</span><span class=p>,</span> <span class=s1>&#39;price&#39;</span><span class=p>,</span> <span class=s1>&#39;quantity&#39;</span>
<span class=p>)</span>
</code></pre></div> <p><strong>Named Aggregation with Weighted Average:</strong></p> <div class=highlight><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>weighted_mean</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>value_col</span><span class=p>,</span> <span class=n>weight_col</span><span class=p>):</span>
    <span class=k>return</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=n>value_col</span><span class=p>]</span> <span class=o>*</span> <span class=n>df</span><span class=p>[</span><span class=n>weight_col</span><span class=p>])</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=n>df</span><span class=p>[</span><span class=n>weight_col</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>

<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span>
    <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>({</span>
        <span class=s1>&#39;weighted_price&#39;</span><span class=p>:</span> <span class=n>weighted_mean</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=s1>&#39;price&#39;</span><span class=p>,</span> <span class=s1>&#39;quantity&#39;</span><span class=p>),</span>
        <span class=s1>&#39;total_quantity&#39;</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
    <span class=p>})</span>
<span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Custom aggregations.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses np.average with weights</li> <li>Can apply to groups</li> <li>Handles edge cases (zero weights)</li> </ul> </div> </details> <hr> <h3 id=how-to-perform-window-functions-like-sql-google-amazon-interview-question>How to Perform Window Functions Like SQL? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Window Functions</code>, <code>Analytics</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>SQL-like Window Functions:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>],</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2023-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>6</span><span class=p>),</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>60</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># ROW_NUMBER</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;row_num&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>cumcount</span><span class=p>()</span> <span class=o>+</span> <span class=mi>1</span>

<span class=c1># RANK</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;rank&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s1>&#39;min&#39;</span><span class=p>)</span>

<span class=c1># DENSE_RANK</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;dense_rank&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s1>&#39;dense&#39;</span><span class=p>)</span>

<span class=c1># LEAD / LAG</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;prev_value&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>shift</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;next_value&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>shift</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>

<span class=c1># Running SUM / AVG</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;running_sum&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cumsum</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;running_avg&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>expanding</span><span class=p>()</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=o>.</span><span class=n>values</span>

<span class=c1># Percent of total</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;pct_of_cat&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=s1>&#39;sum&#39;</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Analytics skills.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Maps SQL functions to Pandas</li> <li>Uses transform for same-shape output</li> <li>Combines groupby with cumulative ops</li> </ul> </div> </details> <hr> <h3 id=how-to-compare-two-dataframes-amazon-google-interview-question>How to Compare Two DataFrames? - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Data Comparison</code>, <code>Validation</code> | <strong>Asked by:</strong> Amazon, Google, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>compare() Method (Pandas 1.1+):</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>]})</span>
<span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;x&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>]})</span>

<span class=c1># Show differences</span>
<span class=n>df1</span><span class=o>.</span><span class=n>compare</span><span class=p>(</span><span class=n>df2</span><span class=p>)</span>
<span class=c1># Shows &#39;self&#39; and &#39;other&#39; for differences</span>

<span class=c1># Keep all rows</span>
<span class=n>df1</span><span class=o>.</span><span class=n>compare</span><span class=p>(</span><span class=n>df2</span><span class=p>,</span> <span class=n>keep_equal</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Keep all columns</span>
<span class=n>df1</span><span class=o>.</span><span class=n>compare</span><span class=p>(</span><span class=n>df2</span><span class=p>,</span> <span class=n>keep_shape</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <p><strong>Testing Equality:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Check if equal</span>
<span class=n>df1</span><span class=o>.</span><span class=n>equals</span><span class=p>(</span><span class=n>df2</span><span class=p>)</span>  <span class=c1># Returns True/False</span>

<span class=c1># Element-wise comparison</span>
<span class=n>df1</span> <span class=o>==</span> <span class=n>df2</span>  <span class=c1># Boolean DataFrame</span>
<span class=p>(</span><span class=n>df1</span> <span class=o>==</span> <span class=n>df2</span><span class=p>)</span><span class=o>.</span><span class=n>all</span><span class=p>()</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>  <span class=c1># All equal?</span>

<span class=c1># For testing</span>
<span class=kn>from</span><span class=w> </span><span class=nn>pandas.testing</span><span class=w> </span><span class=kn>import</span> <span class=n>assert_frame_equal</span>
<span class=n>assert_frame_equal</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>check_dtype</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> <p><strong>Find Differences:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Rows in df1 not in df2</span>
<span class=n>df1</span><span class=p>[</span><span class=o>~</span><span class=n>df1</span><span class=o>.</span><span class=n>isin</span><span class=p>(</span><span class=n>df2</span><span class=p>)</span><span class=o>.</span><span class=n>all</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)]</span>

<span class=c1># Using merge</span>
<span class=n>merged</span> <span class=o>=</span> <span class=n>df1</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df2</span><span class=p>,</span> <span class=n>indicator</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>)</span>
<span class=n>only_in_df1</span> <span class=o>=</span> <span class=n>merged</span><span class=p>[</span><span class=n>merged</span><span class=p>[</span><span class=s1>&#39;_merge&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;left_only&#39;</span><span class=p>]</span>
<span class=n>only_in_df2</span> <span class=o>=</span> <span class=n>merged</span><span class=p>[</span><span class=n>merged</span><span class=p>[</span><span class=s1>&#39;_merge&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;right_only&#39;</span><span class=p>]</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Data validation skills.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses compare() for visual diff</li> <li>Uses assert_frame_equal for tests</li> <li>Can find specific differences</li> </ul> </div> </details> <hr> <h3 id=how-to-handle-settingwithcopywarning-properly-google-amazon-interview-question>How to Handle SettingWithCopyWarning Properly? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Best Practices</code>, <code>Common Errors</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>Copy-on-Write in Pandas 2.0+:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=c1># Enable CoW globally</span>
<span class=n>pd</span><span class=o>.</span><span class=n>options</span><span class=o>.</span><span class=n>mode</span><span class=o>.</span><span class=n>copy_on_write</span> <span class=o>=</span> <span class=kc>True</span>

<span class=c1># Now this is safe</span>
<span class=n>df2</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>]</span>
<span class=n>df2</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>  <span class=c1># Creates copy automatically</span>

<span class=c1># Original df unchanged</span>
</code></pre></div> <p><strong>Best Practices Summary:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># 1. Modifying original - use .loc</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>

<span class=c1># 2. Creating new DataFrame - use .copy()</span>
<span class=n>df_new</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=n>df_new</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>

<span class=c1># 3. Method chaining - use .assign()</span>
<span class=n>df_new</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;A &gt; 0&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>assign</span><span class=p>(</span><span class=n>B</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span>

<span class=c1># 4. Never chain indexing</span>
<span class=c1># BAD</span>
<span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>][</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>
<span class=c1># GOOD</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Production-safe code.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows CoW in Pandas 2.0+</li> <li>Uses .loc consistently</li> <li>Avoids chained indexing</li> </ul> </div> </details> <hr> <h3 id=how-to-use-sparse-data-structures-google-amazon-interview-question>How to Use Sparse Data Structures? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Sparse Data</code>, <code>Memory Optimization</code> | <strong>Asked by:</strong> Google, Amazon, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>Sparse Arrays - For Mostly-Null Data:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># Create sparse array</span>
<span class=n>arr</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>arrays</span><span class=o>.</span><span class=n>SparseArray</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span>

<span class=c1># Memory savings</span>
<span class=nb>print</span><span class=p>(</span><span class=n>arr</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>())</span>  <span class=c1># Much smaller than dense</span>

<span class=c1># Sparse Series</span>
<span class=n>s</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>arrays</span><span class=o>.</span><span class=n>SparseArray</span><span class=p>([</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>1000000</span> <span class=o>+</span> <span class=p>[</span><span class=mi>1</span><span class=p>]))</span>
<span class=nb>print</span><span class=p>(</span><span class=n>s</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>())</span>  <span class=c1># ~16 bytes vs ~8MB</span>

<span class=c1># Convert existing</span>
<span class=n>df_sparse</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>SparseDtype</span><span class=p>(</span><span class=s1>&#39;float&#39;</span><span class=p>,</span> <span class=n>fill_value</span><span class=o>=</span><span class=mi>0</span><span class=p>))</span>
</code></pre></div> <p><strong>Use Cases:</strong></p> <table> <thead> <tr> <th>Scenario</th> <th>Memory Savings</th> </tr> </thead> <tbody> <tr> <td>90% zeros</td> <td>~10x</td> </tr> <tr> <td>99% zeros</td> <td>~100x</td> </tr> <tr> <td>One-hot encoded</td> <td>Massive</td> </tr> </tbody> </table> <p><strong>Operations:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># Most operations work normally</span>
<span class=n>s_sparse</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<span class=n>s_sparse</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>

<span class=c1># Convert back to dense</span>
<span class=n>s_dense</span> <span class=o>=</span> <span class=n>s_sparse</span><span class=o>.</span><span class=n>sparse</span><span class=o>.</span><span class=n>to_dense</span><span class=p>()</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Advanced memory optimization.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses for mostly-zero data</li> <li>Knows fill_value parameter</li> <li>Understands trade-offs</li> </ul> </div> </details> <hr> <h3 id=how-to-implement-custom-aggregation-functions-google-amazon-interview-question>How to Implement Custom Aggregation Functions? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Aggregation</code>, <code>Custom Functions</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Custom Aggregation:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>],</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Lambda function</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>agg</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>min</span><span class=p>())</span>

<span class=c1># Named function</span>
<span class=k>def</span><span class=w> </span><span class=nf>range_func</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
    <span class=k>return</span> <span class=n>x</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>min</span><span class=p>()</span>

<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>agg</span><span class=p>(</span><span class=n>range_func</span><span class=p>)</span>

<span class=c1># Multiple custom aggregations</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>agg</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;range&#39;</span><span class=p>,</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>min</span><span class=p>()),</span>
    <span class=p>(</span><span class=s1>&#39;cv&#39;</span><span class=p>,</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>std</span><span class=p>()</span> <span class=o>/</span> <span class=n>x</span><span class=o>.</span><span class=n>mean</span><span class=p>()),</span>  <span class=c1># Coefficient of variation</span>
    <span class=p>(</span><span class=s1>&#39;iqr&#39;</span><span class=p>,</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=mf>0.75</span><span class=p>)</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=mf>0.25</span><span class=p>))</span>
<span class=p>])</span>

<span class=c1># Named aggregation with custom</span>
<span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>(</span>
    <span class=n>value_range</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;value&#39;</span><span class=p>,</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>min</span><span class=p>()),</span>
    <span class=n>value_cv</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;value&#39;</span><span class=p>,</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>std</span><span class=p>()</span> <span class=o>/</span> <span class=n>x</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span>
<span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Advanced aggregation skills.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Uses named aggregations</li> <li>Defines reusable functions</li> <li>Combines built-in and custom</li> </ul> </div> </details> <hr> <h3 id=how-to-perform-asof-joins-nearest-key-join-google-amazon-netflix-interview-question>How to Perform Asof Joins (Nearest Key Join)? - Google, Amazon, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Joining</code>, <code>Time Series</code> | <strong>Asked by:</strong> Google, Amazon, Netflix, Apple</p> <details class=success> <summary>View Answer</summary> <p><strong>merge_asof() - Join on Nearest Key:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=c1># Trade data</span>
<span class=n>trades</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;time&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>([</span><span class=s1>&#39;2023-01-01 10:00:01&#39;</span><span class=p>,</span> <span class=s1>&#39;2023-01-01 10:00:03&#39;</span><span class=p>,</span> 
                            <span class=s1>&#39;2023-01-01 10:00:05&#39;</span><span class=p>]),</span>
    <span class=s1>&#39;ticker&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;AAPL&#39;</span><span class=p>,</span> <span class=s1>&#39;AAPL&#39;</span><span class=p>,</span> <span class=s1>&#39;AAPL&#39;</span><span class=p>],</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>150</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Quote data</span>
<span class=n>quotes</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;time&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>([</span><span class=s1>&#39;2023-01-01 10:00:00&#39;</span><span class=p>,</span> <span class=s1>&#39;2023-01-01 10:00:02&#39;</span><span class=p>,</span> 
                            <span class=s1>&#39;2023-01-01 10:00:04&#39;</span><span class=p>]),</span>
    <span class=s1>&#39;ticker&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;AAPL&#39;</span><span class=p>,</span> <span class=s1>&#39;AAPL&#39;</span><span class=p>,</span> <span class=s1>&#39;AAPL&#39;</span><span class=p>],</span>
    <span class=s1>&#39;bid&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>149.0</span><span class=p>,</span> <span class=mf>149.5</span><span class=p>,</span> <span class=mf>150.0</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Join trade with most recent quote</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge_asof</span><span class=p>(</span>
    <span class=n>trades</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;time&#39;</span><span class=p>),</span>
    <span class=n>quotes</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;time&#39;</span><span class=p>),</span>
    <span class=n>on</span><span class=o>=</span><span class=s1>&#39;time&#39;</span><span class=p>,</span>
    <span class=n>by</span><span class=o>=</span><span class=s1>&#39;ticker&#39;</span><span class=p>,</span>
    <span class=n>direction</span><span class=o>=</span><span class=s1>&#39;backward&#39;</span>  <span class=c1># Use most recent quote</span>
<span class=p>)</span>
</code></pre></div> <p><strong>Direction Options:</strong></p> <table> <thead> <tr> <th>Direction</th> <th>Meaning</th> </tr> </thead> <tbody> <tr> <td>backward</td> <td>Previous/equal key</td> </tr> <tr> <td>forward</td> <td>Next/equal key</td> </tr> <tr> <td>nearest</td> <td>Closest key</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Time series joining.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Sorts data before asof join</li> <li>Uses by= for grouping</li> <li>Knows direction parameter</li> </ul> </div> </details> <hr> <h3 id=how-to-calculate-cohort-metrics-meta-netflix-amazon-interview-question>How to Calculate Cohort Metrics? - Meta, Netflix, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Cohort Analysis</code>, <code>Time Series</code> | <strong>Asked by:</strong> Meta, Netflix, Amazon, Google</p> <details class=success> <summary>View Answer</summary> <p><strong>Cohort Retention Analysis:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
    <span class=s1>&#39;order_date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>([</span>
        <span class=s1>&#39;2023-01-05&#39;</span><span class=p>,</span> <span class=s1>&#39;2023-02-10&#39;</span><span class=p>,</span> <span class=s1>&#39;2023-03-15&#39;</span><span class=p>,</span>
        <span class=s1>&#39;2023-01-20&#39;</span><span class=p>,</span> <span class=s1>&#39;2023-03-25&#39;</span><span class=p>,</span> <span class=s1>&#39;2023-02-01&#39;</span>
    <span class=p>])</span>
<span class=p>})</span>

<span class=c1># Get first purchase date (cohort)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;cohort&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;user_id&#39;</span><span class=p>)[</span><span class=s1>&#39;order_date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=s1>&#39;min&#39;</span><span class=p>)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;cohort_month&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;cohort&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>to_period</span><span class=p>(</span><span class=s1>&#39;M&#39;</span><span class=p>)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;order_month&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;order_date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>to_period</span><span class=p>(</span><span class=s1>&#39;M&#39;</span><span class=p>)</span>

<span class=c1># Calculate months since cohort</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;months_since_cohort&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;order_month&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span> <span class=o>-</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;cohort_month&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
<span class=p>)</span>

<span class=c1># Create cohort pivot</span>
<span class=n>cohort_data</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=s1>&#39;cohort_month&#39;</span><span class=p>,</span> <span class=s1>&#39;months_since_cohort&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>agg</span><span class=p>(</span>
    <span class=n>users</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;user_id&#39;</span><span class=p>,</span> <span class=s1>&#39;nunique&#39;</span><span class=p>)</span>
<span class=p>)</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>

<span class=n>cohort_pivot</span> <span class=o>=</span> <span class=n>cohort_data</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;cohort_month&#39;</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;months_since_cohort&#39;</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=s1>&#39;users&#39;</span>
<span class=p>)</span>

<span class=c1># Calculate retention rates</span>
<span class=n>cohort_sizes</span> <span class=o>=</span> <span class=n>cohort_pivot</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<span class=n>retention</span> <span class=o>=</span> <span class=n>cohort_pivot</span><span class=o>.</span><span class=n>divide</span><span class=p>(</span><span class=n>cohort_sizes</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Business analytics skills.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Calculates cohort from first action</li> <li>Uses period for month grouping</li> <li>Creates retention matrix</li> </ul> </div> </details> <hr> <h3 id=how-to-implement-ab-test-analysis-in-pandas-meta-google-netflix-interview-question>How to Implement A/B Test Analysis in Pandas? - Meta, Google, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>A/B Testing</code>, <code>Statistical Analysis</code> | <strong>Asked by:</strong> Meta, Google, Netflix, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>A/B Test Analysis:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>from</span><span class=w> </span><span class=nn>scipy</span><span class=w> </span><span class=kn>import</span> <span class=n>stats</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10000</span><span class=p>),</span>
    <span class=s1>&#39;variant&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;control&#39;</span><span class=p>,</span> <span class=s1>&#39;treatment&#39;</span><span class=p>],</span> <span class=mi>10000</span><span class=p>),</span>
    <span class=s1>&#39;converted&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>binomial</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=p>[</span><span class=mf>0.10</span><span class=p>]</span> <span class=o>*</span> <span class=mi>5000</span> <span class=o>+</span> <span class=p>[</span><span class=mf>0.12</span><span class=p>]</span> <span class=o>*</span> <span class=mi>5000</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># Summary statistics per variant</span>
<span class=n>summary</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;variant&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>(</span>
    <span class=n>users</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;user_id&#39;</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>),</span>
    <span class=n>conversions</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;converted&#39;</span><span class=p>,</span> <span class=s1>&#39;sum&#39;</span><span class=p>),</span>
    <span class=n>conversion_rate</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;converted&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>)</span>
<span class=p>)</span>

<span class=c1># Statistical test</span>
<span class=n>control</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;variant&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;control&#39;</span><span class=p>][</span><span class=s1>&#39;converted&#39;</span><span class=p>]</span>
<span class=n>treatment</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;variant&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;treatment&#39;</span><span class=p>][</span><span class=s1>&#39;converted&#39;</span><span class=p>]</span>

<span class=c1># Chi-squared test for proportions</span>
<span class=n>contingency</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;variant&#39;</span><span class=p>],</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;converted&#39;</span><span class=p>])</span>
<span class=n>chi2</span><span class=p>,</span> <span class=n>p_value</span><span class=p>,</span> <span class=n>dof</span><span class=p>,</span> <span class=n>expected</span> <span class=o>=</span> <span class=n>stats</span><span class=o>.</span><span class=n>chi2_contingency</span><span class=p>(</span><span class=n>contingency</span><span class=p>)</span>

<span class=c1># Or use proportion z-test</span>
<span class=kn>from</span><span class=w> </span><span class=nn>statsmodels.stats.proportion</span><span class=w> </span><span class=kn>import</span> <span class=n>proportions_ztest</span>
<span class=n>count</span> <span class=o>=</span> <span class=p>[</span><span class=n>treatment</span><span class=o>.</span><span class=n>sum</span><span class=p>(),</span> <span class=n>control</span><span class=o>.</span><span class=n>sum</span><span class=p>()]</span>
<span class=n>nobs</span> <span class=o>=</span> <span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>treatment</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>control</span><span class=p>)]</span>
<span class=n>z_stat</span><span class=p>,</span> <span class=n>p_value</span> <span class=o>=</span> <span class=n>proportions_ztest</span><span class=p>(</span><span class=n>count</span><span class=p>,</span> <span class=n>nobs</span><span class=p>)</span>

<span class=c1># Confidence interval for lift</span>
<span class=n>lift</span> <span class=o>=</span> <span class=p>(</span><span class=n>treatment</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=o>-</span> <span class=n>control</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span> <span class=o>/</span> <span class=n>control</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Statistical analysis skills.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Calculates conversion rates</li> <li>Uses appropriate statistical test</li> <li>Interprets p-value correctly</li> </ul> </div> </details> <hr> <h3 id=how-to-use-copy-on-write-cow-in-pandas-20-google-meta-interview-question>How to Use Copy-on-Write (CoW) in Pandas 2.0+? - Google, Meta Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Internals</code>, <code>Performance</code> | <strong>Asked by:</strong> Google, Meta, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>Copy-on-Write Explained:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=c1># Enable globally</span>
<span class=n>pd</span><span class=o>.</span><span class=n>options</span><span class=o>.</span><span class=n>mode</span><span class=o>.</span><span class=n>copy_on_write</span> <span class=o>=</span> <span class=kc>True</span>

<span class=c1># Or use context manager</span>
<span class=k>with</span> <span class=n>pd</span><span class=o>.</span><span class=n>option_context</span><span class=p>(</span><span class=s1>&#39;mode.copy_on_write&#39;</span><span class=p>,</span> <span class=kc>True</span><span class=p>):</span>
    <span class=n>df2</span> <span class=o>=</span> <span class=n>df</span><span class=p>[[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]]</span>
    <span class=n>df2</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>  <span class=c1># Creates copy only when modified</span>
</code></pre></div> <p><strong>Benefits:</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>Without CoW</th> <th>With CoW</th> </tr> </thead> <tbody> <tr> <td>Memory</td> <td>Copies on slice</td> <td>Shares until modified</td> </tr> <tr> <td>Safety</td> <td>Ambiguous</td> <td>Always safe</td> </tr> <tr> <td>Speed</td> <td>Unnecessary copies</td> <td>Lazy copies</td> </tr> </tbody> </table> <p><strong>Behavior:</strong></p> <div class=highlight><pre><span></span><code><span class=n>pd</span><span class=o>.</span><span class=n>options</span><span class=o>.</span><span class=n>mode</span><span class=o>.</span><span class=n>copy_on_write</span> <span class=o>=</span> <span class=kc>True</span>

<span class=c1># Views share data until modification</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]})</span>
<span class=n>df2</span> <span class=o>=</span> <span class=n>df</span><span class=p>[[</span><span class=s1>&#39;A&#39;</span><span class=p>]]</span>  <span class=c1># No copy yet</span>

<span class=n>df2</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>  <span class=c1># Copy created here</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>  <span class=c1># Original unchanged!</span>

<span class=c1># No more SettingWithCopyWarning</span>
<span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>][</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>99</span>  <span class=c1># Safe, no effect on df</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Modern Pandas knowledge.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows CoW mechanism</li> <li>Understands lazy copying</li> <li>Knows it's default in Pandas 3.0</li> </ul> </div> </details> <hr> <h3 id=how-to-use-pyarrow-backend-for-better-performance-google-amazon-interview-question>How to Use PyArrow Backend for Better Performance? - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Performance</code>, <code>Arrow</code> | <strong>Asked by:</strong> Google, Amazon, Databricks</p> <details class=success> <summary>View Answer</summary> <p><strong>PyArrow Backend (Pandas 2.0+):</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=c1># Read with PyArrow backend</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;data.csv&#39;</span><span class=p>,</span> <span class=n>dtype_backend</span><span class=o>=</span><span class=s1>&#39;pyarrow&#39;</span><span class=p>)</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>(</span><span class=s1>&#39;data.parquet&#39;</span><span class=p>,</span> <span class=n>dtype_backend</span><span class=o>=</span><span class=s1>&#39;pyarrow&#39;</span><span class=p>)</span>

<span class=c1># Convert existing DataFrame</span>
<span class=n>df_arrow</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>convert_dtypes</span><span class=p>(</span><span class=n>dtype_backend</span><span class=o>=</span><span class=s1>&#39;pyarrow&#39;</span><span class=p>)</span>

<span class=c1># Check types</span>
<span class=n>df_arrow</span><span class=o>.</span><span class=n>dtypes</span>
<span class=c1># int64[pyarrow], string[pyarrow], etc.</span>
</code></pre></div> <p><strong>Benefits:</strong></p> <table> <thead> <tr> <th>Feature</th> <th>NumPy Backend</th> <th>PyArrow Backend</th> </tr> </thead> <tbody> <tr> <td>String memory</td> <td>High</td> <td>Low</td> </tr> <tr> <td>Null handling</td> <td>float64 trick</td> <td>Native</td> </tr> <tr> <td>Interop</td> <td>Limited</td> <td>Arrow ecosystem</td> </tr> </tbody> </table> <p><strong>String Performance:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># PyArrow strings are much more efficient</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;text_col&#39;</span><span class=p>]</span>  <span class=c1># With PyArrow: less memory, faster ops</span>

<span class=c1># Native null support</span>
<span class=n>df_arrow</span><span class=p>[</span><span class=s1>&#39;int_col&#39;</span><span class=p>]</span>  <span class=c1># Can have Int64 with nulls</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Cutting-edge Pandas.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows Arrow for string efficiency</li> <li>Uses for interop with Spark/Arrow</li> <li>Understands when to use</li> </ul> </div> </details> <hr> <h2 id=quick-reference-127-interview-questions>Quick Reference: 127+ Interview Questions</h2> <table> <thead> <tr> <th>Sno</th> <th>Question Title</th> <th>Practice Links</th> <th>Companies Asking</th> <th>Difficulty</th> <th>Topics</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>What is Pandas and why is it used?</td> <td><a href=https://pandas.pydata.org/docs/getting_started/overview.html>Pandas Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Easy</td> <td>Basics, Introduction</td> </tr> <tr> <td>2</td> <td>Difference between Series and DataFrame</td> <td><a href=https://www.geeksforgeeks.org/python-pandas-dataframe/ >GeeksforGeeks</a></td> <td>Google, Amazon, Meta, Microsoft</td> <td>Easy</td> <td>Data Structures</td> </tr> <tr> <td>3</td> <td>How to create a DataFrame from dictionary?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html>Pandas Docs</a></td> <td>Amazon, Google, Flipkart</td> <td>Easy</td> <td>DataFrame Creation</td> </tr> <tr> <td>4</td> <td>Difference between loc and iloc</td> <td><a href=https://stackoverflow.com/questions/28757389/pandas-loc-vs-iloc-vs-at-vs-iat>Stack Overflow</a></td> <td>Google, Amazon, Meta, Apple, Netflix</td> <td>Easy</td> <td>Indexing, Selection</td> </tr> <tr> <td>5</td> <td>How to read CSV, Excel, JSON files?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/io.html>Pandas Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Data I/O</td> </tr> <tr> <td>6</td> <td>How to handle missing values (NaN)?</td> <td><a href=https://realpython.com/python-pandas-missing-data/ >Real Python</a></td> <td>Google, Amazon, Meta, Netflix, Apple</td> <td>Medium</td> <td>Missing Data, fillna, dropna</td> </tr> <tr> <td>7</td> <td>Difference between dropna() and fillna()</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.fillna.html>Pandas Docs</a></td> <td>Amazon, Google, Microsoft</td> <td>Easy</td> <td>Missing Data</td> </tr> <tr> <td>8</td> <td>Explain GroupBy in Pandas</td> <td><a href=https://realpython.com/pandas-groupby/ >Real Python</a></td> <td>Google, Amazon, Meta, Netflix, Apple</td> <td>Medium</td> <td>GroupBy, Aggregation</td> </tr> <tr> <td>9</td> <td>How to merge two DataFrames?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/merging.html>Pandas Docs</a></td> <td>Google, Amazon, Meta, Microsoft</td> <td>Medium</td> <td>Merging, Joining</td> </tr> <tr> <td>10</td> <td>Difference between merge(), join(), concat()</td> <td><a href=https://stackoverflow.com/questions/40468069/pandas-merge-join-and-concat-difference>Stack Overflow</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Merging, Joining, Concatenation</td> </tr> <tr> <td>11</td> <td>How to apply a function to DataFrame?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply.html>Pandas Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>apply, applymap, map</td> </tr> <tr> <td>12</td> <td>Difference between apply(), map(), applymap()</td> <td><a href=https://www.geeksforgeeks.org/difference-between-map-applymap-and-apply-methods-in-pandas/ >GeeksforGeeks</a></td> <td>Google, Amazon, Microsoft</td> <td>Medium</td> <td>Data Transformation</td> </tr> <tr> <td>13</td> <td>How to rename columns in DataFrame?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rename.html>Pandas Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Column Operations</td> </tr> <tr> <td>14</td> <td>How to sort DataFrame by column values?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sort_values.html>Pandas Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Sorting</td> </tr> <tr> <td>15</td> <td>How to filter rows based on conditions?</td> <td><a href=https://pandas.pydata.org/docs/getting_started/intro_tutorials/03_subset_data.html>Pandas Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Easy</td> <td>Filtering, Boolean Indexing</td> </tr> <tr> <td>16</td> <td>How to remove duplicate rows?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop_duplicates.html>Pandas Docs</a></td> <td>Amazon, Google, Microsoft</td> <td>Easy</td> <td>Data Cleaning, Deduplication</td> </tr> <tr> <td>17</td> <td>How to change data types of columns?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.astype.html>Pandas Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Data Types</td> </tr> <tr> <td>18</td> <td>What is the difference between copy() and view?</td> <td><a href=https://stackoverflow.com/questions/27673231/what-does-the-copy-method-do-in-pandas>Stack Overflow</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Memory Management</td> </tr> <tr> <td>19</td> <td>Explain pivot tables in Pandas</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.pivot_table.html>Pandas Docs</a></td> <td>Amazon, Google, Microsoft, Netflix</td> <td>Medium</td> <td>Pivot Tables, Reshaping</td> </tr> <tr> <td>20</td> <td>Difference between pivot() and pivot_table()</td> <td><a href=https://stackoverflow.com/questions/30960338/pandas-pivot-vs-pivot-table-what-is-the-difference>Stack Overflow</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Reshaping</td> </tr> <tr> <td>21</td> <td>How to handle datetime data in Pandas?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/timeseries.html>Pandas Docs</a></td> <td>Google, Amazon, Netflix, Meta</td> <td>Medium</td> <td>DateTime, Time Series</td> </tr> <tr> <td>22</td> <td>How to create a date range?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.date_range.html>Pandas Docs</a></td> <td>Amazon, Netflix, Google</td> <td>Easy</td> <td>DateTime</td> </tr> <tr> <td>23</td> <td>What is MultiIndex (Hierarchical Indexing)?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/advanced.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Hard</td> <td>MultiIndex, Hierarchical Data</td> </tr> <tr> <td>24</td> <td>How to reset and set index?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.reset_index.html>Pandas Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Indexing</td> </tr> <tr> <td>25</td> <td>How to perform rolling window calculations?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rolling.html>Pandas Docs</a></td> <td>Google, Amazon, Netflix, Apple</td> <td>Medium</td> <td>Rolling Windows, Time Series</td> </tr> <tr> <td>26</td> <td>How to calculate moving averages?</td> <td><a href=https://www.geeksforgeeks.org/how-to-calculate-moving-average-in-a-pandas-dataframe/ >GeeksforGeeks</a></td> <td>Google, Amazon, Netflix, Apple</td> <td>Medium</td> <td>Rolling Windows, Finance</td> </tr> <tr> <td>27</td> <td>How to perform resampling on time series?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.resample.html>Pandas Docs</a></td> <td>Google, Amazon, Netflix</td> <td>Medium</td> <td>Resampling, Time Series</td> </tr> <tr> <td>28</td> <td>Difference between transform() and apply()</td> <td><a href=https://stackoverflow.com/questions/27517425/apply-vs-transform-on-a-group-object>Stack Overflow</a></td> <td>Google, Amazon, Meta</td> <td>Hard</td> <td>GroupBy, Data Transformation</td> </tr> <tr> <td>29</td> <td>How to create bins with cut() and qcut()?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.cut.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Discretization, Binning</td> </tr> <tr> <td>30</td> <td>How to handle categorical data?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/categorical.html>Pandas Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Categorical Data, Memory</td> </tr> <tr> <td>31</td> <td>How to one-hot encode categorical data?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.get_dummies.html>Pandas Docs</a></td> <td>Google, Amazon, Meta, Microsoft</td> <td>Easy</td> <td>Feature Engineering, ML</td> </tr> <tr> <td>32</td> <td>How to read data from SQL database?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.read_sql.html>Pandas Docs</a></td> <td>Amazon, Google, Microsoft</td> <td>Medium</td> <td>Database I/O</td> </tr> <tr> <td>33</td> <td>How to export DataFrame to various formats?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/io.html>Pandas Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Data Export</td> </tr> <tr> <td>34</td> <td>How to handle large datasets efficiently?</td> <td><a href=https://towardsdatascience.com/why-and-how-to-use-pandas-with-large-data-9594c2b3f7f0>Towards Data Science</a></td> <td>Google, Amazon, Netflix, Meta</td> <td>Hard</td> <td>Performance, Memory Optimization</td> </tr> <tr> <td>35</td> <td>What is Categorical dtype and when to use it?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/categorical.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Data Types, Memory Optimization</td> </tr> <tr> <td>36</td> <td>How to optimize memory usage in Pandas?</td> <td><a href=https://medium.com/bigdatarepublic/advanced-pandas-optimize-speed-and-memory-a654b53be4c9>Medium</a></td> <td>Google, Amazon, Netflix</td> <td>Hard</td> <td>Memory Optimization</td> </tr> <tr> <td>37</td> <td>Difference between inplace=True and returning copy</td> <td><a href=https://stackoverflow.com/questions/43893457/pandas-inplace-true-vs-creating-a-new-variable>Stack Overflow</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>DataFrame Modification</td> </tr> <tr> <td>38</td> <td>How to use query() method for filtering?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Easy</td> <td>Filtering, Query</td> </tr> <tr> <td>39</td> <td>How to work with string data (str accessor)?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/text.html>Pandas Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>String Operations</td> </tr> <tr> <td>40</td> <td>How to use str accessor methods?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.Series.str.html>Pandas Docs</a></td> <td>Amazon, Google, Microsoft</td> <td>Medium</td> <td>String Operations</td> </tr> <tr> <td>41</td> <td>How to split and expand string columns?</td> <td><a href=https://www.geeksforgeeks.org/python-pandas-split-a-list-values-into-multiple-columns/ >GeeksforGeeks</a></td> <td>Amazon, Google, Meta</td> <td>Medium</td> <td>String Operations, Data Cleaning</td> </tr> <tr> <td>42</td> <td>How to use melt() for unpivoting data?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.melt.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Reshaping, Unpivoting</td> </tr> <tr> <td>43</td> <td>How to use stack() and unstack()?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.stack.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Reshaping, MultiIndex</td> </tr> <tr> <td>44</td> <td>How to cross-tabulate with crosstab()?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.crosstab.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Cross Tabulation, Analysis</td> </tr> <tr> <td>45</td> <td>How to calculate correlations?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.corr.html>Pandas Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Easy</td> <td>Statistical Analysis</td> </tr> <tr> <td>46</td> <td>How to calculate descriptive statistics?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.describe.html>Pandas Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Statistical Analysis</td> </tr> <tr> <td>47</td> <td>How to use agg() for multiple aggregations?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.agg.html>Pandas Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Aggregation</td> </tr> <tr> <td>48</td> <td>How to use named aggregations?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.core.groupby.DataFrameGroupBy.agg.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>GroupBy, Named Aggregation</td> </tr> <tr> <td>49</td> <td>How to handle timezone-aware datetime?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/timeseries.html#time-zone-handling>Pandas Docs</a></td> <td>Google, Amazon, Netflix</td> <td>Medium</td> <td>DateTime, Timezones</td> </tr> <tr> <td>50</td> <td>How to interpolate missing values?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.interpolate.html>Pandas Docs</a></td> <td>Google, Amazon, Netflix</td> <td>Medium</td> <td>Missing Data, Interpolation</td> </tr> <tr> <td>51</td> <td>How to forward fill and backward fill?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.ffill.html>Pandas Docs</a></td> <td>Amazon, Netflix, Google</td> <td>Easy</td> <td>Missing Data, Time Series</td> </tr> <tr> <td>52</td> <td>How to use where() and mask() methods?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.where.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Conditional Operations</td> </tr> <tr> <td>53</td> <td>How to clip values in DataFrame?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.clip.html>Pandas Docs</a></td> <td>Amazon, Google, Meta</td> <td>Easy</td> <td>Data Transformation</td> </tr> <tr> <td>54</td> <td>How to rank values in Pandas?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rank.html>Pandas Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Easy</td> <td>Ranking</td> </tr> <tr> <td>55</td> <td>How to calculate percentage change?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pct_change.html>Pandas Docs</a></td> <td>Google, Amazon, Netflix, Apple</td> <td>Easy</td> <td>Time Series, Finance</td> </tr> <tr> <td>56</td> <td>How to shift and lag data?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.shift.html>Pandas Docs</a></td> <td>Google, Amazon, Netflix</td> <td>Easy</td> <td>Time Series, Lag Features</td> </tr> <tr> <td>57</td> <td>How to calculate cumulative statistics?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.cumsum.html>Pandas Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Easy</td> <td>Cumulative Operations</td> </tr> <tr> <td>58</td> <td>How to use explode() for list columns?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.explode.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>List Operations, Data Preprocessing</td> </tr> <tr> <td>59</td> <td>How to sample data from DataFrame?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sample.html>Pandas Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Easy</td> <td>Sampling</td> </tr> <tr> <td>60</td> <td>How to detect and handle outliers?</td> <td><a href=https://towardsdatascience.com/detecting-and-treating-outliers-in-python-1c66d55f0b8d>Towards Data Science</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Outlier Detection, Data Cleaning</td> </tr> <tr> <td>61</td> <td>How to normalize/standardize data?</td> <td><a href=https://www.geeksforgeeks.org/python-pandas-dataframe-normalization/ >GeeksforGeeks</a></td> <td>Google, Amazon, Meta, Microsoft</td> <td>Medium</td> <td>Feature Engineering, ML</td> </tr> <tr> <td>62</td> <td>How to use eval() for efficient operations?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.eval.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Hard</td> <td>Performance Optimization</td> </tr> <tr> <td>63</td> <td>How to perform element-wise operations?</td> <td><a href=https://pandas.pydata.org/docs/getting_started/intro_tutorials/05_add_columns.html>Pandas Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Arithmetic Operations</td> </tr> <tr> <td>64</td> <td>Why vectorized operations are faster than loops?</td> <td><a href=https://realpython.com/numpy-scipy-pandas-differences/ >Real Python</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Performance, Vectorization</td> </tr> <tr> <td>65</td> <td>How to profile Pandas code performance?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/enhancingperf.html>Pandas Docs</a></td> <td>Google, Amazon, Netflix</td> <td>Hard</td> <td>Performance Profiling</td> </tr> <tr> <td>66</td> <td>How to use pipe() for method chaining?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pipe.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Method Chaining</td> </tr> <tr> <td>67</td> <td>How to handle SettingWithCopyWarning?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/indexing.html#returning-a-view-versus-a-copy>Pandas Docs</a></td> <td>Google, Amazon, Meta, Microsoft</td> <td>Medium</td> <td>Common Errors, Debugging</td> </tr> <tr> <td>68</td> <td>How to compare two DataFrames?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.compare.html>Pandas Docs</a></td> <td>Amazon, Google, Microsoft</td> <td>Medium</td> <td>Data Comparison, Validation</td> </tr> <tr> <td>69</td> <td>How to combine DataFrames with different schemas?</td> <td><a href=https://stackoverflow.com/questions/23668427/pandas-three-way-joining-multiple-dataframes-on-columns>Stack Overflow</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Merging, Schema Alignment</td> </tr> <tr> <td>70</td> <td>How to create conditional columns?</td> <td><a href=https://www.geeksforgeeks.org/adding-new-column-to-existing-dataframe-in-pandas/ >GeeksforGeeks</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Data Transformation</td> </tr> <tr> <td>71</td> <td>How to use np.where() with Pandas?</td> <td><a href=https://realpython.com/numpy-array-programming/ >Real Python</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Easy</td> <td>Conditional Operations</td> </tr> <tr> <td>72</td> <td>How to use np.select() for multiple conditions?</td> <td><a href=https://stackoverflow.com/questions/19913659/pandas-conditional-creation-of-a-series-dataframe-column>Stack Overflow</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Conditional Operations</td> </tr> <tr> <td>73</td> <td>How to count value frequencies?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.Series.value_counts.html>Pandas Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Data Exploration</td> </tr> <tr> <td>74</td> <td>How to find unique values and nunique()?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.nunique.html>Pandas Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Data Exploration</td> </tr> <tr> <td>75</td> <td>How to check for null values?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isnull.html>Pandas Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Missing Data</td> </tr> <tr> <td>76</td> <td>How to use any() and all() methods?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.any.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Easy</td> <td>Boolean Operations</td> </tr> <tr> <td>77</td> <td>How to select specific columns?</td> <td><a href=https://pandas.pydata.org/docs/getting_started/intro_tutorials/03_subset_data.html>Pandas Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Column Selection</td> </tr> <tr> <td>78</td> <td>How to drop columns or rows?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop.html>Pandas Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Data Cleaning</td> </tr> <tr> <td>79</td> <td>How to use assign() for creating new columns?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.assign.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Easy</td> <td>Column Creation</td> </tr> <tr> <td>80</td> <td>How to use idxmax() and idxmin()?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.idxmax.html>Pandas Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Easy</td> <td>Indexing</td> </tr> <tr> <td>81</td> <td>Why is iterating over rows slow?</td> <td><a href=https://stackoverflow.com/questions/16476924/how-to-iterate-over-rows-in-a-dataframe-in-pandas>Stack Overflow</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Performance</td> </tr> <tr> <td>82</td> <td>How to use iterrows() and itertuples()?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.iterrows.html>Pandas Docs</a></td> <td>Amazon, Google, Microsoft</td> <td>Easy</td> <td>Iteration</td> </tr> <tr> <td>83</td> <td>How to vectorize custom functions?</td> <td><a href=https://realpython.com/numpy-scipy-pandas-intro/ >Real Python</a></td> <td>Google, Amazon, Meta</td> <td>Hard</td> <td>Performance Optimization</td> </tr> <tr> <td>84</td> <td>How to use Pandas with NumPy?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/basics.html>Pandas Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Easy</td> <td>NumPy Integration</td> </tr> <tr> <td>85</td> <td>How to flatten hierarchical index?</td> <td><a href=https://stackoverflow.com/questions/14507794/how-to-flatten-multiindex-columns>Stack Overflow</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>MultiIndex</td> </tr> <tr> <td>86</td> <td>How to group by multiple columns?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/groupby.html>Pandas Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>GroupBy</td> </tr> <tr> <td>87</td> <td>How to filter groups after GroupBy?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.core.groupby.DataFrameGroupBy.filter.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>GroupBy, Filtering</td> </tr> <tr> <td>88</td> <td>How to get first/last n rows per group?</td> <td><a href=https://stackoverflow.com/questions/20067636/pandas-dataframe-get-first-row-of-each-group>Stack Overflow</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>GroupBy</td> </tr> <tr> <td>89</td> <td>How to handle JSON with nested structures?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.json_normalize.html>Pandas Docs</a></td> <td>Amazon, Google, Meta</td> <td>Medium</td> <td>JSON Processing</td> </tr> <tr> <td>90</td> <td>How to read/write Parquet files?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.read_parquet.html>Pandas Docs</a></td> <td>Google, Amazon, Netflix, Meta</td> <td>Easy</td> <td>File I/O, Big Data</td> </tr> <tr> <td>91</td> <td>Difference between Parquet, CSV, and Feather</td> <td><a href=https://towardsdatascience.com/the-best-format-to-save-pandas-data-414dca023e0d>Towards Data Science</a></td> <td>Google, Amazon, Netflix</td> <td>Medium</td> <td>File Formats, Performance</td> </tr> <tr> <td>92</td> <td>How to use chunksize for large files?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html>Pandas Docs</a></td> <td>Google, Amazon, Netflix, Meta</td> <td>Medium</td> <td>Large Data Processing</td> </tr> <tr> <td>93</td> <td>How to use nsmallest() and nlargest()?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.nlargest.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Easy</td> <td>Selection</td> </tr> <tr> <td>94</td> <td>How to calculate weighted average?</td> <td><a href=https://stackoverflow.com/questions/10951341/pandas-dataframe-aggregate-function-using-multiple-columns>Stack Overflow</a></td> <td>Google, Amazon, Netflix, Apple</td> <td>Medium</td> <td>Aggregation, Finance</td> </tr> <tr> <td>95</td> <td>How to perform window functions like SQL?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/window.html>Pandas Docs</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Window Functions</td> </tr> <tr> <td>96</td> <td>How to join on nearest key (asof join)?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.merge_asof.html>Pandas Docs</a></td> <td>Google, Amazon, Netflix, Apple</td> <td>Hard</td> <td>Joining, Time Series</td> </tr> <tr> <td>97</td> <td>How to use combine_first() for data merging?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.combine_first.html>Pandas Docs</a></td> <td>Amazon, Google, Microsoft</td> <td>Medium</td> <td>Merging</td> </tr> <tr> <td>98</td> <td>How to create period indices?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.period_range.html>Pandas Docs</a></td> <td>Google, Amazon, Netflix</td> <td>Medium</td> <td>Time Series</td> </tr> <tr> <td>99</td> <td>How to use Timedelta for time differences?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.Timedelta.html>Pandas Docs</a></td> <td>Google, Amazon, Netflix</td> <td>Easy</td> <td>DateTime</td> </tr> <tr> <td>100</td> <td>How to set display options globally?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/options.html>Pandas Docs</a></td> <td>Most Tech Companies</td> <td>Easy</td> <td>Display Options</td> </tr> <tr> <td>101</td> <td>What is method chaining and when to use it?</td> <td><a href=https://tomaugspurger.github.io/method-chaining.html>Tom Augspurger Blog</a></td> <td>Google, Amazon, Meta</td> <td>Medium</td> <td>Method Chaining, Clean Code</td> </tr> <tr> <td>102</td> <td>How to calculate month-over-month change?</td> <td><a href=https://www.stratascratch.com/ >StrataScratch</a></td> <td>Google, Amazon, Meta, Netflix</td> <td>Medium</td> <td>Time Series, Analytics</td> </tr> <tr> <td>103</td> <td>How to find customers with highest orders?</td> <td><a href=https://datalemur.com/ >DataLemur</a></td> <td>Amazon, Google, Meta, Netflix</td> <td>Medium</td> <td>GroupBy, Aggregation</td> </tr> <tr> <td>104</td> <td><strong>[HARD]</strong> How to calculate retention metrics efficiently?</td> <td><a href=https://www.stratascratch.com/ >StrataScratch</a></td> <td>Meta, Netflix, Amazon, Google</td> <td>Hard</td> <td>Cohort Analysis, Time Series</td> </tr> <tr> <td>105</td> <td><strong>[HARD]</strong> How to implement A/B test analysis?</td> <td><a href=https://towardsdatascience.com/ >Towards Data Science</a></td> <td>Meta, Google, Netflix, Amazon</td> <td>Hard</td> <td>Statistical Analysis, Testing</td> </tr> <tr> <td>106</td> <td><strong>[HARD]</strong> How to optimize memory with <code>category</code> types?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/categorical.html>Pandas Docs</a></td> <td>Google, Amazon, Netflix</td> <td>Hard</td> <td>Memory Optimization</td> </tr> <tr> <td>107</td> <td><strong>[HARD]</strong> How to implement cohort analysis?</td> <td><a href=https://towardsdatascience.com/ >Towards Data Science</a></td> <td>Meta, Netflix, Amazon, Google</td> <td>Hard</td> <td>Cohort Analysis</td> </tr> <tr> <td>108</td> <td><strong>[HARD]</strong> How to calculate funnel drop-off rates?</td> <td><a href=https://www.stratascratch.com/ >StrataScratch</a></td> <td>Meta, Google, Amazon, Netflix</td> <td>Hard</td> <td>Funnel Analysis, Analytics</td> </tr> <tr> <td>109</td> <td><strong>[HARD]</strong> How to implement custom testing using <code>assert_frame_equal</code>?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.testing.assert_frame_equal.html>Pandas Docs</a></td> <td>Google, Amazon, Microsoft</td> <td>Hard</td> <td>Testing, Quality</td> </tr> <tr> <td>110</td> <td><strong>[HARD]</strong> How to handle sparse data structures?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/sparse.html>Pandas Docs</a></td> <td>Google, Amazon, Netflix</td> <td>Hard</td> <td>Sparse Data, Memory</td> </tr> <tr> <td>111</td> <td><strong>[HARD]</strong> How to use Numba/JIT with Pandas?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/enhancingperf.html>Pandas Docs</a></td> <td>Google, Amazon, Hedge Funds</td> <td>Hard</td> <td>Performance</td> </tr> <tr> <td>112</td> <td><strong>[HARD]</strong> How to implement custom accessors?</td> <td><a href=https://pandas.pydata.org/docs/development/extending.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Hard</td> <td>Extending Pandas</td> </tr> <tr> <td>113</td> <td><strong>[HARD]</strong> How to use Swifter for parallel processing?</td> <td><a href=https://github.com/jmcarpenter2/swifter>Swifter Docs</a></td> <td>Google, Amazon, Uber</td> <td>Hard</td> <td>Parallelism</td> </tr> <tr> <td>114</td> <td><strong>[HARD]</strong> Explain Pandas Block Manager structure</td> <td><a href=https://github.com/pandas-dev/pandas/wiki>Pandas Wiki</a></td> <td>Google, Amazon, Meta</td> <td>Hard</td> <td>Internals</td> </tr> <tr> <td>115</td> <td><strong>[HARD]</strong> How Copy-on-Write (CoW) works in Pandas 2.0+?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/copy_on_write.html>Pandas Docs</a></td> <td>Google, Meta, Microsoft</td> <td>Hard</td> <td>Internals, Performance</td> </tr> <tr> <td>116</td> <td><strong>[HARD]</strong> How to use PyArrow backend for performance?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/pyarrow.html>Pandas Docs</a></td> <td>Google, Amazon, Databricks</td> <td>Hard</td> <td>Performance, Arrow</td> </tr> <tr> <td>117</td> <td><strong>[HARD]</strong> How to implement custom index types?</td> <td><a href=https://pandas.pydata.org/docs/development/extending.html>Pandas Docs</a></td> <td>Google, Amazon</td> <td>Hard</td> <td>Extending Pandas</td> </tr> <tr> <td>118</td> <td><strong>[HARD]</strong> How to optimize MultiIndex slicing performance?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/advanced.html>Pandas Docs</a></td> <td>Google, Amazon, Hedge Funds</td> <td>Hard</td> <td>Optimization</td> </tr> <tr> <td>119</td> <td><strong>[HARD]</strong> <code>groupby().transform()</code> internal mechanics vs <code>apply()</code></td> <td><a href=https://pandas.pydata.org/docs/user_guide/groupby.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Hard</td> <td>Deep Dive</td> </tr> <tr> <td>120</td> <td><strong>[HARD]</strong> How to implement rolling window with <code>raw=True</code>?</td> <td><a href=https://pandas.pydata.org/docs/reference/api/pandas.core.window.rolling.Rolling.apply.html>Pandas Docs</a></td> <td>Google, Amazon, Hedge Funds</td> <td>Hard</td> <td>Optimization</td> </tr> <tr> <td>121</td> <td><strong>[HARD]</strong> How to extend Pandas with custom plotting backends?</td> <td><a href=https://pandas.pydata.org/docs/development/extending.html>Pandas Docs</a></td> <td>Google, Amazon</td> <td>Hard</td> <td>Extending Pandas</td> </tr> <tr> <td>122</td> <td><strong>[HARD]</strong> How to handle time series offset aliases?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/timeseries.html>Pandas Docs</a></td> <td>Google, Amazon, Hedge Funds</td> <td>Hard</td> <td>Time Series</td> </tr> <tr> <td>123</td> <td><strong>[HARD]</strong> How to use Dask DataFrames for out-of-core computing?</td> <td><a href=https://docs.dask.org/en/stable/dataframe.html>Dask Docs</a></td> <td>Google, Amazon, Netflix</td> <td>Hard</td> <td>Big Data</td> </tr> <tr> <td>124</td> <td><strong>[HARD]</strong> How to optimize chained assignment performance?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/indexing.html>Pandas Docs</a></td> <td>Google, Amazon, Meta</td> <td>Hard</td> <td>Optimization</td> </tr> <tr> <td>125</td> <td><strong>[HARD]</strong> Nullable integers/floats implementation?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/integer_na.html>Pandas Docs</a></td> <td>Google, Amazon, Microsoft</td> <td>Hard</td> <td>Internals</td> </tr> <tr> <td>126</td> <td><strong>[HARD]</strong> How to use Cython with Pandas?</td> <td><a href=https://pandas.pydata.org/docs/user_guide/enhancingperf.html>Pandas Docs</a></td> <td>Google, Amazon, HFT Firms</td> <td>Hard</td> <td>Performance</td> </tr> <tr> <td>127</td> <td><strong>[HARD]</strong> Comparison of Parquet vs Feather vs ORC?</td> <td><a href=https://arrow.apache.org/ >Apache Arrow</a></td> <td>Google, Amazon, Netflix</td> <td>Hard</td> <td>Systems</td> </tr> </tbody> </table> <hr> <h2 id=code-examples>Code Examples</h2> <h3 id=1-memory-optimization>1. Memory Optimization</h3> <details class=success> <summary>View Code Example</summary> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Code Example</code> | <strong>Asked by:</strong> Code Pattern <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># Typical large dataframe creation</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>],</span> <span class=n>size</span><span class=o>=</span><span class=mi>1000000</span><span class=p>),</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>1000000</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># Memory usage before optimization</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span><span class=p>,</span> <span class=s2>&quot;MB&quot;</span><span class=p>)</span>

<span class=c1># Optimize by converting object to category</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span>

<span class=c1># Memory usage after optimization</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span><span class=p>,</span> <span class=s2>&quot;MB&quot;</span><span class=p>)</span>
</code></pre></div></p> </details> <h3 id=2-method-chaining-for-clean-code>2. Method Chaining for Clean Code</h3> <details class=success> <summary>View Code Example</summary> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Code Example</code> | <strong>Asked by:</strong> Code Pattern <div class=highlight><pre><span></span><code><span class=c1># Instead of multiple intermediate variables</span>
<span class=n>df</span> <span class=o>=</span> <span class=p>(</span>
    <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;data.csv&#39;</span><span class=p>)</span>
    <span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;status == &quot;active&quot;&#39;</span><span class=p>)</span>
    <span class=o>.</span><span class=n>assign</span><span class=p>(</span>
        <span class=n>year</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>year</span><span class=p>,</span>
        <span class=n>total_cost</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span>
    <span class=p>)</span>
    <span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=s1>&#39;year&#39;</span><span class=p>,</span> <span class=s1>&#39;region&#39;</span><span class=p>])</span>
    <span class=o>.</span><span class=n>agg</span><span class=p>(</span><span class=n>total_revenue</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;total_cost&#39;</span><span class=p>,</span> <span class=s1>&#39;sum&#39;</span><span class=p>))</span>
    <span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
    <span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;total_revenue&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=p>)</span>
</code></pre></div></p> </details> <h3 id=3-parallel-processing-with-swifter>3. Parallel Processing with Swifter</h3> <details class=success> <summary>View Code Example</summary> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Code Example</code> | <strong>Asked by:</strong> Code Pattern <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>swifter</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;text&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;some text&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>100000</span><span class=p>})</span>

<span class=k>def</span><span class=w> </span><span class=nf>heavy_processing</span><span class=p>(</span><span class=n>text</span><span class=p>):</span>
    <span class=c1># Simulate heavy work</span>
    <span class=k>return</span> <span class=n>text</span><span class=o>.</span><span class=n>upper</span><span class=p>()[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>

<span class=c1># Automatic parallelization</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;processed&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;text&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>swifter</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>heavy_processing</span><span class=p>)</span>
</code></pre></div></p> </details> <hr> <h3 id=explain-multiindex-in-pandas-google-meta-interview-question>Explain MultiIndex in Pandas - Google, Meta Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>MultiIndex</code>, <code>Hierarchical Data</code>, <code>Advanced Indexing</code> | <strong>Asked by:</strong> Google, Meta, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>MultiIndex</strong> creates hierarchical row/column labels, enabling multi-dimensional data in 2D DataFrames. Essential for time series, grouped data, and pivot operations.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># 1. Creating MultiIndex</span>
<span class=c1># From tuples</span>
<span class=n>index</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>MultiIndex</span><span class=o>.</span><span class=n>from_tuples</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;USA&#39;</span><span class=p>,</span> <span class=s1>&#39;NY&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;USA&#39;</span><span class=p>,</span> <span class=s1>&#39;CA&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;UK&#39;</span><span class=p>,</span> <span class=s1>&#39;London&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;UK&#39;</span><span class=p>,</span> <span class=s1>&#39;Manchester&#39;</span><span class=p>)</span>
<span class=p>],</span> <span class=n>names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Country&#39;</span><span class=p>,</span> <span class=s1>&#39;City&#39;</span><span class=p>])</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;Population&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>8_000_000</span><span class=p>,</span> <span class=mi>4_000_000</span><span class=p>,</span> <span class=mi>9_000_000</span><span class=p>,</span> <span class=mi>500_000</span><span class=p>],</span>
    <span class=s1>&#39;GDP&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1500</span><span class=p>,</span> <span class=mi>3000</span><span class=p>,</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>80</span><span class=p>]</span>
<span class=p>},</span> <span class=n>index</span><span class=o>=</span><span class=n>index</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># 2. From product</span>
<span class=n>idx</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>MultiIndex</span><span class=o>.</span><span class=n>from_product</span><span class=p>(</span>
    <span class=p>[[</span><span class=s1>&#39;2023&#39;</span><span class=p>,</span> <span class=s1>&#39;2024&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>,</span> <span class=s1>&#39;Q3&#39;</span><span class=p>,</span> <span class=s1>&#39;Q4&#39;</span><span class=p>]],</span>
    <span class=n>names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Year&#39;</span><span class=p>,</span> <span class=s1>&#39;Quarter&#39;</span><span class=p>]</span>
<span class=p>)</span>

<span class=n>sales_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;Revenue&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>8</span><span class=p>),</span>
    <span class=s1>&#39;Profit&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>8</span><span class=p>)</span>
<span class=p>},</span> <span class=n>index</span><span class=o>=</span><span class=n>idx</span><span class=p>)</span>

<span class=c1># 3. Indexing with MultiIndex</span>
<span class=c1># Access by level</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;USA&#39;</span><span class=p>])</span>  <span class=c1># All USA cities</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[(</span><span class=s1>&#39;USA&#39;</span><span class=p>,</span> <span class=s1>&#39;NY&#39;</span><span class=p>)])</span>  <span class=c1># Specific city</span>

<span class=c1># Cross-section (xs)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>xs</span><span class=p>(</span><span class=s1>&#39;USA&#39;</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=s1>&#39;Country&#39;</span><span class=p>))</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>xs</span><span class=p>(</span><span class=s1>&#39;NY&#39;</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=s1>&#39;City&#39;</span><span class=p>))</span>

<span class=c1># 4. Slicing MultiIndex</span>
<span class=c1># Slice first level</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;USA&#39;</span><span class=p>:</span><span class=s1>&#39;UK&#39;</span><span class=p>])</span>

<span class=c1># Slice second level</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[(</span><span class=s1>&#39;USA&#39;</span><span class=p>,</span> <span class=s1>&#39;CA&#39;</span><span class=p>):(</span><span class=s1>&#39;UK&#39;</span><span class=p>,</span> <span class=s1>&#39;London&#39;</span><span class=p>)])</span>

<span class=c1># 5. Stack and Unstack</span>
<span class=c1># Create sample data</span>
<span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;Year&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>2023</span><span class=p>,</span> <span class=mi>2023</span><span class=p>,</span> <span class=mi>2024</span><span class=p>,</span> <span class=mi>2024</span><span class=p>],</span>
    <span class=s1>&#39;Quarter&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>,</span> <span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>],</span>
    <span class=s1>&#39;Revenue&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>120</span><span class=p>,</span> <span class=mi>180</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Set multiindex</span>
<span class=n>data_idx</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>set_index</span><span class=p>([</span><span class=s1>&#39;Year&#39;</span><span class=p>,</span> <span class=s1>&#39;Quarter&#39;</span><span class=p>])</span>

<span class=c1># Unstack: move index level to columns</span>
<span class=n>unstacked</span> <span class=o>=</span> <span class=n>data_idx</span><span class=o>.</span><span class=n>unstack</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=n>unstacked</span><span class=p>)</span>

<span class=c1># Stack: move column level to index</span>
<span class=n>stacked</span> <span class=o>=</span> <span class=n>unstacked</span><span class=o>.</span><span class=n>stack</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=n>stacked</span><span class=p>)</span>

<span class=c1># 6. GroupBy with MultiIndex</span>
<span class=n>df_sales</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;Region&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span><span class=p>,</span>
    <span class=s1>&#39;Product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span><span class=p>,</span>
    <span class=s1>&#39;Quarter&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>],</span>
    <span class=s1>&#39;Revenue&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>120</span><span class=p>,</span> <span class=mi>180</span><span class=p>,</span> <span class=mi>110</span><span class=p>,</span> <span class=mi>160</span><span class=p>,</span> <span class=mi>130</span><span class=p>,</span> <span class=mi>190</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Create MultiIndex from groupby</span>
<span class=n>grouped</span> <span class=o>=</span> <span class=n>df_sales</span><span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=s1>&#39;Region&#39;</span><span class=p>,</span> <span class=s1>&#39;Product&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=n>grouped</span><span class=p>)</span>

<span class=c1># 7. Sorting MultiIndex</span>
<span class=c1># Sort by all levels</span>
<span class=n>df_sorted</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>sort_index</span><span class=p>()</span>

<span class=c1># Sort by specific level</span>
<span class=n>df_sorted</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>sort_index</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=s1>&#39;City&#39;</span><span class=p>)</span>

<span class=c1># Sort descending</span>
<span class=n>df_sorted</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>sort_index</span><span class=p>(</span><span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

<span class=c1># 8. Swapping Levels</span>
<span class=c1># Swap index levels</span>
<span class=n>df_swapped</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>swaplevel</span><span class=p>(</span><span class=s1>&#39;Country&#39;</span><span class=p>,</span> <span class=s1>&#39;City&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_swapped</span><span class=p>)</span>

<span class=c1># 9. Resetting Index</span>
<span class=c1># Remove MultiIndex</span>
<span class=n>df_reset</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_reset</span><span class=p>)</span>

<span class=c1># Keep one level</span>
<span class=n>df_reset_partial</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=s1>&#39;City&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_reset_partial</span><span class=p>)</span>

<span class=c1># 10. Advanced Operations</span>
<span class=c1># Sum across levels</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=s1>&#39;Country&#39;</span><span class=p>))</span>

<span class=c1># Mean across levels</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=s1>&#39;City&#39;</span><span class=p>))</span>

<span class=c1># Apply function per level</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=s1>&#39;Country&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>({</span>
    <span class=s1>&#39;Population&#39;</span><span class=p>:</span> <span class=s1>&#39;sum&#39;</span><span class=p>,</span>
    <span class=s1>&#39;GDP&#39;</span><span class=p>:</span> <span class=s1>&#39;mean&#39;</span>
<span class=p>})</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</code></pre></div> <p><strong>Creating MultiIndex:</strong></p> <table> <thead> <tr> <th>Method</th> <th>Use Case</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>from_tuples</strong></td> <td>Explicit labels</td> <td><code>pd.MultiIndex.from_tuples([('A', 1)])</code></td> </tr> <tr> <td><strong>from_product</strong></td> <td>Cartesian product</td> <td><code>pd.MultiIndex.from_product([['A', 'B'], [1, 2]])</code></td> </tr> <tr> <td><strong>from_arrays</strong></td> <td>Separate arrays</td> <td><code>pd.MultiIndex.from_arrays([['A', 'B'], [1, 2]])</code></td> </tr> <tr> <td><strong>set_index</strong></td> <td>From columns</td> <td><code>df.set_index(['col1', 'col2'])</code></td> </tr> </tbody> </table> <p><strong>Common Operations:</strong></p> <table> <thead> <tr> <th>Operation</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>loc</strong></td> <td>Access by labels</td> <td><code>df.loc[('USA', 'NY')]</code></td> </tr> <tr> <td><strong>xs</strong></td> <td>Cross-section</td> <td><code>df.xs('USA', level=0)</code></td> </tr> <tr> <td><strong>unstack</strong></td> <td>Level to columns</td> <td><code>df.unstack()</code></td> </tr> <tr> <td><strong>stack</strong></td> <td>Columns to level</td> <td><code>df.stack()</code></td> </tr> <tr> <td><strong>swaplevel</strong></td> <td>Swap index levels</td> <td><code>df.swaplevel(0, 1)</code></td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Advanced indexing and hierarchical data structures.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows from_tuples, from_product, set_index methods</li> <li>Can access specific levels with loc and xs()</li> <li>Understands stack/unstack transformations</li> <li>Mentions GroupBy creates MultiIndex naturally</li> <li>Uses sort_index(level=...) for sorting</li> <li>Applies to time series and pivot tables</li> </ul> </div> </details> <hr> <h3 id=explain-pdmerge-parameters-amazon-microsoft-interview-question>Explain pd.merge() Parameters - Amazon, Microsoft Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Merge</code>, <code>Join</code>, <code>Data Combination</code> | <strong>Asked by:</strong> Amazon, Microsoft, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>pd.merge()</strong> combines DataFrames using SQL-style joins. Parameters: <strong>how</strong> (join type), <strong>on</strong> (keys), <strong>left_on/right_on</strong>, <strong>suffixes</strong>, <strong>indicator</strong>.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=c1># Sample data</span>
<span class=n>customers</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>,</span> <span class=s1>&#39;David&#39;</span><span class=p>],</span>
    <span class=s1>&#39;city&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;NYC&#39;</span><span class=p>,</span> <span class=s1>&#39;LA&#39;</span><span class=p>,</span> <span class=s1>&#39;Chicago&#39;</span><span class=p>,</span> <span class=s1>&#39;Boston&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>orders</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>101</span><span class=p>,</span> <span class=mi>102</span><span class=p>,</span> <span class=mi>103</span><span class=p>,</span> <span class=mi>104</span><span class=p>,</span> <span class=mi>105</span><span class=p>],</span>
    <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span>
    <span class=s1>&#39;amount&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>300</span><span class=p>,</span> <span class=mi>50</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># 1. Inner Join (default)</span>
<span class=n>inner</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>customers</span><span class=p>,</span> <span class=n>orders</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;inner&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Inner join:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>inner</span><span class=p>)</span>
<span class=c1># Only matching records (customer_id 1, 2)</span>

<span class=c1># 2. Left Join</span>
<span class=n>left</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>customers</span><span class=p>,</span> <span class=n>orders</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;left&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Left join:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>left</span><span class=p>)</span>
<span class=c1># All customers, NaN for unmatched orders</span>

<span class=c1># 3. Right Join</span>
<span class=n>right</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>customers</span><span class=p>,</span> <span class=n>orders</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;right&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Right join:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>right</span><span class=p>)</span>
<span class=c1># All orders, NaN for unmatched customers</span>

<span class=c1># 4. Outer Join</span>
<span class=n>outer</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>customers</span><span class=p>,</span> <span class=n>orders</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Outer join:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>outer</span><span class=p>)</span>
<span class=c1># All records, NaN where no match</span>

<span class=c1># 5. Different Column Names</span>
<span class=n>products</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;product_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Widget&#39;</span><span class=p>,</span> <span class=s1>&#39;Gadget&#39;</span><span class=p>,</span> <span class=s1>&#39;Tool&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>order_items</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>101</span><span class=p>,</span> <span class=mi>102</span><span class=p>],</span>
    <span class=s1>&#39;prod_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>3</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>merged</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span>
    <span class=n>products</span><span class=p>,</span> <span class=n>order_items</span><span class=p>,</span>
    <span class=n>left_on</span><span class=o>=</span><span class=s1>&#39;product_id&#39;</span><span class=p>,</span>
    <span class=n>right_on</span><span class=o>=</span><span class=s1>&#39;prod_id&#39;</span><span class=p>,</span>
    <span class=n>how</span><span class=o>=</span><span class=s1>&#39;inner&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Different column names:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>merged</span><span class=p>)</span>

<span class=c1># 6. Multiple Keys</span>
<span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;year&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>2023</span><span class=p>,</span> <span class=mi>2023</span><span class=p>,</span> <span class=mi>2024</span><span class=p>],</span>
    <span class=s1>&#39;quarter&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>,</span> <span class=s1>&#39;Q1&#39;</span><span class=p>],</span>
    <span class=s1>&#39;revenue&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>120</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;year&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>2023</span><span class=p>,</span> <span class=mi>2023</span><span class=p>,</span> <span class=mi>2024</span><span class=p>],</span>
    <span class=s1>&#39;quarter&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>],</span>
    <span class=s1>&#39;profit&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>25</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>multi_key</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>,</span> <span class=s1>&#39;quarter&#39;</span><span class=p>],</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Multiple keys:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>multi_key</span><span class=p>)</span>

<span class=c1># 7. Suffixes for Duplicate Columns</span>
<span class=n>left_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;key&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>],</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span>
    <span class=s1>&#39;extra&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>right_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;key&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>],</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span>
    <span class=s1>&#39;extra&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>with_suffixes</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span>
    <span class=n>left_df</span><span class=p>,</span> <span class=n>right_df</span><span class=p>,</span>
    <span class=n>on</span><span class=o>=</span><span class=s1>&#39;key&#39;</span><span class=p>,</span>
    <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span>
    <span class=n>suffixes</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;_left&#39;</span><span class=p>,</span> <span class=s1>&#39;_right&#39;</span><span class=p>)</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With suffixes:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>with_suffixes</span><span class=p>)</span>

<span class=c1># 8. Indicator Column</span>
<span class=n>with_indicator</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span>
    <span class=n>customers</span><span class=p>,</span> <span class=n>orders</span><span class=p>,</span>
    <span class=n>on</span><span class=o>=</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span>
    <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span>
    <span class=n>indicator</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With indicator:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>with_indicator</span><span class=p>)</span>
<span class=c1># Shows source of each row</span>

<span class=c1># Custom indicator name</span>
<span class=n>custom_indicator</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span>
    <span class=n>customers</span><span class=p>,</span> <span class=n>orders</span><span class=p>,</span>
    <span class=n>on</span><span class=o>=</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span>
    <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span>
    <span class=n>indicator</span><span class=o>=</span><span class=s1>&#39;source&#39;</span>
<span class=p>)</span>

<span class=c1># 9. Index-based Merge</span>
<span class=n>left_idx</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]},</span> <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>])</span>
<span class=n>right_idx</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]},</span> <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>])</span>

<span class=n>idx_merge</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span>
    <span class=n>left_idx</span><span class=p>,</span> <span class=n>right_idx</span><span class=p>,</span>
    <span class=n>left_index</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>right_index</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Index merge:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>idx_merge</span><span class=p>)</span>

<span class=c1># 10. Validate Merge</span>
<span class=c1># Ensure one-to-one merge</span>
<span class=k>try</span><span class=p>:</span>
    <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span>
        <span class=n>customers</span><span class=p>,</span> <span class=n>orders</span><span class=p>,</span>
        <span class=n>on</span><span class=o>=</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span>
        <span class=n>validate</span><span class=o>=</span><span class=s1>&#39;one_to_one&#39;</span>  <span class=c1># Will fail (one customer, many orders)</span>
    <span class=p>)</span>
<span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Validation error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># Valid one-to-many</span>
<span class=n>valid</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span>
    <span class=n>customers</span><span class=p>,</span> <span class=n>orders</span><span class=p>,</span>
    <span class=n>on</span><span class=o>=</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span>
    <span class=n>validate</span><span class=o>=</span><span class=s1>&#39;one_to_many&#39;</span>  <span class=c1># OK</span>
<span class=p>)</span>
</code></pre></div> <p><strong>Join Types:</strong></p> <table> <thead> <tr> <th>how</th> <th>SQL Equivalent</th> <th>Description</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>inner</strong></td> <td>INNER JOIN</td> <td>Only matches</td> <td>Common records</td> </tr> <tr> <td><strong>left</strong></td> <td>LEFT JOIN</td> <td>All left + matches</td> <td>Keep all left</td> </tr> <tr> <td><strong>right</strong></td> <td>RIGHT JOIN</td> <td>All right + matches</td> <td>Keep all right</td> </tr> <tr> <td><strong>outer</strong></td> <td>FULL OUTER JOIN</td> <td>All records</td> <td>Keep everything</td> </tr> <tr> <td><strong>cross</strong></td> <td>CROSS JOIN</td> <td>Cartesian product</td> <td>All combinations</td> </tr> </tbody> </table> <p><strong>Key Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>on</strong></td> <td>Common column(s)</td> <td><code>on='customer_id'</code></td> </tr> <tr> <td><strong>left_on/right_on</strong></td> <td>Different names</td> <td><code>left_on='id', right_on='cust_id'</code></td> </tr> <tr> <td><strong>how</strong></td> <td>Join type</td> <td><code>how='left'</code></td> </tr> <tr> <td><strong>suffixes</strong></td> <td>Duplicate columns</td> <td><code>suffixes=('_x', '_y')</code></td> </tr> <tr> <td><strong>indicator</strong></td> <td>Show merge source</td> <td><code>indicator=True</code></td> </tr> <tr> <td><strong>validate</strong></td> <td>Check cardinality</td> <td><code>validate='one_to_one'</code></td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> SQL join knowledge and data combination strategies.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows all join types: inner, left, right, outer</li> <li>Uses left_on/right_on for different column names</li> <li>Applies suffixes to avoid duplicate columns</li> <li>Mentions indicator=True for tracking merge source</li> <li>Knows validate parameter for cardinality checks</li> <li>Can merge on index with left_index/right_index</li> </ul> </div> </details> <hr> <h3 id=explain-apply-vs-map-vs-applymap-google-netflix-interview-question>Explain apply() vs map() vs applymap() - Google, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>apply</code>, <code>map</code>, <code>Performance</code> | <strong>Asked by:</strong> Google, Netflix, Meta, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>map()</strong> for Series element-wise. <strong>apply()</strong> for Series/DataFrame row/column-wise. <strong>applymap()</strong> (deprecated) for DataFrame element-wise. Use vectorized operations when possible.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>],</span>
    <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># 1. Series.map() - Element-wise</span>
<span class=c1># Map with dict</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;C_mapped&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;C&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>map</span><span class=p>({</span><span class=s1>&#39;a&#39;</span><span class=p>:</span> <span class=s1>&#39;apple&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>:</span> <span class=s1>&#39;banana&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>:</span> <span class=s1>&#39;cherry&#39;</span><span class=p>})</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># Map with function</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;A_squared&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span>

<span class=c1># 2. Series.apply() - Element-wise (like map)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;A_cubed&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=o>**</span> <span class=mi>3</span><span class=p>)</span>

<span class=c1># More complex function</span>
<span class=k>def</span><span class=w> </span><span class=nf>categorize</span><span class=p>(</span><span class=n>value</span><span class=p>):</span>
    <span class=k>if</span> <span class=n>value</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>:</span>
        <span class=k>return</span> <span class=s1>&#39;low&#39;</span>
    <span class=k>elif</span> <span class=n>value</span> <span class=o>&lt;</span> <span class=mi>4</span><span class=p>:</span>
        <span class=k>return</span> <span class=s1>&#39;medium&#39;</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=k>return</span> <span class=s1>&#39;high&#39;</span>

<span class=n>df</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>categorize</span><span class=p>)</span>

<span class=c1># 3. DataFrame.apply() - Row/Column-wise</span>
<span class=c1># Apply to columns (axis=0, default)</span>
<span class=n>col_sums</span> <span class=o>=</span> <span class=n>df</span><span class=p>[[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=nb>sum</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Column sums:&quot;</span><span class=p>,</span> <span class=n>col_sums</span><span class=p>)</span>

<span class=c1># Apply to rows (axis=1)</span>
<span class=n>row_sums</span> <span class=o>=</span> <span class=n>df</span><span class=p>[[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=nb>sum</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Row sums:&quot;</span><span class=p>,</span> <span class=n>row_sums</span><span class=p>)</span>

<span class=c1># Return Series from apply</span>
<span class=k>def</span><span class=w> </span><span class=nf>compute_stats</span><span class=p>(</span><span class=n>row</span><span class=p>):</span>
    <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>({</span>
        <span class=s1>&#39;sum&#39;</span><span class=p>:</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>],</span>
        <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span>
    <span class=p>})</span>

<span class=n>stats</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>compute_stats</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Stats:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>stats</span><span class=p>)</span>

<span class=c1># 4. DataFrame.applymap() - Element-wise (deprecated)</span>
<span class=c1># Use df.map() in pandas 2.1+</span>
<span class=n>numeric_df</span> <span class=o>=</span> <span class=n>df</span><span class=p>[[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]]</span>

<span class=c1># Old way (deprecated):</span>
<span class=c1># result = numeric_df.applymap(lambda x: x * 2)</span>

<span class=c1># New way:</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>numeric_df</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Element-wise operation:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 5. Performance Comparison</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=n>df_large</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>100000</span><span class=p>),</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>100000</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># Vectorized (fastest)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>result_vec</span> <span class=o>=</span> <span class=n>df_large</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=n>df_large</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span>
<span class=n>vec_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Vectorized: </span><span class=si>{</span><span class=n>vec_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>

<span class=c1># apply (slower)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>result_apply</span> <span class=o>=</span> <span class=n>df_large</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>row</span><span class=p>:</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span> <span class=o>+</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=n>apply_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;apply(): </span><span class=si>{</span><span class=n>apply_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s (</span><span class=si>{</span><span class=n>apply_time</span><span class=o>/</span><span class=n>vec_time</span><span class=si>:</span><span class=s2>.0f</span><span class=si>}</span><span class=s2>x slower)&quot;</span><span class=p>)</span>

<span class=c1># 6. When to Use Each</span>
<span class=c1># map: Series, simple transformations, dict mapping</span>
<span class=n>status_map</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>:</span> <span class=s1>&#39;active&#39;</span><span class=p>,</span> <span class=mi>2</span><span class=p>:</span> <span class=s1>&#39;inactive&#39;</span><span class=p>,</span> <span class=mi>3</span><span class=p>:</span> <span class=s1>&#39;pending&#39;</span><span class=p>}</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>status_map</span><span class=p>)</span>

<span class=c1># apply: Series, more complex functions, multiple outputs</span>
<span class=k>def</span><span class=w> </span><span class=nf>complex_transform</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
    <span class=k>return</span> <span class=n>x</span> <span class=o>**</span> <span class=mi>2</span> <span class=k>if</span> <span class=n>x</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=n>x</span> <span class=o>**</span> <span class=mi>3</span>

<span class=n>df</span><span class=p>[</span><span class=s1>&#39;complex&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>complex_transform</span><span class=p>)</span>

<span class=c1># DataFrame.apply: row/column aggregations, multi-column operations</span>
<span class=k>def</span><span class=w> </span><span class=nf>calculate_score</span><span class=p>(</span><span class=n>row</span><span class=p>):</span>
    <span class=n>base</span> <span class=o>=</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span>
    <span class=n>bonus</span> <span class=o>=</span> <span class=mi>10</span> <span class=k>if</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>2</span> <span class=k>else</span> <span class=mi>0</span>
    <span class=k>return</span> <span class=n>base</span> <span class=o>+</span> <span class=n>bonus</span>

<span class=n>df</span><span class=p>[</span><span class=s1>&#39;score&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>calculate_score</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>

<span class=c1># 7. Vectorized Alternative (Best Performance)</span>
<span class=c1># Instead of apply for simple operations:</span>
<span class=c1># Slow:</span>
<span class=c1># df[&#39;sum&#39;] = df.apply(lambda row: row[&#39;A&#39;] + row[&#39;B&#39;], axis=1)</span>

<span class=c1># Fast:</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sum&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span>

<span class=c1># Instead of apply with conditions:</span>
<span class=c1># Slow:</span>
<span class=c1># df[&#39;flag&#39;] = df[&#39;A&#39;].apply(lambda x: &#39;high&#39; if x &gt; 2 else &#39;low&#39;)</span>

<span class=c1># Fast:</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;flag&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;high&#39;</span><span class=p>,</span> <span class=s1>&#39;low&#39;</span><span class=p>)</span>

<span class=c1># 8. Result Type Parameter</span>
<span class=n>df_nums</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Return DataFrame</span>
<span class=n>result_df</span> <span class=o>=</span> <span class=n>df_nums</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=o>*</span> <span class=mi>2</span><span class=p>,</span> <span class=n>result_type</span><span class=o>=</span><span class=s1>&#39;expand&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result_df</span><span class=p>)</span>

<span class=c1># Return list (broadcast)</span>
<span class=n>result_broadcast</span> <span class=o>=</span> <span class=n>df_nums</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=n>result_type</span><span class=o>=</span><span class=s1>&#39;broadcast&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result_broadcast</span><span class=p>)</span>
</code></pre></div> <p><strong>Method Comparison:</strong></p> <table> <thead> <tr> <th>Method</th> <th>Scope</th> <th>Axis</th> <th>Use Case</th> <th>Speed</th> </tr> </thead> <tbody> <tr> <td><strong>Series.map()</strong></td> <td>Element</td> <td>N/A</td> <td>Dict mapping, simple transform</td> <td>Medium</td> </tr> <tr> <td><strong>Series.apply()</strong></td> <td>Element</td> <td>N/A</td> <td>Complex functions</td> <td>Medium</td> </tr> <tr> <td><strong>DataFrame.apply()</strong></td> <td>Row/Column</td> <td>0/1</td> <td>Multi-column, aggregations</td> <td>Slow</td> </tr> <tr> <td><strong>DataFrame.map()</strong></td> <td>Element</td> <td>N/A</td> <td>Element-wise transform</td> <td>Medium</td> </tr> <tr> <td><strong>Vectorized</strong></td> <td>All</td> <td>N/A</td> <td>Math operations</td> <td><strong>Fast</strong></td> </tr> </tbody> </table> <p><strong>Performance Tips:</strong></p> <table> <thead> <tr> <th>Slow</th> <th>Fast</th> <th>Speedup</th> </tr> </thead> <tbody> <tr> <td><code>df.apply(lambda r: r['A']+r['B'], axis=1)</code></td> <td><code>df['A'] + df['B']</code></td> <td>100x+</td> </tr> <tr> <td><code>df['A'].apply(lambda x: x*2)</code></td> <td><code>df['A'] * 2</code></td> <td>50x+</td> </tr> <tr> <td><code>df['A'].apply(lambda x: 'Y' if x&gt;5 else 'N')</code></td> <td><code>np.where(df['A']&gt;5, 'Y', 'N')</code></td> <td>20x+</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Performance optimization and function application methods.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Distinguishes map() for Series vs apply() for both</li> <li>Knows applymap() is deprecated (use df.map())</li> <li>Understands axis=0 (columns) vs axis=1 (rows)</li> <li>Prefers vectorized operations (100x+ faster)</li> <li>Uses np.where() instead of apply for conditionals</li> <li>Only uses apply when vectorization impossible</li> </ul> </div> </details> <hr> <h3 id=explain-pdcut-vs-pdqcut-amazon-google-interview-question>Explain pd.cut() vs pd.qcut() - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Binning</code>, <code>Discretization</code>, <code>Data Preparation</code> | <strong>Asked by:</strong> Amazon, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>pd.cut()</strong> bins data into equal-width intervals. <strong>pd.qcut()</strong> bins into equal-frequency quantiles. Use cut for fixed ranges, qcut for balanced distribution.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># Sample data</span>
<span class=n>ages</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>18</span><span class=p>,</span> <span class=mi>22</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>27</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>55</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>65</span><span class=p>,</span> <span class=mi>70</span><span class=p>,</span> <span class=mi>75</span><span class=p>,</span> <span class=mi>80</span><span class=p>])</span>
<span class=n>scores</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>45</span><span class=p>,</span> <span class=mi>67</span><span class=p>,</span> <span class=mi>89</span><span class=p>,</span> <span class=mi>72</span><span class=p>,</span> <span class=mi>81</span><span class=p>,</span> <span class=mi>55</span><span class=p>,</span> <span class=mi>93</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>77</span><span class=p>,</span> <span class=mi>85</span><span class=p>,</span> <span class=mi>92</span><span class=p>,</span> <span class=mi>68</span><span class=p>,</span> <span class=mi>74</span><span class=p>,</span> <span class=mi>82</span><span class=p>,</span> <span class=mi>90</span><span class=p>])</span>

<span class=c1># 1. pd.cut() - Equal-width Bins</span>
<span class=c1># Create 3 bins of equal width</span>
<span class=n>age_bins</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>ages</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;cut() with 3 bins:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>age_bins</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>age_bins</span><span class=o>.</span><span class=n>value_counts</span><span class=p>())</span>

<span class=c1># 2. pd.cut() with Custom Labels</span>
<span class=n>age_categories</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span>
    <span class=n>ages</span><span class=p>,</span>
    <span class=n>bins</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span>
    <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Young&#39;</span><span class=p>,</span> <span class=s1>&#39;Middle-aged&#39;</span><span class=p>,</span> <span class=s1>&#39;Senior&#39;</span><span class=p>]</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Custom labels:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>age_categories</span><span class=p>)</span>

<span class=c1># 3. pd.cut() with right=False</span>
<span class=c1># Default: intervals are right-closed (a, b]</span>
<span class=c1># With right=False: intervals are left-closed [a, b)</span>
<span class=n>bins_left</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>ages</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>right</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Left-closed intervals:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>bins_left</span><span class=p>)</span>

<span class=c1># 4. pd.qcut() - Equal-frequency Quantiles</span>
<span class=c1># Create 4 quantiles (quartiles)</span>
<span class=n>score_quartiles</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>scores</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>qcut() quartiles:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>score_quartiles</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>score_quartiles</span><span class=o>.</span><span class=n>value_counts</span><span class=p>())</span>

<span class=c1># 5. pd.qcut() with Custom Labels</span>
<span class=n>score_categories</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span>
    <span class=n>scores</span><span class=p>,</span>
    <span class=n>q</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span>
    <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Low&#39;</span><span class=p>,</span> <span class=s1>&#39;Medium&#39;</span><span class=p>,</span> <span class=s1>&#39;High&#39;</span><span class=p>,</span> <span class=s1>&#39;Very High&#39;</span><span class=p>]</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Quantile labels:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>score_categories</span><span class=p>)</span>

<span class=c1># 6. Specific Quantiles</span>
<span class=c1># Deciles (10 groups)</span>
<span class=n>deciles</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>scores</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Deciles:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>deciles</span><span class=o>.</span><span class=n>value_counts</span><span class=p>())</span>

<span class=c1># Custom quantiles</span>
<span class=n>custom_quantiles</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span>
    <span class=n>scores</span><span class=p>,</span>
    <span class=n>q</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mf>0.25</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> <span class=mf>0.75</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>],</span>
    <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>,</span> <span class=s1>&#39;Q3&#39;</span><span class=p>,</span> <span class=s1>&#39;Q4&#39;</span><span class=p>]</span>
<span class=p>)</span>

<span class=c1># 7. Include Lowest</span>
<span class=c1># Include lowest value in first bin</span>
<span class=n>with_lowest</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span>
    <span class=n>ages</span><span class=p>,</span>
    <span class=n>bins</span><span class=o>=</span><span class=p>[</span><span class=mi>18</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>80</span><span class=p>],</span>
    <span class=n>include_lowest</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Include lowest:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>with_lowest</span><span class=p>)</span>

<span class=c1># 8. Duplicate Edges Handling</span>
<span class=c1># When data has duplicates, qcut may fail</span>
<span class=n>data_with_dups</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>])</span>

<span class=c1># This would fail:</span>
<span class=c1># pd.qcut(data_with_dups, q=4)</span>

<span class=c1># Use duplicates=&#39;drop&#39;</span>
<span class=n>safe_qcut</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>data_with_dups</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>duplicates</span><span class=o>=</span><span class=s1>&#39;drop&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With duplicates:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>safe_qcut</span><span class=p>)</span>

<span class=c1># 9. Return Bins</span>
<span class=c1># Get bin edges</span>
<span class=n>values</span><span class=p>,</span> <span class=n>bin_edges</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>ages</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>retbins</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Bin edges:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>bin_edges</span><span class=p>)</span>

<span class=c1># 10. Practical Example: Customer Segmentation</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>16</span><span class=p>),</span>
    <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=n>ages</span><span class=p>,</span>
    <span class=s1>&#39;purchase_amount&#39;</span><span class=p>:</span> <span class=n>scores</span> <span class=o>*</span> <span class=mi>10</span><span class=p>,</span>
    <span class=s1>&#39;frequency&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>15</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># Age groups (equal width)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;age_group&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>],</span>
    <span class=n>bins</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span>
    <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Young&#39;</span><span class=p>,</span> <span class=s1>&#39;Middle&#39;</span><span class=p>,</span> <span class=s1>&#39;Senior&#39;</span><span class=p>]</span>
<span class=p>)</span>

<span class=c1># Spending tiers (equal frequency)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;spending_tier&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;purchase_amount&#39;</span><span class=p>],</span>
    <span class=n>q</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
    <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Low&#39;</span><span class=p>,</span> <span class=s1>&#39;Medium&#39;</span><span class=p>,</span> <span class=s1>&#39;High&#39;</span><span class=p>]</span>
<span class=p>)</span>

<span class=c1># Frequency quintiles</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;freq_quintile&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;frequency&#39;</span><span class=p>],</span>
    <span class=n>q</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>
    <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>,</span> <span class=s1>&#39;Q3&#39;</span><span class=p>,</span> <span class=s1>&#39;Q4&#39;</span><span class=p>,</span> <span class=s1>&#39;Q5&#39;</span><span class=p>],</span>
    <span class=n>duplicates</span><span class=o>=</span><span class=s1>&#39;drop&#39;</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Customer Segmentation:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># Analysis by segment</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Average purchase by age group:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;age_group&#39;</span><span class=p>)[</span><span class=s1>&#39;purchase_amount&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Customers per spending tier:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;spending_tier&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>value_counts</span><span class=p>())</span>
</code></pre></div> <p><strong>cut() vs qcut():</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>pd.cut()</th> <th>pd.qcut()</th> </tr> </thead> <tbody> <tr> <td><strong>Method</strong></td> <td>Equal-width intervals</td> <td>Equal-frequency quantiles</td> </tr> <tr> <td><strong>Bins</strong></td> <td>Same size ranges</td> <td>Same number of items</td> </tr> <tr> <td><strong>Use Case</strong></td> <td>Fixed ranges (e.g., age groups)</td> <td>Balanced distribution</td> </tr> <tr> <td><strong>Example</strong></td> <td>0-20, 20-40, 40-60</td> <td>Each bin has ~same count</td> </tr> <tr> <td><strong>Distribution</strong></td> <td>Uneven counts</td> <td>Even counts</td> </tr> </tbody> </table> <p><strong>Key Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>cut()</th> <th>qcut()</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><strong>bins/q</strong></td> <td>‚úÖ</td> <td>‚úÖ</td> <td>Number of bins/quantiles</td> </tr> <tr> <td><strong>labels</strong></td> <td>‚úÖ</td> <td>‚úÖ</td> <td>Custom category names</td> </tr> <tr> <td><strong>right</strong></td> <td>‚úÖ</td> <td>‚úÖ</td> <td>Right-closed intervals (default True)</td> </tr> <tr> <td><strong>include_lowest</strong></td> <td>‚úÖ</td> <td>‚úÖ</td> <td>Include smallest value</td> </tr> <tr> <td><strong>duplicates</strong></td> <td>‚ùå</td> <td>‚úÖ</td> <td>Handle duplicate edges</td> </tr> <tr> <td><strong>retbins</strong></td> <td>‚úÖ</td> <td>‚úÖ</td> <td>Return bin edges</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Data discretization and binning strategies.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows cut() creates equal-width intervals</li> <li>Knows qcut() creates equal-frequency quantiles</li> <li>Uses cut for fixed ranges (age groups, scores)</li> <li>Uses qcut for balanced distributions (percentiles)</li> <li>Applies custom labels parameter</li> <li>Handles duplicates with duplicates='drop' in qcut</li> </ul> </div> </details> <hr> <h3 id=explain-categorical-data-type-meta-netflix-interview-question>Explain Categorical Data Type - Meta, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Categorical</code>, <code>Memory Optimization</code>, <code>Performance</code> | <strong>Asked by:</strong> Meta, Netflix, Google, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>Categorical</strong> dtype stores repeated string values as integers with mapping, reducing memory usage by 90%+ for low-cardinality columns. Essential for large datasets.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># 1. Creating Categorical</span>
<span class=c1># From list</span>
<span class=n>colors</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Categorical</span><span class=p>([</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;green&#39;</span><span class=p>,</span> <span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=s1>&#39;red&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Categorical:&quot;</span><span class=p>,</span> <span class=n>colors</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Categories:&quot;</span><span class=p>,</span> <span class=n>colors</span><span class=o>.</span><span class=n>categories</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Codes:&quot;</span><span class=p>,</span> <span class=n>colors</span><span class=o>.</span><span class=n>codes</span><span class=p>)</span>

<span class=c1># 2. DataFrame Column</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>10000</span><span class=p>,</span>
    <span class=s1>&#39;size&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;S&#39;</span><span class=p>,</span> <span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;L&#39;</span><span class=p>,</span> <span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;S&#39;</span><span class=p>,</span> <span class=s1>&#39;L&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>10000</span>
<span class=p>})</span>

<span class=c1># Memory before</span>
<span class=n>memory_before</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Memory before: </span><span class=si>{</span><span class=n>memory_before</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>

<span class=c1># Convert to categorical</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;product&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;product&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;size&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;size&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span>

<span class=c1># Memory after</span>
<span class=n>memory_after</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Memory after: </span><span class=si>{</span><span class=n>memory_after</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Reduction: </span><span class=si>{</span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>memory_after</span><span class=o>/</span><span class=n>memory_before</span><span class=p>)</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>

<span class=c1># 3. Ordered Categories</span>
<span class=n>sizes</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Categorical</span><span class=p>(</span>
    <span class=p>[</span><span class=s1>&#39;S&#39;</span><span class=p>,</span> <span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;L&#39;</span><span class=p>,</span> <span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;S&#39;</span><span class=p>,</span> <span class=s1>&#39;XL&#39;</span><span class=p>],</span>
    <span class=n>categories</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;S&#39;</span><span class=p>,</span> <span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;L&#39;</span><span class=p>,</span> <span class=s1>&#39;XL&#39;</span><span class=p>],</span>
    <span class=n>ordered</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Ordered categorical:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>sizes</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;S &lt; M:&quot;</span><span class=p>,</span> <span class=n>sizes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>sizes</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>

<span class=c1># 4. Adding/Removing Categories</span>
<span class=n>cat</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Categorical</span><span class=p>([</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>])</span>

<span class=c1># Add category</span>
<span class=n>cat</span> <span class=o>=</span> <span class=n>cat</span><span class=o>.</span><span class=n>add_categories</span><span class=p>([</span><span class=s1>&#39;d&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Added category:&quot;</span><span class=p>,</span> <span class=n>cat</span><span class=o>.</span><span class=n>categories</span><span class=p>)</span>

<span class=c1># Remove category</span>
<span class=n>cat</span> <span class=o>=</span> <span class=n>cat</span><span class=o>.</span><span class=n>remove_categories</span><span class=p>([</span><span class=s1>&#39;d&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Removed category:&quot;</span><span class=p>,</span> <span class=n>cat</span><span class=o>.</span><span class=n>categories</span><span class=p>)</span>

<span class=c1># Set categories</span>
<span class=n>cat</span> <span class=o>=</span> <span class=n>cat</span><span class=o>.</span><span class=n>set_categories</span><span class=p>([</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Set categories:&quot;</span><span class=p>,</span> <span class=n>cat</span><span class=o>.</span><span class=n>categories</span><span class=p>)</span>

<span class=c1># 5. Reordering Categories</span>
<span class=n>df_survey</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;satisfaction&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Good&#39;</span><span class=p>,</span> <span class=s1>&#39;Bad&#39;</span><span class=p>,</span> <span class=s1>&#39;Excellent&#39;</span><span class=p>,</span> <span class=s1>&#39;Good&#39;</span><span class=p>,</span> <span class=s1>&#39;Bad&#39;</span><span class=p>,</span> <span class=s1>&#39;Fair&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>df_survey</span><span class=p>[</span><span class=s1>&#39;satisfaction&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Categorical</span><span class=p>(</span>
    <span class=n>df_survey</span><span class=p>[</span><span class=s1>&#39;satisfaction&#39;</span><span class=p>],</span>
    <span class=n>categories</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Bad&#39;</span><span class=p>,</span> <span class=s1>&#39;Fair&#39;</span><span class=p>,</span> <span class=s1>&#39;Good&#39;</span><span class=p>,</span> <span class=s1>&#39;Excellent&#39;</span><span class=p>],</span>
    <span class=n>ordered</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>

<span class=c1># Now can sort meaningfully</span>
<span class=n>df_sorted</span> <span class=o>=</span> <span class=n>df_survey</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;satisfaction&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Sorted by category order:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_sorted</span><span class=p>)</span>

<span class=c1># 6. Groupby with Categories</span>
<span class=n>df_sales</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;region&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Categorical</span><span class=p>([</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>,</span> <span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;East&#39;</span><span class=p>]),</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>180</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Add unused category</span>
<span class=n>df_sales</span><span class=p>[</span><span class=s1>&#39;region&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_sales</span><span class=p>[</span><span class=s1>&#39;region&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cat</span><span class=o>.</span><span class=n>add_categories</span><span class=p>([</span><span class=s1>&#39;West&#39;</span><span class=p>])</span>

<span class=c1># Groupby includes empty categories</span>
<span class=n>grouped</span> <span class=o>=</span> <span class=n>df_sales</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>,</span> <span class=n>observed</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Groupby with empty category:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>grouped</span><span class=p>)</span>

<span class=c1># Exclude empty categories</span>
<span class=n>grouped_observed</span> <span class=o>=</span> <span class=n>df_sales</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>,</span> <span class=n>observed</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Groupby observed only:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>grouped_observed</span><span class=p>)</span>

<span class=c1># 7. Renaming Categories</span>
<span class=n>df_status</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Categorical</span><span class=p>([</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>])</span>
<span class=p>})</span>

<span class=c1># Rename</span>
<span class=n>df_status</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_status</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cat</span><span class=o>.</span><span class=n>rename_categories</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=s1>&#39;Active&#39;</span><span class=p>,</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=s1>&#39;Blocked&#39;</span><span class=p>,</span>
    <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=s1>&#39;Closed&#39;</span>
<span class=p>})</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Renamed categories:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_status</span><span class=p>)</span>

<span class=c1># 8. Performance Comparison</span>
<span class=c1># String operations</span>
<span class=n>df_str</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>100000</span>
<span class=p>})</span>

<span class=n>df_cat</span> <span class=o>=</span> <span class=n>df_str</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=n>df_cat</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_cat</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span>

<span class=c1># Comparison speed</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>df_str</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;A&#39;</span>
<span class=n>str_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>df_cat</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;A&#39;</span>
<span class=n>cat_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>String comparison: </span><span class=si>{</span><span class=n>str_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Categorical comparison: </span><span class=si>{</span><span class=n>cat_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Speedup: </span><span class=si>{</span><span class=n>str_time</span><span class=o>/</span><span class=n>cat_time</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>x&quot;</span><span class=p>)</span>

<span class=c1># 9. When to Use Categorical</span>
<span class=c1># Good: low cardinality (few unique values)</span>
<span class=n>df_good</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;country&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;USA&#39;</span><span class=p>,</span> <span class=s1>&#39;UK&#39;</span><span class=p>,</span> <span class=s1>&#39;Canada&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>10000</span>  <span class=c1># 3 unique</span>
<span class=p>})</span>
<span class=n>df_good</span><span class=p>[</span><span class=s1>&#39;country&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_good</span><span class=p>[</span><span class=s1>&#39;country&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span>

<span class=c1># Bad: high cardinality (many unique values)</span>
<span class=n>df_bad</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=sa>f</span><span class=s1>&#39;user_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10000</span><span class=p>)]</span>  <span class=c1># All unique</span>
<span class=p>})</span>
<span class=c1># Don&#39;t convert to categorical - no benefit!</span>

<span class=c1># 10. Practical Example: Survey Data</span>
<span class=n>df_survey</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;age_group&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Categorical</span><span class=p>(</span>
        <span class=p>[</span><span class=s1>&#39;18-25&#39;</span><span class=p>,</span> <span class=s1>&#39;26-35&#39;</span><span class=p>,</span> <span class=s1>&#39;18-25&#39;</span><span class=p>,</span> <span class=s1>&#39;36-45&#39;</span><span class=p>,</span> <span class=s1>&#39;26-35&#39;</span><span class=p>],</span>
        <span class=n>categories</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;18-25&#39;</span><span class=p>,</span> <span class=s1>&#39;26-35&#39;</span><span class=p>,</span> <span class=s1>&#39;36-45&#39;</span><span class=p>,</span> <span class=s1>&#39;46-55&#39;</span><span class=p>,</span> <span class=s1>&#39;55+&#39;</span><span class=p>],</span>
        <span class=n>ordered</span><span class=o>=</span><span class=kc>True</span>
    <span class=p>),</span>
    <span class=s1>&#39;satisfaction&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Categorical</span><span class=p>(</span>
        <span class=p>[</span><span class=s1>&#39;Good&#39;</span><span class=p>,</span> <span class=s1>&#39;Bad&#39;</span><span class=p>,</span> <span class=s1>&#39;Excellent&#39;</span><span class=p>,</span> <span class=s1>&#39;Good&#39;</span><span class=p>,</span> <span class=s1>&#39;Fair&#39;</span><span class=p>],</span>
        <span class=n>categories</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Bad&#39;</span><span class=p>,</span> <span class=s1>&#39;Fair&#39;</span><span class=p>,</span> <span class=s1>&#39;Good&#39;</span><span class=p>,</span> <span class=s1>&#39;Excellent&#39;</span><span class=p>],</span>
        <span class=n>ordered</span><span class=o>=</span><span class=kc>True</span>
    <span class=p>),</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Categorical</span><span class=p>([</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>])</span>
<span class=p>})</span>

<span class=c1># Efficient aggregation</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df_survey</span><span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=s1>&#39;age_group&#39;</span><span class=p>,</span> <span class=s1>&#39;product&#39;</span><span class=p>],</span> <span class=n>observed</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>size</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Survey analysis:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</code></pre></div> <p><strong>Benefits:</strong></p> <table> <thead> <tr> <th>Benefit</th> <th>Description</th> <th>Example Savings</th> </tr> </thead> <tbody> <tr> <td><strong>Memory</strong></td> <td>Stores as int codes</td> <td>90%+ reduction</td> </tr> <tr> <td><strong>Speed</strong></td> <td>Faster comparisons</td> <td>2-10x faster</td> </tr> <tr> <td><strong>Ordering</strong></td> <td>Meaningful sorts</td> <td>Survey ratings</td> </tr> <tr> <td><strong>Groupby</strong></td> <td>Include empty categories</td> <td>Complete reports</td> </tr> </tbody> </table> <p><strong>When to Use:</strong></p> <table> <thead> <tr> <th>Use Categorical</th> <th>Don't Use Categorical</th> </tr> </thead> <tbody> <tr> <td>Low cardinality (&lt;50% unique)</td> <td>High cardinality (90%+ unique)</td> </tr> <tr> <td>Repeated values</td> <td>Mostly unique values</td> </tr> <tr> <td>Surveys, ratings</td> <td>User IDs, timestamps</td> </tr> <tr> <td>Country, department</td> <td>Email addresses</td> </tr> <tr> <td>Fixed set of values</td> <td>Free-form text</td> </tr> </tbody> </table> <p><strong>Key Operations:</strong></p> <table> <thead> <tr> <th>Operation</th> <th>Method</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>Create</strong></td> <td><code>astype('category')</code></td> <td><code>df['col'].astype('category')</code></td> </tr> <tr> <td><strong>Add category</strong></td> <td><code>.cat.add_categories()</code></td> <td><code>.cat.add_categories(['new'])</code></td> </tr> <tr> <td><strong>Remove</strong></td> <td><code>.cat.remove_categories()</code></td> <td><code>.cat.remove_categories(['old'])</code></td> </tr> <tr> <td><strong>Rename</strong></td> <td><code>.cat.rename_categories()</code></td> <td><code>.cat.rename_categories({'A': 'Active'})</code></td> </tr> <tr> <td><strong>Reorder</strong></td> <td><code>.cat.reorder_categories()</code></td> <td><code>.cat.reorder_categories(['S', 'M', 'L'])</code></td> </tr> <tr> <td><strong>Set ordered</strong></td> <td><code>.cat.as_ordered()</code></td> <td><code>.cat.as_ordered()</code></td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> Memory optimization and categorical data handling.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows categorical stores strings as integer codes with mapping</li> <li>Mentions 90%+ memory reduction for low-cardinality columns</li> <li>Uses ordered=True for meaningful sorting (e.g., ratings)</li> <li>Applies when &lt;50% unique values with repetition</li> <li>Avoids for high cardinality data (unique IDs)</li> <li>Uses .cat accessor for category management</li> <li>Sets observed=False to include empty categories in groupby</li> </ul> </div> </details> <hr> <h3 id=explain-window-functions-rolling-expanding-ewma-google-amazon-interview-question>Explain Window Functions (Rolling, Expanding, EWMA) - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Window Functions</code>, <code>Time Series</code>, <code>Rolling Statistics</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>Window functions</strong> compute statistics over sliding, expanding, or exponentially weighted windows. Essential for time series analysis, moving averages, and trend detection.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>

<span class=c1># Sample time series data</span>
<span class=n>dates</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>)</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>dates</span><span class=p>,</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>80</span><span class=p>,</span> <span class=mi>120</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span> <span class=o>*</span> <span class=mf>0.1</span><span class=p>)</span> <span class=o>*</span> <span class=mi>20</span><span class=p>,</span>
    <span class=s1>&#39;temperature&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>normal</span><span class=p>(</span><span class=mi>70</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
<span class=p>})</span>
<span class=n>df</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s1>&#39;date&#39;</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># 1. Rolling Window (Moving Average)</span>
<span class=c1># 7-day moving average</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_ma7&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>

<span class=c1># 30-day moving average</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_ma30&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>30</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Rolling means:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;sales_ma7&#39;</span><span class=p>,</span> <span class=s1>&#39;sales_ma30&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>35</span><span class=p>))</span>

<span class=c1># 2. Rolling with min_periods</span>
<span class=c1># Calculate even with fewer than 7 values</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_ma7_min&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>7</span><span class=p>,</span> <span class=n>min_periods</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>

<span class=c1># 3. Rolling Aggregations</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_roll_std&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_roll_min&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>min</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_roll_max&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_roll_sum&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>

<span class=c1># Multiple aggregations</span>
<span class=n>rolling_stats</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>([</span><span class=s1>&#39;mean&#39;</span><span class=p>,</span> <span class=s1>&#39;std&#39;</span><span class=p>,</span> <span class=s1>&#39;min&#39;</span><span class=p>,</span> <span class=s1>&#39;max&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Rolling statistics:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>rolling_stats</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span>

<span class=c1># 4. Expanding Window</span>
<span class=c1># Cumulative average (all data up to current point)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_cumavg&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>expanding</span><span class=p>()</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>

<span class=c1># Cumulative sum</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_cumsum&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>expanding</span><span class=p>()</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>

<span class=c1># Cumulative max</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_cummax&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>expanding</span><span class=p>()</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Expanding statistics:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;sales_cumavg&#39;</span><span class=p>,</span> <span class=s1>&#39;sales_cumsum&#39;</span><span class=p>,</span> <span class=s1>&#39;sales_cummax&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span>

<span class=c1># 5. Exponentially Weighted Moving Average (EWMA)</span>
<span class=c1># More weight to recent values</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_ewma&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>ewm</span><span class=p>(</span><span class=n>span</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>

<span class=c1># Different smoothing parameters</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_ewm_fast&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>ewm</span><span class=p>(</span><span class=n>span</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>  <span class=c1># Fast response</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_ewm_slow&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>ewm</span><span class=p>(</span><span class=n>span</span><span class=o>=</span><span class=mi>14</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>  <span class=c1># Slow response</span>

<span class=c1># Alpha parameter (0-1)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_ewm_alpha&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>ewm</span><span class=p>(</span><span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>

<span class=c1># 6. Center Parameter</span>
<span class=c1># Center the window (for smoothing, not forecasting)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_centered&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>7</span><span class=p>,</span> <span class=n>center</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Centered vs non-centered:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;sales_ma7&#39;</span><span class=p>,</span> <span class=s1>&#39;sales_centered&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>3</span><span class=p>:</span><span class=mi>8</span><span class=p>])</span>

<span class=c1># 7. Rolling with Custom Function</span>
<span class=k>def</span><span class=w> </span><span class=nf>range_ratio</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Range divided by mean.&quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>min</span><span class=p>())</span> <span class=o>/</span> <span class=n>x</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=k>if</span> <span class=n>x</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=o>!=</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>

<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_volatility&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>range_ratio</span><span class=p>)</span>

<span class=c1># 8. Time-based Window</span>
<span class=c1># 7-day window (calendar days, not data points)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_7d&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=s1>&#39;7D&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>

<span class=c1># 14-day window</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_14d&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=s1>&#39;14D&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>

<span class=c1># 9. Shift and Diff</span>
<span class=c1># Previous value</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_prev&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>shift</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>

<span class=c1># Change from previous day</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_change&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>diff</span><span class=p>()</span>

<span class=c1># Percentage change</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_pct_change&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>pct_change</span><span class=p>()</span>

<span class=c1># Change from 7 days ago</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_change_7d&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>diff</span><span class=p>(</span><span class=mi>7</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Changes:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;sales_prev&#39;</span><span class=p>,</span> <span class=s1>&#39;sales_change&#39;</span><span class=p>,</span> <span class=s1>&#39;sales_pct_change&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span>

<span class=c1># 10. Practical Example: Anomaly Detection</span>
<span class=c1># Bollinger Bands</span>
<span class=n>window</span> <span class=o>=</span> <span class=mi>20</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;bb_mid&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=n>window</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;bb_std&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=n>window</span><span class=p>)</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;bb_upper&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;bb_mid&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;bb_std&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;bb_lower&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;bb_mid&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;bb_std&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span>

<span class=c1># Detect anomalies</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;anomaly&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>((</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;bb_upper&#39;</span><span class=p>])</span> <span class=o>|</span> 
                 <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;bb_lower&#39;</span><span class=p>]))</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Anomalies detected:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;anomaly&#39;</span><span class=p>]][[</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;bb_upper&#39;</span><span class=p>,</span> <span class=s1>&#39;bb_lower&#39;</span><span class=p>]])</span>

<span class=c1># 11. Multi-column Rolling</span>
<span class=c1># Rolling correlation</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;corr_sales_temp&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>30</span><span class=p>)</span><span class=o>.</span><span class=n>corr</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;temperature&#39;</span><span class=p>])</span>

<span class=c1># 12. GroupBy + Rolling</span>
<span class=c1># Add categories</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>],</span> <span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>))</span>

<span class=c1># Rolling average per category</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_ma_by_cat&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>drop</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div> <p><strong>Window Types:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Method</th> <th>Use Case</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>Rolling</strong></td> <td><code>.rolling(window)</code></td> <td>Moving average</td> <td>7-day MA</td> </tr> <tr> <td><strong>Expanding</strong></td> <td><code>.expanding()</code></td> <td>Cumulative stats</td> <td>Running total</td> </tr> <tr> <td><strong>EWMA</strong></td> <td><code>.ewm(span/alpha)</code></td> <td>Weighted average</td> <td>Trend smoothing</td> </tr> </tbody> </table> <p><strong>Common Rolling Operations:</strong></p> <table> <thead> <tr> <th>Operation</th> <th>Method</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><strong>Mean</strong></td> <td><code>.rolling(n).mean()</code></td> <td>Moving average</td> </tr> <tr> <td><strong>Sum</strong></td> <td><code>.rolling(n).sum()</code></td> <td>Moving total</td> </tr> <tr> <td><strong>Std</strong></td> <td><code>.rolling(n).std()</code></td> <td>Moving volatility</td> </tr> <tr> <td><strong>Min/Max</strong></td> <td><code>.rolling(n).min/max()</code></td> <td>Moving range</td> </tr> <tr> <td><strong>Corr</strong></td> <td><code>.rolling(n).corr()</code></td> <td>Moving correlation</td> </tr> <tr> <td><strong>Apply</strong></td> <td><code>.rolling(n).apply(func)</code></td> <td>Custom function</td> </tr> </tbody> </table> <p><strong>Key Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>window</strong></td> <td>Window size</td> <td><code>window=7</code></td> </tr> <tr> <td><strong>min_periods</strong></td> <td>Min values needed</td> <td><code>min_periods=1</code></td> </tr> <tr> <td><strong>center</strong></td> <td>Center the window</td> <td><code>center=True</code></td> </tr> <tr> <td><strong>span</strong></td> <td>EWMA span</td> <td><code>span=7</code></td> </tr> <tr> <td><strong>alpha</strong></td> <td>EWMA smoothing</td> <td><code>alpha=0.3</code></td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"rolling(): moving average over fixed window"</li> <li>"expanding(): cumulative statistics"</li> <li>"ewm(): exponentially weighted (recent values weighted more)"</li> <li>"min_periods: handle NaN at start"</li> <li>"center=True: for smoothing (not forecasting)"</li> <li>"Time-based: <code>rolling('7D')</code> for calendar days"</li> <li>"Shift: <code>df['prev'] = df['col'].shift(1)</code>"</li> <li>"Diff: <code>df['change'] = df['col'].diff()</code>"</li> <li>"Use for: moving averages, anomaly detection, trend analysis"</li> </ul> </div> </details> <hr> <h3 id=explain-dataframe-indexing-loc-vs-iloc-vs-at-vs-iat-microsoft-amazon-interview-question>Explain DataFrame Indexing (.loc vs .iloc vs .at vs .iat) - Microsoft, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Indexing</code>, <code>DataFrame Access</code>, <code>Performance</code> | <strong>Asked by:</strong> Microsoft, Amazon, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>.loc</strong> accesses by label, <strong>.iloc</strong> by integer position, <strong>.at/.iat</strong> for single values (faster). Use loc for label-based, iloc for position-based indexing.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span>
    <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>]</span>
<span class=p>},</span> <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;row1&#39;</span><span class=p>,</span> <span class=s1>&#39;row2&#39;</span><span class=p>,</span> <span class=s1>&#39;row3&#39;</span><span class=p>,</span> <span class=s1>&#39;row4&#39;</span><span class=p>,</span> <span class=s1>&#39;row5&#39;</span><span class=p>])</span>

<span class=c1># 1. .loc - Label-based</span>
<span class=c1># Single value</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;row1&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>])</span>  <span class=c1># 1</span>

<span class=c1># Row</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;row2&#39;</span><span class=p>])</span>  <span class=c1># Series</span>

<span class=c1># Multiple rows</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[[</span><span class=s1>&#39;row1&#39;</span><span class=p>,</span> <span class=s1>&#39;row3&#39;</span><span class=p>]])</span>

<span class=c1># Slice (inclusive)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;row1&#39;</span><span class=p>:</span><span class=s1>&#39;row3&#39;</span><span class=p>])</span>  <span class=c1># Includes row3!</span>

<span class=c1># Boolean indexing</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>])</span>

<span class=c1># Multiple columns</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;row1&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]])</span>

<span class=c1># 2. .iloc - Position-based</span>
<span class=c1># Single value</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span>  <span class=c1># 1</span>

<span class=c1># Row by position</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>  <span class=c1># Second row</span>

<span class=c1># Multiple rows</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>]])</span>

<span class=c1># Slice (exclusive end)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>])</span>  <span class=c1># Rows 0, 1, 2 (not 3)</span>

<span class=c1># Negative indexing</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>  <span class=c1># Last row</span>

<span class=c1># 2D slicing</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>1</span><span class=p>:</span><span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>:</span><span class=mi>2</span><span class=p>])</span>  <span class=c1># Rows 1-2, columns 0-1</span>

<span class=c1># 3. .at - Fast single value (label)</span>
<span class=n>value</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>at</span><span class=p>[</span><span class=s1>&#39;row1&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>]</span>
<span class=nb>print</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>  <span class=c1># 1</span>

<span class=c1># Set value</span>
<span class=n>df</span><span class=o>.</span><span class=n>at</span><span class=p>[</span><span class=s1>&#39;row1&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>

<span class=c1># 4. .iat - Fast single value (position)</span>
<span class=n>value</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>iat</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
<span class=nb>print</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>  <span class=c1># 100</span>

<span class=c1># Set value</span>
<span class=n>df</span><span class=o>.</span><span class=n>iat</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>

<span class=c1># 5. Performance Comparison</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=n>large_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10000</span><span class=p>,</span> <span class=mi>100</span><span class=p>))</span>

<span class=c1># .loc timing</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1000</span><span class=p>):</span>
    <span class=n>_</span> <span class=o>=</span> <span class=n>large_df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=mi>500</span><span class=p>,</span> <span class=mi>50</span><span class=p>]</span>
<span class=n>loc_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=c1># .at timing (faster)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1000</span><span class=p>):</span>
    <span class=n>_</span> <span class=o>=</span> <span class=n>large_df</span><span class=o>.</span><span class=n>at</span><span class=p>[</span><span class=mi>500</span><span class=p>,</span> <span class=mi>50</span><span class=p>]</span>
<span class=n>at_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;.loc: </span><span class=si>{</span><span class=n>loc_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;.at: </span><span class=si>{</span><span class=n>at_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s (</span><span class=si>{</span><span class=n>loc_time</span><span class=o>/</span><span class=n>at_time</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>x slower)&quot;</span><span class=p>)</span>

<span class=c1># 6. Setting Values</span>
<span class=c1># Set single value</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;row1&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>999</span>

<span class=c1># Set multiple values</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;row1&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]]</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]</span>

<span class=c1># Set column</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span> <span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>

<span class=c1># Set with condition</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>

<span class=c1># 7. Adding Rows/Columns</span>
<span class=c1># Add row</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;row6&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=mi>6</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=s1>&#39;f&#39;</span><span class=p>]</span>

<span class=c1># Add column</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[:,</span> <span class=s1>&#39;D&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]</span>

<span class=c1># 8. Common Pitfalls</span>
<span class=c1># Chain indexing (bad!)</span>
<span class=c1># df[df[&#39;A&#39;] &gt; 2][&#39;B&#39;] = 999  # SettingWithCopyWarning</span>

<span class=c1># Correct way</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>999</span>

<span class=c1># 9. MultiIndex</span>
<span class=n>df_multi</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]</span>
<span class=p>},</span> <span class=n>index</span><span class=o>=</span><span class=n>pd</span><span class=o>.</span><span class=n>MultiIndex</span><span class=o>.</span><span class=n>from_tuples</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
<span class=p>]))</span>

<span class=c1># Access with tuple</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_multi</span><span class=o>.</span><span class=n>loc</span><span class=p>[(</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)])</span>

<span class=c1># Slice first level</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_multi</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>])</span>

<span class=c1># 10. Boolean + Label</span>
<span class=c1># Combine conditions</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>50</span><span class=p>),</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>]]</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</code></pre></div> <p><strong>Comparison:</strong></p> <table> <thead> <tr> <th>Method</th> <th>Indexing Type</th> <th>Speed</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>.loc</strong></td> <td>Label-based</td> <td>Medium</td> <td>General access by label</td> </tr> <tr> <td><strong>.iloc</strong></td> <td>Position-based</td> <td>Medium</td> <td>Access by position</td> </tr> <tr> <td><strong>.at</strong></td> <td>Label-based</td> <td><strong>Fast</strong></td> <td>Single value by label</td> </tr> <tr> <td><strong>.iat</strong></td> <td>Position-based</td> <td><strong>Fast</strong></td> <td>Single value by position</td> </tr> </tbody> </table> <p><strong>Key Differences:</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>.loc</th> <th>.iloc</th> </tr> </thead> <tbody> <tr> <td><strong>Input</strong></td> <td>Labels</td> <td>Integers</td> </tr> <tr> <td><strong>Slice</strong></td> <td>Inclusive end</td> <td>Exclusive end</td> </tr> <tr> <td><strong>Example</strong></td> <td><code>df.loc['row1':'row3']</code></td> <td><code>df.iloc[0:3]</code></td> </tr> <tr> <td><strong>Boolean</strong></td> <td>‚úÖ Yes</td> <td>‚ùå No</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"loc: label-based, iloc: position-based"</li> <li>"loc slicing: inclusive end"</li> <li>"iloc slicing: exclusive end (like Python)"</li> <li>"at/iat: faster for single values"</li> <li>"Use loc with boolean indexing"</li> <li>"Avoid chained indexing: <code>df[col][row]</code>"</li> <li>"Correct: <code>df.loc[row, col]</code>"</li> <li>"at/iat: 10-100x faster for scalar access"</li> </ul> </div> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <p><strong>What they're testing:</strong> DataFrame indexing fundamentals and performance.</p> <p><strong>Strong answer signals:</strong></p> <ul> <li>Knows loc uses labels, iloc uses integer positions</li> <li>Mentions at/iat are 10-100x faster for single values</li> <li>Understands loc slicing is inclusive, iloc is exclusive</li> <li>Avoids chained indexing to prevent SettingWithCopyWarning</li> <li>Uses loc for boolean indexing and filtering</li> </ul> </div> </details> <hr> <h3 id=explain-pdconcat-vs-pdmerge-amazon-google-interview-question>Explain pd.concat() vs pd.merge() - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>concat</code>, <code>merge</code>, <code>Data Combination</code> | <strong>Asked by:</strong> Amazon, Google, Meta, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>pd.concat()</strong> stacks DataFrames vertically/horizontally. <strong>pd.merge()</strong> combines based on keys (SQL joins). Use concat for stacking, merge for joining on columns.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=c1># Sample data</span>
<span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>12</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>df3</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>13</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=mi>15</span><span class=p>],</span>
    <span class=s1>&#39;D&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>16</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=mi>18</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># 1. concat() - Vertical (default axis=0)</span>
<span class=n>vertical</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Vertical concat:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>vertical</span><span class=p>)</span>
<span class=c1># Stacks rows, keeps all columns</span>

<span class=c1># Reset index</span>
<span class=n>vertical_reset</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>],</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With reset index:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>vertical_reset</span><span class=p>)</span>

<span class=c1># 2. concat() - Horizontal (axis=1)</span>
<span class=n>horizontal</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df3</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Horizontal concat:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>horizontal</span><span class=p>)</span>
<span class=c1># Side-by-side, matches by index</span>

<span class=c1># 3. concat() with Keys</span>
<span class=n>keyed</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>],</span> <span class=n>keys</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;first&#39;</span><span class=p>,</span> <span class=s1>&#39;second&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With keys:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>keyed</span><span class=p>)</span>
<span class=c1># Creates MultiIndex</span>

<span class=c1># 4. concat() with Missing Columns</span>
<span class=n>df4</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span>
    <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]</span>  <span class=c1># Different column</span>
<span class=p>})</span>

<span class=n>mixed</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df4</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Missing columns (filled with NaN):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>mixed</span><span class=p>)</span>

<span class=c1># Inner join (only common columns)</span>
<span class=n>inner</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df4</span><span class=p>],</span> <span class=n>join</span><span class=o>=</span><span class=s1>&#39;inner&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Inner join:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>inner</span><span class=p>)</span>

<span class=c1># 5. merge() - Inner Join</span>
<span class=n>customers</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>orders</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>101</span><span class=p>,</span> <span class=mi>102</span><span class=p>,</span> <span class=mi>103</span><span class=p>],</span>
    <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span>
    <span class=s1>&#39;amount&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>300</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>inner_merge</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>customers</span><span class=p>,</span> <span class=n>orders</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;customer_id&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Inner merge:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>inner_merge</span><span class=p>)</span>
<span class=c1># Only matching customer_ids (1, 2)</span>

<span class=c1># 6. merge() - Outer Join</span>
<span class=n>outer_merge</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>customers</span><span class=p>,</span> <span class=n>orders</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Outer merge:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>outer_merge</span><span class=p>)</span>
<span class=c1># All records, NaN for missing</span>

<span class=c1># 7. When to Use Each</span>
<span class=c1># concat: Same structure, stack them</span>
<span class=n>jan</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>]})</span>
<span class=n>feb</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>150</span><span class=p>,</span> <span class=mi>250</span><span class=p>]})</span>
<span class=n>mar</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>120</span><span class=p>,</span> <span class=mi>220</span><span class=p>]})</span>

<span class=n>quarterly</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>jan</span><span class=p>,</span> <span class=n>feb</span><span class=p>,</span> <span class=n>mar</span><span class=p>],</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Quarterly sales (concat):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>quarterly</span><span class=p>)</span>

<span class=c1># merge: Different tables, join on key</span>
<span class=n>products</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;product_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Widget&#39;</span><span class=p>,</span> <span class=s1>&#39;Gadget&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>sales</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;product_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>sales_detail</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>sales</span><span class=p>,</span> <span class=n>products</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;product_id&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Sales detail (merge):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>sales_detail</span><span class=p>)</span>

<span class=c1># 8. concat Multiple DataFrames</span>
<span class=n>dfs</span> <span class=o>=</span> <span class=p>[</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>,</span> <span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>]</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span><span class=n>dfs</span><span class=p>,</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Multiple concat:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 9. Performance: concat vs append</span>
<span class=c1># append (deprecated) - slow in loop</span>
<span class=c1># result = pd.DataFrame()</span>
<span class=c1># for df in dfs:</span>
<span class=c1>#     result = result.append(df)  # Slow!</span>

<span class=c1># concat - fast</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span><span class=n>dfs</span><span class=p>)</span>  <span class=c1># Much faster</span>

<span class=c1># 10. Practical Example</span>
<span class=c1># Monthly data files</span>
<span class=n>data_2023_q1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2023-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>90</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>),</span>
    <span class=s1>&#39;revenue&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>90</span><span class=p>)</span>
<span class=p>})</span>

<span class=n>data_2023_q2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2023-04-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>91</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>),</span>
    <span class=s1>&#39;revenue&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>191</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># Combine time series</span>
<span class=n>full_year</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>data_2023_q1</span><span class=p>,</span> <span class=n>data_2023_q2</span><span class=p>],</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Add metadata</span>
<span class=n>metadata</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2023-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>181</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>),</span>
    <span class=s1>&#39;holiday&#39;</span><span class=p>:</span> <span class=p>[</span><span class=kc>False</span><span class=p>]</span> <span class=o>*</span> <span class=mi>181</span>
<span class=p>})</span>

<span class=c1># Merge with metadata</span>
<span class=n>complete</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>full_year</span><span class=p>,</span> <span class=n>metadata</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;date&#39;</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;left&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Complete data:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>complete</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>
</code></pre></div> <p><strong>concat() vs merge():</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>concat()</th> <th>merge()</th> </tr> </thead> <tbody> <tr> <td><strong>Purpose</strong></td> <td>Stack DataFrames</td> <td>Join on keys</td> </tr> <tr> <td><strong>Direction</strong></td> <td>Vertical/Horizontal</td> <td>Based on keys</td> </tr> <tr> <td><strong>Use Case</strong></td> <td>Append rows, add columns</td> <td>SQL-style joins</td> </tr> <tr> <td><strong>Key Required</strong></td> <td>No</td> <td>Yes</td> </tr> <tr> <td><strong>Example</strong></td> <td>Monthly data ‚Üí yearly</td> <td>Customers + Orders</td> </tr> </tbody> </table> <p><strong>concat() Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>axis</strong></td> <td>0=vertical, 1=horizontal</td> <td><code>axis=0</code></td> </tr> <tr> <td><strong>ignore_index</strong></td> <td>Reset index</td> <td><code>ignore_index=True</code></td> </tr> <tr> <td><strong>keys</strong></td> <td>Create MultiIndex</td> <td><code>keys=['a', 'b']</code></td> </tr> <tr> <td><strong>join</strong></td> <td>'outer' (default) or 'inner'</td> <td><code>join='inner'</code></td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"concat: stack DataFrames (same structure)"</li> <li>"merge: join on keys (different tables)"</li> <li>"concat axis=0: vertical, axis=1: horizontal"</li> <li>"concat ignore_index: reset index"</li> <li>"merge for SQL-style joins"</li> <li>"concat join='inner': only common columns"</li> <li>"Use concat for: time series, appending rows"</li> <li>"Use merge for: combining related tables"</li> <li>"concat list of DFs: faster than repeated append"</li> </ul> </div> </details> <hr> <h3 id=explain-groupby-aggregation-functions-google-meta-interview-question>Explain GroupBy Aggregation Functions - Google, Meta Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>GroupBy</code>, <code>Aggregation</code>, <code>Statistics</code> | <strong>Asked by:</strong> Google, Meta, Netflix, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>GroupBy</strong> splits data into groups, applies functions, combines results. Supports multiple aggregations, custom functions, and named aggregations with <strong>agg()</strong>.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># Sample sales data</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;region&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>,</span> <span class=s1>&#39;East&#39;</span><span class=p>,</span> <span class=s1>&#39;East&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>5</span><span class=p>,</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>5</span><span class=p>,</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>30</span><span class=p>),</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>),</span>
    <span class=s1>&#39;cost&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>50</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>30</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># 1. Basic GroupBy</span>
<span class=c1># Single aggregation</span>
<span class=n>region_sales</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Sales by region:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>region_sales</span><span class=p>)</span>

<span class=c1># Multiple columns</span>
<span class=n>by_region_product</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=s1>&#39;region&#39;</span><span class=p>,</span> <span class=s1>&#39;product&#39;</span><span class=p>])[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Sales by region and product:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>by_region_product</span><span class=p>)</span>

<span class=c1># 2. Multiple Aggregations</span>
<span class=c1># Same function on all columns</span>
<span class=n>summary</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Sum by region:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>summary</span><span class=p>)</span>

<span class=c1># Multiple functions</span>
<span class=n>stats</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>agg</span><span class=p>([</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>,</span> <span class=s1>&#39;std&#39;</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Multiple stats:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>stats</span><span class=p>)</span>

<span class=c1># 3. Different Functions per Column</span>
<span class=n>aggregations</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>({</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=s1>&#39;sum&#39;</span><span class=p>,</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=s1>&#39;mean&#39;</span><span class=p>,</span>
    <span class=s1>&#39;cost&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;min&#39;</span><span class=p>,</span> <span class=s1>&#39;max&#39;</span><span class=p>]</span>
<span class=p>})</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Different functions per column:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>aggregations</span><span class=p>)</span>

<span class=c1># 4. Named Aggregations (Clean Column Names)</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>(</span>
    <span class=n>total_sales</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;sum&#39;</span><span class=p>),</span>
    <span class=n>avg_quantity</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;quantity&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>),</span>
    <span class=n>max_cost</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;cost&#39;</span><span class=p>,</span> <span class=s1>&#39;max&#39;</span><span class=p>),</span>
    <span class=n>sales_count</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>)</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Named aggregations:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 5. Custom Aggregation Functions</span>
<span class=k>def</span><span class=w> </span><span class=nf>range_func</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
    <span class=k>return</span> <span class=n>x</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>min</span><span class=p>()</span>

<span class=k>def</span><span class=w> </span><span class=nf>coefficient_of_variation</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
    <span class=k>return</span> <span class=n>x</span><span class=o>.</span><span class=n>std</span><span class=p>()</span> <span class=o>/</span> <span class=n>x</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=k>if</span> <span class=n>x</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=o>!=</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>

<span class=n>custom</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>agg</span><span class=p>([</span>
    <span class=p>(</span><span class=s1>&#39;total&#39;</span><span class=p>,</span> <span class=s1>&#39;sum&#39;</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;average&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;range&#39;</span><span class=p>,</span> <span class=n>range_func</span><span class=p>),</span>
    <span class=p>(</span><span class=s1>&#39;cv&#39;</span><span class=p>,</span> <span class=n>coefficient_of_variation</span><span class=p>)</span>
<span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Custom functions:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>custom</span><span class=p>)</span>

<span class=c1># 6. Lambda Functions</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>({</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span>
        <span class=p>(</span><span class=s1>&#39;total&#39;</span><span class=p>,</span> <span class=s1>&#39;sum&#39;</span><span class=p>),</span>
        <span class=p>(</span><span class=s1>&#39;weighted_avg&#39;</span><span class=p>,</span> <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=p>(</span><span class=n>x</span> <span class=o>*</span> <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>x</span><span class=o>.</span><span class=n>index</span><span class=p>,</span> <span class=s1>&#39;quantity&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>x</span><span class=o>.</span><span class=n>index</span><span class=p>,</span> <span class=s1>&#39;quantity&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>())</span>
    <span class=p>]</span>
<span class=p>})</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Lambda aggregation:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 7. Transform (Keep Original Shape)</span>
<span class=c1># Add group mean to each row</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;region_avg_sales&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=s1>&#39;mean&#39;</span><span class=p>)</span>

<span class=c1># Normalize within group</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_normalized&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span>
    <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span> <span class=o>/</span> <span class=n>x</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With transform:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;region&#39;</span><span class=p>,</span> <span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;region_avg_sales&#39;</span><span class=p>,</span> <span class=s1>&#39;sales_normalized&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>

<span class=c1># 8. Filter Groups</span>
<span class=c1># Keep only groups with more than 5 records</span>
<span class=n>filtered</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>5</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Filtered groups:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>filtered</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>size</span><span class=p>())</span>

<span class=c1># Keep groups with high average sales</span>
<span class=n>high_sales</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=o>&gt;</span> <span class=mi>250</span><span class=p>)</span>

<span class=c1># 9. Apply (Most Flexible)</span>
<span class=k>def</span><span class=w> </span><span class=nf>top_products</span><span class=p>(</span><span class=n>group</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get top 2 products by sales.&quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>group</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;sales&#39;</span><span class=p>)</span>

<span class=n>top_per_region</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>top_products</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top products per region:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>top_per_region</span><span class=p>)</span>

<span class=c1># 10. GroupBy with MultiIndex</span>
<span class=n>multi_group</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=s1>&#39;region&#39;</span><span class=p>,</span> <span class=s1>&#39;product&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>agg</span><span class=p>({</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>],</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=s1>&#39;sum&#39;</span>
<span class=p>})</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>MultiIndex groupby:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>multi_group</span><span class=p>)</span>

<span class=c1># Flatten MultiIndex columns</span>
<span class=n>multi_group</span><span class=o>.</span><span class=n>columns</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;_&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>col</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>multi_group</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>values</span><span class=p>]</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Flattened columns:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>multi_group</span><span class=p>)</span>

<span class=c1># 11. Cumulative Operations</span>
<span class=c1># Cumulative sum within group</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;cumulative_sales&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cumsum</span><span class=p>()</span>

<span class=c1># Ranking within group</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales_rank&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Cumulative operations:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;region&#39;</span><span class=p>,</span> <span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;cumulative_sales&#39;</span><span class=p>,</span> <span class=s1>&#39;sales_rank&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span>

<span class=c1># 12. Practical Example: Sales Report</span>
<span class=n>report</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>(</span>
    <span class=n>total_revenue</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;sum&#39;</span><span class=p>),</span>
    <span class=n>avg_sale</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>),</span>
    <span class=n>total_units</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;quantity&#39;</span><span class=p>,</span> <span class=s1>&#39;sum&#39;</span><span class=p>),</span>
    <span class=n>num_transactions</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>),</span>
    <span class=n>max_sale</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;max&#39;</span><span class=p>),</span>
    <span class=n>min_sale</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;min&#39;</span><span class=p>)</span>
<span class=p>)</span>

<span class=c1># Add calculated columns</span>
<span class=n>report</span><span class=p>[</span><span class=s1>&#39;revenue_per_unit&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>report</span><span class=p>[</span><span class=s1>&#39;total_revenue&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=n>report</span><span class=p>[</span><span class=s1>&#39;total_units&#39;</span><span class=p>]</span>
<span class=n>report</span><span class=p>[</span><span class=s1>&#39;avg_units_per_transaction&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>report</span><span class=p>[</span><span class=s1>&#39;total_units&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=n>report</span><span class=p>[</span><span class=s1>&#39;num_transactions&#39;</span><span class=p>]</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Sales report:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>report</span><span class=p>)</span>
</code></pre></div> <p><strong>Common Aggregation Functions:</strong></p> <table> <thead> <tr> <th>Function</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>sum</strong></td> <td>Total</td> <td><code>groupby().sum()</code></td> </tr> <tr> <td><strong>mean</strong></td> <td>Average</td> <td><code>groupby().mean()</code></td> </tr> <tr> <td><strong>count</strong></td> <td>Count non-null</td> <td><code>groupby().count()</code></td> </tr> <tr> <td><strong>size</strong></td> <td>Count all (including null)</td> <td><code>groupby().size()</code></td> </tr> <tr> <td><strong>std</strong></td> <td>Standard deviation</td> <td><code>groupby().std()</code></td> </tr> <tr> <td><strong>min/max</strong></td> <td>Min/Max</td> <td><code>groupby().max()</code></td> </tr> <tr> <td><strong>first/last</strong></td> <td>First/Last value</td> <td><code>groupby().first()</code></td> </tr> <tr> <td><strong>nunique</strong></td> <td>Unique count</td> <td><code>groupby().nunique()</code></td> </tr> </tbody> </table> <p><strong>GroupBy Methods:</strong></p> <table> <thead> <tr> <th>Method</th> <th>Purpose</th> <th>Returns</th> </tr> </thead> <tbody> <tr> <td><strong>agg()</strong></td> <td>Apply aggregations</td> <td>Aggregated data</td> </tr> <tr> <td><strong>transform()</strong></td> <td>Keep original shape</td> <td>Same shape as input</td> </tr> <tr> <td><strong>filter()</strong></td> <td>Filter groups</td> <td>Subset of data</td> </tr> <tr> <td><strong>apply()</strong></td> <td>Custom function</td> <td>Custom result</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"groupby(): split-apply-combine pattern"</li> <li>"agg(): apply multiple functions"</li> <li>"Named agg: <code>total_sales=('sales', 'sum')</code>"</li> <li>"transform(): keep original shape"</li> <li>"filter(): keep/remove entire groups"</li> <li>"apply(): most flexible, returns custom structure"</li> <li>"Multiple grouping: <code>groupby(['col1', 'col2'])</code>"</li> <li>"Custom functions: pass callable to agg()"</li> <li>"Flatten MultiIndex: <code>'_'.join(col)</code>"</li> </ul> </div> </details> <hr> <h3 id=explain-pandas-query-method-amazon-netflix-interview-question>Explain Pandas Query Method - Amazon, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Query</code>, <code>Filtering</code>, <code>Performance</code> | <strong>Asked by:</strong> Amazon, Netflix, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>query()</strong> filters DataFrames using string expressions (SQL-like). Cleaner syntax than boolean indexing, supports variables with @, and can be faster for large DataFrames.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>,</span> <span class=s1>&#39;David&#39;</span><span class=p>,</span> <span class=s1>&#39;Eve&#39;</span><span class=p>],</span>
    <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>25</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>28</span><span class=p>],</span>
    <span class=s1>&#39;salary&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>50000</span><span class=p>,</span> <span class=mi>60000</span><span class=p>,</span> <span class=mi>70000</span><span class=p>,</span> <span class=mi>80000</span><span class=p>,</span> <span class=mi>55000</span><span class=p>],</span>
    <span class=s1>&#39;department&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Sales&#39;</span><span class=p>,</span> <span class=s1>&#39;IT&#39;</span><span class=p>,</span> <span class=s1>&#39;Sales&#39;</span><span class=p>,</span> <span class=s1>&#39;IT&#39;</span><span class=p>,</span> <span class=s1>&#39;HR&#39;</span><span class=p>],</span>
    <span class=s1>&#39;experience&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>3</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># 1. Basic Query</span>
<span class=c1># Simple condition</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;age &gt; 30&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Age &gt; 30:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># Multiple conditions (AND)</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;age &gt; 25 and salary &gt; 55000&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Age &gt; 25 AND salary &gt; 55000:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># OR condition</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;department == &quot;IT&quot; or salary &gt; 70000&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>IT OR high salary:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 2. Comparison with Boolean Indexing</span>
<span class=c1># Boolean indexing (verbose)</span>
<span class=n>result_bool</span> <span class=o>=</span> <span class=n>df</span><span class=p>[(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>25</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;salary&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>55000</span><span class=p>)]</span>

<span class=c1># Query (cleaner)</span>
<span class=n>result_query</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;age &gt; 25 and salary &gt; 55000&#39;</span><span class=p>)</span>

<span class=c1># Both produce same result</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Results equal:&quot;</span><span class=p>,</span> <span class=n>result_bool</span><span class=o>.</span><span class=n>equals</span><span class=p>(</span><span class=n>result_query</span><span class=p>))</span>

<span class=c1># 3. Using Variables with @</span>
<span class=n>min_age</span> <span class=o>=</span> <span class=mi>30</span>
<span class=n>min_salary</span> <span class=o>=</span> <span class=mi>60000</span>

<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;age &gt; @min_age and salary &gt; @min_salary&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With variables:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># List membership</span>
<span class=n>departments</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;IT&#39;</span><span class=p>,</span> <span class=s1>&#39;HR&#39;</span><span class=p>]</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;department in @departments&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Department in list:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 4. String Operations</span>
<span class=c1># String contains</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;name.str.contains(&quot;a&quot;, case=False)&#39;</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>&#39;python&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Name contains &#39;a&#39;:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># String startswith</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;name.str.startswith(&quot;D&quot;)&#39;</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>&#39;python&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Name starts with &#39;D&#39;:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 5. Between</span>
<span class=c1># Age between 25 and 35</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;25 &lt;= age &lt;= 35&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Age between 25 and 35:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 6. Not Equal</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;department != &quot;Sales&quot;&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Not Sales:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 7. Complex Expressions</span>
<span class=c1># Calculate in query</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;salary / experience &gt; 10000&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Salary per year experience &gt; 10k:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 8. Index Queries</span>
<span class=n>df_indexed</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>)</span>

<span class=c1># Query index</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df_indexed</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;index == &quot;Alice&quot;&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Query index:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 9. Performance Comparison</span>
<span class=n>large_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>100000</span><span class=p>),</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>100000</span><span class=p>),</span>
    <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>100000</span><span class=p>)</span>
<span class=p>})</span>

<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=c1># Boolean indexing</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>large_df</span><span class=p>[(</span><span class=n>large_df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>50</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>large_df</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>30</span><span class=p>)]</span>
<span class=n>bool_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=c1># Query</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>large_df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;A &gt; 50 and B &lt; 30&#39;</span><span class=p>)</span>
<span class=n>query_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Boolean: </span><span class=si>{</span><span class=n>bool_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Query: </span><span class=si>{</span><span class=n>query_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>

<span class=c1># 10. Inplace Modification</span>
<span class=n>df_copy</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>

<span class=c1># Filter and reassign</span>
<span class=n>df_filtered</span> <span class=o>=</span> <span class=n>df_copy</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;age &gt; 30&#39;</span><span class=p>)</span>

<span class=c1># Can&#39;t use inplace=True with query (returns filtered view)</span>

<span class=c1># 11. Backticks for Column Names with Spaces</span>
<span class=n>df_spaces</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;First Name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>],</span>
    <span class=s1>&#39;Last Name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Smith&#39;</span><span class=p>,</span> <span class=s1>&#39;Jones&#39;</span><span class=p>],</span>
    <span class=s1>&#39;Age&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>25</span><span class=p>,</span> <span class=mi>30</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>result</span> <span class=o>=</span> <span class=n>df_spaces</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;`First Name` == &quot;Alice&quot;&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With spaces in column names:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 12. Practical Example: Data Analysis</span>
<span class=n>sales_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>10</span><span class=p>,</span>
    <span class=s1>&#39;region&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>30</span><span class=p>,</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>1000</span><span class=p>,</span> <span class=mi>60</span><span class=p>),</span>
    <span class=s1>&#39;units&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>60</span><span class=p>),</span>
    <span class=s1>&#39;quarter&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>,</span> <span class=s1>&#39;Q3&#39;</span><span class=p>,</span> <span class=s1>&#39;Q4&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>15</span>
<span class=p>})</span>

<span class=c1># Complex business query</span>
<span class=n>target_sales</span> <span class=o>=</span> <span class=mi>500</span>
<span class=n>target_region</span> <span class=o>=</span> <span class=s1>&#39;North&#39;</span>

<span class=n>high_performers</span> <span class=o>=</span> <span class=n>sales_df</span><span class=o>.</span><span class=n>query</span><span class=p>(</span>
    <span class=s1>&#39;sales &gt; @target_sales and region == @target_region and units &gt; 20&#39;</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>High performers:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>high_performers</span><span class=p>)</span>

<span class=c1># Chained queries</span>
<span class=n>result</span> <span class=o>=</span> <span class=p>(</span><span class=n>sales_df</span>
          <span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;region == &quot;North&quot;&#39;</span><span class=p>)</span>
          <span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;sales &gt; 500&#39;</span><span class=p>)</span>
          <span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;quarter in [&quot;Q1&quot;, &quot;Q2&quot;]&#39;</span><span class=p>))</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Chained queries:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</code></pre></div> <p><strong>query() vs Boolean Indexing:</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>query()</th> <th>Boolean Indexing</th> </tr> </thead> <tbody> <tr> <td><strong>Syntax</strong></td> <td><code>df.query('age &gt; 30')</code></td> <td><code>df[df['age'] &gt; 30]</code></td> </tr> <tr> <td><strong>Readability</strong></td> <td>Cleaner, SQL-like</td> <td>More verbose</td> </tr> <tr> <td><strong>Performance</strong></td> <td>Faster (large data)</td> <td>Slower</td> </tr> <tr> <td><strong>Variables</strong></td> <td>Use <code>@</code></td> <td>Direct</td> </tr> <tr> <td><strong>Complex</strong></td> <td>More readable</td> <td>Harder to read</td> </tr> </tbody> </table> <p><strong>Query Operators:</strong></p> <table> <thead> <tr> <th>Operator</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>==, !=</strong></td> <td>Equality</td> <td><code>'age == 30'</code></td> </tr> <tr> <td><strong>&gt;, &lt;, &gt;=, &lt;=</strong></td> <td>Comparison</td> <td><code>'salary &gt; 50000'</code></td> </tr> <tr> <td><strong>and, or, not</strong></td> <td>Logical</td> <td><code>'age &gt; 30 and salary &lt; 60000'</code></td> </tr> <tr> <td><strong>in</strong></td> <td>Membership</td> <td><code>'dept in @departments'</code></td> </tr> <tr> <td><strong>@</strong></td> <td>Variable reference</td> <td><code>'age &gt; @min_age'</code></td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"query(): SQL-like string expressions"</li> <li>"Cleaner than boolean indexing"</li> <li>"Use @ for variables: <code>query('age &gt; @min_age')</code>"</li> <li>"and/or instead of &amp;/|"</li> <li>"Faster for large DataFrames (numexpr)"</li> <li>"Backticks for spaces: <code>`column name`</code>"</li> <li>"Can query index: <code>query('index == \"value\"')</code>"</li> <li>"engine='python' for string methods"</li> <li>"More readable for complex conditions"</li> </ul> </div> </details> <hr> <h3 id=explain-pandas-memory-usage-optimization-netflix-google-interview-question>Explain Pandas Memory Usage Optimization - Netflix, Google Interview Question</h3> <p><strong>Difficulty:</strong> üî¥ Hard | <strong>Tags:</strong> <code>Memory</code>, <code>Performance</code>, <code>Optimization</code> | <strong>Asked by:</strong> Netflix, Google, Meta, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>Memory optimization</strong> reduces DataFrame memory footprint through: downcasting numeric types, categorical dtype for strings, sparse arrays, chunking, and efficient file formats (parquet).</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># 1. Check Memory Usage</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;int_col&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>1000000</span><span class=p>),</span>
    <span class=s1>&#39;float_col&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>1000000</span><span class=p>),</span>
    <span class=s1>&#39;str_col&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>],</span> <span class=mi>1000000</span><span class=p>),</span>
    <span class=s1>&#39;date_col&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2020-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>1000000</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;min&#39;</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># Memory before</span>
<span class=n>memory_before</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Memory before: </span><span class=si>{</span><span class=n>memory_before</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Memory by column:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>

<span class=c1># 2. Downcast Numeric Types</span>
<span class=c1># int64 ‚Üí int8/int16/int32</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;int_col&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_numeric</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;int_col&#39;</span><span class=p>],</span> <span class=n>downcast</span><span class=o>=</span><span class=s1>&#39;integer&#39;</span><span class=p>)</span>

<span class=c1># float64 ‚Üí float32</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;float_col&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_numeric</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;float_col&#39;</span><span class=p>],</span> <span class=n>downcast</span><span class=o>=</span><span class=s1>&#39;float&#39;</span><span class=p>)</span>

<span class=n>memory_after_numeric</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>After numeric downcast: </span><span class=si>{</span><span class=n>memory_after_numeric</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Saved: </span><span class=si>{</span><span class=n>memory_before</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>memory_after_numeric</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>

<span class=c1># 3. Categorical for Low Cardinality Strings</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;str_col&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;str_col&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span>

<span class=n>memory_after_cat</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;After categorical: </span><span class=si>{</span><span class=n>memory_after_cat</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total saved: </span><span class=si>{</span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>memory_after_cat</span><span class=o>/</span><span class=n>memory_before</span><span class=p>)</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>

<span class=c1># 4. Automatic Optimization Function</span>
<span class=k>def</span><span class=w> </span><span class=nf>optimize_dataframe</span><span class=p>(</span><span class=n>df</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Automatically optimize DataFrame dtypes.&quot;&quot;&quot;</span>
    <span class=n>optimized</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>

    <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>optimized</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
        <span class=n>col_type</span> <span class=o>=</span> <span class=n>optimized</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>dtype</span>

        <span class=c1># Numeric columns</span>
        <span class=k>if</span> <span class=n>col_type</span> <span class=o>!=</span> <span class=s1>&#39;object&#39;</span> <span class=ow>and</span> <span class=n>col_type</span><span class=o>.</span><span class=n>name</span> <span class=o>!=</span> <span class=s1>&#39;category&#39;</span><span class=p>:</span>
            <span class=n>c_min</span> <span class=o>=</span> <span class=n>optimized</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>()</span>
            <span class=n>c_max</span> <span class=o>=</span> <span class=n>optimized</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span>

            <span class=c1># Integer</span>
            <span class=k>if</span> <span class=nb>str</span><span class=p>(</span><span class=n>col_type</span><span class=p>)[:</span><span class=mi>3</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;int&#39;</span><span class=p>:</span>
                <span class=k>if</span> <span class=n>c_min</span> <span class=o>&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>iinfo</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>int8</span><span class=p>)</span><span class=o>.</span><span class=n>min</span> <span class=ow>and</span> <span class=n>c_max</span> <span class=o>&lt;</span> <span class=n>np</span><span class=o>.</span><span class=n>iinfo</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>int8</span><span class=p>)</span><span class=o>.</span><span class=n>max</span><span class=p>:</span>
                    <span class=n>optimized</span><span class=p>[</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>optimized</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>int8</span><span class=p>)</span>
                <span class=k>elif</span> <span class=n>c_min</span> <span class=o>&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>iinfo</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>int16</span><span class=p>)</span><span class=o>.</span><span class=n>min</span> <span class=ow>and</span> <span class=n>c_max</span> <span class=o>&lt;</span> <span class=n>np</span><span class=o>.</span><span class=n>iinfo</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>int16</span><span class=p>)</span><span class=o>.</span><span class=n>max</span><span class=p>:</span>
                    <span class=n>optimized</span><span class=p>[</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>optimized</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>int16</span><span class=p>)</span>
                <span class=k>elif</span> <span class=n>c_min</span> <span class=o>&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>iinfo</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span><span class=o>.</span><span class=n>min</span> <span class=ow>and</span> <span class=n>c_max</span> <span class=o>&lt;</span> <span class=n>np</span><span class=o>.</span><span class=n>iinfo</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span><span class=o>.</span><span class=n>max</span><span class=p>:</span>
                    <span class=n>optimized</span><span class=p>[</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>optimized</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>

            <span class=c1># Float</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=k>if</span> <span class=n>c_min</span> <span class=o>&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>finfo</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span><span class=o>.</span><span class=n>min</span> <span class=ow>and</span> <span class=n>c_max</span> <span class=o>&lt;</span> <span class=n>np</span><span class=o>.</span><span class=n>finfo</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span><span class=o>.</span><span class=n>max</span><span class=p>:</span>
                    <span class=n>optimized</span><span class=p>[</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>optimized</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>

        <span class=c1># String to categorical</span>
        <span class=k>elif</span> <span class=n>col_type</span> <span class=o>==</span> <span class=s1>&#39;object&#39;</span><span class=p>:</span>
            <span class=n>num_unique</span> <span class=o>=</span> <span class=n>optimized</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>nunique</span><span class=p>()</span>
            <span class=n>num_total</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>optimized</span><span class=p>[</span><span class=n>col</span><span class=p>])</span>
            <span class=k>if</span> <span class=n>num_unique</span> <span class=o>/</span> <span class=n>num_total</span> <span class=o>&lt;</span> <span class=mf>0.5</span><span class=p>:</span>  <span class=c1># Less than 50% unique</span>
                <span class=n>optimized</span><span class=p>[</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>optimized</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>optimized</span>

<span class=c1># Test optimization</span>
<span class=n>df_test</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100000</span><span class=p>),</span>
    <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;D&#39;</span><span class=p>],</span> <span class=mi>100000</span><span class=p>),</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>100000</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span>
<span class=p>})</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Before optimization: </span><span class=si>{</span><span class=n>df_test</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=o>/</span><span class=mi>1024</span><span class=o>**</span><span class=mi>2</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>
<span class=n>df_optimized</span> <span class=o>=</span> <span class=n>optimize_dataframe</span><span class=p>(</span><span class=n>df_test</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;After optimization: </span><span class=si>{</span><span class=n>df_optimized</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=o>/</span><span class=mi>1024</span><span class=o>**</span><span class=mi>2</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>

<span class=c1># 5. Sparse Arrays</span>
<span class=c1># For data with many zeros/NaN</span>
<span class=n>df_sparse</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>arrays</span><span class=o>.</span><span class=n>SparseArray</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>100000</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># Regular array</span>
<span class=n>df_dense</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>100000</span>
<span class=p>})</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Dense: </span><span class=si>{</span><span class=n>df_dense</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=o>/</span><span class=mi>1024</span><span class=o>**</span><span class=mi>2</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Sparse: </span><span class=si>{</span><span class=n>df_sparse</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=o>/</span><span class=mi>1024</span><span class=o>**</span><span class=mi>2</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>

<span class=c1># 6. Chunking for Large Files</span>
<span class=n>chunk_size</span> <span class=o>=</span> <span class=mi>10000</span>

<span class=c1># Process in chunks</span>
<span class=k>def</span><span class=w> </span><span class=nf>process_large_file</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=n>chunksize</span><span class=o>=</span><span class=mi>10000</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Process large CSV in chunks.&quot;&quot;&quot;</span>
    <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=n>chunksize</span><span class=o>=</span><span class=n>chunksize</span><span class=p>):</span>
        <span class=c1># Process chunk</span>
        <span class=n>processed</span> <span class=o>=</span> <span class=n>chunk</span><span class=p>[</span><span class=n>chunk</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>50</span><span class=p>]</span>
        <span class=n>results</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>processed</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span><span class=n>results</span><span class=p>,</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># 7. Efficient File Formats</span>
<span class=c1># Save test data</span>
<span class=n>df_test</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=s1>&#39;test.csv&#39;</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=n>df_test</span><span class=o>.</span><span class=n>to_parquet</span><span class=p>(</span><span class=s1>&#39;test.parquet&#39;</span><span class=p>)</span>

<span class=kn>import</span><span class=w> </span><span class=nn>os</span>
<span class=n>csv_size</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>getsize</span><span class=p>(</span><span class=s1>&#39;test.csv&#39;</span><span class=p>)</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>
<span class=n>parquet_size</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>getsize</span><span class=p>(</span><span class=s1>&#39;test.parquet&#39;</span><span class=p>)</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>CSV size: </span><span class=si>{</span><span class=n>csv_size</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Parquet size: </span><span class=si>{</span><span class=n>parquet_size</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Parquet is </span><span class=si>{</span><span class=n>csv_size</span><span class=o>/</span><span class=n>parquet_size</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>x smaller&quot;</span><span class=p>)</span>

<span class=c1># 8. Column Selection</span>
<span class=c1># Read only needed columns</span>
<span class=c1># df_subset = pd.read_csv(&#39;large_file.csv&#39;, usecols=[&#39;col1&#39;, &#39;col2&#39;])</span>

<span class=c1># 9. Date Parsing</span>
<span class=c1># Don&#39;t parse dates if not needed</span>
<span class=c1># df = pd.read_csv(&#39;file.csv&#39;, parse_dates=False)</span>

<span class=c1># 10. Practical Example: Large Dataset</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>=== Optimization Summary ===&quot;</span><span class=p>)</span>

<span class=c1># Original</span>
<span class=n>df_original</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1000000</span><span class=p>),</span>
    <span class=s1>&#39;country&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;USA&#39;</span><span class=p>,</span> <span class=s1>&#39;UK&#39;</span><span class=p>,</span> <span class=s1>&#39;Canada&#39;</span><span class=p>,</span> <span class=s1>&#39;Germany&#39;</span><span class=p>],</span> <span class=mi>1000000</span><span class=p>),</span>
    <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>18</span><span class=p>,</span> <span class=mi>80</span><span class=p>,</span> <span class=mi>1000000</span><span class=p>),</span>
    <span class=s1>&#39;score&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>1000000</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span>
    <span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;active&#39;</span><span class=p>,</span> <span class=s1>&#39;inactive&#39;</span><span class=p>],</span> <span class=mi>1000000</span><span class=p>)</span>
<span class=p>})</span>

<span class=n>mem_original</span> <span class=o>=</span> <span class=n>df_original</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Original: </span><span class=si>{</span><span class=n>mem_original</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>

<span class=c1># Optimized</span>
<span class=n>df_opt</span> <span class=o>=</span> <span class=n>df_original</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=n>df_opt</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_numeric</span><span class=p>(</span><span class=n>df_opt</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>],</span> <span class=n>downcast</span><span class=o>=</span><span class=s1>&#39;integer&#39;</span><span class=p>)</span>
<span class=n>df_opt</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_numeric</span><span class=p>(</span><span class=n>df_opt</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>],</span> <span class=n>downcast</span><span class=o>=</span><span class=s1>&#39;integer&#39;</span><span class=p>)</span>
<span class=n>df_opt</span><span class=p>[</span><span class=s1>&#39;score&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_numeric</span><span class=p>(</span><span class=n>df_opt</span><span class=p>[</span><span class=s1>&#39;score&#39;</span><span class=p>],</span> <span class=n>downcast</span><span class=o>=</span><span class=s1>&#39;float&#39;</span><span class=p>)</span>
<span class=n>df_opt</span><span class=p>[</span><span class=s1>&#39;country&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_opt</span><span class=p>[</span><span class=s1>&#39;country&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span>
<span class=n>df_opt</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_opt</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span>

<span class=n>mem_opt</span> <span class=o>=</span> <span class=n>df_opt</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Optimized: </span><span class=si>{</span><span class=n>mem_opt</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Reduction: </span><span class=si>{</span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>mem_opt</span><span class=o>/</span><span class=n>mem_original</span><span class=p>)</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>

<span class=c1># Cleanup</span>
<span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=s1>&#39;test.csv&#39;</span><span class=p>)</span>
<span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=s1>&#39;test.parquet&#39;</span><span class=p>)</span>
</code></pre></div> <p><strong>Optimization Techniques:</strong></p> <table> <thead> <tr> <th>Technique</th> <th>Memory Savings</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>Downcast int64‚Üíint8</strong></td> <td>87.5%</td> <td>Small integers</td> </tr> <tr> <td><strong>Downcast float64‚Üífloat32</strong></td> <td>50%</td> <td>Precision not critical</td> </tr> <tr> <td><strong>String‚ÜíCategorical</strong></td> <td>90%+</td> <td>Low cardinality</td> </tr> <tr> <td><strong>Sparse arrays</strong></td> <td>90%+</td> <td>Many zeros/NaN</td> </tr> <tr> <td><strong>Parquet format</strong></td> <td>50-90%</td> <td>File storage</td> </tr> <tr> <td><strong>Chunking</strong></td> <td>No limit</td> <td>Process huge files</td> </tr> </tbody> </table> <p><strong>Data Type Sizes:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Size</th> <th>Range</th> </tr> </thead> <tbody> <tr> <td><strong>int8</strong></td> <td>1 byte</td> <td>-128 to 127</td> </tr> <tr> <td><strong>int16</strong></td> <td>2 bytes</td> <td>-32,768 to 32,767</td> </tr> <tr> <td><strong>int32</strong></td> <td>4 bytes</td> <td>-2B to 2B</td> </tr> <tr> <td><strong>int64</strong></td> <td>8 bytes</td> <td>-9E18 to 9E18</td> </tr> <tr> <td><strong>float32</strong></td> <td>4 bytes</td> <td>~7 decimals</td> </tr> <tr> <td><strong>float64</strong></td> <td>8 bytes</td> <td>~15 decimals</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"memory_usage(deep=True): check actual usage"</li> <li>"Downcast: int64‚Üíint8/16/32, float64‚Üífloat32"</li> <li>"Categorical: 90%+ savings for low-cardinality strings"</li> <li>"Sparse arrays: for data with many zeros"</li> <li>"Chunking: process files larger than RAM"</li> <li>"Parquet: smaller, faster than CSV"</li> <li>"read_csv usecols: load only needed columns"</li> <li>"Automatic optimization: check ranges, convert types"</li> <li>"Rule: &lt;50% unique ‚Üí categorical"</li> </ul> </div> </details> <hr> <h3 id=explain-pandas-eval-method-google-amazon-interview-question>Explain Pandas Eval Method - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>eval</code>, <code>Performance</code>, <code>Expression Evaluation</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>eval()</strong> evaluates string expressions efficiently using numexpr backend. Much faster than standard operations for large DataFrames, especially with complex arithmetic.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=c1># Create large DataFrame</span>
<span class=n>n</span> <span class=o>=</span> <span class=mi>1000000</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=n>n</span><span class=p>),</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=n>n</span><span class=p>),</span>
    <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=n>n</span><span class=p>),</span>
    <span class=s1>&#39;D&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># 1. Basic eval()</span>
<span class=c1># Standard operation</span>
<span class=n>result_standard</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;C&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;D&#39;</span><span class=p>]</span>

<span class=c1># eval operation</span>
<span class=n>result_eval</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;A + B * C - D&#39;</span><span class=p>)</span>

<span class=c1># Results are equal</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Results equal:&quot;</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>allclose</span><span class=p>(</span><span class=n>result_standard</span><span class=p>,</span> <span class=n>result_eval</span><span class=p>))</span>

<span class=c1># 2. Performance Comparison</span>
<span class=c1># Standard</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;C&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;D&#39;</span><span class=p>]</span>
<span class=n>standard_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=c1># eval</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;A + B * C - D&#39;</span><span class=p>)</span>
<span class=n>eval_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Standard: </span><span class=si>{</span><span class=n>standard_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;eval: </span><span class=si>{</span><span class=n>eval_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Speedup: </span><span class=si>{</span><span class=n>standard_time</span><span class=o>/</span><span class=n>eval_time</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>x&quot;</span><span class=p>)</span>

<span class=c1># 3. Column Assignment</span>
<span class=c1># Create new column</span>
<span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;E = A + B&#39;</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>New column E:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;E&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>

<span class=c1># Multiple assignments</span>
<span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;&#39;&#39;</span>
<span class=s1>    F = A * 2</span>
<span class=s1>    G = B + C</span>
<span class=s1>&#39;&#39;&#39;</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># 4. Using Variables with @</span>
<span class=n>multiplier</span> <span class=o>=</span> <span class=mf>2.5</span>
<span class=n>threshold</span> <span class=o>=</span> <span class=mf>0.5</span>

<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;A * @multiplier &gt; @threshold&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With variables:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>

<span class=c1># 5. Comparison Operations</span>
<span class=c1># Boolean mask</span>
<span class=n>mask</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;A &gt; 0.5 and B &lt; 0.3&#39;</span><span class=p>)</span>
<span class=n>filtered</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>mask</span><span class=p>]</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Filtered rows:&quot;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>filtered</span><span class=p>))</span>

<span class=c1># Multiple conditions</span>
<span class=n>complex_mask</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;(A &gt; 0.5 and B &lt; 0.3) or (C &gt; 0.8 and D &lt; 0.2)&#39;</span><span class=p>)</span>

<span class=c1># 6. Local vs Global Variables</span>
<span class=n>local_var</span> <span class=o>=</span> <span class=mi>10</span>

<span class=c1># Access local variable</span>
<span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;H = A * @local_var&#39;</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># 7. DataFrame.eval() vs pd.eval()</span>
<span class=c1># DataFrame.eval</span>
<span class=n>df_result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;A + B&#39;</span><span class=p>)</span>

<span class=c1># pd.eval with multiple DataFrames</span>
<span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;X&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=n>n</span><span class=p>),</span>
    <span class=s1>&#39;Y&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># Doesn&#39;t work directly with multiple DataFrames in df.eval</span>
<span class=c1># Use standard operations or merge first</span>

<span class=c1># 8. Assignment Operators</span>
<span class=c1># Add to existing column</span>
<span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;A = A + 1&#39;</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Conditional assignment (use where instead)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;I&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;A if A &gt; 0.5 else B&#39;</span><span class=p>)</span>

<span class=c1># 9. Complex Expressions</span>
<span class=c1># Multi-line expressions</span>
<span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;&#39;&#39;</span>
<span class=s1>    temp1 = A + B</span>
<span class=s1>    temp2 = C * D</span>
<span class=s1>    result = temp1 / temp2</span>
<span class=s1>&#39;&#39;&#39;</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># 10. When eval() is Faster</span>
<span class=c1># Good: Complex arithmetic</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;A + B * C / D - (A * B) + (C / D)&#39;</span><span class=p>)</span>
<span class=n>eval_fast</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;C&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;D&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>])</span> <span class=o>+</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;C&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;D&#39;</span><span class=p>])</span>
<span class=n>standard_slow</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Complex arithmetic:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;eval: </span><span class=si>{</span><span class=n>eval_fast</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Standard: </span><span class=si>{</span><span class=n>standard_slow</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Speedup: </span><span class=si>{</span><span class=n>standard_slow</span><span class=o>/</span><span class=n>eval_fast</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>x&quot;</span><span class=p>)</span>

<span class=c1># Bad: Simple operations, small data</span>
<span class=n>small_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]})</span>

<span class=c1># Not faster for small data</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>small_df</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;A + B&#39;</span><span class=p>)</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>small_df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>small_df</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span>  <span class=c1># Similar speed</span>

<span class=c1># 11. Supported Operations</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>=== Supported Operations ===&quot;</span><span class=p>)</span>
<span class=n>df_ops</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Arithmetic</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Arithmetic:&quot;</span><span class=p>,</span> <span class=n>df_ops</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;A + B * 2&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>

<span class=c1># Comparison</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Comparison:&quot;</span><span class=p>,</span> <span class=n>df_ops</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;A &gt; 1&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>

<span class=c1># Logical</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Logical:&quot;</span><span class=p>,</span> <span class=n>df_ops</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;A &gt; 1 and B &lt; 6&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>

<span class=c1># 12. Limitations</span>
<span class=c1># Can&#39;t use:</span>
<span class=c1># - String methods: df.eval(&#39;A.str.upper()&#39;)  # Error</span>
<span class=c1># - Complex functions: df.eval(&#39;A.apply(func)&#39;)  # Error</span>
<span class=c1># - Method chaining</span>

<span class=c1># Use standard operations instead for these</span>

<span class=c1># 13. Practical Example</span>
<span class=c1># Financial calculations</span>
<span class=n>portfolio</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;shares&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>1000</span><span class=p>,</span> <span class=mi>10000</span><span class=p>),</span>
    <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10000</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span><span class=p>,</span>
    <span class=s1>&#39;cost_basis&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10000</span><span class=p>)</span> <span class=o>*</span> <span class=mi>80</span><span class=p>,</span>
    <span class=s1>&#39;dividend&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10000</span><span class=p>)</span> <span class=o>*</span> <span class=mi>5</span>
<span class=p>})</span>

<span class=c1># Calculate portfolio metrics</span>
<span class=n>portfolio</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;&#39;&#39;</span>
<span class=s1>    market_value = shares * price</span>
<span class=s1>    cost_value = shares * cost_basis</span>
<span class=s1>    unrealized_gain = market_value - cost_value</span>
<span class=s1>    gain_pct = (unrealized_gain / cost_value) * 100</span>
<span class=s1>    annual_dividend = shares * dividend</span>
<span class=s1>    yield_pct = (annual_dividend / market_value) * 100</span>
<span class=s1>&#39;&#39;&#39;</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Portfolio metrics:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>portfolio</span><span class=p>[[</span><span class=s1>&#39;market_value&#39;</span><span class=p>,</span> <span class=s1>&#39;unrealized_gain&#39;</span><span class=p>,</span> <span class=s1>&#39;gain_pct&#39;</span><span class=p>,</span> <span class=s1>&#39;yield_pct&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>
</code></pre></div> <p><strong>eval() vs Standard:</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>eval()</th> <th>Standard</th> </tr> </thead> <tbody> <tr> <td><strong>Syntax</strong></td> <td>String expression</td> <td>Python operations</td> </tr> <tr> <td><strong>Speed</strong></td> <td>Faster (large data)</td> <td>Slower</td> </tr> <tr> <td><strong>Memory</strong></td> <td>More efficient</td> <td>More allocations</td> </tr> <tr> <td><strong>Readability</strong></td> <td>SQL-like, cleaner</td> <td>More verbose</td> </tr> <tr> <td><strong>Best for</strong></td> <td>Complex arithmetic</td> <td>Simple operations</td> </tr> </tbody> </table> <p><strong>When to Use eval():</strong></p> <table> <thead> <tr> <th>Use eval()</th> <th>Don't Use eval()</th> </tr> </thead> <tbody> <tr> <td>Large DataFrames (&gt;100k rows)</td> <td>Small DataFrames</td> </tr> <tr> <td>Complex arithmetic</td> <td>Simple operations</td> </tr> <tr> <td>Multiple operations</td> <td>Single operation</td> </tr> <tr> <td>Chained calculations</td> <td>String methods</td> </tr> <tr> <td>Memory constrained</td> <td>Custom functions</td> </tr> </tbody> </table> <p><strong>Supported Operations:</strong></p> <table> <thead> <tr> <th>Operation</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>Arithmetic</strong></td> <td><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>**</code>, <code>%</code></td> </tr> <tr> <td><strong>Comparison</strong></td> <td><code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>==</code>, <code>!=</code></td> </tr> <tr> <td><strong>Logical</strong></td> <td><code>and</code>, <code>or</code>, <code>not</code>, <code>&amp;</code>, <code>|</code>, <code>~</code></td> </tr> <tr> <td><strong>Variables</strong></td> <td><code>@variable_name</code></td> </tr> <tr> <td><strong>Assignment</strong></td> <td><code>new_col = expression</code></td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"eval(): string expressions using numexpr"</li> <li>"Faster for large DataFrames (100k+ rows)"</li> <li>"Best for complex arithmetic: 2-4x speedup"</li> <li>"More memory efficient"</li> <li>"Use @ for variables: <code>eval('A * @multiplier')</code>"</li> <li>"inplace=True: modify DataFrame"</li> <li>"Limitations: no string methods, custom functions"</li> <li>"Not faster for small data or simple ops"</li> <li>"Cleaner syntax for complex calculations"</li> </ul> </div> </details> <hr> <h3 id=explain-pandas-time-series-resampling-meta-netflix-interview-question>Explain Pandas Time Series Resampling - Meta, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Time Series</code>, <code>Resampling</code>, <code>Aggregation</code> | <strong>Asked by:</strong> Meta, Netflix, Google, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>Resample()</strong> converts time series to different frequencies (upsampling/downsampling). Essential for time series aggregation, business reporting, and data alignment.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># Create time series data</span>
<span class=n>dates</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>365</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>)</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>dates</span><span class=p>,</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>365</span><span class=p>)</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>365</span><span class=p>)</span> <span class=o>*</span> <span class=mf>0.1</span><span class=p>)</span> <span class=o>*</span> <span class=mi>50</span><span class=p>,</span>
    <span class=s1>&#39;customers&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>365</span><span class=p>),</span>
    <span class=s1>&#39;temperature&#39;</span><span class=p>:</span> <span class=mi>70</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>365</span><span class=p>)</span> <span class=o>*</span> <span class=mf>0.017</span><span class=p>)</span> <span class=o>*</span> <span class=mi>20</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>365</span><span class=p>)</span> <span class=o>*</span> <span class=mi>5</span>
<span class=p>})</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s1>&#39;date&#39;</span><span class=p>)</span>

<span class=c1># 1. Downsampling (Higher ‚Üí Lower Frequency)</span>
<span class=c1># Daily ‚Üí Weekly</span>
<span class=n>weekly</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;W&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Weekly totals:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>weekly</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>

<span class=c1># Daily ‚Üí Monthly</span>
<span class=n>monthly</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;M&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Monthly totals:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>monthly</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>

<span class=c1># Daily ‚Üí Quarterly</span>
<span class=n>quarterly</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;Q&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Quarterly totals:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>quarterly</span><span class=p>)</span>

<span class=c1># 2. Different Aggregations</span>
<span class=c1># Multiple aggregations</span>
<span class=n>monthly_stats</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;M&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>({</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>,</span> <span class=s1>&#39;max&#39;</span><span class=p>],</span>
    <span class=s1>&#39;customers&#39;</span><span class=p>:</span> <span class=s1>&#39;sum&#39;</span><span class=p>,</span>
    <span class=s1>&#39;temperature&#39;</span><span class=p>:</span> <span class=s1>&#39;mean&#39;</span>
<span class=p>})</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Monthly statistics:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>monthly_stats</span><span class=p>)</span>

<span class=c1># 3. Upsampling (Lower ‚Üí Higher Frequency)</span>
<span class=c1># Create sparse data</span>
<span class=n>weekly_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>180</span><span class=p>]</span>
<span class=p>},</span> <span class=n>index</span><span class=o>=</span><span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;W&#39;</span><span class=p>))</span>

<span class=c1># Fill forward</span>
<span class=n>daily_ffill</span> <span class=o>=</span> <span class=n>weekly_data</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;D&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>ffill</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Upsampled (forward fill):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>daily_ffill</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span>

<span class=c1># Interpolate</span>
<span class=n>daily_interp</span> <span class=o>=</span> <span class=n>weekly_data</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;D&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>interpolate</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Upsampled (interpolate):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>daily_interp</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span>

<span class=c1># 4. Common Frequency Codes</span>
<span class=n>freq_examples</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;D&#39;</span><span class=p>:</span> <span class=s1>&#39;Daily&#39;</span><span class=p>,</span>
    <span class=s1>&#39;W&#39;</span><span class=p>:</span> <span class=s1>&#39;Weekly&#39;</span><span class=p>,</span>
    <span class=s1>&#39;M&#39;</span><span class=p>:</span> <span class=s1>&#39;Month end&#39;</span><span class=p>,</span>
    <span class=s1>&#39;MS&#39;</span><span class=p>:</span> <span class=s1>&#39;Month start&#39;</span><span class=p>,</span>
    <span class=s1>&#39;Q&#39;</span><span class=p>:</span> <span class=s1>&#39;Quarter end&#39;</span><span class=p>,</span>
    <span class=s1>&#39;QS&#39;</span><span class=p>:</span> <span class=s1>&#39;Quarter start&#39;</span><span class=p>,</span>
    <span class=s1>&#39;Y&#39;</span><span class=p>:</span> <span class=s1>&#39;Year end&#39;</span><span class=p>,</span>
    <span class=s1>&#39;H&#39;</span><span class=p>:</span> <span class=s1>&#39;Hourly&#39;</span><span class=p>,</span>
    <span class=s1>&#39;T&#39;</span> <span class=ow>or</span> <span class=s1>&#39;min&#39;</span><span class=p>:</span> <span class=s1>&#39;Minute&#39;</span><span class=p>,</span>
    <span class=s1>&#39;S&#39;</span><span class=p>:</span> <span class=s1>&#39;Second&#39;</span>
<span class=p>}</span>

<span class=c1># 5. Business Day Resampling</span>
<span class=c1># Business days only (Mon-Fri)</span>
<span class=n>business_weekly</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;W-MON&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>  <span class=c1># Week ending Monday</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Weekly (business days):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>business_weekly</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>

<span class=c1># Business month</span>
<span class=n>business_monthly</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;BM&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>  <span class=c1># Business month end</span>

<span class=c1># 6. Offset Resampling</span>
<span class=c1># 2-week periods</span>
<span class=n>biweekly</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;2W&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Bi-weekly totals:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>biweekly</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>

<span class=c1># 10-day periods</span>
<span class=n>ten_day</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;10D&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>

<span class=c1># 7. Rolling with Resample</span>
<span class=c1># Monthly average with rolling</span>
<span class=n>monthly_rolling</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;M&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=o>.</span><span class=n>rolling</span><span class=p>(</span><span class=n>window</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>3-month moving average:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>monthly_rolling</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>6</span><span class=p>))</span>

<span class=c1># 8. Groupby with Resample</span>
<span class=c1># Add category</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;region&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>],</span> <span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>))</span>

<span class=c1># Resample per group</span>
<span class=n>regional_monthly</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;M&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Regional monthly sales:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>regional_monthly</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>

<span class=c1># 9. Custom Aggregation</span>
<span class=k>def</span><span class=w> </span><span class=nf>custom_agg</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Custom aggregation function.&quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>({</span>
        <span class=s1>&#39;total&#39;</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>sum</span><span class=p>(),</span>
        <span class=s1>&#39;average&#39;</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>mean</span><span class=p>(),</span>
        <span class=s1>&#39;peak&#39;</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>max</span><span class=p>(),</span>
        <span class=s1>&#39;days&#39;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
    <span class=p>})</span>

<span class=n>custom_monthly</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;M&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>custom_agg</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Custom aggregation:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>custom_monthly</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>

<span class=c1># 10. Label and Closed Parameters</span>
<span class=c1># Default: label=&#39;right&#39;, closed=&#39;right&#39;</span>
<span class=c1># Period labeled by right edge, closed on right</span>

<span class=c1># Label by left edge</span>
<span class=n>left_label</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;W&#39;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s1>&#39;left&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>

<span class=c1># Closed on left</span>
<span class=n>left_closed</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;W&#39;</span><span class=p>,</span> <span class=n>closed</span><span class=o>=</span><span class=s1>&#39;left&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>

<span class=c1># 11. Origin and Offset</span>
<span class=c1># Start resampling from specific point</span>
<span class=n>custom_origin</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;10D&#39;</span><span class=p>,</span> <span class=n>origin</span><span class=o>=</span><span class=s1>&#39;2024-01-05&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>

<span class=c1># 12. Practical Example: Business Reporting</span>
<span class=n>sales_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;H&#39;</span><span class=p>),</span>
    <span class=s1>&#39;revenue&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>1000</span><span class=p>,</span> <span class=mi>1000</span><span class=p>),</span>
    <span class=s1>&#39;orders&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>1000</span><span class=p>)</span>
<span class=p>})</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s1>&#39;timestamp&#39;</span><span class=p>)</span>

<span class=c1># Daily summary</span>
<span class=n>daily_report</span> <span class=o>=</span> <span class=n>sales_data</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;D&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>({</span>
    <span class=s1>&#39;revenue&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>,</span> <span class=s1>&#39;max&#39;</span><span class=p>],</span>
    <span class=s1>&#39;orders&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Add calculated metrics</span>
<span class=n>daily_report</span><span class=p>[</span><span class=s1>&#39;avg_order_value&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
    <span class=n>daily_report</span><span class=p>[(</span><span class=s1>&#39;revenue&#39;</span><span class=p>,</span> <span class=s1>&#39;sum&#39;</span><span class=p>)]</span> <span class=o>/</span> <span class=n>daily_report</span><span class=p>[(</span><span class=s1>&#39;orders&#39;</span><span class=p>,</span> <span class=s1>&#39;sum&#39;</span><span class=p>)]</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Daily business report:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>daily_report</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>

<span class=c1># Weekly summary with week-over-week growth</span>
<span class=n>weekly_report</span> <span class=o>=</span> <span class=n>sales_data</span><span class=o>.</span><span class=n>resample</span><span class=p>(</span><span class=s1>&#39;W&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<span class=n>weekly_report</span><span class=p>[</span><span class=s1>&#39;revenue_growth&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>weekly_report</span><span class=p>[</span><span class=s1>&#39;revenue&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>pct_change</span><span class=p>()</span> <span class=o>*</span> <span class=mi>100</span>
<span class=n>weekly_report</span><span class=p>[</span><span class=s1>&#39;orders_growth&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>weekly_report</span><span class=p>[</span><span class=s1>&#39;orders&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>pct_change</span><span class=p>()</span> <span class=o>*</span> <span class=mi>100</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Weekly growth report:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>weekly_report</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>

<span class=c1># 13. Combining with Transform</span>
<span class=c1># Add group statistics back to original data</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;monthly_avg&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>to_period</span><span class=p>(</span><span class=s1>&#39;M&#39;</span><span class=p>))[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=s1>&#39;mean&#39;</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With monthly average:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;monthly_avg&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>35</span><span class=p>))</span>
</code></pre></div> <p><strong>Frequency Codes:</strong></p> <table> <thead> <tr> <th>Code</th> <th>Meaning</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>D</strong></td> <td>Day</td> <td>Daily data</td> </tr> <tr> <td><strong>W</strong></td> <td>Week</td> <td>Weekly summary</td> </tr> <tr> <td><strong>M</strong></td> <td>Month end</td> <td>Monthly totals</td> </tr> <tr> <td><strong>MS</strong></td> <td>Month start</td> <td>Start of month</td> </tr> <tr> <td><strong>Q</strong></td> <td>Quarter end</td> <td>Quarterly reports</td> </tr> <tr> <td><strong>Y</strong></td> <td>Year end</td> <td>Annual data</td> </tr> <tr> <td><strong>H</strong></td> <td>Hour</td> <td>Hourly aggregation</td> </tr> <tr> <td><strong>T/min</strong></td> <td>Minute</td> <td>Minute-level data</td> </tr> <tr> <td><strong>S</strong></td> <td>Second</td> <td>Second-level data</td> </tr> <tr> <td><strong>B</strong></td> <td>Business day</td> <td>Weekdays only</td> </tr> </tbody> </table> <p><strong>Resampling Methods:</strong></p> <table> <thead> <tr> <th>Method</th> <th>Description</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>sum()</strong></td> <td>Total</td> <td>Revenue, quantities</td> </tr> <tr> <td><strong>mean()</strong></td> <td>Average</td> <td>Prices, temperatures</td> </tr> <tr> <td><strong>first()</strong></td> <td>First value</td> <td>Opening price</td> </tr> <tr> <td><strong>last()</strong></td> <td>Last value</td> <td>Closing price</td> </tr> <tr> <td><strong>max()/min()</strong></td> <td>Peak/Low</td> <td>Daily highs/lows</td> </tr> <tr> <td><strong>count()</strong></td> <td>Count</td> <td>Transactions</td> </tr> <tr> <td><strong>ffill()</strong></td> <td>Forward fill</td> <td>Upsampling</td> </tr> <tr> <td><strong>interpolate()</strong></td> <td>Interpolation</td> <td>Smooth upsampling</td> </tr> </tbody> </table> <p><strong>Upsampling vs Downsampling:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Direction</th> <th>Aggregation</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>Downsampling</strong></td> <td>High ‚Üí Low freq</td> <td>Required</td> <td>Daily ‚Üí Monthly</td> </tr> <tr> <td><strong>Upsampling</strong></td> <td>Low ‚Üí High freq</td> <td>Fill/interpolate</td> <td>Monthly ‚Üí Daily</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"resample(): convert time series frequency"</li> <li>"Downsampling: higher ‚Üí lower (daily ‚Üí monthly)"</li> <li>"Upsampling: lower ‚Üí higher (monthly ‚Üí daily)"</li> <li>"Frequency codes: D, W, M, Q, Y, H"</li> <li>"Aggregation: sum, mean, max for downsampling"</li> <li>"Fill methods: ffill, bfill, interpolate for upsampling"</li> <li>"label: 'left' or 'right' edge labeling"</li> <li>"Business days: 'B', 'BM' for business calendars"</li> <li>"Combine with groupby for category-wise resampling"</li> </ul> </div> </details> <hr> <h3 id=explain-pandas-pivot-tables-microsoft-amazon-interview-question>Explain Pandas Pivot Tables - Microsoft, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Pivot Tables</code>, <code>Aggregation</code>, <code>Reshaping</code> | <strong>Asked by:</strong> Microsoft, Amazon, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>pivot_table()</strong> summarizes data with row/column groupings and aggregations (like Excel). <strong>pivot()</strong> reshapes without aggregation. Use pivot_table for reports, pivot for simple reshaping.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># Sample sales data</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>repeat</span><span class=p>(</span><span class=mi>3</span><span class=p>),</span>
    <span class=s1>&#39;region&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>tile</span><span class=p>([</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>,</span> <span class=s1>&#39;East&#39;</span><span class=p>],</span> <span class=mi>100</span><span class=p>),</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>tile</span><span class=p>([</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>],</span> <span class=mi>100</span><span class=p>),</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>1000</span><span class=p>,</span> <span class=mi>300</span><span class=p>),</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>300</span><span class=p>),</span>
    <span class=s1>&#39;profit&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>300</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># 1. Basic pivot_table</span>
<span class=c1># Sales by region and product</span>
<span class=n>pivot</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>df</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;region&#39;</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;product&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;sum&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Sales by region and product:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>pivot</span><span class=p>)</span>

<span class=c1># 2. Multiple Aggregations</span>
<span class=c1># Multiple functions</span>
<span class=n>multi_agg</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>df</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;region&#39;</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;product&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>]</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Multiple aggregations:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>multi_agg</span><span class=p>)</span>

<span class=c1># 3. Multiple Values</span>
<span class=c1># Different columns</span>
<span class=n>multi_values</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>df</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;profit&#39;</span><span class=p>],</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;region&#39;</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;product&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;sum&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Multiple values:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>multi_values</span><span class=p>)</span>

<span class=c1># 4. Margins (Totals)</span>
<span class=c1># Add row and column totals</span>
<span class=n>with_totals</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>df</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;region&#39;</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;product&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span>
    <span class=n>margins</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>margins_name</span><span class=o>=</span><span class=s1>&#39;Total&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With totals:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>with_totals</span><span class=p>)</span>

<span class=c1># 5. Fill Missing Values</span>
<span class=c1># Replace NaN</span>
<span class=n>filled</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>df</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;region&#39;</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;product&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span>
    <span class=n>fill_value</span><span class=o>=</span><span class=mi>0</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Filled with zeros:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>filled</span><span class=p>)</span>

<span class=c1># 6. Multiple Index Levels</span>
<span class=c1># Hierarchical index</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;month&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>to_period</span><span class=p>(</span><span class=s1>&#39;M&#39;</span><span class=p>)</span>

<span class=n>multi_index</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>df</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span>
    <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;month&#39;</span><span class=p>,</span> <span class=s1>&#39;region&#39;</span><span class=p>],</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;product&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;sum&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Multi-index:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>multi_index</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span>

<span class=c1># 7. Custom Aggregation</span>
<span class=k>def</span><span class=w> </span><span class=nf>range_func</span><span class=p>(</span><span class=n>x</span><span class=p>):</span>
    <span class=k>return</span> <span class=n>x</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>min</span><span class=p>()</span>

<span class=n>custom_agg</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>df</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;region&#39;</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;product&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=n>range_func</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Custom aggregation (range):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>custom_agg</span><span class=p>)</span>

<span class=c1># 8. pivot() vs pivot_table()</span>
<span class=c1># Simple data (unique index/column combinations)</span>
<span class=n>simple_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;row&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>],</span>
    <span class=s1>&#39;col&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;X&#39;</span><span class=p>,</span> <span class=s1>&#39;Y&#39;</span><span class=p>,</span> <span class=s1>&#39;X&#39;</span><span class=p>,</span> <span class=s1>&#39;Y&#39;</span><span class=p>],</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># pivot (no aggregation, must be unique)</span>
<span class=n>pivoted</span> <span class=o>=</span> <span class=n>simple_df</span><span class=o>.</span><span class=n>pivot</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=s1>&#39;row&#39;</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;col&#39;</span><span class=p>,</span> <span class=n>values</span><span class=o>=</span><span class=s1>&#39;value&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>pivot() result:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>pivoted</span><span class=p>)</span>

<span class=c1># pivot_table (with aggregation, handles duplicates)</span>
<span class=n>dup_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;row&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>],</span>
    <span class=s1>&#39;col&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;X&#39;</span><span class=p>,</span> <span class=s1>&#39;X&#39;</span><span class=p>,</span> <span class=s1>&#39;Y&#39;</span><span class=p>,</span> <span class=s1>&#39;X&#39;</span><span class=p>],</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># pivot would fail (duplicates)</span>
<span class=c1># pivoted = dup_df.pivot(index=&#39;row&#39;, columns=&#39;col&#39;, values=&#39;value&#39;)  # Error!</span>

<span class=c1># pivot_table handles it</span>
<span class=n>pivoted_agg</span> <span class=o>=</span> <span class=n>dup_df</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;row&#39;</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;col&#39;</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=s1>&#39;value&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;sum&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>pivot_table() with duplicates:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>pivoted_agg</span><span class=p>)</span>

<span class=c1># 9. Observed Parameter</span>
<span class=c1># Add categorical column</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Categorical</span><span class=p>(</span>
    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;Cat1&#39;</span><span class=p>,</span> <span class=s1>&#39;Cat2&#39;</span><span class=p>,</span> <span class=s1>&#39;Cat3&#39;</span><span class=p>],</span> <span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>)),</span>
    <span class=n>categories</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Cat1&#39;</span><span class=p>,</span> <span class=s1>&#39;Cat2&#39;</span><span class=p>,</span> <span class=s1>&#39;Cat3&#39;</span><span class=p>,</span> <span class=s1>&#39;Cat4&#39;</span><span class=p>]</span>  <span class=c1># Cat4 unused</span>
<span class=p>)</span>

<span class=c1># Include unused categories</span>
<span class=n>with_unused</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>df</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;category&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span>
    <span class=n>observed</span><span class=o>=</span><span class=kc>False</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With unused categories:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>with_unused</span><span class=p>)</span>

<span class=c1># Exclude unused</span>
<span class=n>observed_only</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>df</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;category&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span>
    <span class=n>observed</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Observed only:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>observed_only</span><span class=p>)</span>

<span class=c1># 10. Practical Example: Business Report</span>
<span class=n>sales_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>365</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>),</span>
    <span class=s1>&#39;region&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>,</span> <span class=s1>&#39;East&#39;</span><span class=p>,</span> <span class=s1>&#39;West&#39;</span><span class=p>],</span> <span class=mi>365</span><span class=p>),</span>
    <span class=s1>&#39;product_category&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;Electronics&#39;</span><span class=p>,</span> <span class=s1>&#39;Clothing&#39;</span><span class=p>,</span> <span class=s1>&#39;Food&#39;</span><span class=p>],</span> <span class=mi>365</span><span class=p>),</span>
    <span class=s1>&#39;revenue&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1000</span><span class=p>,</span> <span class=mi>10000</span><span class=p>,</span> <span class=mi>365</span><span class=p>),</span>
    <span class=s1>&#39;units_sold&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>365</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># Add month and quarter</span>
<span class=n>sales_data</span><span class=p>[</span><span class=s1>&#39;month&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>sales_data</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>to_period</span><span class=p>(</span><span class=s1>&#39;M&#39;</span><span class=p>)</span>
<span class=n>sales_data</span><span class=p>[</span><span class=s1>&#39;quarter&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>sales_data</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>to_period</span><span class=p>(</span><span class=s1>&#39;Q&#39;</span><span class=p>)</span>

<span class=c1># Quarterly report</span>
<span class=n>quarterly_report</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>sales_data</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;revenue&#39;</span><span class=p>,</span> <span class=s1>&#39;units_sold&#39;</span><span class=p>],</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;quarter&#39;</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;region&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=p>{</span>
        <span class=s1>&#39;revenue&#39;</span><span class=p>:</span> <span class=s1>&#39;sum&#39;</span><span class=p>,</span>
        <span class=s1>&#39;units_sold&#39;</span><span class=p>:</span> <span class=s1>&#39;sum&#39;</span>
    <span class=p>},</span>
    <span class=n>margins</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>fill_value</span><span class=o>=</span><span class=mi>0</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Quarterly business report:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>quarterly_report</span><span class=p>)</span>

<span class=c1># Monthly category performance</span>
<span class=n>category_report</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>sales_data</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=s1>&#39;revenue&#39;</span><span class=p>,</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;month&#39;</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;product_category&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>],</span>
    <span class=n>margins</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Monthly category report:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>category_report</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>6</span><span class=p>))</span>
</code></pre></div> <p><strong>pivot() vs pivot_table():</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>pivot()</th> <th>pivot_table()</th> </tr> </thead> <tbody> <tr> <td><strong>Aggregation</strong></td> <td>No</td> <td>Yes</td> </tr> <tr> <td><strong>Duplicates</strong></td> <td>Must be unique</td> <td>Handles duplicates</td> </tr> <tr> <td><strong>Use Case</strong></td> <td>Simple reshape</td> <td>Summarization</td> </tr> <tr> <td><strong>Example</strong></td> <td>Wide to long</td> <td>Excel pivot table</td> </tr> <tr> <td><strong>Parameters</strong></td> <td>index, columns, values</td> <td>+ aggfunc, margins</td> </tr> </tbody> </table> <p><strong>Common Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>values</strong></td> <td>Column(s) to aggregate</td> <td><code>values='sales'</code></td> </tr> <tr> <td><strong>index</strong></td> <td>Row grouping</td> <td><code>index='region'</code></td> </tr> <tr> <td><strong>columns</strong></td> <td>Column grouping</td> <td><code>columns='product'</code></td> </tr> <tr> <td><strong>aggfunc</strong></td> <td>Aggregation function</td> <td><code>aggfunc='sum'</code></td> </tr> <tr> <td><strong>fill_value</strong></td> <td>Replace NaN</td> <td><code>fill_value=0</code></td> </tr> <tr> <td><strong>margins</strong></td> <td>Add totals</td> <td><code>margins=True</code></td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"pivot_table(): Excel-like summarization"</li> <li>"pivot(): reshape without aggregation"</li> <li>"index: row grouping, columns: column grouping"</li> <li>"aggfunc: 'sum', 'mean', 'count', or custom"</li> <li>"margins=True: add row/column totals"</li> <li>"fill_value=0: replace NaN"</li> <li>"pivot_table handles duplicates, pivot doesn't"</li> <li>"Multiple values: list in values parameter"</li> <li>"Use for: reports, summaries, cross-tabulation"</li> </ul> </div> </details> <hr> <h3 id=explain-pdmelt-google-meta-interview-question>Explain pd.melt() - Google, Meta Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>melt</code>, <code>Reshaping</code>, <code>Wide to Long</code> | <strong>Asked by:</strong> Google, Meta, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>melt()</strong> transforms wide format to long format (unpivots). Opposite of pivot. Essential for tidy data, plotting, and analysis requiring long format.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=c1># Wide format data</span>
<span class=n>df_wide</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;student&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>],</span>
    <span class=s1>&#39;math&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>85</span><span class=p>,</span> <span class=mi>92</span><span class=p>,</span> <span class=mi>78</span><span class=p>],</span>
    <span class=s1>&#39;science&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>88</span><span class=p>,</span> <span class=mi>95</span><span class=p>,</span> <span class=mi>82</span><span class=p>],</span>
    <span class=s1>&#39;english&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>90</span><span class=p>,</span> <span class=mi>87</span><span class=p>,</span> <span class=mi>85</span><span class=p>]</span>
<span class=p>})</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Wide format:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_wide</span><span class=p>)</span>

<span class=c1># 1. Basic melt</span>
<span class=n>df_long</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span><span class=n>df_wide</span><span class=p>,</span> <span class=n>id_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;student&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Long format (basic):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_long</span><span class=p>)</span>

<span class=c1># 2. Custom Column Names</span>
<span class=n>df_long</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span>
    <span class=n>df_wide</span><span class=p>,</span>
    <span class=n>id_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;student&#39;</span><span class=p>],</span>
    <span class=n>var_name</span><span class=o>=</span><span class=s1>&#39;subject&#39;</span><span class=p>,</span>
    <span class=n>value_name</span><span class=o>=</span><span class=s1>&#39;score&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With custom names:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_long</span><span class=p>)</span>

<span class=c1># 3. Select Specific Columns to Melt</span>
<span class=n>df_long</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span>
    <span class=n>df_wide</span><span class=p>,</span>
    <span class=n>id_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;student&#39;</span><span class=p>],</span>
    <span class=n>value_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;math&#39;</span><span class=p>,</span> <span class=s1>&#39;science&#39;</span><span class=p>],</span>  <span class=c1># Only these columns</span>
    <span class=n>var_name</span><span class=o>=</span><span class=s1>&#39;subject&#39;</span><span class=p>,</span>
    <span class=n>value_name</span><span class=o>=</span><span class=s1>&#39;score&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Selected columns:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_long</span><span class=p>)</span>

<span class=c1># 4. Multiple ID Variables</span>
<span class=n>df_multi</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;student&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>],</span>
    <span class=s1>&#39;class&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>],</span>
    <span class=s1>&#39;math&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>85</span><span class=p>,</span> <span class=mi>92</span><span class=p>,</span> <span class=mi>78</span><span class=p>],</span>
    <span class=s1>&#39;science&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>88</span><span class=p>,</span> <span class=mi>95</span><span class=p>,</span> <span class=mi>82</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>df_long</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span>
    <span class=n>df_multi</span><span class=p>,</span>
    <span class=n>id_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;student&#39;</span><span class=p>,</span> <span class=s1>&#39;class&#39;</span><span class=p>],</span>
    <span class=n>var_name</span><span class=o>=</span><span class=s1>&#39;subject&#39;</span><span class=p>,</span>
    <span class=n>value_name</span><span class=o>=</span><span class=s1>&#39;score&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Multiple ID vars:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_long</span><span class=p>)</span>

<span class=c1># 5. melt() + pivot() (Round Trip)</span>
<span class=c1># Wide ‚Üí Long</span>
<span class=n>df_long</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span><span class=n>df_wide</span><span class=p>,</span> <span class=n>id_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;student&#39;</span><span class=p>])</span>

<span class=c1># Long ‚Üí Wide</span>
<span class=n>df_back</span> <span class=o>=</span> <span class=n>df_long</span><span class=o>.</span><span class=n>pivot</span><span class=p>(</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;student&#39;</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;variable&#39;</span><span class=p>,</span>
    <span class=n>values</span><span class=o>=</span><span class=s1>&#39;value&#39;</span>
<span class=p>)</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Round trip (original):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_wide</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Round trip (restored):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_back</span><span class=p>)</span>

<span class=c1># 6. Real Example: Time Series</span>
<span class=n>sales_wide</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Widget&#39;</span><span class=p>,</span> <span class=s1>&#39;Gadget&#39;</span><span class=p>,</span> <span class=s1>&#39;Tool&#39;</span><span class=p>],</span>
    <span class=s1>&#39;2023-Q1&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>80</span><span class=p>],</span>
    <span class=s1>&#39;2023-Q2&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>120</span><span class=p>,</span> <span class=mi>160</span><span class=p>,</span> <span class=mi>90</span><span class=p>],</span>
    <span class=s1>&#39;2023-Q3&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>110</span><span class=p>,</span> <span class=mi>170</span><span class=p>,</span> <span class=mi>85</span><span class=p>],</span>
    <span class=s1>&#39;2023-Q4&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>130</span><span class=p>,</span> <span class=mi>180</span><span class=p>,</span> <span class=mi>95</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>sales_long</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span>
    <span class=n>sales_wide</span><span class=p>,</span>
    <span class=n>id_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;product&#39;</span><span class=p>],</span>
    <span class=n>var_name</span><span class=o>=</span><span class=s1>&#39;quarter&#39;</span><span class=p>,</span>
    <span class=n>value_name</span><span class=o>=</span><span class=s1>&#39;sales&#39;</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Time series (long format):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>sales_long</span><span class=p>)</span>

<span class=c1># Convert quarter to datetime</span>
<span class=n>sales_long</span><span class=p>[</span><span class=s1>&#39;quarter&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>PeriodIndex</span><span class=p>(</span><span class=n>sales_long</span><span class=p>[</span><span class=s1>&#39;quarter&#39;</span><span class=p>],</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;Q&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>to_timestamp</span><span class=p>()</span>

<span class=c1># 7. Handling Missing Values</span>
<span class=n>df_missing</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=kc>None</span><span class=p>,</span> <span class=mi>30</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>40</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Default: keeps NaN</span>
<span class=n>df_long_nan</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span><span class=n>df_missing</span><span class=p>,</span> <span class=n>id_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With NaN:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_long_nan</span><span class=p>)</span>

<span class=c1># Drop NaN</span>
<span class=n>df_long_clean</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span><span class=n>df_missing</span><span class=p>,</span> <span class=n>id_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>NaN dropped:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_long_clean</span><span class=p>)</span>

<span class=c1># 8. Practical Example: Survey Data</span>
<span class=n>survey</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;respondent_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
    <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>25</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>35</span><span class=p>],</span>
    <span class=s1>&#39;q1_satisfaction&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
    <span class=s1>&#39;q2_likelihood&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span>
    <span class=s1>&#39;q3_quality&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>5</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Melt only question columns</span>
<span class=n>survey_long</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span>
    <span class=n>survey</span><span class=p>,</span>
    <span class=n>id_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;respondent_id&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>],</span>
    <span class=n>value_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;q1_satisfaction&#39;</span><span class=p>,</span> <span class=s1>&#39;q2_likelihood&#39;</span><span class=p>,</span> <span class=s1>&#39;q3_quality&#39;</span><span class=p>],</span>
    <span class=n>var_name</span><span class=o>=</span><span class=s1>&#39;question&#39;</span><span class=p>,</span>
    <span class=n>value_name</span><span class=o>=</span><span class=s1>&#39;response&#39;</span>
<span class=p>)</span>

<span class=c1># Clean question names</span>
<span class=n>survey_long</span><span class=p>[</span><span class=s1>&#39;question&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>survey_long</span><span class=p>[</span><span class=s1>&#39;question&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;q</span><span class=se>\\</span><span class=s1>d+_&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>regex</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Survey data (long):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>survey_long</span><span class=p>)</span>

<span class=c1># 9. Performance with Large Data</span>
<span class=c1># melt is efficient for large datasets</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>large_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10000</span><span class=p>),</span>
    <span class=o>**</span><span class=p>{</span><span class=sa>f</span><span class=s1>&#39;col_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>10000</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>50</span><span class=p>)}</span>
<span class=p>})</span>

<span class=kn>import</span><span class=w> </span><span class=nn>time</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>large_melted</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span><span class=n>large_df</span><span class=p>,</span> <span class=n>id_vars</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>])</span>
<span class=n>melt_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Melted 10k rows x 50 cols in </span><span class=si>{</span><span class=n>melt_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Result shape: </span><span class=si>{</span><span class=n>large_melted</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># 10. Use Cases Comparison</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>=== When to Use ===&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Wide format:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;- Human-readable reports&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;- Pivot tables&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;- Matrix operations&quot;</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Long format (melt):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;- Analysis in Pandas/SQL&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;- Plotting with seaborn/plotly&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;- GroupBy operations&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;- Statistical modeling&quot;</span><span class=p>)</span>
</code></pre></div> <p><strong>Wide vs Long Format:</strong></p> <table> <thead> <tr> <th>Format</th> <th>Structure</th> <th>Use Case</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>Wide</strong></td> <td>Many columns</td> <td>Reports, humans</td> <td>Math: 85, Science: 88</td> </tr> <tr> <td><strong>Long</strong></td> <td>Few columns, many rows</td> <td>Analysis, computers</td> <td>Subject: Math, Score: 85</td> </tr> </tbody> </table> <p><strong>melt() Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>id_vars</strong></td> <td>Columns to keep</td> <td><code>id_vars=['student']</code></td> </tr> <tr> <td><strong>value_vars</strong></td> <td>Columns to melt</td> <td><code>value_vars=['math', 'science']</code></td> </tr> <tr> <td><strong>var_name</strong></td> <td>Name for variable column</td> <td><code>var_name='subject'</code></td> </tr> <tr> <td><strong>value_name</strong></td> <td>Name for value column</td> <td><code>value_name='score'</code></td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"melt(): wide ‚Üí long format (unpivot)"</li> <li>"id_vars: columns to keep fixed"</li> <li>"value_vars: columns to melt (optional, default all)"</li> <li>"var_name: name for melted column names"</li> <li>"value_name: name for values"</li> <li>"Opposite of pivot()/pivot_table()"</li> <li>"Use for: plotting, analysis, tidy data"</li> <li>"Long format better for: GroupBy, seaborn, SQL"</li> <li>"Round trip: melt() + pivot() = original"</li> </ul> </div> </details> <hr> <h3 id=explain-pdcrosstab-amazon-microsoft-interview-question>Explain pd.crosstab() - Amazon, Microsoft Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>crosstab</code>, <code>Frequency Tables</code>, <code>Statistics</code> | <strong>Asked by:</strong> Amazon, Microsoft, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>crosstab()</strong> computes cross-tabulation of two or more factors. Shows frequency distributions. Similar to pivot_table but specialized for counts and proportions.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># Sample data</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;gender&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;F&#39;</span><span class=p>],</span> <span class=mi>200</span><span class=p>),</span>
    <span class=s1>&#39;education&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;HS&#39;</span><span class=p>,</span> <span class=s1>&#39;Bachelor&#39;</span><span class=p>,</span> <span class=s1>&#39;Master&#39;</span><span class=p>,</span> <span class=s1>&#39;PhD&#39;</span><span class=p>],</span> <span class=mi>200</span><span class=p>),</span>
    <span class=s1>&#39;employed&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;Yes&#39;</span><span class=p>,</span> <span class=s1>&#39;No&#39;</span><span class=p>],</span> <span class=mi>200</span><span class=p>),</span>
    <span class=s1>&#39;age_group&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;18-25&#39;</span><span class=p>,</span> <span class=s1>&#39;26-35&#39;</span><span class=p>,</span> <span class=s1>&#39;36-50&#39;</span><span class=p>,</span> <span class=s1>&#39;50+&#39;</span><span class=p>],</span> <span class=mi>200</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># 1. Basic Crosstab (Counts)</span>
<span class=n>ct</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;education&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Basic crosstab:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>ct</span><span class=p>)</span>

<span class=c1># 2. With Margins (Totals)</span>
<span class=n>ct_margins</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;education&#39;</span><span class=p>],</span>
    <span class=n>margins</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>margins_name</span><span class=o>=</span><span class=s1>&#39;Total&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With totals:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>ct_margins</span><span class=p>)</span>

<span class=c1># 3. Normalize (Percentages)</span>
<span class=c1># Normalize all (percentages of total)</span>
<span class=n>ct_norm_all</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;education&#39;</span><span class=p>],</span>
    <span class=n>normalize</span><span class=o>=</span><span class=s1>&#39;all&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Normalized (all):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>ct_norm_all</span><span class=p>)</span>

<span class=c1># Normalize by rows</span>
<span class=n>ct_norm_index</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;education&#39;</span><span class=p>],</span>
    <span class=n>normalize</span><span class=o>=</span><span class=s1>&#39;index&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Normalized (by row):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>ct_norm_index</span><span class=p>)</span>

<span class=c1># Normalize by columns</span>
<span class=n>ct_norm_columns</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;education&#39;</span><span class=p>],</span>
    <span class=n>normalize</span><span class=o>=</span><span class=s1>&#39;columns&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Normalized (by column):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>ct_norm_columns</span><span class=p>)</span>

<span class=c1># 4. Multiple Row/Column Variables</span>
<span class=n>ct_multi</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span>
    <span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;age_group&#39;</span><span class=p>]],</span>
    <span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;education&#39;</span><span class=p>],</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;employed&#39;</span><span class=p>]]</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Multi-level crosstab:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>ct_multi</span><span class=p>)</span>

<span class=c1># 5. With Values (Like pivot_table)</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;income&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>30000</span><span class=p>,</span> <span class=mi>120000</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>))</span>

<span class=n>ct_values</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;education&#39;</span><span class=p>],</span>
    <span class=n>values</span><span class=o>=</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;income&#39;</span><span class=p>],</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;mean&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With values (mean income):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>ct_values</span><span class=p>)</span>

<span class=c1># 6. Multiple Aggregations</span>
<span class=n>ct_multi_agg</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;education&#39;</span><span class=p>],</span>
    <span class=n>values</span><span class=o>=</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;income&#39;</span><span class=p>],</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;mean&#39;</span><span class=p>,</span> <span class=s1>&#39;median&#39;</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>]</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Multiple aggregations:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>ct_multi_agg</span><span class=p>)</span>

<span class=c1># 7. Dropna Parameter</span>
<span class=n>df_with_nan</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=n>df_with_nan</span><span class=o>.</span><span class=n>loc</span><span class=p>[::</span><span class=mi>10</span><span class=p>,</span> <span class=s1>&#39;education&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>

<span class=c1># Include NaN</span>
<span class=n>ct_with_nan</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span>
    <span class=n>df_with_nan</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span>
    <span class=n>df_with_nan</span><span class=p>[</span><span class=s1>&#39;education&#39;</span><span class=p>],</span>
    <span class=n>dropna</span><span class=o>=</span><span class=kc>False</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With NaN:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>ct_with_nan</span><span class=p>)</span>

<span class=c1># Exclude NaN</span>
<span class=n>ct_no_nan</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span>
    <span class=n>df_with_nan</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span>
    <span class=n>df_with_nan</span><span class=p>[</span><span class=s1>&#39;education&#39;</span><span class=p>],</span>
    <span class=n>dropna</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Excluding NaN:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>ct_no_nan</span><span class=p>)</span>

<span class=c1># 8. Practical Example: A/B Test Analysis</span>
<span class=n>ab_test</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;variant&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>],</span> <span class=mi>1000</span><span class=p>),</span>
    <span class=s1>&#39;converted&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;Yes&#39;</span><span class=p>,</span> <span class=s1>&#39;No&#39;</span><span class=p>],</span> <span class=mi>1000</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=p>[</span><span class=mf>0.15</span><span class=p>,</span> <span class=mf>0.85</span><span class=p>]),</span>
    <span class=s1>&#39;device&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;Mobile&#39;</span><span class=p>,</span> <span class=s1>&#39;Desktop&#39;</span><span class=p>],</span> <span class=mi>1000</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># Conversion rates</span>
<span class=n>conversion_ct</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span>
    <span class=n>ab_test</span><span class=p>[</span><span class=s1>&#39;variant&#39;</span><span class=p>],</span>
    <span class=n>ab_test</span><span class=p>[</span><span class=s1>&#39;converted&#39;</span><span class=p>],</span>
    <span class=n>normalize</span><span class=o>=</span><span class=s1>&#39;index&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>A/B test conversion rates:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>conversion_ct</span><span class=p>)</span>

<span class=c1># By device</span>
<span class=n>device_ct</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span>
    <span class=p>[</span><span class=n>ab_test</span><span class=p>[</span><span class=s1>&#39;variant&#39;</span><span class=p>],</span> <span class=n>ab_test</span><span class=p>[</span><span class=s1>&#39;device&#39;</span><span class=p>]],</span>
    <span class=n>ab_test</span><span class=p>[</span><span class=s1>&#39;converted&#39;</span><span class=p>],</span>
    <span class=n>normalize</span><span class=o>=</span><span class=s1>&#39;index&#39;</span><span class=p>,</span>
    <span class=n>margins</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>By device:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>device_ct</span><span class=p>)</span>

<span class=c1># 9. Chi-Square Test</span>
<span class=c1># Statistical independence test</span>
<span class=kn>from</span><span class=w> </span><span class=nn>scipy.stats</span><span class=w> </span><span class=kn>import</span> <span class=n>chi2_contingency</span>

<span class=n>ct_test</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;employed&#39;</span><span class=p>])</span>
<span class=n>chi2</span><span class=p>,</span> <span class=n>p_value</span><span class=p>,</span> <span class=n>dof</span><span class=p>,</span> <span class=n>expected</span> <span class=o>=</span> <span class=n>chi2_contingency</span><span class=p>(</span><span class=n>ct_test</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Chi-square test:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Chi2: </span><span class=si>{</span><span class=n>chi2</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;P-value: </span><span class=si>{</span><span class=n>p_value</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Independent: </span><span class=si>{</span><span class=n>p_value</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>0.05</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># 10. Comparison with pivot_table</span>
<span class=c1># crosstab</span>
<span class=n>ct</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;gender&#39;</span><span class=p>],</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;education&#39;</span><span class=p>])</span>

<span class=c1># Equivalent pivot_table</span>
<span class=n>pt</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>pivot_table</span><span class=p>(</span>
    <span class=n>index</span><span class=o>=</span><span class=s1>&#39;gender&#39;</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=s1>&#39;education&#39;</span><span class=p>,</span>
    <span class=n>aggfunc</span><span class=o>=</span><span class=s1>&#39;size&#39;</span><span class=p>,</span>
    <span class=n>fill_value</span><span class=o>=</span><span class=mi>0</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>crosstab == pivot_table:&quot;</span><span class=p>,</span> <span class=n>ct</span><span class=o>.</span><span class=n>equals</span><span class=p>(</span><span class=n>pt</span><span class=p>))</span>
</code></pre></div> <p><strong>crosstab() vs pivot_table():</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>crosstab()</th> <th>pivot_table()</th> </tr> </thead> <tbody> <tr> <td><strong>Purpose</strong></td> <td>Frequency counts</td> <td>General aggregation</td> </tr> <tr> <td><strong>Default aggfunc</strong></td> <td>Count</td> <td>Mean</td> </tr> <tr> <td><strong>Normalize</strong></td> <td>‚úÖ Built-in</td> <td>‚ùå Manual</td> </tr> <tr> <td><strong>Input</strong></td> <td>Arrays or Series</td> <td>DataFrame columns</td> </tr> <tr> <td><strong>Use Case</strong></td> <td>Categorical analysis</td> <td>Numeric summarization</td> </tr> </tbody> </table> <p><strong>normalize Parameter:</strong></p> <table> <thead> <tr> <th>Value</th> <th>Meaning</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>'all'</strong></td> <td>% of total</td> <td>Overall distribution</td> </tr> <tr> <td><strong>'index'</strong></td> <td>% of row total</td> <td>Row-wise comparison</td> </tr> <tr> <td><strong>'columns'</strong></td> <td>% of column total</td> <td>Column-wise comparison</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"crosstab(): frequency table of categorical variables"</li> <li>"Default: counts, can aggregate with values/aggfunc"</li> <li>"normalize: 'all', 'index', 'columns' for percentages"</li> <li>"margins=True: add row/column totals"</li> <li>"Useful for: categorical analysis, A/B testing, chi-square"</li> <li>"vs pivot_table: specialized for counts"</li> <li>"Multiple variables: pass lists to index/columns"</li> <li>"Chi-square test: test independence of variables"</li> </ul> </div> </details> <hr> <h3 id=explain-pdget_dummies-for-one-hot-encoding-google-netflix-interview-question>Explain pd.get_dummies() for One-Hot Encoding - Google, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>One-Hot Encoding</code>, <code>Feature Engineering</code>, <code>ML Preprocessing</code> | <strong>Asked by:</strong> Google, Netflix, Meta, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>get_dummies()</strong> converts categorical variables to binary indicator columns (one-hot encoding). Essential for machine learning with categorical features.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># Sample data</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;color&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=s1>&#39;green&#39;</span><span class=p>,</span> <span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;blue&#39;</span><span class=p>],</span>
    <span class=s1>&#39;size&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;S&#39;</span><span class=p>,</span> <span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;L&#39;</span><span class=p>,</span> <span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;S&#39;</span><span class=p>],</span>
    <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>18</span><span class=p>]</span>
<span class=p>})</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Original data:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># 1. Basic One-Hot Encoding</span>
<span class=n>dummies</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;color&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>One-hot encoded:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>dummies</span><span class=p>)</span>

<span class=c1># 2. Add Prefix</span>
<span class=n>dummies</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;color&#39;</span><span class=p>],</span> <span class=n>prefix</span><span class=o>=</span><span class=s1>&#39;color&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With prefix:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>dummies</span><span class=p>)</span>

<span class=c1># 3. Encode Entire DataFrame</span>
<span class=n>df_encoded</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;color&#39;</span><span class=p>,</span> <span class=s1>&#39;size&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Full DataFrame encoded:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_encoded</span><span class=p>)</span>

<span class=c1># 4. Drop First (Avoid Multicollinearity)</span>
<span class=c1># Drop one category to avoid dummy variable trap</span>
<span class=n>dummies_drop</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span>
    <span class=n>df</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;color&#39;</span><span class=p>,</span> <span class=s1>&#39;size&#39;</span><span class=p>],</span>
    <span class=n>drop_first</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Drop first category:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>dummies_drop</span><span class=p>)</span>

<span class=c1># 5. Custom Prefix for Multiple Columns</span>
<span class=n>dummies_custom</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span>
    <span class=n>df</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;color&#39;</span><span class=p>,</span> <span class=s1>&#39;size&#39;</span><span class=p>],</span>
    <span class=n>prefix</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;col&#39;</span><span class=p>,</span> <span class=s1>&#39;sz&#39;</span><span class=p>]</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Custom prefixes:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>dummies_custom</span><span class=p>)</span>

<span class=c1># 6. Handle Unknown Categories</span>
<span class=c1># Training data</span>
<span class=n>train</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>train_encoded</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>train</span><span class=p>,</span> <span class=n>prefix</span><span class=o>=</span><span class=s1>&#39;cat&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Training encoded:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>train_encoded</span><span class=p>)</span>

<span class=c1># Test data with new category &#39;D&#39;</span>
<span class=n>test</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;D&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>test_encoded</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>test</span><span class=p>,</span> <span class=n>prefix</span><span class=o>=</span><span class=s1>&#39;cat&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Test encoded (has &#39;D&#39;):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>test_encoded</span><span class=p>)</span>

<span class=c1># Align columns</span>
<span class=n>test_aligned</span> <span class=o>=</span> <span class=n>test_encoded</span><span class=o>.</span><span class=n>reindex</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=n>train_encoded</span><span class=o>.</span><span class=n>columns</span><span class=p>,</span> <span class=n>fill_value</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Test aligned with training:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>test_aligned</span><span class=p>)</span>

<span class=c1># 7. Dummy NA</span>
<span class=c1># Include NaN as category</span>
<span class=n>df_na</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;color&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;blue&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>,</span> <span class=s1>&#39;red&#39;</span><span class=p>,</span> <span class=s1>&#39;blue&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>dummies_na</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df_na</span><span class=p>,</span> <span class=n>dummy_na</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With NaN as category:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>dummies_na</span><span class=p>)</span>

<span class=c1># 8. Sparse Matrix (Memory Efficient)</span>
<span class=c1># For high cardinality</span>
<span class=n>df_large</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=s1>&#39;ABCDEFGHIJ&#39;</span><span class=p>),</span> <span class=mi>10000</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># Dense (default)</span>
<span class=n>dense</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df_large</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Dense memory: </span><span class=si>{</span><span class=n>dense</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1024</span><span class=o>**</span><span class=mi>2</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>

<span class=c1># Sparse</span>
<span class=n>sparse</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df_large</span><span class=p>,</span> <span class=n>sparse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Sparse memory: </span><span class=si>{</span><span class=n>sparse</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1024</span><span class=o>**</span><span class=mi>2</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>

<span class=c1># 9. Practical Example: ML Preprocessing</span>
<span class=c1># Customer data</span>
<span class=n>customers</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span>
    <span class=s1>&#39;country&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;USA&#39;</span><span class=p>,</span> <span class=s1>&#39;UK&#39;</span><span class=p>,</span> <span class=s1>&#39;Canada&#39;</span><span class=p>,</span> <span class=s1>&#39;USA&#39;</span><span class=p>,</span> <span class=s1>&#39;UK&#39;</span><span class=p>],</span>
    <span class=s1>&#39;membership&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Gold&#39;</span><span class=p>,</span> <span class=s1>&#39;Silver&#39;</span><span class=p>,</span> <span class=s1>&#39;Bronze&#39;</span><span class=p>,</span> <span class=s1>&#39;Gold&#39;</span><span class=p>,</span> <span class=s1>&#39;Silver&#39;</span><span class=p>],</span>
    <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>25</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>],</span>
    <span class=s1>&#39;purchases&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>6</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Encode categorical, keep numeric</span>
<span class=n>customers_encoded</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span>
    <span class=n>customers</span><span class=p>,</span>
    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;country&#39;</span><span class=p>,</span> <span class=s1>&#39;membership&#39;</span><span class=p>],</span>
    <span class=n>drop_first</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>  <span class=c1># Avoid multicollinearity</span>
    <span class=n>prefix</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;country&#39;</span><span class=p>,</span> <span class=s1>&#39;tier&#39;</span><span class=p>]</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>ML-ready data:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>customers_encoded</span><span class=p>)</span>

<span class=c1># 10. Comparison with Categorical</span>
<span class=c1># get_dummies: expands to multiple columns</span>
<span class=n>encoded</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;color&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>get_dummies (wide):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>encoded</span><span class=p>)</span>

<span class=c1># Categorical: single column with integer codes</span>
<span class=n>categorical</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;color&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Categorical (compact):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>categorical</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Codes:&quot;</span><span class=p>,</span> <span class=n>categorical</span><span class=o>.</span><span class=n>cat</span><span class=o>.</span><span class=n>codes</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>
</code></pre></div> <p><strong>get_dummies() Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>data</strong></td> <td>DataFrame or Series</td> <td><code>pd.get_dummies(df)</code></td> </tr> <tr> <td><strong>columns</strong></td> <td>Columns to encode</td> <td><code>columns=['color']</code></td> </tr> <tr> <td><strong>prefix</strong></td> <td>Column name prefix</td> <td><code>prefix='cat'</code></td> </tr> <tr> <td><strong>drop_first</strong></td> <td>Avoid multicollinearity</td> <td><code>drop_first=True</code></td> </tr> <tr> <td><strong>dummy_na</strong></td> <td>Include NaN as category</td> <td><code>dummy_na=True</code></td> </tr> <tr> <td><strong>sparse</strong></td> <td>Use sparse matrix</td> <td><code>sparse=True</code></td> </tr> </tbody> </table> <p><strong>When to drop_first:</strong></p> <table> <thead> <tr> <th>Use Case</th> <th>drop_first</th> <th>Reason</th> </tr> </thead> <tbody> <tr> <td><strong>Linear models</strong></td> <td>‚úÖ True</td> <td>Avoid multicollinearity</td> </tr> <tr> <td><strong>Tree models</strong></td> <td>‚ùå False</td> <td>Can handle all dummies</td> </tr> <tr> <td><strong>Neural networks</strong></td> <td>‚ùå False</td> <td>Usually fine</td> </tr> <tr> <td><strong>Interpretation</strong></td> <td>‚ùå False</td> <td>Easier to understand</td> </tr> </tbody> </table> <p><strong>get_dummies() vs Categorical:</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>get_dummies()</th> <th>Categorical</th> </tr> </thead> <tbody> <tr> <td><strong>Format</strong></td> <td>Multiple columns</td> <td>Single column</td> </tr> <tr> <td><strong>Storage</strong></td> <td>More space</td> <td>Less space</td> </tr> <tr> <td><strong>ML</strong></td> <td>Ready to use</td> <td>Need encoding</td> </tr> <tr> <td><strong>Interpretability</strong></td> <td>Clear</td> <td>Needs mapping</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"get_dummies(): one-hot encoding (categorical ‚Üí binary)"</li> <li>"Creates column per category with 0/1"</li> <li>"prefix: add meaningful column names"</li> <li>"drop_first=True: avoid dummy variable trap (linear models)"</li> <li>"dummy_na=True: treat NaN as separate category"</li> <li>"sparse=True: save memory for high cardinality"</li> <li>"Align train/test: use reindex() for new categories"</li> <li>"vs LabelEncoder: ordinal encoding (single column)"</li> <li>"Use for: ML models that need numeric input"</li> </ul> </div> </details> <hr> <h3 id=explain-settingwithcopywarning-meta-google-interview-question>Explain SettingWithCopyWarning - Meta, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Warning</code>, <code>DataFrame Copies</code>, <code>Best Practices</code> | <strong>Asked by:</strong> Meta, Google, Amazon, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>SettingWithCopyWarning</strong> occurs when modifying a DataFrame slice that might be a view or copy. Use <strong>.loc</strong> for assignment and <strong>.copy()</strong> when needed to avoid ambiguity.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span>
    <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># 1. The Problem: Chained Indexing</span>
<span class=c1># BAD: This triggers warning</span>
<span class=c1># df[df[&#39;A&#39;] &gt; 2][&#39;B&#39;] = 999  # SettingWithCopyWarning!</span>

<span class=c1># GOOD: Use .loc</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>999</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Correct assignment:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># Reset for more examples</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span>
    <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># 2. View vs Copy</span>
<span class=c1># Sometimes slice is a view, sometimes a copy</span>
<span class=c1># Pandas can&#39;t always tell which</span>

<span class=c1># This might be a view</span>
<span class=n>subset1</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>]</span>

<span class=c1># This might be a copy</span>
<span class=n>subset2</span> <span class=o>=</span> <span class=n>df</span><span class=p>[[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]]</span>

<span class=c1># Modifying triggers warning (is it view or copy?)</span>
<span class=c1># subset1[&#39;B&#39;] = 999  # Warning!</span>

<span class=c1># 3. Explicit Copy</span>
<span class=c1># Make explicit copy to avoid warning</span>
<span class=n>subset_copy</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=n>subset_copy</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>999</span>  <span class=c1># No warning</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Explicit copy:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>subset_copy</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Original unchanged:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># 4. Using .loc (Recommended)</span>
<span class=c1># Always use .loc for assignment</span>
<span class=n>df_correct</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>

<span class=c1># Single condition</span>
<span class=n>df_correct</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>df_correct</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>999</span>

<span class=c1># Multiple conditions</span>
<span class=n>df_correct</span><span class=o>.</span><span class=n>loc</span><span class=p>[(</span><span class=n>df_correct</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>df_correct</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>50</span><span class=p>),</span> <span class=s1>&#39;C&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;updated&#39;</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Using .loc:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_correct</span><span class=p>)</span>

<span class=c1># 5. Function Modifications</span>
<span class=c1># BAD: Modifying without copy</span>
<span class=k>def</span><span class=w> </span><span class=nf>process_bad</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
    <span class=c1># If data is a slice, this warns</span>
    <span class=n>data</span><span class=p>[</span><span class=s1>&#39;new_col&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span>
    <span class=k>return</span> <span class=n>data</span>

<span class=c1># GOOD: Explicit copy</span>
<span class=k>def</span><span class=w> </span><span class=nf>process_good</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
    <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>data</span><span class=p>[</span><span class=s1>&#39;new_col&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span>
    <span class=k>return</span> <span class=n>data</span>

<span class=n>subset</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>]</span>
<span class=c1># result_bad = process_bad(subset)  # Warning</span>
<span class=n>result_good</span> <span class=o>=</span> <span class=n>process_good</span><span class=p>(</span><span class=n>subset</span><span class=p>)</span>  <span class=c1># No warning</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Processed with copy:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result_good</span><span class=p>)</span>

<span class=c1># 6. When to Copy</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>=== When to Use .copy() ===&quot;</span><span class=p>)</span>

<span class=c1># Slice you&#39;ll modify</span>
<span class=n>working_df</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=n>working_df</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>  <span class=c1># Safe</span>

<span class=c1># Function that modifies</span>
<span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
    <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>  <span class=c1># Safe</span>
    <span class=n>data</span><span class=p>[</span><span class=s1>&#39;transformed&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>**</span> <span class=mi>2</span>
    <span class=k>return</span> <span class=n>data</span>

<span class=c1># 7. Detecting Views vs Copies</span>
<span class=c1># Check if shares memory</span>
<span class=n>df_original</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]})</span>

<span class=c1># View (shares memory)</span>
<span class=n>view</span> <span class=o>=</span> <span class=n>df_original</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>View shares memory: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>shares_memory</span><span class=p>(</span><span class=n>df_original</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>,</span><span class=w> </span><span class=n>view</span><span class=o>.</span><span class=n>values</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># Copy (doesn&#39;t share)</span>
<span class=n>copy</span> <span class=o>=</span> <span class=n>df_original</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Copy shares memory: </span><span class=si>{</span><span class=n>np</span><span class=o>.</span><span class=n>shares_memory</span><span class=p>(</span><span class=n>df_original</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>,</span><span class=w> </span><span class=n>copy</span><span class=o>.</span><span class=n>values</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># 8. Common Patterns</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>=== Best Practices ===&quot;</span><span class=p>)</span>

<span class=c1># Pattern 1: Filtering then modifying</span>
<span class=c1># BAD:</span>
<span class=c1># filtered = df[df[&#39;A&#39;] &gt; 2]</span>
<span class=c1># filtered[&#39;B&#39;] = 100  # Warning</span>

<span class=c1># GOOD:</span>
<span class=n>filtered</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=n>filtered</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>  <span class=c1># No warning</span>

<span class=c1># Pattern 2: Direct modification</span>
<span class=c1># BEST (if you want to modify original):</span>
<span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span>

<span class=c1># Pattern 3: Function returning modified data</span>
<span class=k>def</span><span class=w> </span><span class=nf>clean_data</span><span class=p>(</span><span class=n>df</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Always copy at start of function.&quot;&quot;&quot;</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;cleaned&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2</span>
    <span class=k>return</span> <span class=n>df</span>

<span class=c1># 9. Disabling Warning (Not Recommended)</span>
<span class=c1># Only for debugging</span>
<span class=c1># pd.options.mode.chained_assignment = None  # Disable</span>
<span class=c1># pd.options.mode.chained_assignment = &#39;warn&#39;  # Default</span>
<span class=c1># pd.options.mode.chained_assignment = &#39;raise&#39;  # Raise error</span>

<span class=c1># 10. Real-World Example</span>
<span class=n>sales_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;D&#39;</span><span class=p>,</span> <span class=s1>&#39;E&#39;</span><span class=p>],</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>300</span><span class=p>,</span> <span class=mi>250</span><span class=p>],</span>
    <span class=s1>&#39;region&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>,</span> <span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>,</span> <span class=s1>&#39;North&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Task: Add 10% bonus to North region</span>

<span class=c1># BAD:</span>
<span class=c1># north = sales_df[sales_df[&#39;region&#39;] == &#39;North&#39;]</span>
<span class=c1># north[&#39;sales&#39;] = north[&#39;sales&#39;] * 1.1  # Warning!</span>

<span class=c1># GOOD Option 1: Use .loc on original</span>
<span class=n>sales_df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>sales_df</span><span class=p>[</span><span class=s1>&#39;region&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;sales&#39;</span><span class=p>]</span> <span class=o>*=</span> <span class=mf>1.1</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Sales with bonus:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>sales_df</span><span class=p>)</span>

<span class=c1># GOOD Option 2: Explicit copy if you need subset</span>
<span class=n>north_copy</span> <span class=o>=</span> <span class=n>sales_df</span><span class=p>[</span><span class=n>sales_df</span><span class=p>[</span><span class=s1>&#39;region&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;North&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=n>north_copy</span><span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span> <span class=o>*=</span> <span class=mf>1.1</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>North region (copy):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>north_copy</span><span class=p>)</span>
</code></pre></div> <p><strong>Common Causes:</strong></p> <table> <thead> <tr> <th>Pattern</th> <th>Problem</th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td><code>df[cond][col] = val</code></td> <td>Chained indexing</td> <td><code>df.loc[cond, col] = val</code></td> </tr> <tr> <td><code>subset['col'] = val</code></td> <td>Unclear if view/copy</td> <td><code>subset = df[...].copy()</code></td> </tr> <tr> <td><code>func(df[...])</code></td> <td>Function modifies slice</td> <td>Copy in function</td> </tr> </tbody> </table> <p><strong>Best Practices:</strong></p> <table> <thead> <tr> <th>Scenario</th> <th>Recommended Approach</th> </tr> </thead> <tbody> <tr> <td><strong>Modify original</strong></td> <td><code>df.loc[condition, column] = value</code></td> </tr> <tr> <td><strong>Modify subset</strong></td> <td><code>subset = df[...].copy()</code></td> </tr> <tr> <td><strong>Function</strong></td> <td>Copy at start: <code>df = df.copy()</code></td> </tr> <tr> <td><strong>Read-only</strong></td> <td>No copy needed</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"SettingWithCopyWarning: ambiguous view vs copy"</li> <li>"Chained indexing bad: <code>df[cond][col] = val</code>"</li> <li>"Use .loc: <code>df.loc[cond, col] = val</code>"</li> <li>"Explicit copy when needed: <code>.copy()</code>"</li> <li>"View: shares memory, copy: independent"</li> <li>"Always copy at function start if modifying"</li> <li>"Warning helps avoid silent bugs"</li> <li>"Never disable warning without understanding"</li> <li>"Rule: if modifying slice, use .loc or .copy()"</li> </ul> </div> </details> <hr> <h3 id=explain-pandas-string-methods-str-accessor-amazon-microsoft-interview-question>Explain Pandas String Methods (.str accessor) - Amazon, Microsoft Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>String Methods</code>, <code>Text Processing</code>, <code>Data Cleaning</code> | <strong>Asked by:</strong> Amazon, Microsoft, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>.str accessor</strong> provides vectorized string operations on Series. Essential for text cleaning, pattern matching, and feature extraction. Much faster than Python loops.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;  John Doe  &#39;</span><span class=p>,</span> <span class=s1>&#39;jane smith&#39;</span><span class=p>,</span> <span class=s1>&#39;BOB WILSON&#39;</span><span class=p>,</span> <span class=s1>&#39;Alice Johnson&#39;</span><span class=p>],</span>
    <span class=s1>&#39;email&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;john@example.com&#39;</span><span class=p>,</span> <span class=s1>&#39;jane@test.com&#39;</span><span class=p>,</span> <span class=s1>&#39;bob@EXAMPLE.COM&#39;</span><span class=p>,</span> <span class=s1>&#39;alice@test.com&#39;</span><span class=p>],</span>
    <span class=s1>&#39;phone&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;123-456-7890&#39;</span><span class=p>,</span> <span class=s1>&#39;(555) 123-4567&#39;</span><span class=p>,</span> <span class=s1>&#39;555.123.4567&#39;</span><span class=p>,</span> <span class=s1>&#39;1234567890&#39;</span><span class=p>],</span>
    <span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;123 Main St, NYC, NY&#39;</span><span class=p>,</span> <span class=s1>&#39;456 Oak Ave, LA, CA&#39;</span><span class=p>,</span> <span class=s1>&#39;789 Elm Rd, Austin, TX&#39;</span><span class=p>,</span> <span class=s1>&#39;321 Pine Dr, Miami, FL&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># 1. Basic String Operations</span>
<span class=c1># Lower/upper case</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;name_lower&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;name_upper&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span>

<span class=c1># Title case</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;name_title&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>title</span><span class=p>()</span>

<span class=c1># Strip whitespace</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;name_clean&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Case conversions:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;name_lower&#39;</span><span class=p>,</span> <span class=s1>&#39;name_title&#39;</span><span class=p>,</span> <span class=s1>&#39;name_clean&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>

<span class=c1># 2. Contains / Startswith / Endswith</span>
<span class=c1># Check if contains pattern</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;has_john&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>contains</span><span class=p>(</span><span class=s1>&#39;john&#39;</span><span class=p>)</span>

<span class=c1># Starts with</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;starts_with_j&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;j&#39;</span><span class=p>)</span>

<span class=c1># Ends with</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;gmail&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s1>&#39;@example.com&#39;</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Pattern matching:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;has_john&#39;</span><span class=p>,</span> <span class=s1>&#39;starts_with_j&#39;</span><span class=p>]])</span>

<span class=c1># 3. Replace</span>
<span class=c1># Simple replace</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;email_masked&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;@&#39;</span><span class=p>,</span> <span class=s1>&#39;[at]&#39;</span><span class=p>)</span>

<span class=c1># Regex replace</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;phone_clean&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;phone&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;[\(\)\-\.\s]&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>regex</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Replace:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;email&#39;</span><span class=p>,</span> <span class=s1>&#39;email_masked&#39;</span><span class=p>,</span> <span class=s1>&#39;phone&#39;</span><span class=p>,</span> <span class=s1>&#39;phone_clean&#39;</span><span class=p>]])</span>

<span class=c1># 4. Extract with Regex</span>
<span class=c1># Extract domain from email</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;domain&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>extract</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;@(\w+\.\w+)&#39;</span><span class=p>)</span>

<span class=c1># Extract area code</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;area_code&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;phone_clean&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>extract</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^(\d</span><span class=si>{3}</span><span class=s1>)&#39;</span><span class=p>)</span>

<span class=c1># Multiple groups</span>
<span class=n>df</span><span class=p>[[</span><span class=s1>&#39;first_name&#39;</span><span class=p>,</span> <span class=s1>&#39;last_name&#39;</span><span class=p>]]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;name_clean&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>extract</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;(\w+)\s+(\w+)&#39;</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Extract:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;email&#39;</span><span class=p>,</span> <span class=s1>&#39;domain&#39;</span><span class=p>,</span> <span class=s1>&#39;first_name&#39;</span><span class=p>,</span> <span class=s1>&#39;last_name&#39;</span><span class=p>]])</span>

<span class=c1># 5. Split</span>
<span class=c1># Split on space</span>
<span class=n>name_parts</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;name_clean&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Split (list):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>name_parts</span><span class=p>)</span>

<span class=c1># Expand to columns</span>
<span class=n>df</span><span class=p>[[</span><span class=s1>&#39;first&#39;</span><span class=p>,</span> <span class=s1>&#39;last&#39;</span><span class=p>]]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;name_clean&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>n</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>expand</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Split address</span>
<span class=n>df</span><span class=p>[[</span><span class=s1>&#39;street&#39;</span><span class=p>,</span> <span class=s1>&#39;city&#39;</span><span class=p>,</span> <span class=s1>&#39;state&#39;</span><span class=p>]]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;address&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>,</span> <span class=n>expand</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Split (expanded):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;first&#39;</span><span class=p>,</span> <span class=s1>&#39;last&#39;</span><span class=p>,</span> <span class=s1>&#39;city&#39;</span><span class=p>]])</span>

<span class=c1># 6. Slice</span>
<span class=c1># First 3 characters</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;name_abbr&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;name_clean&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=p>[:</span><span class=mi>3</span><span class=p>]</span>

<span class=c1># Last 4 of phone</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;phone_last4&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;phone_clean&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=p>[</span><span class=o>-</span><span class=mi>4</span><span class=p>:]</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Slice:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;name_clean&#39;</span><span class=p>,</span> <span class=s1>&#39;name_abbr&#39;</span><span class=p>,</span> <span class=s1>&#39;phone_last4&#39;</span><span class=p>]])</span>

<span class=c1># 7. Length and Find</span>
<span class=c1># String length</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;name_length&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;name_clean&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>len</span><span class=p>()</span>

<span class=c1># Find position</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;at_position&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s1>&#39;@&#39;</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Length and find:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;name_clean&#39;</span><span class=p>,</span> <span class=s1>&#39;name_length&#39;</span><span class=p>,</span> <span class=s1>&#39;email&#39;</span><span class=p>,</span> <span class=s1>&#39;at_position&#39;</span><span class=p>]])</span>

<span class=c1># 8. Count Occurrences</span>
<span class=c1># Count character</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;num_spaces&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;address&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)</span>

<span class=c1># Count pattern</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;num_digits&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;phone&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;\d&#39;</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Count:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;address&#39;</span><span class=p>,</span> <span class=s1>&#39;num_spaces&#39;</span><span class=p>]])</span>

<span class=c1># 9. Padding</span>
<span class=c1># Pad with zeros</span>
<span class=n>order_ids</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>42</span><span class=p>,</span> <span class=mi>123</span><span class=p>])</span>
<span class=n>padded</span> <span class=o>=</span> <span class=n>order_ids</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Zero-padded:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>padded</span><span class=p>)</span>

<span class=c1># Pad left/right</span>
<span class=n>padded_left</span> <span class=o>=</span> <span class=n>order_ids</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>pad</span><span class=p>(</span><span class=n>width</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>side</span><span class=o>=</span><span class=s1>&#39;left&#39;</span><span class=p>,</span> <span class=n>fillchar</span><span class=o>=</span><span class=s1>&#39;0&#39;</span><span class=p>)</span>
<span class=n>padded_right</span> <span class=o>=</span> <span class=n>order_ids</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>pad</span><span class=p>(</span><span class=n>width</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>side</span><span class=o>=</span><span class=s1>&#39;right&#39;</span><span class=p>,</span> <span class=n>fillchar</span><span class=o>=</span><span class=s1>&#39;*&#39;</span><span class=p>)</span>

<span class=c1># 10. Practical Example: Data Cleaning</span>
<span class=n>messy_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;customer_name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;  john DOE  &#39;</span><span class=p>,</span> <span class=s1>&#39;Jane_Smith&#39;</span><span class=p>,</span> <span class=s1>&#39;bob-wilson&#39;</span><span class=p>],</span>
    <span class=s1>&#39;email&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;JOHN@EXAMPLE.COM&#39;</span><span class=p>,</span> <span class=s1>&#39;jane.smith@test&#39;</span><span class=p>,</span> <span class=s1>&#39;bob@example.COM&#39;</span><span class=p>],</span>
    <span class=s1>&#39;phone&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;(555)123-4567&#39;</span><span class=p>,</span> <span class=s1>&#39;555 123 4567&#39;</span><span class=p>,</span> <span class=s1>&#39;5551234567&#39;</span><span class=p>],</span>
    <span class=s1>&#39;zip_code&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;12345&#39;</span><span class=p>,</span> <span class=s1>&#39;678&#39;</span><span class=p>,</span> <span class=s1>&#39;90210&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Clean everything</span>
<span class=n>cleaned</span> <span class=o>=</span> <span class=n>messy_data</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>

<span class=c1># Names: strip, title case, replace special chars</span>
<span class=n>cleaned</span><span class=p>[</span><span class=s1>&#39;customer_name&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>cleaned</span><span class=p>[</span><span class=s1>&#39;customer_name&#39;</span><span class=p>]</span>
                            <span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
                            <span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;[_-]&#39;</span><span class=p>,</span> <span class=s1>&#39; &#39;</span><span class=p>,</span> <span class=n>regex</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
                            <span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>title</span><span class=p>())</span>

<span class=c1># Email: lowercase, validate format</span>
<span class=n>cleaned</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>cleaned</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
<span class=n>cleaned</span><span class=p>[</span><span class=s1>&#39;email_valid&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>cleaned</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^[\w\.-]+@[\w\.-]+\.\w+$&#39;</span><span class=p>)</span>

<span class=c1># Phone: extract digits only, format</span>
<span class=n>phone_digits</span> <span class=o>=</span> <span class=n>cleaned</span><span class=p>[</span><span class=s1>&#39;phone&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;\D&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>regex</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=n>cleaned</span><span class=p>[</span><span class=s1>&#39;phone_formatted&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>phone_digits</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span>
    <span class=sa>r</span><span class=s1>&#39;^(\d</span><span class=si>{3}</span><span class=s1>)(\d</span><span class=si>{3}</span><span class=s1>)(\d</span><span class=si>{4}</span><span class=s1>)$&#39;</span><span class=p>,</span>
    <span class=sa>r</span><span class=s1>&#39;(\1) \2-\3&#39;</span><span class=p>,</span>
    <span class=n>regex</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>

<span class=c1># Zip: pad with zeros</span>
<span class=n>cleaned</span><span class=p>[</span><span class=s1>&#39;zip_code&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>cleaned</span><span class=p>[</span><span class=s1>&#39;zip_code&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>zfill</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Cleaned data:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>cleaned</span><span class=p>)</span>

<span class=c1># 11. Performance Comparison</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=n>large_series</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=s1>&#39;test_string&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>100000</span><span class=p>)</span>

<span class=c1># Vectorized (fast)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>large_series</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span>
<span class=n>vectorized_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=c1># Loop (slow)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=p>[</span><span class=n>s</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>large_series</span><span class=p>]</span>
<span class=n>loop_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Vectorized: </span><span class=si>{</span><span class=n>vectorized_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Loop: </span><span class=si>{</span><span class=n>loop_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s (</span><span class=si>{</span><span class=n>loop_time</span><span class=o>/</span><span class=n>vectorized_time</span><span class=si>:</span><span class=s2>.0f</span><span class=si>}</span><span class=s2>x slower)&quot;</span><span class=p>)</span>
</code></pre></div> <p><strong>Common String Methods:</strong></p> <table> <thead> <tr> <th>Method</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>lower/upper/title</strong></td> <td>Case conversion</td> <td><code>.str.lower()</code></td> </tr> <tr> <td><strong>strip/lstrip/rstrip</strong></td> <td>Remove whitespace</td> <td><code>.str.strip()</code></td> </tr> <tr> <td><strong>contains</strong></td> <td>Check if contains</td> <td><code>.str.contains('word')</code></td> </tr> <tr> <td><strong>replace</strong></td> <td>Replace substring</td> <td><code>.str.replace('old', 'new')</code></td> </tr> <tr> <td><strong>extract</strong></td> <td>Regex extract</td> <td><code>.str.extract(r'(\d+)')</code></td> </tr> <tr> <td><strong>split</strong></td> <td>Split string</td> <td><code>.str.split(',')</code></td> </tr> <tr> <td><strong>[:n]</strong></td> <td>Slice</td> <td><code>.str[:5]</code></td> </tr> <tr> <td><strong>len</strong></td> <td>Length</td> <td><code>.str.len()</code></td> </tr> <tr> <td><strong>find</strong></td> <td>Find position</td> <td><code>.str.find('@')</code></td> </tr> <tr> <td><strong>count</strong></td> <td>Count occurrences</td> <td><code>.str.count('a')</code></td> </tr> </tbody> </table> <p><strong>Regex Operations:</strong></p> <table> <thead> <tr> <th>Method</th> <th>Purpose</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>contains</strong></td> <td>Match pattern</td> <td><code>.str.contains(r'\d{3}')</code></td> </tr> <tr> <td><strong>extract</strong></td> <td>Extract groups</td> <td><code>.str.extract(r'(\w+)@(\w+)')</code></td> </tr> <tr> <td><strong>replace</strong></td> <td>Replace pattern</td> <td><code>.str.replace(r'\s+', ' ')</code></td> </tr> <tr> <td><strong>match</strong></td> <td>Full match</td> <td><code>.str.match(r'^\d{5}$')</code></td> </tr> <tr> <td><strong>findall</strong></td> <td>Find all matches</td> <td><code>.str.findall(r'\d+')</code></td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>".str accessor: vectorized string operations"</li> <li>"Much faster than Python loops (10-100x)"</li> <li>"Common: lower(), strip(), replace(), contains()"</li> <li>"extract(): use regex with capturing groups"</li> <li>"split(expand=True): split into columns"</li> <li>"replace(regex=True): regex patterns"</li> <li>"Use for: data cleaning, feature extraction"</li> <li>"Returns Series of same length (NaN for missing)"</li> <li>"Performance: always prefer .str over loops"</li> </ul> </div> </details> <hr> <h3 id=explain-pdexplode-google-amazon-interview-question>Explain pd.explode() - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>explode</code>, <code>List Columns</code>, <code>Data Transformation</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>explode()</strong> transforms list-like column into separate rows. Each list element becomes a new row with duplicated other column values. Essential for nested data structures.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># 1. Basic explode</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>],</span>
    <span class=s1>&#39;hobbies&#39;</span><span class=p>:</span> <span class=p>[[</span><span class=s1>&#39;reading&#39;</span><span class=p>,</span> <span class=s1>&#39;swimming&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;gaming&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;cooking&#39;</span><span class=p>,</span> <span class=s1>&#39;painting&#39;</span><span class=p>,</span> <span class=s1>&#39;music&#39;</span><span class=p>]]</span>
<span class=p>})</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Original (lists in column):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=n>exploded</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>explode</span><span class=p>(</span><span class=s1>&#39;hobbies&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Exploded:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>exploded</span><span class=p>)</span>

<span class=c1># 2. Reset Index</span>
<span class=n>exploded_reset</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>explode</span><span class=p>(</span><span class=s1>&#39;hobbies&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>drop</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With reset index:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>exploded_reset</span><span class=p>)</span>

<span class=c1># 3. Multiple Columns with Lists</span>
<span class=n>df_multi</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span>
    <span class=s1>&#39;tags&#39;</span><span class=p>:</span> <span class=p>[[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>],</span> <span class=p>[</span><span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=s1>&#39;e&#39;</span><span class=p>]],</span>
    <span class=s1>&#39;scores&#39;</span><span class=p>:</span> <span class=p>[[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>],</span> <span class=p>[</span><span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>50</span><span class=p>]]</span>
<span class=p>})</span>

<span class=c1># Explode both columns (must be same length per row)</span>
<span class=n>exploded_multi</span> <span class=o>=</span> <span class=n>df_multi</span><span class=o>.</span><span class=n>explode</span><span class=p>([</span><span class=s1>&#39;tags&#39;</span><span class=p>,</span> <span class=s1>&#39;scores&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Explode multiple columns:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>exploded_multi</span><span class=p>)</span>

<span class=c1># 4. With Missing Values</span>
<span class=n>df_missing</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>],</span>
    <span class=s1>&#39;items&#39;</span><span class=p>:</span> <span class=p>[[</span><span class=s1>&#39;apple&#39;</span><span class=p>,</span> <span class=s1>&#39;banana&#39;</span><span class=p>],</span> <span class=kc>None</span><span class=p>,</span> <span class=p>[]]</span>
<span class=p>})</span>

<span class=n>exploded_na</span> <span class=o>=</span> <span class=n>df_missing</span><span class=o>.</span><span class=n>explode</span><span class=p>(</span><span class=s1>&#39;items&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With missing/empty:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>exploded_na</span><span class=p>)</span>

<span class=c1># 5. Practical Example: User Tags</span>
<span class=n>users</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>101</span><span class=p>,</span> <span class=mi>102</span><span class=p>,</span> <span class=mi>103</span><span class=p>],</span>
    <span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;alice&#39;</span><span class=p>,</span> <span class=s1>&#39;bob&#39;</span><span class=p>,</span> <span class=s1>&#39;charlie&#39;</span><span class=p>],</span>
    <span class=s1>&#39;interests&#39;</span><span class=p>:</span> <span class=p>[</span>
        <span class=p>[</span><span class=s1>&#39;python&#39;</span><span class=p>,</span> <span class=s1>&#39;data science&#39;</span><span class=p>,</span> <span class=s1>&#39;ML&#39;</span><span class=p>],</span>
        <span class=p>[</span><span class=s1>&#39;javascript&#39;</span><span class=p>,</span> <span class=s1>&#39;web dev&#39;</span><span class=p>],</span>
        <span class=p>[</span><span class=s1>&#39;design&#39;</span><span class=p>,</span> <span class=s1>&#39;UX&#39;</span><span class=p>,</span> <span class=s1>&#39;CSS&#39;</span><span class=p>,</span> <span class=s1>&#39;HTML&#39;</span><span class=p>]</span>
    <span class=p>]</span>
<span class=p>})</span>

<span class=c1># Explode to analyze tag frequency</span>
<span class=n>user_interests</span> <span class=o>=</span> <span class=n>users</span><span class=o>.</span><span class=n>explode</span><span class=p>(</span><span class=s1>&#39;interests&#39;</span><span class=p>)</span>

<span class=n>tag_counts</span> <span class=o>=</span> <span class=n>user_interests</span><span class=p>[</span><span class=s1>&#39;interests&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>value_counts</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Tag frequency:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>tag_counts</span><span class=p>)</span>

<span class=c1># 6. E-commerce Orders</span>
<span class=n>orders</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
    <span class=s1>&#39;customer&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>],</span>
    <span class=s1>&#39;products&#39;</span><span class=p>:</span> <span class=p>[</span>
        <span class=p>[</span><span class=s1>&#39;Laptop&#39;</span><span class=p>,</span> <span class=s1>&#39;Mouse&#39;</span><span class=p>],</span>
        <span class=p>[</span><span class=s1>&#39;Keyboard&#39;</span><span class=p>],</span>
        <span class=p>[</span><span class=s1>&#39;Monitor&#39;</span><span class=p>,</span> <span class=s1>&#39;Cable&#39;</span><span class=p>,</span> <span class=s1>&#39;Stand&#39;</span><span class=p>]</span>
    <span class=p>],</span>
    <span class=s1>&#39;quantities&#39;</span><span class=p>:</span> <span class=p>[</span>
        <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span>
        <span class=p>[</span><span class=mi>1</span><span class=p>],</span>
        <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>
    <span class=p>],</span>
    <span class=s1>&#39;prices&#39;</span><span class=p>:</span> <span class=p>[</span>
        <span class=p>[</span><span class=mi>1000</span><span class=p>,</span> <span class=mi>25</span><span class=p>],</span>
        <span class=p>[</span><span class=mi>75</span><span class=p>],</span>
        <span class=p>[</span><span class=mi>300</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>]</span>
    <span class=p>]</span>
<span class=p>})</span>

<span class=c1># Explode order items</span>
<span class=n>order_items</span> <span class=o>=</span> <span class=n>orders</span><span class=o>.</span><span class=n>explode</span><span class=p>([</span><span class=s1>&#39;products&#39;</span><span class=p>,</span> <span class=s1>&#39;quantities&#39;</span><span class=p>,</span> <span class=s1>&#39;prices&#39;</span><span class=p>])</span>
<span class=n>order_items</span> <span class=o>=</span> <span class=n>order_items</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>drop</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Calculate line totals</span>
<span class=n>order_items</span><span class=p>[</span><span class=s1>&#39;line_total&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
    <span class=n>order_items</span><span class=p>[</span><span class=s1>&#39;quantities&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span> <span class=o>*</span> 
    <span class=n>order_items</span><span class=p>[</span><span class=s1>&#39;prices&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Order items:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>order_items</span><span class=p>)</span>

<span class=c1># Total per order</span>
<span class=n>order_totals</span> <span class=o>=</span> <span class=n>order_items</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;order_id&#39;</span><span class=p>)[</span><span class=s1>&#39;line_total&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Order totals:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>order_totals</span><span class=p>)</span>

<span class=c1># 7. JSON/Nested Data</span>
<span class=c1># Simulating API response</span>
<span class=n>api_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;post_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span>
    <span class=s1>&#39;author&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>],</span>
    <span class=s1>&#39;comments&#39;</span><span class=p>:</span> <span class=p>[</span>
        <span class=p>[</span>
            <span class=p>{</span><span class=s1>&#39;user&#39;</span><span class=p>:</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;text&#39;</span><span class=p>:</span> <span class=s1>&#39;Great!&#39;</span><span class=p>},</span>
            <span class=p>{</span><span class=s1>&#39;user&#39;</span><span class=p>:</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>,</span> <span class=s1>&#39;text&#39;</span><span class=p>:</span> <span class=s1>&#39;Awesome!&#39;</span><span class=p>}</span>
        <span class=p>],</span>
        <span class=p>[</span>
            <span class=p>{</span><span class=s1>&#39;user&#39;</span><span class=p>:</span> <span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;text&#39;</span><span class=p>:</span> <span class=s1>&#39;Thanks!&#39;</span><span class=p>}</span>
        <span class=p>]</span>
    <span class=p>]</span>
<span class=p>})</span>

<span class=c1># Explode comments</span>
<span class=n>comments_df</span> <span class=o>=</span> <span class=n>api_data</span><span class=o>.</span><span class=n>explode</span><span class=p>(</span><span class=s1>&#39;comments&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>drop</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Extract comment fields</span>
<span class=n>comments_df</span><span class=p>[</span><span class=s1>&#39;commenter&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>comments_df</span><span class=p>[</span><span class=s1>&#39;comments&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;user&#39;</span><span class=p>]</span> <span class=k>if</span> <span class=n>x</span> <span class=k>else</span> <span class=kc>None</span><span class=p>)</span>
<span class=n>comments_df</span><span class=p>[</span><span class=s1>&#39;comment_text&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>comments_df</span><span class=p>[</span><span class=s1>&#39;comments&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;text&#39;</span><span class=p>]</span> <span class=k>if</span> <span class=n>x</span> <span class=k>else</span> <span class=kc>None</span><span class=p>)</span>

<span class=n>comments_df</span> <span class=o>=</span> <span class=n>comments_df</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=s1>&#39;comments&#39;</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Extracted comments:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>comments_df</span><span class=p>)</span>

<span class=c1># 8. Time Series Events</span>
<span class=n>events</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>),</span>
    <span class=s1>&#39;events&#39;</span><span class=p>:</span> <span class=p>[</span>
        <span class=p>[</span><span class=s1>&#39;login&#39;</span><span class=p>,</span> <span class=s1>&#39;purchase&#39;</span><span class=p>,</span> <span class=s1>&#39;logout&#39;</span><span class=p>],</span>
        <span class=p>[</span><span class=s1>&#39;login&#39;</span><span class=p>],</span>
        <span class=p>[</span><span class=s1>&#39;login&#39;</span><span class=p>,</span> <span class=s1>&#39;view&#39;</span><span class=p>,</span> <span class=s1>&#39;view&#39;</span><span class=p>,</span> <span class=s1>&#39;logout&#39;</span><span class=p>]</span>
    <span class=p>]</span>
<span class=p>})</span>

<span class=n>event_log</span> <span class=o>=</span> <span class=n>events</span><span class=o>.</span><span class=n>explode</span><span class=p>(</span><span class=s1>&#39;events&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>drop</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Event frequency by day</span>
<span class=n>event_freq</span> <span class=o>=</span> <span class=n>event_log</span><span class=o>.</span><span class=n>groupby</span><span class=p>([</span><span class=s1>&#39;date&#39;</span><span class=p>,</span> <span class=s1>&#39;events&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>size</span><span class=p>()</span><span class=o>.</span><span class=n>unstack</span><span class=p>(</span><span class=n>fill_value</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Event frequency:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>event_freq</span><span class=p>)</span>

<span class=c1># 9. Performance Note</span>
<span class=c1># explode is efficient, but watch for very large lists</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=c1># Create test data</span>
<span class=n>large_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1000</span><span class=p>),</span>
    <span class=s1>&#39;values&#39;</span><span class=p>:</span> <span class=p>[[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>]</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1000</span><span class=p>)]</span>
<span class=p>})</span>

<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>large_df</span><span class=o>.</span><span class=n>explode</span><span class=p>(</span><span class=s1>&#39;values&#39;</span><span class=p>)</span>
<span class=n>explode_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Exploded 1000 rows √ó 5 values in </span><span class=si>{</span><span class=n>explode_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>

<span class=c1># 10. Reverse: groupby + list</span>
<span class=c1># Explode ‚Üí Group back to lists</span>
<span class=n>exploded_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>],</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>grouped</span> <span class=o>=</span> <span class=n>exploded_data</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;category&#39;</span><span class=p>)[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Grouped back to lists:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>grouped</span><span class=p>)</span>
</code></pre></div> <p><strong>explode() Characteristics:</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><strong>Input</strong></td> <td>Column with lists/arrays/sets</td> </tr> <tr> <td><strong>Output</strong></td> <td>One row per list element</td> </tr> <tr> <td><strong>Index</strong></td> <td>Duplicates original index</td> </tr> <tr> <td><strong>Other cols</strong></td> <td>Repeated for each element</td> </tr> <tr> <td><strong>Empty list</strong></td> <td>Creates one row with NaN</td> </tr> <tr> <td><strong>None/NaN</strong></td> <td>Creates one row with NaN</td> </tr> </tbody> </table> <p><strong>Common Patterns:</strong></p> <table> <thead> <tr> <th>Pattern</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>User tags</strong></td> <td>Analyze interests, categories</td> </tr> <tr> <td><strong>Order items</strong></td> <td>E-commerce line items</td> </tr> <tr> <td><strong>JSON arrays</strong></td> <td>Flatten nested API data</td> </tr> <tr> <td><strong>Multi-value fields</strong></td> <td>Convert to normalized form</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"explode(): list column ‚Üí separate rows"</li> <li>"Each list element becomes new row"</li> <li>"Other columns duplicated"</li> <li>"Index preserved (duplicated)"</li> <li>"reset_index(drop=True) for clean index"</li> <li>"Can explode multiple columns (same lengths)"</li> <li>"Empty list ‚Üí NaN row"</li> <li>"Reverse: groupby().apply(list)"</li> <li>"Use for: nested data, JSON arrays, multi-value fields"</li> </ul> </div> </details> <hr> <h3 id=explain-pandas-pipe-method-meta-google-interview-question>Explain Pandas Pipe Method - Meta, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Pipe</code>, <code>Method Chaining</code>, <code>Clean Code</code> | <strong>Asked by:</strong> Meta, Google, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>pipe()</strong> enables method chaining with custom functions. Pass DataFrame through pipeline of functions for clean, readable data transformations.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>,</span> <span class=s1>&#39;David&#39;</span><span class=p>],</span>
    <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>25</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>40</span><span class=p>],</span>
    <span class=s1>&#39;salary&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>50000</span><span class=p>,</span> <span class=mi>60000</span><span class=p>,</span> <span class=mi>70000</span><span class=p>,</span> <span class=mi>80000</span><span class=p>],</span>
    <span class=s1>&#39;department&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Sales&#39;</span><span class=p>,</span> <span class=s1>&#39;IT&#39;</span><span class=p>,</span> <span class=s1>&#39;Sales&#39;</span><span class=p>,</span> <span class=s1>&#39;IT&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># 1. Without pipe (nested functions - hard to read)</span>
<span class=k>def</span><span class=w> </span><span class=nf>add_bonus</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>rate</span><span class=o>=</span><span class=mf>0.1</span><span class=p>):</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;bonus&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;salary&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>rate</span>
    <span class=k>return</span> <span class=n>df</span>

<span class=k>def</span><span class=w> </span><span class=nf>calculate_total</span><span class=p>(</span><span class=n>df</span><span class=p>):</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;total&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;salary&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;bonus&#39;</span><span class=p>]</span>
    <span class=k>return</span> <span class=n>df</span>

<span class=c1># Nested (ugly)</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>calculate_total</span><span class=p>(</span><span class=n>add_bonus</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>rate</span><span class=o>=</span><span class=mf>0.15</span><span class=p>))</span>

<span class=c1># 2. With pipe (clean, readable)</span>
<span class=n>result</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span>
          <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>add_bonus</span><span class=p>,</span> <span class=n>rate</span><span class=o>=</span><span class=mf>0.15</span><span class=p>)</span>
          <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>calculate_total</span><span class=p>))</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;With pipe:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 3. Multiple Transformations</span>
<span class=k>def</span><span class=w> </span><span class=nf>filter_by_age</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>min_age</span><span class=p>):</span>
    <span class=k>return</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>min_age</span><span class=p>]</span>

<span class=k>def</span><span class=w> </span><span class=nf>add_age_group</span><span class=p>(</span><span class=n>df</span><span class=p>):</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;age_group&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>],</span> <span class=n>bins</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span> 
                              <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Young&#39;</span><span class=p>,</span> <span class=s1>&#39;Middle&#39;</span><span class=p>,</span> <span class=s1>&#39;Senior&#39;</span><span class=p>])</span>
    <span class=k>return</span> <span class=n>df</span>

<span class=k>def</span><span class=w> </span><span class=nf>calculate_metrics</span><span class=p>(</span><span class=n>df</span><span class=p>):</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;salary_per_age&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;salary&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span>
    <span class=k>return</span> <span class=n>df</span>

<span class=c1># Clean pipeline</span>
<span class=n>result</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span>
          <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>filter_by_age</span><span class=p>,</span> <span class=n>min_age</span><span class=o>=</span><span class=mi>28</span><span class=p>)</span>
          <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>add_age_group</span><span class=p>)</span>
          <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>calculate_metrics</span><span class=p>))</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Pipeline result:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 4. Mixing Built-in and Custom Functions</span>
<span class=n>result</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span>
          <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span> <span class=n>d</span><span class=p>[</span><span class=n>d</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>25</span><span class=p>])</span>  <span class=c1># Lambda</span>
          <span class=o>.</span><span class=n>assign</span><span class=p>(</span><span class=n>bonus</span><span class=o>=</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span> <span class=n>d</span><span class=p>[</span><span class=s1>&#39;salary&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mf>0.1</span><span class=p>)</span>  <span class=c1># Built-in</span>
          <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span> <span class=n>d</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;bonus&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>))</span>
          <span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>drop</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Mixed pipeline:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 5. Pipe with Arguments and Kwargs</span>
<span class=k>def</span><span class=w> </span><span class=nf>apply_discount</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>column</span><span class=p>,</span> <span class=n>discount_rate</span><span class=p>,</span> <span class=n>condition_col</span><span class=p>,</span> <span class=n>condition_val</span><span class=p>):</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>mask</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>condition_col</span><span class=p>]</span> <span class=o>==</span> <span class=n>condition_val</span>
    <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>mask</span><span class=p>,</span> <span class=n>column</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>mask</span><span class=p>,</span> <span class=n>column</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>discount_rate</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>df</span>

<span class=n>result</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span>
          <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>apply_discount</span><span class=p>,</span> 
                <span class=n>column</span><span class=o>=</span><span class=s1>&#39;salary&#39;</span><span class=p>,</span>
                <span class=n>discount_rate</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span>
                <span class=n>condition_col</span><span class=o>=</span><span class=s1>&#39;department&#39;</span><span class=p>,</span>
                <span class=n>condition_val</span><span class=o>=</span><span class=s1>&#39;Sales&#39;</span><span class=p>))</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With arguments:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 6. Error Handling in Pipeline</span>
<span class=k>def</span><span class=w> </span><span class=nf>validate_data</span><span class=p>(</span><span class=n>df</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Validate DataFrame.&quot;&quot;&quot;</span>
    <span class=k>assert</span> <span class=ow>not</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;salary&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>isna</span><span class=p>()</span><span class=o>.</span><span class=n>any</span><span class=p>(),</span> <span class=s2>&quot;Salary has NaN&quot;</span>
    <span class=k>assert</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>all</span><span class=p>(),</span> <span class=s2>&quot;Invalid age&quot;</span>
    <span class=k>return</span> <span class=n>df</span>

<span class=k>def</span><span class=w> </span><span class=nf>clean_data</span><span class=p>(</span><span class=n>df</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Clean DataFrame.&quot;&quot;&quot;</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>]</span>
    <span class=k>return</span> <span class=n>df</span>

<span class=c1># Safe pipeline</span>
<span class=n>result</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span>
          <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>clean_data</span><span class=p>)</span>
          <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>validate_data</span><span class=p>)</span>
          <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>add_bonus</span><span class=p>,</span> <span class=n>rate</span><span class=o>=</span><span class=mf>0.1</span><span class=p>))</span>

<span class=c1># 7. Practical Example: Data Processing Pipeline</span>
<span class=n>sales_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>101</span><span class=p>),</span>
    <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>],</span> <span class=mi>100</span><span class=p>),</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span>
    <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>)</span>
<span class=p>})</span>

<span class=k>def</span><span class=w> </span><span class=nf>add_revenue</span><span class=p>(</span><span class=n>df</span><span class=p>):</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;revenue&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span>
    <span class=k>return</span> <span class=n>df</span>

<span class=k>def</span><span class=w> </span><span class=nf>add_date_features</span><span class=p>(</span><span class=n>df</span><span class=p>):</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;month&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>month</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;day_of_week&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>day_name</span><span class=p>()</span>
    <span class=k>return</span> <span class=n>df</span>

<span class=k>def</span><span class=w> </span><span class=nf>filter_high_value</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>min_revenue</span><span class=o>=</span><span class=mi>500</span><span class=p>):</span>
    <span class=k>return</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;revenue&#39;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>min_revenue</span><span class=p>]</span>

<span class=k>def</span><span class=w> </span><span class=nf>add_customer_segment</span><span class=p>(</span><span class=n>df</span><span class=p>):</span>
    <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
    <span class=n>customer_totals</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;customer_id&#39;</span><span class=p>)[</span><span class=s1>&#39;revenue&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
    <span class=n>segments</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>customer_totals</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Low&#39;</span><span class=p>,</span> <span class=s1>&#39;Medium&#39;</span><span class=p>,</span> <span class=s1>&#39;High&#39;</span><span class=p>])</span>
    <span class=n>df</span><span class=p>[</span><span class=s1>&#39;segment&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;customer_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>segments</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>df</span>

<span class=c1># Complete pipeline</span>
<span class=n>processed</span> <span class=o>=</span> <span class=p>(</span><span class=n>sales_data</span>
             <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>add_revenue</span><span class=p>)</span>
             <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>add_date_features</span><span class=p>)</span>
             <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>filter_high_value</span><span class=p>,</span> <span class=n>min_revenue</span><span class=o>=</span><span class=mi>300</span><span class=p>)</span>
             <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>add_customer_segment</span><span class=p>)</span>
             <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span> <span class=n>d</span><span class=o>.</span><span class=n>sort_values</span><span class=p>([</span><span class=s1>&#39;segment&#39;</span><span class=p>,</span> <span class=s1>&#39;revenue&#39;</span><span class=p>],</span> 
                                           <span class=n>ascending</span><span class=o>=</span><span class=p>[</span><span class=kc>True</span><span class=p>,</span> <span class=kc>False</span><span class=p>])))</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Processed sales data:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>processed</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span>

<span class=c1># 8. Reusable Pipelines</span>
<span class=k>def</span><span class=w> </span><span class=nf>sales_pipeline</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>min_revenue</span><span class=o>=</span><span class=mi>500</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Reusable sales processing pipeline.&quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=p>(</span><span class=n>df</span>
            <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>add_revenue</span><span class=p>)</span>
            <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>add_date_features</span><span class=p>)</span>
            <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>filter_high_value</span><span class=p>,</span> <span class=n>min_revenue</span><span class=o>=</span><span class=n>min_revenue</span><span class=p>)</span>
            <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>add_customer_segment</span><span class=p>))</span>

<span class=c1># Apply to different datasets</span>
<span class=n>result1</span> <span class=o>=</span> <span class=n>sales_pipeline</span><span class=p>(</span><span class=n>sales_data</span><span class=p>,</span> <span class=n>min_revenue</span><span class=o>=</span><span class=mi>300</span><span class=p>)</span>
<span class=n>result2</span> <span class=o>=</span> <span class=n>sales_pipeline</span><span class=p>(</span><span class=n>sales_data</span><span class=p>,</span> <span class=n>min_revenue</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With min_revenue=300: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>result1</span><span class=p>)</span><span class=si>}</span><span class=s2> rows&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;With min_revenue=600: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>result2</span><span class=p>)</span><span class=si>}</span><span class=s2> rows&quot;</span><span class=p>)</span>

<span class=c1># 9. pipe() vs Method Chaining</span>
<span class=c1># Method chaining (only built-in methods)</span>
<span class=n>result_chain</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span>
                <span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;age &gt; 25&#39;</span><span class=p>)</span>
                <span class=o>.</span><span class=n>assign</span><span class=p>(</span><span class=n>bonus</span><span class=o>=</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span> <span class=n>d</span><span class=p>[</span><span class=s1>&#39;salary&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mf>0.1</span><span class=p>)</span>
                <span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;bonus&#39;</span><span class=p>))</span>

<span class=c1># pipe (custom functions)</span>
<span class=n>result_pipe</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span>
               <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span> <span class=n>d</span><span class=p>[</span><span class=n>d</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>25</span><span class=p>])</span>
               <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=n>add_bonus</span><span class=p>,</span> <span class=n>rate</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>
               <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span> <span class=n>d</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;bonus&#39;</span><span class=p>)))</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Both approaches work:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Chain: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>result_chain</span><span class=p>)</span><span class=si>}</span><span class=s2> rows&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Pipe: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>result_pipe</span><span class=p>)</span><span class=si>}</span><span class=s2> rows&quot;</span><span class=p>)</span>

<span class=c1># 10. Performance Note</span>
<span class=c1># pipe() has minimal overhead</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=n>large_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100000</span><span class=p>),</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100000</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># With pipe</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=p>(</span><span class=n>large_df</span>
     <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span> <span class=n>d</span><span class=p>[</span><span class=n>d</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>50000</span><span class=p>])</span>
     <span class=o>.</span><span class=n>pipe</span><span class=p>(</span><span class=k>lambda</span> <span class=n>d</span><span class=p>:</span> <span class=n>d</span><span class=o>.</span><span class=n>assign</span><span class=p>(</span><span class=n>C</span><span class=o>=</span><span class=n>d</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>d</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>])))</span>
<span class=n>pipe_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=c1># Without pipe</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>temp</span> <span class=o>=</span> <span class=n>large_df</span><span class=p>[</span><span class=n>large_df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>50000</span><span class=p>]</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>temp</span><span class=o>.</span><span class=n>assign</span><span class=p>(</span><span class=n>C</span><span class=o>=</span><span class=n>temp</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>temp</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>])</span>
<span class=n>direct_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Pipe: </span><span class=si>{</span><span class=n>pipe_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Direct: </span><span class=si>{</span><span class=n>direct_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;(Virtually same performance)&quot;</span><span class=p>)</span>
</code></pre></div> <p><strong>pipe() Benefits:</strong></p> <table> <thead> <tr> <th>Benefit</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><strong>Readability</strong></td> <td>Linear, top-to-bottom flow</td> </tr> <tr> <td><strong>Reusability</strong></td> <td>Functions can be reused</td> </tr> <tr> <td><strong>Testability</strong></td> <td>Each function testable</td> </tr> <tr> <td><strong>Maintainability</strong></td> <td>Easy to add/remove steps</td> </tr> <tr> <td><strong>Debugging</strong></td> <td>Comment out steps easily</td> </tr> </tbody> </table> <p><strong>pipe() vs Method Chaining:</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>pipe()</th> <th>Method Chaining</th> </tr> </thead> <tbody> <tr> <td><strong>Functions</strong></td> <td>Custom functions</td> <td>Built-in methods</td> </tr> <tr> <td><strong>Flexibility</strong></td> <td>Very flexible</td> <td>Limited to methods</td> </tr> <tr> <td><strong>Arguments</strong></td> <td>Pass parameters</td> <td>Use kwargs</td> </tr> <tr> <td><strong>Use Case</strong></td> <td>Complex pipelines</td> <td>Simple transformations</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"pipe(): pass DataFrame through functions"</li> <li>"Enables method chaining with custom functions"</li> <li>"Clean, readable data pipelines"</li> <li>"Pass arguments: <code>.pipe(func, arg1, arg2)</code>"</li> <li>"Better than nested functions: <code>f(g(h(df)))</code>"</li> <li>"Combine with built-in methods: assign, query"</li> <li>"Each function: take df, return df"</li> <li>"Benefits: readability, reusability, testability"</li> <li>"Minimal performance overhead"</li> </ul> </div> </details> <hr> <h3 id=explain-pdjson_normalize-amazon-google-interview-question>Explain pd.json_normalize() - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>JSON</code>, <code>Nested Data</code>, <code>Flattening</code> | <strong>Asked by:</strong> Amazon, Google, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>json_normalize()</strong> flattens nested JSON/dict structures into DataFrames. Essential for API responses, nested documents, and semi-structured data.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>json</span>

<span class=c1># 1. Simple Nested JSON</span>
<span class=n>data</span> <span class=o>=</span> <span class=p>[</span>
    <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=mi>25</span><span class=p>,</span> <span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;city&#39;</span><span class=p>:</span> <span class=s1>&#39;NYC&#39;</span><span class=p>,</span> <span class=s1>&#39;zip&#39;</span><span class=p>:</span> <span class=s1>&#39;10001&#39;</span><span class=p>}},</span>
    <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=mi>30</span><span class=p>,</span> <span class=s1>&#39;address&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;city&#39;</span><span class=p>:</span> <span class=s1>&#39;LA&#39;</span><span class=p>,</span> <span class=s1>&#39;zip&#39;</span><span class=p>:</span> <span class=s1>&#39;90001&#39;</span><span class=p>}}</span>
<span class=p>]</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>json_normalize</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Flattened JSON:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># 2. Deep Nesting</span>
<span class=n>data</span> <span class=o>=</span> <span class=p>[</span>
    <span class=p>{</span>
        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
        <span class=s1>&#39;user&#39;</span><span class=p>:</span> <span class=p>{</span>
            <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Alice&#39;</span><span class=p>,</span>
            <span class=s1>&#39;contact&#39;</span><span class=p>:</span> <span class=p>{</span>
                <span class=s1>&#39;email&#39;</span><span class=p>:</span> <span class=s1>&#39;alice@example.com&#39;</span><span class=p>,</span>
                <span class=s1>&#39;phone&#39;</span><span class=p>:</span> <span class=s1>&#39;123-456-7890&#39;</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>},</span>
    <span class=p>{</span>
        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
        <span class=s1>&#39;user&#39;</span><span class=p>:</span> <span class=p>{</span>
            <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span>
            <span class=s1>&#39;contact&#39;</span><span class=p>:</span> <span class=p>{</span>
                <span class=s1>&#39;email&#39;</span><span class=p>:</span> <span class=s1>&#39;bob@example.com&#39;</span><span class=p>,</span>
                <span class=s1>&#39;phone&#39;</span><span class=p>:</span> <span class=s1>&#39;098-765-4321&#39;</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>]</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>json_normalize</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Deep nesting:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># 3. Custom Separator</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>json_normalize</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>sep</span><span class=o>=</span><span class=s1>&#39;_&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Custom separator:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># 4. Arrays in JSON</span>
<span class=n>data</span> <span class=o>=</span> <span class=p>[</span>
    <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;scores&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>90</span><span class=p>,</span> <span class=mi>85</span><span class=p>,</span> <span class=mi>88</span><span class=p>]},</span>
    <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;scores&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>78</span><span class=p>,</span> <span class=mi>82</span><span class=p>,</span> <span class=mi>80</span><span class=p>]}</span>
<span class=p>]</span>

<span class=c1># Note: Arrays stay as lists</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>json_normalize</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With arrays:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># Explode to separate rows</span>
<span class=n>df_exploded</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>explode</span><span class=p>(</span><span class=s1>&#39;scores&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>drop</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Exploded scores:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_exploded</span><span class=p>)</span>

<span class=c1># 5. Nested Arrays of Objects</span>
<span class=n>data</span> <span class=o>=</span> <span class=p>[</span>
    <span class=p>{</span>
        <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
        <span class=s1>&#39;customer&#39;</span><span class=p>:</span> <span class=s1>&#39;Alice&#39;</span><span class=p>,</span>
        <span class=s1>&#39;items&#39;</span><span class=p>:</span> <span class=p>[</span>
            <span class=p>{</span><span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=s1>&#39;Laptop&#39;</span><span class=p>,</span> <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=mi>1000</span><span class=p>},</span>
            <span class=p>{</span><span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=s1>&#39;Mouse&#39;</span><span class=p>,</span> <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=mi>25</span><span class=p>}</span>
        <span class=p>]</span>
    <span class=p>},</span>
    <span class=p>{</span>
        <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
        <span class=s1>&#39;customer&#39;</span><span class=p>:</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span>
        <span class=s1>&#39;items&#39;</span><span class=p>:</span> <span class=p>[</span>
            <span class=p>{</span><span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=s1>&#39;Keyboard&#39;</span><span class=p>,</span> <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=mi>75</span><span class=p>}</span>
        <span class=p>]</span>
    <span class=p>}</span>
<span class=p>]</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>json_normalize</span><span class=p>(</span>
    <span class=n>data</span><span class=p>,</span>
    <span class=n>record_path</span><span class=o>=</span><span class=s1>&#39;items&#39;</span><span class=p>,</span>
    <span class=n>meta</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>,</span> <span class=s1>&#39;customer&#39;</span><span class=p>]</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Nested arrays of objects:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># 6. Multiple Levels of Nesting</span>
<span class=n>data</span> <span class=o>=</span> <span class=p>[</span>
    <span class=p>{</span>
        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
        <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Alice&#39;</span><span class=p>,</span>
        <span class=s1>&#39;orders&#39;</span><span class=p>:</span> <span class=p>[</span>
            <span class=p>{</span>
                <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=mi>101</span><span class=p>,</span>
                <span class=s1>&#39;items&#39;</span><span class=p>:</span> <span class=p>[</span>
                    <span class=p>{</span><span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;qty&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>},</span>
                    <span class=p>{</span><span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;qty&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>}</span>
                <span class=p>]</span>
            <span class=p>}</span>
        <span class=p>]</span>
    <span class=p>}</span>
<span class=p>]</span>

<span class=c1># Flatten orders</span>
<span class=n>df_orders</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>json_normalize</span><span class=p>(</span>
    <span class=n>data</span><span class=p>,</span>
    <span class=n>record_path</span><span class=o>=</span><span class=s1>&#39;orders&#39;</span><span class=p>,</span>
    <span class=n>meta</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>]</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Flattened orders:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_orders</span><span class=p>)</span>

<span class=c1># Further flatten items</span>
<span class=c1># Need to work with the items column</span>
<span class=n>items_data</span> <span class=o>=</span> <span class=p>[]</span>
<span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>df_orders</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
    <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;items&#39;</span><span class=p>]:</span>
        <span class=n>items_data</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
            <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>],</span>
            <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>],</span>
            <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>],</span>
            <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=n>item</span><span class=p>[</span><span class=s1>&#39;product&#39;</span><span class=p>],</span>
            <span class=s1>&#39;qty&#39;</span><span class=p>:</span> <span class=n>item</span><span class=p>[</span><span class=s1>&#39;qty&#39;</span><span class=p>]</span>
        <span class=p>})</span>

<span class=n>df_items</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>items_data</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Fully flattened:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_items</span><span class=p>)</span>

<span class=c1># 7. Real Example: GitHub API Response</span>
<span class=n>github_response</span> <span class=o>=</span> <span class=p>[</span>
    <span class=p>{</span>
        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
        <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;repo1&#39;</span><span class=p>,</span>
        <span class=s1>&#39;owner&#39;</span><span class=p>:</span> <span class=p>{</span>
            <span class=s1>&#39;login&#39;</span><span class=p>:</span> <span class=s1>&#39;alice&#39;</span><span class=p>,</span>
            <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>123</span><span class=p>,</span>
            <span class=s1>&#39;url&#39;</span><span class=p>:</span> <span class=s1>&#39;https://github.com/alice&#39;</span>
        <span class=p>},</span>
        <span class=s1>&#39;stats&#39;</span><span class=p>:</span> <span class=p>{</span>
            <span class=s1>&#39;stars&#39;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
            <span class=s1>&#39;forks&#39;</span><span class=p>:</span> <span class=mi>20</span><span class=p>,</span>
            <span class=s1>&#39;watchers&#39;</span><span class=p>:</span> <span class=mi>50</span>
        <span class=p>}</span>
    <span class=p>},</span>
    <span class=p>{</span>
        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
        <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;repo2&#39;</span><span class=p>,</span>
        <span class=s1>&#39;owner&#39;</span><span class=p>:</span> <span class=p>{</span>
            <span class=s1>&#39;login&#39;</span><span class=p>:</span> <span class=s1>&#39;bob&#39;</span><span class=p>,</span>
            <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>456</span><span class=p>,</span>
            <span class=s1>&#39;url&#39;</span><span class=p>:</span> <span class=s1>&#39;https://github.com/bob&#39;</span>
        <span class=p>},</span>
        <span class=s1>&#39;stats&#39;</span><span class=p>:</span> <span class=p>{</span>
            <span class=s1>&#39;stars&#39;</span><span class=p>:</span> <span class=mi>500</span><span class=p>,</span>
            <span class=s1>&#39;forks&#39;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
            <span class=s1>&#39;watchers&#39;</span><span class=p>:</span> <span class=mi>250</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>]</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>json_normalize</span><span class=p>(</span><span class=n>github_response</span><span class=p>,</span> <span class=n>sep</span><span class=o>=</span><span class=s1>&#39;_&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>GitHub repos:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># 8. Handling Missing Keys</span>
<span class=n>data</span> <span class=o>=</span> <span class=p>[</span>
    <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=mi>25</span><span class=p>,</span> <span class=s1>&#39;city&#39;</span><span class=p>:</span> <span class=s1>&#39;NYC&#39;</span><span class=p>},</span>
    <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=mi>30</span><span class=p>},</span>  <span class=c1># Missing &#39;city&#39;</span>
    <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>,</span> <span class=s1>&#39;city&#39;</span><span class=p>:</span> <span class=s1>&#39;LA&#39;</span><span class=p>}</span>  <span class=c1># Missing &#39;age&#39;</span>
<span class=p>]</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>json_normalize</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Missing keys (NaN):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># 9. Real Example: Twitter/X API</span>
<span class=n>tweets</span> <span class=o>=</span> <span class=p>[</span>
    <span class=p>{</span>
        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
        <span class=s1>&#39;text&#39;</span><span class=p>:</span> <span class=s1>&#39;Hello World&#39;</span><span class=p>,</span>
        <span class=s1>&#39;user&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;followers&#39;</span><span class=p>:</span> <span class=mi>1000</span><span class=p>},</span>
        <span class=s1>&#39;entities&#39;</span><span class=p>:</span> <span class=p>{</span>
            <span class=s1>&#39;hashtags&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;hello&#39;</span><span class=p>,</span> <span class=s1>&#39;world&#39;</span><span class=p>],</span>
            <span class=s1>&#39;mentions&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;@bob&#39;</span><span class=p>]</span>
        <span class=p>},</span>
        <span class=s1>&#39;metrics&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;likes&#39;</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span> <span class=s1>&#39;retweets&#39;</span><span class=p>:</span> <span class=mi>10</span><span class=p>}</span>
    <span class=p>},</span>
    <span class=p>{</span>
        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
        <span class=s1>&#39;text&#39;</span><span class=p>:</span> <span class=s1>&#39;Python is great&#39;</span><span class=p>,</span>
        <span class=s1>&#39;user&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;followers&#39;</span><span class=p>:</span> <span class=mi>5000</span><span class=p>},</span>
        <span class=s1>&#39;entities&#39;</span><span class=p>:</span> <span class=p>{</span>
            <span class=s1>&#39;hashtags&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;python&#39;</span><span class=p>],</span>
            <span class=s1>&#39;mentions&#39;</span><span class=p>:</span> <span class=p>[]</span>
        <span class=p>},</span>
        <span class=s1>&#39;metrics&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;likes&#39;</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=s1>&#39;retweets&#39;</span><span class=p>:</span> <span class=mi>50</span><span class=p>}</span>
    <span class=p>}</span>
<span class=p>]</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>json_normalize</span><span class=p>(</span><span class=n>tweets</span><span class=p>,</span> <span class=n>sep</span><span class=o>=</span><span class=s1>&#39;_&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Tweets data:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;id&#39;</span><span class=p>,</span> <span class=s1>&#39;text&#39;</span><span class=p>,</span> <span class=s1>&#39;user_name&#39;</span><span class=p>,</span> <span class=s1>&#39;user_followers&#39;</span><span class=p>,</span> <span class=s1>&#39;metrics_likes&#39;</span><span class=p>]])</span>

<span class=c1># 10. Performance with Large JSON</span>
<span class=c1># json_normalize is efficient</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=n>large_data</span> <span class=o>=</span> <span class=p>[</span>
    <span class=p>{</span>
        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=n>i</span><span class=p>,</span>
        <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=p>{</span>
            <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=n>i</span> <span class=o>*</span> <span class=mi>2</span><span class=p>,</span>
            <span class=s1>&#39;meta&#39;</span><span class=p>:</span> <span class=p>{</span>
                <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span>
                <span class=s1>&#39;source&#39;</span><span class=p>:</span> <span class=s1>&#39;api&#39;</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10000</span><span class=p>)</span>
<span class=p>]</span>

<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>json_normalize</span><span class=p>(</span><span class=n>large_data</span><span class=p>,</span> <span class=n>sep</span><span class=o>=</span><span class=s1>&#39;_&#39;</span><span class=p>)</span>
<span class=n>normalize_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Normalized 10k records in </span><span class=si>{</span><span class=n>normalize_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Result shape: </span><span class=si>{</span><span class=n>df</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</code></pre></div> <p><strong>json_normalize() Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>data</strong></td> <td>JSON data (list of dicts)</td> <td><code>[{'a': 1}]</code></td> </tr> <tr> <td><strong>record_path</strong></td> <td>Path to nested records</td> <td><code>record_path='items'</code></td> </tr> <tr> <td><strong>meta</strong></td> <td>Columns to include from parent</td> <td><code>meta=['id', 'name']</code></td> </tr> <tr> <td><strong>sep</strong></td> <td>Separator for flattened keys</td> <td><code>sep='_'</code> (default '.')</td> </tr> <tr> <td><strong>max_level</strong></td> <td>Max nesting depth</td> <td><code>max_level=1</code></td> </tr> </tbody> </table> <p><strong>Common Patterns:</strong></p> <table> <thead> <tr> <th>Pattern</th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td><strong>Simple nesting</strong></td> <td><code>json_normalize(data)</code></td> </tr> <tr> <td><strong>Nested arrays</strong></td> <td><code>json_normalize(data, record_path='items', meta=['id'])</code></td> </tr> <tr> <td><strong>Deep nesting</strong></td> <td>Flatten in multiple steps</td> </tr> <tr> <td><strong>Arrays of values</strong></td> <td>Use with <code>.explode()</code></td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"json_normalize(): flatten nested JSON/dicts"</li> <li>"Converts nested structures to flat DataFrame"</li> <li>"record_path: path to nested array"</li> <li>"meta: parent columns to include"</li> <li>"sep: separator for flattened names (default '.')"</li> <li>"Use with explode() for nested arrays"</li> <li>"Essential for: API responses, NoSQL data"</li> <li>"Handles missing keys (creates NaN)"</li> <li>"Use for: Twitter API, GitHub API, MongoDB docs"</li> </ul> </div> </details> <hr> <h3 id=explain-pdto_datetime-options-microsoft-amazon-interview-question>Explain pd.to_datetime() Options - Microsoft, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>DateTime</code>, <code>Parsing</code>, <code>Time Series</code> | <strong>Asked by:</strong> Microsoft, Amazon, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>to_datetime()</strong> parses strings/numbers to datetime objects. Supports multiple formats, error handling, timezone conversions, and performance optimizations with format parameter.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># 1. Basic Parsing</span>
<span class=c1># Automatic format detection</span>
<span class=n>dates</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=s1>&#39;2024-01-15&#39;</span><span class=p>,</span> <span class=s1>&#39;2024-02-20&#39;</span><span class=p>,</span> <span class=s1>&#39;2024-03-25&#39;</span><span class=p>])</span>
<span class=n>parsed</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>dates</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Basic parsing:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>parsed</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Type: </span><span class=si>{</span><span class=n>parsed</span><span class=o>.</span><span class=n>dtype</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># 2. Different Formats</span>
<span class=c1># Common formats</span>
<span class=n>formats</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;ISO&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;2024-01-15&#39;</span><span class=p>,</span> <span class=s1>&#39;2024-02-20&#39;</span><span class=p>],</span>
    <span class=s1>&#39;US&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;01/15/2024&#39;</span><span class=p>,</span> <span class=s1>&#39;02/20/2024&#39;</span><span class=p>],</span>
    <span class=s1>&#39;EU&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;15/01/2024&#39;</span><span class=p>,</span> <span class=s1>&#39;20/02/2024&#39;</span><span class=p>],</span>
    <span class=s1>&#39;Text&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Jan 15, 2024&#39;</span><span class=p>,</span> <span class=s1>&#39;Feb 20, 2024&#39;</span><span class=p>]</span>
<span class=p>}</span>

<span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>dates</span> <span class=ow>in</span> <span class=n>formats</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
    <span class=n>parsed</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>dates</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2> format:&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>parsed</span><span class=p>)</span>

<span class=c1># 3. Specify Format (Much Faster!)</span>
<span class=n>dates</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=s1>&#39;20240115&#39;</span><span class=p>,</span> <span class=s1>&#39;20240220&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>10000</span><span class=p>)</span>

<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=c1># Without format (slow, tries multiple formats)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>dates</span><span class=p>)</span>
<span class=n>auto_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=c1># With format (fast, direct parsing)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>dates</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;%Y%m</span><span class=si>%d</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=n>format_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Auto detection: </span><span class=si>{</span><span class=n>auto_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;With format: </span><span class=si>{</span><span class=n>format_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s (</span><span class=si>{</span><span class=n>auto_time</span><span class=o>/</span><span class=n>format_time</span><span class=si>:</span><span class=s2>.0f</span><span class=si>}</span><span class=s2>x faster!)&quot;</span><span class=p>)</span>

<span class=c1># 4. Common Format Codes</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>=== Format Codes ===&quot;</span><span class=p>)</span>
<span class=n>examples</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1>&#39;</span><span class=p>:</span> <span class=s1>&#39;2024-01-15&#39;</span><span class=p>,</span>
    <span class=s1>&#39;</span><span class=si>%d</span><span class=s1>/%m/%Y&#39;</span><span class=p>:</span> <span class=s1>&#39;15/01/2024&#39;</span><span class=p>,</span>
    <span class=s1>&#39;%m/</span><span class=si>%d</span><span class=s1>/%Y&#39;</span><span class=p>:</span> <span class=s1>&#39;01/15/2024&#39;</span><span class=p>,</span>
    <span class=s1>&#39;%Y%m</span><span class=si>%d</span><span class=s1>&#39;</span><span class=p>:</span> <span class=s1>&#39;20240115&#39;</span><span class=p>,</span>
    <span class=s1>&#39;</span><span class=si>%d</span><span class=s1>-%b-%Y&#39;</span><span class=p>:</span> <span class=s1>&#39;15-Jan-2024&#39;</span><span class=p>,</span>
    <span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1> %H:%M:%S&#39;</span><span class=p>:</span> <span class=s1>&#39;2024-01-15 14:30:00&#39;</span><span class=p>,</span>
    <span class=s1>&#39;</span><span class=si>%d</span><span class=s1>/%m/%Y %I:%M %p&#39;</span><span class=p>:</span> <span class=s1>&#39;15/01/2024 02:30 PM&#39;</span>
<span class=p>}</span>

<span class=k>for</span> <span class=n>fmt</span><span class=p>,</span> <span class=n>example</span> <span class=ow>in</span> <span class=n>examples</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
    <span class=n>parsed</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>example</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=n>fmt</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>fmt</span><span class=si>:</span><span class=s2>25</span><span class=si>}</span><span class=s2> ‚Üí </span><span class=si>{</span><span class=n>example</span><span class=si>:</span><span class=s2>25</span><span class=si>}</span><span class=s2> ‚Üí </span><span class=si>{</span><span class=n>parsed</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># 5. Error Handling</span>
<span class=n>mixed_dates</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=s1>&#39;2024-01-15&#39;</span><span class=p>,</span> <span class=s1>&#39;2024-02-20&#39;</span><span class=p>,</span> <span class=s1>&#39;not a date&#39;</span><span class=p>,</span> <span class=s1>&#39;2024-03-25&#39;</span><span class=p>])</span>

<span class=c1># errors=&#39;raise&#39; (default) - raises exception</span>
<span class=c1># try: pd.to_datetime(mixed_dates); except: pass</span>

<span class=c1># errors=&#39;ignore&#39; - returns original if can&#39;t parse</span>
<span class=n>ignore_result</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>mixed_dates</span><span class=p>,</span> <span class=n>errors</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>errors=&#39;ignore&#39;:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>ignore_result</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Types: </span><span class=si>{</span><span class=p>[</span><span class=nb>type</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=o>.</span><span class=vm>__name__</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=ow>in</span><span class=w> </span><span class=n>ignore_result</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># errors=&#39;coerce&#39; - NaT for invalid</span>
<span class=n>coerce_result</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>mixed_dates</span><span class=p>,</span> <span class=n>errors</span><span class=o>=</span><span class=s1>&#39;coerce&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>errors=&#39;coerce&#39;:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>coerce_result</span><span class=p>)</span>

<span class=c1># 6. From Components</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;year&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>2024</span><span class=p>,</span> <span class=mi>2024</span><span class=p>,</span> <span class=mi>2024</span><span class=p>],</span>
    <span class=s1>&#39;month&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
    <span class=s1>&#39;day&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>15</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>25</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Combine columns</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;year&#39;</span><span class=p>,</span> <span class=s1>&#39;month&#39;</span><span class=p>,</span> <span class=s1>&#39;day&#39;</span><span class=p>]])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>From components:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># 7. Unix Timestamps</span>
<span class=n>timestamps</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>1704067200</span><span class=p>,</span> <span class=mi>1706745600</span><span class=p>,</span> <span class=mi>1709337600</span><span class=p>])</span>

<span class=c1># Convert (unit=&#39;s&#39; for seconds)</span>
<span class=n>dates</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>timestamps</span><span class=p>,</span> <span class=n>unit</span><span class=o>=</span><span class=s1>&#39;s&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>From Unix timestamp:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>dates</span><span class=p>)</span>

<span class=c1># Milliseconds</span>
<span class=n>timestamps_ms</span> <span class=o>=</span> <span class=n>timestamps</span> <span class=o>*</span> <span class=mi>1000</span>
<span class=n>dates_ms</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>timestamps_ms</span><span class=p>,</span> <span class=n>unit</span><span class=o>=</span><span class=s1>&#39;ms&#39;</span><span class=p>)</span>

<span class=c1># 8. Timezone Handling</span>
<span class=c1># Parse with timezone</span>
<span class=n>dates</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=s1>&#39;2024-01-15 10:00:00&#39;</span><span class=p>,</span> <span class=s1>&#39;2024-02-20 15:30:00&#39;</span><span class=p>])</span>

<span class=c1># UTC</span>
<span class=n>utc</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>dates</span><span class=p>,</span> <span class=n>utc</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>UTC:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>utc</span><span class=p>)</span>

<span class=c1># Convert to timezone</span>
<span class=n>eastern</span> <span class=o>=</span> <span class=n>utc</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>tz_convert</span><span class=p>(</span><span class=s1>&#39;America/New_York&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Eastern Time:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>eastern</span><span class=p>)</span>

<span class=c1># Localize (add timezone to naive)</span>
<span class=n>naive</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>dates</span><span class=p>)</span>
<span class=n>localized</span> <span class=o>=</span> <span class=n>naive</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>tz_localize</span><span class=p>(</span><span class=s1>&#39;America/Los_Angeles&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Localized to Pacific:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>localized</span><span class=p>)</span>

<span class=c1># 9. Day First / Year First</span>
<span class=n>ambiguous_dates</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=s1>&#39;01-02-2024&#39;</span><span class=p>,</span> <span class=s1>&#39;03-04-2024&#39;</span><span class=p>])</span>

<span class=c1># Default: month first (US)</span>
<span class=n>us_format</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>ambiguous_dates</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Month first (US):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>us_format</span><span class=p>)</span>

<span class=c1># Day first (EU)</span>
<span class=n>eu_format</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>ambiguous_dates</span><span class=p>,</span> <span class=n>dayfirst</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Day first (EU):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>eu_format</span><span class=p>)</span>

<span class=c1># 10. Practical Example: Log File Parsing</span>
<span class=n>log_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=p>[</span>
        <span class=s1>&#39;2024-01-15 10:30:45.123&#39;</span><span class=p>,</span>
        <span class=s1>&#39;2024-01-15 10:31:12.456&#39;</span><span class=p>,</span>
        <span class=s1>&#39;2024-01-15 10:32:03.789&#39;</span>
    <span class=p>],</span>
    <span class=s1>&#39;event&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;login&#39;</span><span class=p>,</span> <span class=s1>&#39;click&#39;</span><span class=p>,</span> <span class=s1>&#39;logout&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Parse with milliseconds</span>
<span class=n>log_data</span><span class=p>[</span><span class=s1>&#39;timestamp&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span>
    <span class=n>log_data</span><span class=p>[</span><span class=s1>&#39;timestamp&#39;</span><span class=p>],</span>
    <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1> %H:%M:%S.</span><span class=si>%f</span><span class=s1>&#39;</span>
<span class=p>)</span>

<span class=c1># Extract time components</span>
<span class=n>log_data</span><span class=p>[</span><span class=s1>&#39;hour&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>log_data</span><span class=p>[</span><span class=s1>&#39;timestamp&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>hour</span>
<span class=n>log_data</span><span class=p>[</span><span class=s1>&#39;minute&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>log_data</span><span class=p>[</span><span class=s1>&#39;timestamp&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>minute</span>
<span class=n>log_data</span><span class=p>[</span><span class=s1>&#39;second&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>log_data</span><span class=p>[</span><span class=s1>&#39;timestamp&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>dt</span><span class=o>.</span><span class=n>second</span>

<span class=c1># Calculate duration</span>
<span class=n>log_data</span><span class=p>[</span><span class=s1>&#39;duration&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>log_data</span><span class=p>[</span><span class=s1>&#39;timestamp&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>diff</span><span class=p>()</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Log data:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>log_data</span><span class=p>)</span>
</code></pre></div> <p><strong>Common Format Codes:</strong></p> <table> <thead> <tr> <th>Code</th> <th>Meaning</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>%Y</strong></td> <td>4-digit year</td> <td>2024</td> </tr> <tr> <td><strong>%y</strong></td> <td>2-digit year</td> <td>24</td> </tr> <tr> <td><strong>%m</strong></td> <td>Month (01-12)</td> <td>01</td> </tr> <tr> <td><strong>%d</strong></td> <td>Day (01-31)</td> <td>15</td> </tr> <tr> <td><strong>%H</strong></td> <td>Hour 24h (00-23)</td> <td>14</td> </tr> <tr> <td><strong>%I</strong></td> <td>Hour 12h (01-12)</td> <td>02</td> </tr> <tr> <td><strong>%M</strong></td> <td>Minute (00-59)</td> <td>30</td> </tr> <tr> <td><strong>%S</strong></td> <td>Second (00-59)</td> <td>45</td> </tr> <tr> <td><strong>%f</strong></td> <td>Microsecond</td> <td>123456</td> </tr> <tr> <td><strong>%p</strong></td> <td>AM/PM</td> <td>PM</td> </tr> <tr> <td><strong>%b</strong></td> <td>Month abbr</td> <td>Jan</td> </tr> <tr> <td><strong>%B</strong></td> <td>Month full</td> <td>January</td> </tr> </tbody> </table> <p><strong>Key Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>format</strong></td> <td>Explicit format</td> <td><code>format='%Y-%m-%d'</code></td> </tr> <tr> <td><strong>errors</strong></td> <td>Error handling</td> <td><code>errors='coerce'</code></td> </tr> <tr> <td><strong>dayfirst</strong></td> <td>Day before month</td> <td><code>dayfirst=True</code></td> </tr> <tr> <td><strong>yearfirst</strong></td> <td>Year first</td> <td><code>yearfirst=True</code></td> </tr> <tr> <td><strong>utc</strong></td> <td>Parse as UTC</td> <td><code>utc=True</code></td> </tr> <tr> <td><strong>unit</strong></td> <td>Timestamp unit</td> <td><code>unit='s'</code></td> </tr> </tbody> </table> <p><strong>Error Handling:</strong></p> <table> <thead> <tr> <th>Option</th> <th>Behavior</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>raise</strong></td> <td>Raise exception</td> <td>Ensure all valid</td> </tr> <tr> <td><strong>ignore</strong></td> <td>Return original</td> <td>Keep as string</td> </tr> <tr> <td><strong>coerce</strong></td> <td>Return NaT</td> <td>Fill invalid with NaT</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"to_datetime(): parse strings/numbers to datetime"</li> <li>"format parameter: specify format for speed (10-100x faster)"</li> <li>"Format codes: %Y, %m, %d, %H, %M, %S"</li> <li>"errors='coerce': NaT for invalid dates"</li> <li>"dayfirst=True: European format (day/month/year)"</li> <li>"unit='s': parse Unix timestamps"</li> <li>"utc=True: parse as UTC"</li> <li>"From dict: pass DataFrame with year/month/day columns"</li> <li>"Always specify format for large datasets"</li> </ul> </div> </details> <hr> <h3 id=explain-pdread_csv-optimization-google-netflix-interview-question>Explain pd.read_csv() Optimization - Google, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>File I/O</code>, <code>Performance</code>, <code>Large Files</code> | <strong>Asked by:</strong> Google, Netflix, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>read_csv()</strong> optimization reduces memory and time. Key techniques: dtype specification, usecols, nrows, chunksize, efficient parsers, and using alternative formats.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=c1># Create sample CSV</span>
<span class=n>sample_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100000</span><span class=p>),</span>
    <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>],</span> <span class=mi>100000</span><span class=p>),</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>100000</span><span class=p>),</span>
    <span class=s1>&#39;text&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;some text&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>100000</span><span class=p>,</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2020-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>100000</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;h&#39;</span><span class=p>)</span>
<span class=p>})</span>
<span class=n>sample_df</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=s1>&#39;sample.csv&#39;</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

<span class=c1># 1. Basic (Slow)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;sample.csv&#39;</span><span class=p>)</span>
<span class=n>basic_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
<span class=n>basic_memory</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Basic: </span><span class=si>{</span><span class=n>basic_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s, </span><span class=si>{</span><span class=n>basic_memory</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>dtypes</span><span class=p>)</span>

<span class=c1># 2. Specify dtypes (Faster, Less Memory)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>df_typed</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
    <span class=s1>&#39;sample.csv&#39;</span><span class=p>,</span>
    <span class=n>dtype</span><span class=o>=</span><span class=p>{</span>
        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=s1>&#39;int32&#39;</span><span class=p>,</span>  <span class=c1># vs int64</span>
        <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=s1>&#39;category&#39;</span><span class=p>,</span>  <span class=c1># vs object</span>
        <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=s1>&#39;float32&#39;</span>  <span class=c1># vs float64</span>
    <span class=p>},</span>
    <span class=n>parse_dates</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span>
<span class=p>)</span>
<span class=n>typed_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
<span class=n>typed_memory</span> <span class=o>=</span> <span class=n>df_typed</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With dtypes: </span><span class=si>{</span><span class=n>typed_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s, </span><span class=si>{</span><span class=n>typed_memory</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Memory saved: </span><span class=si>{</span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>typed_memory</span><span class=o>/</span><span class=n>basic_memory</span><span class=p>)</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_typed</span><span class=o>.</span><span class=n>dtypes</span><span class=p>)</span>

<span class=c1># 3. Load Only Needed Columns</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>df_cols</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
    <span class=s1>&#39;sample.csv&#39;</span><span class=p>,</span>
    <span class=n>usecols</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>,</span> <span class=s1>&#39;category&#39;</span><span class=p>,</span> <span class=s1>&#39;value&#39;</span><span class=p>]</span>
<span class=p>)</span>
<span class=n>cols_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
<span class=n>cols_memory</span> <span class=o>=</span> <span class=n>df_cols</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Selected columns: </span><span class=si>{</span><span class=n>cols_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s, </span><span class=si>{</span><span class=n>cols_memory</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>

<span class=c1># 4. Load First N Rows (Testing)</span>
<span class=n>df_sample</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;sample.csv&#39;</span><span class=p>,</span> <span class=n>nrows</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>First 1000 rows: </span><span class=si>{</span><span class=n>df_sample</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># 5. Chunking (For Very Large Files)</span>
<span class=k>def</span><span class=w> </span><span class=nf>process_chunks</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=n>chunksize</span><span class=o>=</span><span class=mi>10000</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Process file in chunks.&quot;&quot;&quot;</span>
    <span class=n>total</span> <span class=o>=</span> <span class=mi>0</span>
    <span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=n>chunksize</span><span class=o>=</span><span class=n>chunksize</span><span class=p>):</span>
        <span class=c1># Process each chunk</span>
        <span class=n>total</span> <span class=o>+=</span> <span class=n>chunk</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
    <span class=k>return</span> <span class=n>total</span>

<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>process_chunks</span><span class=p>(</span><span class=s1>&#39;sample.csv&#39;</span><span class=p>,</span> <span class=n>chunksize</span><span class=o>=</span><span class=mi>10000</span><span class=p>)</span>
<span class=n>chunk_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Chunked processing: </span><span class=si>{</span><span class=n>chunk_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s, result: </span><span class=si>{</span><span class=n>result</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># 6. C Engine vs Python Engine</span>
<span class=c1># C engine (default, faster)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;sample.csv&#39;</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>&#39;c&#39;</span><span class=p>)</span>
<span class=n>c_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=c1># Python engine (more features, slower)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;sample.csv&#39;</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>&#39;python&#39;</span><span class=p>)</span>
<span class=n>python_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>C engine: </span><span class=si>{</span><span class=n>c_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Python engine: </span><span class=si>{</span><span class=n>python_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>

<span class=c1># 7. Low Memory Mode</span>
<span class=c1># Good for files with inconsistent types</span>
<span class=n>df_low_mem</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;sample.csv&#39;</span><span class=p>,</span> <span class=n>low_memory</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># 8. Date Parsing Optimization</span>
<span class=c1># Bad: parse after loading</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;sample.csv&#39;</span><span class=p>)</span>
<span class=n>df1</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>df1</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>])</span>
<span class=n>parse_after_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=c1># Good: parse during loading</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;sample.csv&#39;</span><span class=p>,</span> <span class=n>parse_dates</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;date&#39;</span><span class=p>])</span>
<span class=n>parse_during_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Parse after: </span><span class=si>{</span><span class=n>parse_after_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Parse during: </span><span class=si>{</span><span class=n>parse_during_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>

<span class=c1># 9. Compression</span>
<span class=c1># Save compressed</span>
<span class=n>sample_df</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=s1>&#39;sample.csv.gz&#39;</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>compression</span><span class=o>=</span><span class=s1>&#39;gzip&#39;</span><span class=p>)</span>

<span class=c1># Read compressed (automatic detection)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>df_compressed</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;sample.csv.gz&#39;</span><span class=p>)</span>
<span class=n>compressed_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=kn>import</span><span class=w> </span><span class=nn>os</span>
<span class=n>csv_size</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>getsize</span><span class=p>(</span><span class=s1>&#39;sample.csv&#39;</span><span class=p>)</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>
<span class=n>gz_size</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>getsize</span><span class=p>(</span><span class=s1>&#39;sample.csv.gz&#39;</span><span class=p>)</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>CSV size: </span><span class=si>{</span><span class=n>csv_size</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Gzip size: </span><span class=si>{</span><span class=n>gz_size</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB (</span><span class=si>{</span><span class=p>(</span><span class=mi>1</span><span class=o>-</span><span class=n>gz_size</span><span class=o>/</span><span class=n>csv_size</span><span class=p>)</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>% smaller)&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Load time: </span><span class=si>{</span><span class=n>compressed_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>

<span class=c1># 10. Alternative: Parquet (Much Better!)</span>
<span class=c1># Save as parquet</span>
<span class=n>sample_df</span><span class=o>.</span><span class=n>to_parquet</span><span class=p>(</span><span class=s1>&#39;sample.parquet&#39;</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

<span class=c1># Read parquet</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>df_parquet</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_parquet</span><span class=p>(</span><span class=s1>&#39;sample.parquet&#39;</span><span class=p>)</span>
<span class=n>parquet_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
<span class=n>parquet_size</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>getsize</span><span class=p>(</span><span class=s1>&#39;sample.parquet&#39;</span><span class=p>)</span> <span class=o>/</span> <span class=mi>1024</span><span class=o>**</span><span class=mi>2</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Parquet size: </span><span class=si>{</span><span class=n>parquet_size</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Parquet load: </span><span class=si>{</span><span class=n>parquet_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Parquet vs CSV: </span><span class=si>{</span><span class=n>basic_time</span><span class=o>/</span><span class=n>parquet_time</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>x faster!&quot;</span><span class=p>)</span>

<span class=c1># 11. Skip Rows</span>
<span class=c1># Skip first N rows</span>
<span class=n>df_skip</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;sample.csv&#39;</span><span class=p>,</span> <span class=n>skiprows</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>

<span class=c1># Skip by condition (Python engine)</span>
<span class=n>df_skip_func</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
    <span class=s1>&#39;sample.csv&#39;</span><span class=p>,</span>
    <span class=n>skiprows</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span><span class=p>,</span>  <span class=c1># Every other row</span>
    <span class=n>engine</span><span class=o>=</span><span class=s1>&#39;python&#39;</span>
<span class=p>)</span>

<span class=c1># 12. Practical Recommendations</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>=== Best Practices ===&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;1. Specify dtypes (especially category for low-cardinality)&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;2. Use usecols to load only needed columns&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;3. Use chunksize for files larger than RAM&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;4. parse_dates during loading, not after&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;5. Consider parquet for repeated reads (10x faster)&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;6. Use compression for storage (gzip, snappy)&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;7. Test with nrows first to design pipeline&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;8. Use low_memory=False to avoid dtype warnings&quot;</span><span class=p>)</span>

<span class=c1># Cleanup</span>
<span class=kn>import</span><span class=w> </span><span class=nn>os</span>
<span class=k>for</span> <span class=n>file</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;sample.csv&#39;</span><span class=p>,</span> <span class=s1>&#39;sample.csv.gz&#39;</span><span class=p>,</span> <span class=s1>&#39;sample.parquet&#39;</span><span class=p>]:</span>
    <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>file</span><span class=p>):</span>
        <span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</code></pre></div> <p><strong>Optimization Techniques:</strong></p> <table> <thead> <tr> <th>Technique</th> <th>Speed Improvement</th> <th>Memory Savings</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>dtype</strong></td> <td>10-20%</td> <td>50-90%</td> <td>Specify types</td> </tr> <tr> <td><strong>usecols</strong></td> <td>30-50%</td> <td>50-80%</td> <td>Select columns</td> </tr> <tr> <td><strong>chunksize</strong></td> <td>N/A</td> <td>90%+</td> <td>Larger than RAM</td> </tr> <tr> <td><strong>parse_dates</strong></td> <td>20-30%</td> <td>-</td> <td>Date columns</td> </tr> <tr> <td><strong>engine='c'</strong></td> <td>2-5x</td> <td>-</td> <td>Default, fastest</td> </tr> <tr> <td><strong>parquet</strong></td> <td>5-10x</td> <td>50-80%</td> <td>Best format</td> </tr> </tbody> </table> <p><strong>Key Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Purpose</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>dtype</strong></td> <td>Specify types</td> <td><code>dtype={'col': 'int32'}</code></td> </tr> <tr> <td><strong>usecols</strong></td> <td>Select columns</td> <td><code>usecols=['a', 'b']</code></td> </tr> <tr> <td><strong>nrows</strong></td> <td>Limit rows</td> <td><code>nrows=1000</code></td> </tr> <tr> <td><strong>chunksize</strong></td> <td>Read in chunks</td> <td><code>chunksize=10000</code></td> </tr> <tr> <td><strong>parse_dates</strong></td> <td>Parse dates</td> <td><code>parse_dates=['date']</code></td> </tr> <tr> <td><strong>low_memory</strong></td> <td>Avoid warnings</td> <td><code>low_memory=False</code></td> </tr> <tr> <td><strong>engine</strong></td> <td>Parser</td> <td><code>engine='c'</code> (fast)</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"Specify dtypes: 50-90% memory savings"</li> <li>"usecols: load only needed columns"</li> <li>"chunksize: process files larger than RAM"</li> <li>"parse_dates: faster than parsing after load"</li> <li>"category dtype: 90%+ savings for low cardinality"</li> <li>"int32 vs int64: 50% memory savings"</li> <li>"float32 vs float64: 50% memory savings"</li> <li>"Parquet: 5-10x faster than CSV"</li> <li>"nrows: test with sample first"</li> <li>"engine='c': default, fastest"</li> </ul> </div> </details> <hr> <h3 id=explain-pandas-style-for-formatting-meta-amazon-interview-question>Explain Pandas Style for Formatting - Meta, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Styling</code>, <code>Formatting</code>, <code>Visualization</code> | <strong>Asked by:</strong> Meta, Amazon, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>style</strong> API formats DataFrame output with colors, highlights, and conditional formatting. Creates publication-ready tables, heatmaps, and visual reports.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;Product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;D&#39;</span><span class=p>,</span> <span class=s1>&#39;E&#39;</span><span class=p>],</span>
    <span class=s1>&#39;Sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10000</span><span class=p>,</span> <span class=mi>15000</span><span class=p>,</span> <span class=mi>8000</span><span class=p>,</span> <span class=mi>12000</span><span class=p>,</span> <span class=mi>18000</span><span class=p>],</span>
    <span class=s1>&#39;Profit&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>2000</span><span class=p>,</span> <span class=mi>3500</span><span class=p>,</span> <span class=mi>1200</span><span class=p>,</span> <span class=mi>2800</span><span class=p>,</span> <span class=mi>4200</span><span class=p>],</span>
    <span class=s1>&#39;Growth&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.15</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.05</span><span class=p>,</span> <span class=mf>0.22</span><span class=p>,</span> <span class=mf>0.08</span><span class=p>,</span> <span class=mf>0.18</span><span class=p>],</span>
    <span class=s1>&#39;Target&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>12000</span><span class=p>,</span> <span class=mi>14000</span><span class=p>,</span> <span class=mi>10000</span><span class=p>,</span> <span class=mi>13000</span><span class=p>,</span> <span class=mi>16000</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># 1. Basic Number Formatting</span>
<span class=n>styled</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>format</span><span class=p>({</span>
    <span class=s1>&#39;Sales&#39;</span><span class=p>:</span> <span class=s1>&#39;$</span><span class=si>{:,.0f}</span><span class=s1>&#39;</span><span class=p>,</span>
    <span class=s1>&#39;Profit&#39;</span><span class=p>:</span> <span class=s1>&#39;$</span><span class=si>{:,.0f}</span><span class=s1>&#39;</span><span class=p>,</span>
    <span class=s1>&#39;Growth&#39;</span><span class=p>:</span> <span class=s1>&#39;</span><span class=si>{:.1%}</span><span class=s1>&#39;</span>
<span class=p>})</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Formatted (display in notebook):&quot;</span><span class=p>)</span>
<span class=c1># styled  # Display in Jupyter</span>

<span class=c1># 2. Highlight Maximum</span>
<span class=n>styled</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>highlight_max</span><span class=p>(</span>
    <span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Sales&#39;</span><span class=p>,</span> <span class=s1>&#39;Profit&#39;</span><span class=p>],</span>
    <span class=n>color</span><span class=o>=</span><span class=s1>&#39;lightgreen&#39;</span>
<span class=p>)</span>

<span class=c1># 3. Highlight Minimum</span>
<span class=n>styled</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>highlight_min</span><span class=p>(</span>
    <span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Sales&#39;</span><span class=p>,</span> <span class=s1>&#39;Profit&#39;</span><span class=p>],</span>
    <span class=n>color</span><span class=o>=</span><span class=s1>&#39;lightcoral&#39;</span>
<span class=p>)</span>

<span class=c1># 4. Background Gradient</span>
<span class=n>styled</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>background_gradient</span><span class=p>(</span>
    <span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Sales&#39;</span><span class=p>,</span> <span class=s1>&#39;Profit&#39;</span><span class=p>],</span>
    <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;YlOrRd&#39;</span>
<span class=p>)</span>

<span class=c1># 5. Color Negative Values</span>
<span class=k>def</span><span class=w> </span><span class=nf>color_negative_red</span><span class=p>(</span><span class=n>val</span><span class=p>):</span>
    <span class=n>color</span> <span class=o>=</span> <span class=s1>&#39;red&#39;</span> <span class=k>if</span> <span class=n>val</span> <span class=o>&lt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=s1>&#39;black&#39;</span>
    <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;color: </span><span class=si>{</span><span class=n>color</span><span class=si>}</span><span class=s1>&#39;</span>

<span class=n>styled</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>applymap</span><span class=p>(</span>
    <span class=n>color_negative_red</span><span class=p>,</span>
    <span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Growth&#39;</span><span class=p>]</span>
<span class=p>)</span>

<span class=c1># 6. Conditional Formatting (Row-wise)</span>
<span class=k>def</span><span class=w> </span><span class=nf>highlight_missed_target</span><span class=p>(</span><span class=n>row</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Highlight rows that missed target.&quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;Sales&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;Target&#39;</span><span class=p>]:</span>
        <span class=k>return</span> <span class=p>[</span><span class=s1>&#39;background-color: #ffcccb&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=nb>len</span><span class=p>(</span><span class=n>row</span><span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=k>return</span> <span class=p>[</span><span class=s1>&#39;&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=nb>len</span><span class=p>(</span><span class=n>row</span><span class=p>)</span>

<span class=n>styled</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>highlight_missed_target</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>

<span class=c1># 7. Bar Charts in Cells</span>
<span class=n>styled</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span>
    <span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Sales&#39;</span><span class=p>],</span>
    <span class=n>color</span><span class=o>=</span><span class=s1>&#39;lightblue&#39;</span>
<span class=p>)</span>

<span class=c1># 8. Combining Multiple Styles</span>
<span class=n>styled</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>style</span>
          <span class=o>.</span><span class=n>format</span><span class=p>({</span>
              <span class=s1>&#39;Sales&#39;</span><span class=p>:</span> <span class=s1>&#39;$</span><span class=si>{:,.0f}</span><span class=s1>&#39;</span><span class=p>,</span>
              <span class=s1>&#39;Profit&#39;</span><span class=p>:</span> <span class=s1>&#39;$</span><span class=si>{:,.0f}</span><span class=s1>&#39;</span><span class=p>,</span>
              <span class=s1>&#39;Growth&#39;</span><span class=p>:</span> <span class=s1>&#39;</span><span class=si>{:.1%}</span><span class=s1>&#39;</span><span class=p>,</span>
              <span class=s1>&#39;Target&#39;</span><span class=p>:</span> <span class=s1>&#39;$</span><span class=si>{:,.0f}</span><span class=s1>&#39;</span>
          <span class=p>})</span>
          <span class=o>.</span><span class=n>background_gradient</span><span class=p>(</span><span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Sales&#39;</span><span class=p>],</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;Blues&#39;</span><span class=p>)</span>
          <span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Profit&#39;</span><span class=p>],</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;lightgreen&#39;</span><span class=p>)</span>
          <span class=o>.</span><span class=n>highlight_max</span><span class=p>(</span><span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Growth&#39;</span><span class=p>],</span> <span class=n>color</span><span class=o>=</span><span class=s1>&#39;yellow&#39;</span><span class=p>))</span>

<span class=c1># 9. Custom Function (Element-wise)</span>
<span class=k>def</span><span class=w> </span><span class=nf>color_profit</span><span class=p>(</span><span class=n>val</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Color profit levels.&quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>val</span> <span class=o>&gt;</span> <span class=mi>3000</span><span class=p>:</span>
        <span class=k>return</span> <span class=s1>&#39;background-color: #90EE90&#39;</span>
    <span class=k>elif</span> <span class=n>val</span> <span class=o>&gt;</span> <span class=mi>2000</span><span class=p>:</span>
        <span class=k>return</span> <span class=s1>&#39;background-color: #FFFFCC&#39;</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=k>return</span> <span class=s1>&#39;background-color: #FFB6C1&#39;</span>

<span class=n>styled</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>style</span><span class=o>.</span><span class=n>applymap</span><span class=p>(</span><span class=n>color_profit</span><span class=p>,</span> <span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Profit&#39;</span><span class=p>])</span>

<span class=c1># 10. Practical Example: Sales Dashboard</span>
<span class=n>dashboard_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;Region&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>,</span> <span class=s1>&#39;East&#39;</span><span class=p>,</span> <span class=s1>&#39;West&#39;</span><span class=p>],</span>
    <span class=s1>&#39;Q1_Sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>120000</span><span class=p>,</span> <span class=mi>95000</span><span class=p>,</span> <span class=mi>105000</span><span class=p>,</span> <span class=mi>110000</span><span class=p>],</span>
    <span class=s1>&#39;Q2_Sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>135000</span><span class=p>,</span> <span class=mi>88000</span><span class=p>,</span> <span class=mi>115000</span><span class=p>,</span> <span class=mi>125000</span><span class=p>],</span>
    <span class=s1>&#39;YoY_Growth&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.12</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.08</span><span class=p>,</span> <span class=mf>0.15</span><span class=p>,</span> <span class=mf>0.10</span><span class=p>],</span>
    <span class=s1>&#39;Target_Met&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Yes&#39;</span><span class=p>,</span> <span class=s1>&#39;No&#39;</span><span class=p>,</span> <span class=s1>&#39;Yes&#39;</span><span class=p>,</span> <span class=s1>&#39;Yes&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=k>def</span><span class=w> </span><span class=nf>highlight_yes_green</span><span class=p>(</span><span class=n>val</span><span class=p>):</span>
    <span class=k>if</span> <span class=n>val</span> <span class=o>==</span> <span class=s1>&#39;Yes&#39;</span><span class=p>:</span>
        <span class=k>return</span> <span class=s1>&#39;background-color: lightgreen&#39;</span>
    <span class=k>elif</span> <span class=n>val</span> <span class=o>==</span> <span class=s1>&#39;No&#39;</span><span class=p>:</span>
        <span class=k>return</span> <span class=s1>&#39;background-color: lightcoral&#39;</span>
    <span class=k>return</span> <span class=s1>&#39;&#39;</span>

<span class=n>styled</span> <span class=o>=</span> <span class=p>(</span><span class=n>dashboard_df</span><span class=o>.</span><span class=n>style</span>
          <span class=o>.</span><span class=n>format</span><span class=p>({</span>
              <span class=s1>&#39;Q1_Sales&#39;</span><span class=p>:</span> <span class=s1>&#39;$</span><span class=si>{:,.0f}</span><span class=s1>&#39;</span><span class=p>,</span>
              <span class=s1>&#39;Q2_Sales&#39;</span><span class=p>:</span> <span class=s1>&#39;$</span><span class=si>{:,.0f}</span><span class=s1>&#39;</span><span class=p>,</span>
              <span class=s1>&#39;YoY_Growth&#39;</span><span class=p>:</span> <span class=s1>&#39;</span><span class=si>{:.1%}</span><span class=s1>&#39;</span>
          <span class=p>})</span>
          <span class=o>.</span><span class=n>background_gradient</span><span class=p>(</span><span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Q1_Sales&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2_Sales&#39;</span><span class=p>],</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>&#39;YlGn&#39;</span><span class=p>)</span>
          <span class=o>.</span><span class=n>applymap</span><span class=p>(</span><span class=n>highlight_yes_green</span><span class=p>,</span> <span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Target_Met&#39;</span><span class=p>])</span>
          <span class=o>.</span><span class=n>set_caption</span><span class=p>(</span><span class=s1>&#39;Quarterly Sales Dashboard&#39;</span><span class=p>))</span>

<span class=c1># 11. Export to HTML/Excel</span>
<span class=c1># To HTML</span>
<span class=n>html</span> <span class=o>=</span> <span class=n>styled</span><span class=o>.</span><span class=n>to_html</span><span class=p>()</span>
<span class=c1># with open(&#39;report.html&#39;, &#39;w&#39;) as f:</span>
<span class=c1>#     f.write(html)</span>

<span class=c1># To Excel (with xlsxwriter)</span>
<span class=c1># styled.to_excel(&#39;report.xlsx&#39;, engine=&#39;xlsxwriter&#39;)</span>

<span class=c1># 12. Hiding Index/Columns</span>
<span class=n>styled</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>style</span>
          <span class=o>.</span><span class=n>hide_index</span><span class=p>()</span>
          <span class=o>.</span><span class=n>format</span><span class=p>({</span><span class=s1>&#39;Sales&#39;</span><span class=p>:</span> <span class=s1>&#39;$</span><span class=si>{:,.0f}</span><span class=s1>&#39;</span><span class=p>}))</span>

<span class=c1># 13. Setting Properties</span>
<span class=n>styled</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>style</span>
          <span class=o>.</span><span class=n>set_properties</span><span class=p>(</span><span class=o>**</span><span class=p>{</span>
              <span class=s1>&#39;background-color&#39;</span><span class=p>:</span> <span class=s1>&#39;lightblue&#39;</span><span class=p>,</span>
              <span class=s1>&#39;color&#39;</span><span class=p>:</span> <span class=s1>&#39;black&#39;</span><span class=p>,</span>
              <span class=s1>&#39;border-color&#39;</span><span class=p>:</span> <span class=s1>&#39;white&#39;</span>
          <span class=p>},</span> <span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Product&#39;</span><span class=p>]))</span>

<span class=c1># 14. Tooltips (Hover Text)</span>
<span class=c1># Note: More advanced, requires custom CSS</span>

<span class=c1># 15. Practical Report</span>
<span class=n>financial_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;Metric&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Revenue&#39;</span><span class=p>,</span> <span class=s1>&#39;COGS&#39;</span><span class=p>,</span> <span class=s1>&#39;Gross Profit&#39;</span><span class=p>,</span> <span class=s1>&#39;Operating Exp&#39;</span><span class=p>,</span> <span class=s1>&#39;Net Income&#39;</span><span class=p>],</span>
    <span class=s1>&#39;2023&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1000000</span><span class=p>,</span> <span class=mi>600000</span><span class=p>,</span> <span class=mi>400000</span><span class=p>,</span> <span class=mi>250000</span><span class=p>,</span> <span class=mi>150000</span><span class=p>],</span>
    <span class=s1>&#39;2024&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1200000</span><span class=p>,</span> <span class=mi>680000</span><span class=p>,</span> <span class=mi>520000</span><span class=p>,</span> <span class=mi>280000</span><span class=p>,</span> <span class=mi>240000</span><span class=p>],</span>
    <span class=s1>&#39;Change&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.20</span><span class=p>,</span> <span class=mf>0.13</span><span class=p>,</span> <span class=mf>0.30</span><span class=p>,</span> <span class=mf>0.12</span><span class=p>,</span> <span class=mf>0.60</span><span class=p>]</span>
<span class=p>})</span>

<span class=k>def</span><span class=w> </span><span class=nf>color_change</span><span class=p>(</span><span class=n>val</span><span class=p>):</span>
    <span class=k>if</span> <span class=n>val</span> <span class=o>&gt;</span> <span class=mf>0.15</span><span class=p>:</span>
        <span class=k>return</span> <span class=s1>&#39;color: green; font-weight: bold&#39;</span>
    <span class=k>elif</span> <span class=n>val</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
        <span class=k>return</span> <span class=s1>&#39;color: red; font-weight: bold&#39;</span>
    <span class=k>return</span> <span class=s1>&#39;&#39;</span>

<span class=n>styled</span> <span class=o>=</span> <span class=p>(</span><span class=n>financial_df</span><span class=o>.</span><span class=n>style</span>
          <span class=o>.</span><span class=n>format</span><span class=p>({</span>
              <span class=s1>&#39;2023&#39;</span><span class=p>:</span> <span class=s1>&#39;$</span><span class=si>{:,.0f}</span><span class=s1>&#39;</span><span class=p>,</span>
              <span class=s1>&#39;2024&#39;</span><span class=p>:</span> <span class=s1>&#39;$</span><span class=si>{:,.0f}</span><span class=s1>&#39;</span><span class=p>,</span>
              <span class=s1>&#39;Change&#39;</span><span class=p>:</span> <span class=s1>&#39;</span><span class=si>{:+.1%}</span><span class=s1>&#39;</span>
          <span class=p>})</span>
          <span class=o>.</span><span class=n>applymap</span><span class=p>(</span><span class=n>color_change</span><span class=p>,</span> <span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Change&#39;</span><span class=p>])</span>
          <span class=o>.</span><span class=n>set_caption</span><span class=p>(</span><span class=s1>&#39;Financial Report 2023-2024&#39;</span><span class=p>)</span>
          <span class=o>.</span><span class=n>set_table_styles</span><span class=p>([</span>
              <span class=p>{</span><span class=s1>&#39;selector&#39;</span><span class=p>:</span> <span class=s1>&#39;caption&#39;</span><span class=p>,</span>
               <span class=s1>&#39;props&#39;</span><span class=p>:</span> <span class=p>[(</span><span class=s1>&#39;font-size&#39;</span><span class=p>,</span> <span class=s1>&#39;16px&#39;</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;font-weight&#39;</span><span class=p>,</span> <span class=s1>&#39;bold&#39;</span><span class=p>)]}</span>
          <span class=p>]))</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Style API commonly used in Jupyter notebooks for visual reports&quot;</span><span class=p>)</span>
</code></pre></div> <p><strong>Common Style Methods:</strong></p> <table> <thead> <tr> <th>Method</th> <th>Purpose</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>format</strong></td> <td>Number formatting</td> <td><code>.format({'col': '{:.2f}'})</code></td> </tr> <tr> <td><strong>highlight_max</strong></td> <td>Highlight maximum</td> <td><code>.highlight_max(color='green')</code></td> </tr> <tr> <td><strong>highlight_min</strong></td> <td>Highlight minimum</td> <td><code>.highlight_min(color='red')</code></td> </tr> <tr> <td><strong>background_gradient</strong></td> <td>Color scale</td> <td><code>.background_gradient(cmap='Blues')</code></td> </tr> <tr> <td><strong>bar</strong></td> <td>In-cell bar chart</td> <td><code>.bar(color='blue')</code></td> </tr> <tr> <td><strong>applymap</strong></td> <td>Element-wise function</td> <td><code>.applymap(func, subset=['col'])</code></td> </tr> <tr> <td><strong>apply</strong></td> <td>Row/column function</td> <td><code>.apply(func, axis=1)</code></td> </tr> </tbody> </table> <p><strong>Format Strings:</strong></p> <table> <thead> <tr> <th>Format</th> <th>Output</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong><code>{:.2f}</code></strong></td> <td>12.35</td> <td>2 decimals</td> </tr> <tr> <td><strong><code>{:,.0f}</code></strong></td> <td>1,234</td> <td>Thousands separator</td> </tr> <tr> <td><strong><code>${:,.2f}</code></strong></td> <td>$1,234.56</td> <td>Currency</td> </tr> <tr> <td><strong><code>{:.1%}</code></strong></td> <td>12.3%</td> <td>Percentage</td> </tr> <tr> <td><strong><code>{:+.1f}</code></strong></td> <td>+12.3</td> <td>Show sign</td> </tr> </tbody> </table> <p><strong>Color Maps:</strong></p> <table> <thead> <tr> <th>cmap</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><strong>'YlOrRd'</strong></td> <td>Yellow-Orange-Red (heat)</td> </tr> <tr> <td><strong>'Blues'</strong></td> <td>Light to dark blue</td> </tr> <tr> <td><strong>'Greens'</strong></td> <td>Light to dark green</td> </tr> <tr> <td><strong>'RdYlGn'</strong></td> <td>Red-Yellow-Green (diverging)</td> </tr> <tr> <td><strong>'viridis'</strong></td> <td>Perceptually uniform</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"style: format DataFrame for display"</li> <li>"format(): number formatting (${:,.0f}, {:.1%})"</li> <li>"highlight_max/min(): highlight extremes"</li> <li>"background_gradient(): color scale"</li> <li>"bar(): in-cell bar charts"</li> <li>"applymap(): element-wise styling"</li> <li>"apply(): row/column-wise styling"</li> <li>"Method chaining for multiple styles"</li> <li>"Export: .to_html(), .to_excel()"</li> <li>"Use in: Jupyter reports, dashboards"</li> </ul> </div> </details> <hr> <h3 id=explain-pandas-merge-indicators-google-amazon-interview-question>Explain Pandas Merge Indicators - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Merge</code>, <code>Join</code>, <code>Data Quality</code> | <strong>Asked by:</strong> Google, Amazon, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>Merge indicator</strong> tracks source of each row (left_only, right_only, both). Essential for data validation, join analysis, and identifying mismatches.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>

<span class=c1># Sample data</span>
<span class=n>customers</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>,</span> <span class=s1>&#39;David&#39;</span><span class=p>,</span> <span class=s1>&#39;Eve&#39;</span><span class=p>],</span>
    <span class=s1>&#39;city&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;NYC&#39;</span><span class=p>,</span> <span class=s1>&#39;LA&#39;</span><span class=p>,</span> <span class=s1>&#39;Chicago&#39;</span><span class=p>,</span> <span class=s1>&#39;Boston&#39;</span><span class=p>,</span> <span class=s1>&#39;Seattle&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>orders</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>101</span><span class=p>,</span> <span class=mi>102</span><span class=p>,</span> <span class=mi>103</span><span class=p>,</span> <span class=mi>104</span><span class=p>,</span> <span class=mi>105</span><span class=p>,</span> <span class=mi>106</span><span class=p>],</span>
    <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span>
    <span class=s1>&#39;amount&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>300</span><span class=p>,</span> <span class=mi>250</span><span class=p>,</span> <span class=mi>175</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># 1. Basic Merge with Indicator</span>
<span class=n>merged</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span>
    <span class=n>customers</span><span class=p>,</span>
    <span class=n>orders</span><span class=p>,</span>
    <span class=n>on</span><span class=o>=</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span>
    <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span>
    <span class=n>indicator</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Merge with indicator:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>merged</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Indicator values:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>merged</span><span class=p>[</span><span class=s1>&#39;_merge&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>value_counts</span><span class=p>())</span>

<span class=c1># 2. Custom Indicator Name</span>
<span class=n>merged</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span>
    <span class=n>customers</span><span class=p>,</span>
    <span class=n>orders</span><span class=p>,</span>
    <span class=n>on</span><span class=o>=</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span>
    <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span>
    <span class=n>indicator</span><span class=o>=</span><span class=s1>&#39;source&#39;</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Custom indicator name:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>merged</span><span class=p>[[</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;order_id&#39;</span><span class=p>,</span> <span class=s1>&#39;source&#39;</span><span class=p>]])</span>

<span class=c1># 3. Analyze Merge Results</span>
<span class=c1># Customers without orders</span>
<span class=n>no_orders</span> <span class=o>=</span> <span class=n>merged</span><span class=p>[</span><span class=n>merged</span><span class=p>[</span><span class=s1>&#39;source&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;left_only&#39;</span><span class=p>]</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Customers without orders:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>no_orders</span><span class=p>[[</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>]])</span>

<span class=c1># Orders without customer match</span>
<span class=n>orphan_orders</span> <span class=o>=</span> <span class=n>merged</span><span class=p>[</span><span class=n>merged</span><span class=p>[</span><span class=s1>&#39;source&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;right_only&#39;</span><span class=p>]</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Orphan orders (no matching customer):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>orphan_orders</span><span class=p>[[</span><span class=s1>&#39;order_id&#39;</span><span class=p>,</span> <span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=s1>&#39;amount&#39;</span><span class=p>]])</span>

<span class=c1># Successfully matched</span>
<span class=n>matched</span> <span class=o>=</span> <span class=n>merged</span><span class=p>[</span><span class=n>merged</span><span class=p>[</span><span class=s1>&#39;source&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;both&#39;</span><span class=p>]</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Matched records:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>matched</span><span class=p>[[</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;order_id&#39;</span><span class=p>,</span> <span class=s1>&#39;amount&#39;</span><span class=p>]])</span>

<span class=c1># 4. Data Quality Check</span>
<span class=k>def</span><span class=w> </span><span class=nf>analyze_merge</span><span class=p>(</span><span class=n>left</span><span class=p>,</span> <span class=n>right</span><span class=p>,</span> <span class=n>on</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Analyze merge quality.&quot;&quot;&quot;</span>
    <span class=n>merged</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>left</span><span class=p>,</span> <span class=n>right</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=n>on</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=n>how</span><span class=p>,</span> <span class=n>indicator</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=n>stats</span> <span class=o>=</span> <span class=n>merged</span><span class=p>[</span><span class=s1>&#39;_merge&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>value_counts</span><span class=p>()</span>
    <span class=n>total</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>merged</span><span class=p>)</span>

    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;=== Merge Analysis ===&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Total rows: </span><span class=si>{</span><span class=n>total</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Left only: </span><span class=si>{</span><span class=n>stats</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;left_only&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>stats</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;left_only&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=o>/</span><span class=n>total</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Right only: </span><span class=si>{</span><span class=n>stats</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;right_only&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>stats</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;right_only&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=o>/</span><span class=n>total</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%)&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Both: </span><span class=si>{</span><span class=n>stats</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;both&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>stats</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;both&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=o>/</span><span class=n>total</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%)&quot;</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>merged</span>

<span class=n>result</span> <span class=o>=</span> <span class=n>analyze_merge</span><span class=p>(</span><span class=n>customers</span><span class=p>,</span> <span class=n>orders</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;customer_id&#39;</span><span class=p>)</span>

<span class=c1># 5. Validation After Merge</span>
<span class=n>merged</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>customers</span><span class=p>,</span> <span class=n>orders</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span> <span class=n>indicator</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Assert no orphan orders</span>
<span class=n>orphans</span> <span class=o>=</span> <span class=n>merged</span><span class=p>[</span><span class=n>merged</span><span class=p>[</span><span class=s1>&#39;_merge&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;right_only&#39;</span><span class=p>]</span>
<span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>orphans</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>‚ö†Ô∏è  WARNING: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>orphans</span><span class=p>)</span><span class=si>}</span><span class=s2> orders without customer!&quot;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=n>orphans</span><span class=p>[[</span><span class=s1>&#39;order_id&#39;</span><span class=p>,</span> <span class=s1>&#39;customer_id&#39;</span><span class=p>]])</span>

<span class=c1># Assert all customers have orders</span>
<span class=n>no_orders</span> <span class=o>=</span> <span class=n>merged</span><span class=p>[</span><span class=n>merged</span><span class=p>[</span><span class=s1>&#39;_merge&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;left_only&#39;</span><span class=p>]</span>
<span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>no_orders</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>INFO: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>no_orders</span><span class=p>)</span><span class=si>}</span><span class=s2> customers without orders&quot;</span><span class=p>)</span>

<span class=c1># 6. Practical Example: Product Catalog Sync</span>
<span class=n>catalog</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;sku&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A001&#39;</span><span class=p>,</span> <span class=s1>&#39;A002&#39;</span><span class=p>,</span> <span class=s1>&#39;A003&#39;</span><span class=p>,</span> <span class=s1>&#39;A004&#39;</span><span class=p>],</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Widget&#39;</span><span class=p>,</span> <span class=s1>&#39;Gadget&#39;</span><span class=p>,</span> <span class=s1>&#39;Tool&#39;</span><span class=p>,</span> <span class=s1>&#39;Device&#39;</span><span class=p>],</span>
    <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>25</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>inventory</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;sku&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A001&#39;</span><span class=p>,</span> <span class=s1>&#39;A002&#39;</span><span class=p>,</span> <span class=s1>&#39;A005&#39;</span><span class=p>,</span> <span class=s1>&#39;A006&#39;</span><span class=p>],</span>
    <span class=s1>&#39;warehouse&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;NYC&#39;</span><span class=p>,</span> <span class=s1>&#39;LA&#39;</span><span class=p>,</span> <span class=s1>&#39;NYC&#39;</span><span class=p>,</span> <span class=s1>&#39;LA&#39;</span><span class=p>],</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>75</span><span class=p>,</span> <span class=mi>30</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>sync</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>catalog</span><span class=p>,</span> <span class=n>inventory</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;sku&#39;</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span> <span class=n>indicator</span><span class=o>=</span><span class=s1>&#39;status&#39;</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>=== Catalog Sync Report ===&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Products in catalog only: </span><span class=si>{</span><span class=p>(</span><span class=n>sync</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span><span class=o>==</span><span class=s1>&#39;left_only&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Products in inventory only: </span><span class=si>{</span><span class=p>(</span><span class=n>sync</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span><span class=o>==</span><span class=s1>&#39;right_only&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Products in both: </span><span class=si>{</span><span class=p>(</span><span class=n>sync</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span><span class=o>==</span><span class=s1>&#39;both&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># Products to add to inventory</span>
<span class=n>to_add</span> <span class=o>=</span> <span class=n>sync</span><span class=p>[</span><span class=n>sync</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;left_only&#39;</span><span class=p>]</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Add to inventory:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>to_add</span><span class=p>[[</span><span class=s1>&#39;sku&#39;</span><span class=p>,</span> <span class=s1>&#39;product&#39;</span><span class=p>]])</span>

<span class=c1># Products to remove from inventory</span>
<span class=n>to_remove</span> <span class=o>=</span> <span class=n>sync</span><span class=p>[</span><span class=n>sync</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;right_only&#39;</span><span class=p>]</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Remove from inventory:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>to_remove</span><span class=p>[[</span><span class=s1>&#39;sku&#39;</span><span class=p>,</span> <span class=s1>&#39;warehouse&#39;</span><span class=p>]])</span>

<span class=c1># 7. Multiple Key Merge</span>
<span class=n>sales</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;region&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>,</span> <span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;East&#39;</span><span class=p>],</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>],</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>180</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>targets</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;region&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>,</span> <span class=s1>&#39;West&#39;</span><span class=p>],</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>],</span>
    <span class=s1>&#39;target&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>120</span><span class=p>,</span> <span class=mi>180</span><span class=p>,</span> <span class=mi>100</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>comparison</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span>
    <span class=n>sales</span><span class=p>,</span>
    <span class=n>targets</span><span class=p>,</span>
    <span class=n>on</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;region&#39;</span><span class=p>,</span> <span class=s1>&#39;product&#39;</span><span class=p>],</span>
    <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span>
    <span class=n>indicator</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Sales vs Targets:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>comparison</span><span class=p>)</span>

<span class=c1># Missing targets</span>
<span class=n>no_target</span> <span class=o>=</span> <span class=n>comparison</span><span class=p>[</span><span class=n>comparison</span><span class=p>[</span><span class=s1>&#39;_merge&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;left_only&#39;</span><span class=p>]</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Sales without targets:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>no_target</span><span class=p>[[</span><span class=s1>&#39;region&#39;</span><span class=p>,</span> <span class=s1>&#39;product&#39;</span><span class=p>,</span> <span class=s1>&#39;sales&#39;</span><span class=p>]])</span>

<span class=c1># 8. Time Series Alignment</span>
<span class=n>actual</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>),</span>
    <span class=s1>&#39;actual&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>110</span><span class=p>,</span> <span class=mi>105</span><span class=p>,</span> <span class=mi>115</span><span class=p>,</span> <span class=mi>120</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>forecast</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-01-02&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>),</span>
    <span class=s1>&#39;forecast&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>108</span><span class=p>,</span> <span class=mi>106</span><span class=p>,</span> <span class=mi>116</span><span class=p>,</span> <span class=mi>122</span><span class=p>,</span> <span class=mi>125</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>comparison</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span>
    <span class=n>actual</span><span class=p>,</span>
    <span class=n>forecast</span><span class=p>,</span>
    <span class=n>on</span><span class=o>=</span><span class=s1>&#39;date&#39;</span><span class=p>,</span>
    <span class=n>how</span><span class=o>=</span><span class=s1>&#39;outer&#39;</span><span class=p>,</span>
    <span class=n>indicator</span><span class=o>=</span><span class=kc>True</span>
<span class=p>)</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;date&#39;</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Actual vs Forecast:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>comparison</span><span class=p>)</span>

<span class=c1># Calculate accuracy only where both exist</span>
<span class=n>both_exist</span> <span class=o>=</span> <span class=n>comparison</span><span class=p>[</span><span class=n>comparison</span><span class=p>[</span><span class=s1>&#39;_merge&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;both&#39;</span><span class=p>]</span>
<span class=n>both_exist</span><span class=p>[</span><span class=s1>&#39;error&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=n>both_exist</span><span class=p>[</span><span class=s1>&#39;actual&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>both_exist</span><span class=p>[</span><span class=s1>&#39;forecast&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Forecast accuracy:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>both_exist</span><span class=p>[[</span><span class=s1>&#39;date&#39;</span><span class=p>,</span> <span class=s1>&#39;actual&#39;</span><span class=p>,</span> <span class=s1>&#39;forecast&#39;</span><span class=p>,</span> <span class=s1>&#39;error&#39;</span><span class=p>]])</span>
</code></pre></div> <p><strong>Indicator Values:</strong></p> <table> <thead> <tr> <th>Value</th> <th>Meaning</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><strong>'left_only'</strong></td> <td>In left only</td> <td>No match in right</td> </tr> <tr> <td><strong>'right_only'</strong></td> <td>In right only</td> <td>No match in left</td> </tr> <tr> <td><strong>'both'</strong></td> <td>In both</td> <td>Successfully matched</td> </tr> </tbody> </table> <p><strong>Common Use Cases:</strong></p> <table> <thead> <tr> <th>Use Case</th> <th>Check For</th> </tr> </thead> <tbody> <tr> <td><strong>Data quality</strong></td> <td>Orphan records</td> </tr> <tr> <td><strong>ETL validation</strong></td> <td>Missing matches</td> </tr> <tr> <td><strong>Catalog sync</strong></td> <td>Products to add/remove</td> </tr> <tr> <td><strong>Customer orders</strong></td> <td>Customers without orders</td> </tr> <tr> <td><strong>Join analysis</strong></td> <td>Match rate</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"indicator=True: add _merge column"</li> <li>"Values: 'left_only', 'right_only', 'both'"</li> <li>"Use for: data quality checks, join validation"</li> <li>"Filter by indicator: find unmatched records"</li> <li>"Custom name: <code>indicator='source'</code>"</li> <li>"Essential for: ETL pipelines, data validation"</li> <li>"Check match rate: <code>value_counts()</code> on _merge"</li> <li>"Find orphans: <code>merged[merged['_merge']=='right_only']</code>"</li> <li>"Always use with how='outer' for full picture"</li> </ul> </div> </details> <hr> <h3 id=explain-dataframewhere-and-mask-meta-microsoft-interview-question>Explain DataFrame.where() and mask() - Meta, Microsoft Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Conditional Operations</code>, <code>Filtering</code>, <code>Data Replacement</code> | <strong>Asked by:</strong> Meta, Microsoft, Google</p> <details class=success> <summary>View Answer</summary> <p><strong>where()</strong> and <strong>mask()</strong> replace values based on conditions. where() keeps True values, mask() replaces True values. Alternative to boolean indexing for conditional replacement.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span>
    <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>300</span><span class=p>,</span> <span class=mi>400</span><span class=p>,</span> <span class=mi>500</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># 1. where() - Keep values where condition is True</span>
<span class=c1># Replace False values with NaN</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>df</span> <span class=o>&gt;</span> <span class=mi>20</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;where (keep &gt; 20):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 2. where() with replacement value</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>df</span> <span class=o>&gt;</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>where with 0:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 3. mask() - Replace values where condition is True</span>
<span class=c1># Opposite of where()</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>mask</span><span class=p>(</span><span class=n>df</span> <span class=o>&gt;</span> <span class=mi>20</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>mask (replace &gt; 20 with NaN):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 4. mask() with replacement value</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>mask</span><span class=p>(</span><span class=n>df</span> <span class=o>&gt;</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>mask with 0:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 5. Practical Example: Outlier Capping</span>
<span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;values&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>300</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Cap at 50</span>
<span class=n>capped</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;values&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;values&#39;</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>50</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Capped at 50:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>capped</span><span class=p>)</span>

<span class=c1># Or using mask</span>
<span class=n>capped2</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;values&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mask</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;values&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>50</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Same with mask:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>capped2</span><span class=p>)</span>

<span class=c1># 6. Element-wise Operations</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;temperature&#39;</span><span class=p>:</span> <span class=p>[</span><span class=o>-</span><span class=mi>5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>42</span><span class=p>],</span>
    <span class=s1>&#39;humidity&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>20</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>80</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>95</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Replace extreme temperatures</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;temp_adjusted&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;temperature&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
    <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;temperature&#39;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;temperature&#39;</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=mi>40</span><span class=p>)</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Temperature filtering:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># 7. Using Functions</span>
<span class=c1># where/mask can take callable</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;temperature&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Using lambda:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># 8. Multiple Conditions</span>
<span class=n>sales</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;D&#39;</span><span class=p>,</span> <span class=s1>&#39;E&#39;</span><span class=p>],</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span>
    <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>30</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Flag high-value sales</span>
<span class=n>sales</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;Normal&#39;</span>
<span class=n>sales</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>sales</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
    <span class=n>sales</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>sales</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>1000</span><span class=p>,</span>
    <span class=s1>&#39;High Value&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Sales categories:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>sales</span><span class=p>)</span>

<span class=c1># 9. vs Boolean Indexing</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>50</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Boolean indexing (modifies subset)</span>
<span class=n>df_bool</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=n>df_bool</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>df_bool</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Boolean indexing:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_bool</span><span class=p>)</span>

<span class=c1># where (returns new, preserves shape)</span>
<span class=n>df_where</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=n>df_where</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_where</span><span class=p>[</span><span class=s1>&#39;B&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>df_where</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With where:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_where</span><span class=p>)</span>

<span class=c1># 10. Practical: Data Cleaning</span>
<span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=p>[</span><span class=o>-</span><span class=mi>5</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>45</span><span class=p>],</span>
    <span class=s1>&#39;salary&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>50000</span><span class=p>,</span> <span class=o>-</span><span class=mi>10000</span><span class=p>,</span> <span class=mi>80000</span><span class=p>,</span> <span class=mi>90000</span><span class=p>,</span> <span class=mi>1000000</span><span class=p>,</span> <span class=mi>75000</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Valid ranges</span>
<span class=n>data</span><span class=p>[</span><span class=s1>&#39;age_clean&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
    <span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=mi>120</span><span class=p>)</span>
<span class=p>)</span>
<span class=n>data</span><span class=p>[</span><span class=s1>&#39;salary_clean&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;salary&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
    <span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;salary&#39;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;salary&#39;</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=mi>500000</span><span class=p>)</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Data cleaning:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>

<span class=c1># 11. Winsorization</span>
<span class=c1># Cap extreme values</span>
<span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>300</span><span class=p>])</span>

<span class=n>lower</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=mf>0.05</span><span class=p>)</span>
<span class=n>upper</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>quantile</span><span class=p>(</span><span class=mf>0.95</span><span class=p>)</span>

<span class=n>winsorized</span> <span class=o>=</span> <span class=p>(</span><span class=n>data</span>
              <span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>data</span> <span class=o>&gt;=</span> <span class=n>lower</span><span class=p>,</span> <span class=n>lower</span><span class=p>)</span>
              <span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>data</span> <span class=o>&lt;=</span> <span class=n>upper</span><span class=p>,</span> <span class=n>upper</span><span class=p>))</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Winsorized:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>winsorized</span><span class=p>)</span>

<span class=c1># 12. Time Series Example</span>
<span class=n>dates</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>)</span>
<span class=n>ts</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>dates</span><span class=p>,</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>180</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>70</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>55</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Flag anomalies</span>
<span class=n>mean</span> <span class=o>=</span> <span class=n>ts</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
<span class=n>std</span> <span class=o>=</span> <span class=n>ts</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>

<span class=n>ts</span><span class=p>[</span><span class=s1>&#39;anomaly&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;Normal&#39;</span>
<span class=n>ts</span><span class=p>[</span><span class=s1>&#39;anomaly&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>ts</span><span class=p>[</span><span class=s1>&#39;anomaly&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>where</span><span class=p>(</span>
    <span class=nb>abs</span><span class=p>(</span><span class=n>ts</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>mean</span><span class=p>)</span> <span class=o>&lt;=</span> <span class=mi>2</span> <span class=o>*</span> <span class=n>std</span><span class=p>,</span>
    <span class=s1>&#39;Anomaly&#39;</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Anomaly detection:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>ts</span><span class=p>)</span>

<span class=c1># 13. Performance Note</span>
<span class=c1># where/mask are efficient (vectorized)</span>
<span class=n>large_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>100000</span><span class=p>,</span> <span class=mi>3</span><span class=p>),</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>])</span>

<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=c1># where()</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>large_df</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>large_df</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
<span class=n>where_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=c1># Boolean indexing (slower for full replacement)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>temp</span> <span class=o>=</span> <span class=n>large_df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=n>temp</span><span class=p>[</span><span class=n>temp</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
<span class=n>bool_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>where(): </span><span class=si>{</span><span class=n>where_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Boolean: </span><span class=si>{</span><span class=n>bool_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
</code></pre></div> <p><strong>where() vs mask():</strong></p> <table> <thead> <tr> <th>Method</th> <th>Behavior</th> <th>Equivalent</th> </tr> </thead> <tbody> <tr> <td><strong>where(cond)</strong></td> <td>Keep True, replace False</td> <td><code>df[cond]</code></td> </tr> <tr> <td><strong>mask(cond)</strong></td> <td>Replace True, keep False</td> <td><code>df[~cond]</code></td> </tr> </tbody> </table> <p><strong>Use Cases:</strong></p> <table> <thead> <tr> <th>Use Case</th> <th>Method</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>Outlier capping</strong></td> <td>where</td> <td><code>s.where(s &lt;= 100, 100)</code></td> </tr> <tr> <td><strong>Filter &amp; replace</strong></td> <td>where</td> <td><code>df.where(df &gt; 0, 0)</code></td> </tr> <tr> <td><strong>Anomaly removal</strong></td> <td>mask</td> <td><code>df.mask(is_anomaly)</code></td> </tr> <tr> <td><strong>Winsorization</strong></td> <td>where (twice)</td> <td>Cap both tails</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"where(): keep True, replace False with other"</li> <li>"mask(): replace True with other, keep False"</li> <li>"Default other: NaN"</li> <li>"where(cond, value): replace False with value"</li> <li>"Preserves DataFrame shape (vs boolean indexing)"</li> <li>"Vectorized: efficient on large data"</li> <li>"Use for: outlier capping, data cleaning, winsorization"</li> <li>"Can take callable: <code>where(lambda x: x &gt; 0)</code>"</li> <li>"mask() = where(~cond)"</li> </ul> </div> </details> <hr> <h3 id=explain-nlargest-and-nsmallest-amazon-netflix-interview-question>Explain nlargest() and nsmallest() - Amazon, Netflix Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Selection</code>, <code>Sorting</code>, <code>Top-N</code> | <strong>Asked by:</strong> Amazon, Netflix, Google, Meta</p> <details class=success> <summary>View Answer</summary> <p><strong>nlargest()</strong> and <strong>nsmallest()</strong> select top/bottom N rows by column(s). Faster than sorting for small N. Useful for top products, customers, values.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;D&#39;</span><span class=p>,</span> <span class=s1>&#39;E&#39;</span><span class=p>,</span> <span class=s1>&#39;F&#39;</span><span class=p>],</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1000</span><span class=p>,</span> <span class=mi>5000</span><span class=p>,</span> <span class=mi>3000</span><span class=p>,</span> <span class=mi>8000</span><span class=p>,</span> <span class=mi>2000</span><span class=p>,</span> <span class=mi>6000</span><span class=p>],</span>
    <span class=s1>&#39;profit&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>200</span><span class=p>,</span> <span class=mi>1000</span><span class=p>,</span> <span class=mi>600</span><span class=p>,</span> <span class=mi>1500</span><span class=p>,</span> <span class=mi>400</span><span class=p>,</span> <span class=mi>1200</span><span class=p>],</span>
    <span class=s1>&#39;region&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>,</span> <span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;East&#39;</span><span class=p>,</span> <span class=s1>&#39;West&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># 1. Top 3 by Sales</span>
<span class=n>top_sales</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;sales&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Top 3 by sales:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>top_sales</span><span class=p>)</span>

<span class=c1># 2. Bottom 3 by Sales</span>
<span class=n>bottom_sales</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>nsmallest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;sales&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Bottom 3 by sales:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>bottom_sales</span><span class=p>)</span>

<span class=c1># 3. Multiple Columns (Tiebreaker)</span>
<span class=c1># First by sales, then by profit</span>
<span class=n>top_multi</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;sales&#39;</span><span class=p>,</span> <span class=s1>&#39;profit&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 3 by sales, then profit:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>top_multi</span><span class=p>)</span>

<span class=c1># 4. vs sort_values + head</span>
<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=c1># Large dataset</span>
<span class=n>large_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>1000000</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># nlargest (fast)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>large_df</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=s1>&#39;value&#39;</span><span class=p>)</span>
<span class=n>nlargest_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=c1># sort + head (slow)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>large_df</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;value&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
<span class=n>sort_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>nlargest: </span><span class=si>{</span><span class=n>nlargest_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;sort + head: </span><span class=si>{</span><span class=n>sort_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s (</span><span class=si>{</span><span class=n>sort_time</span><span class=o>/</span><span class=n>nlargest_time</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>x slower)&quot;</span><span class=p>)</span>

<span class=c1># 5. Series nlargest/nsmallest</span>
<span class=n>sales_series</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>100</span><span class=p>,</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>300</span><span class=p>,</span> <span class=mi>800</span><span class=p>,</span> <span class=mi>200</span><span class=p>],</span> 
                         <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;D&#39;</span><span class=p>,</span> <span class=s1>&#39;E&#39;</span><span class=p>])</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 3 products:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>sales_series</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>))</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Bottom 2 products:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>sales_series</span><span class=o>.</span><span class=n>nsmallest</span><span class=p>(</span><span class=mi>2</span><span class=p>))</span>

<span class=c1># 6. Practical: Top Customers</span>
<span class=n>customers</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>101</span><span class=p>),</span>
    <span class=s1>&#39;total_spent&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>10000</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span>
    <span class=s1>&#39;orders&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span>
    <span class=s1>&#39;last_order_days&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>365</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># Top 10 spenders</span>
<span class=n>top_customers</span> <span class=o>=</span> <span class=n>customers</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=s1>&#39;total_spent&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 10 customers by spending:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>top_customers</span><span class=p>[[</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=s1>&#39;total_spent&#39;</span><span class=p>,</span> <span class=s1>&#39;orders&#39;</span><span class=p>]])</span>

<span class=c1># Most frequent buyers</span>
<span class=n>frequent_buyers</span> <span class=o>=</span> <span class=n>customers</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=s1>&#39;orders&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 10 frequent buyers:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>frequent_buyers</span><span class=p>[[</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=s1>&#39;orders&#39;</span><span class=p>,</span> <span class=s1>&#39;total_spent&#39;</span><span class=p>]])</span>

<span class=c1># 7. GroupBy + nlargest</span>
<span class=c1># Top 2 products per region</span>
<span class=n>top_per_region</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span>
    <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;sales&#39;</span><span class=p>)</span>
<span class=p>)</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>drop</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 2 products per region:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>top_per_region</span><span class=p>)</span>

<span class=c1># 8. Practical: Stock Analysis</span>
<span class=n>stocks</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;ticker&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;AAPL&#39;</span><span class=p>,</span> <span class=s1>&#39;GOOGL&#39;</span><span class=p>,</span> <span class=s1>&#39;MSFT&#39;</span><span class=p>,</span> <span class=s1>&#39;AMZN&#39;</span><span class=p>,</span> <span class=s1>&#39;TSLA&#39;</span><span class=p>,</span> <span class=s1>&#39;META&#39;</span><span class=p>],</span>
    <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>175</span><span class=p>,</span> <span class=mi>140</span><span class=p>,</span> <span class=mi>380</span><span class=p>,</span> <span class=mi>145</span><span class=p>,</span> <span class=mi>250</span><span class=p>,</span> <span class=mi>350</span><span class=p>],</span>
    <span class=s1>&#39;volume&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>50000000</span><span class=p>,</span> <span class=mi>25000000</span><span class=p>,</span> <span class=mi>30000000</span><span class=p>,</span> <span class=mi>45000000</span><span class=p>,</span> <span class=mi>80000000</span><span class=p>,</span> <span class=mi>20000000</span><span class=p>],</span>
    <span class=s1>&#39;change_pct&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>2.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.2</span><span class=p>,</span> <span class=mf>1.8</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> <span class=mf>5.2</span><span class=p>,</span> <span class=o>-</span><span class=mf>2.1</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Top gainers</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 3 gainers:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>stocks</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;change_pct&#39;</span><span class=p>)[[</span><span class=s1>&#39;ticker&#39;</span><span class=p>,</span> <span class=s1>&#39;change_pct&#39;</span><span class=p>]])</span>

<span class=c1># Top losers</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 3 losers:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>stocks</span><span class=o>.</span><span class=n>nsmallest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;change_pct&#39;</span><span class=p>)[[</span><span class=s1>&#39;ticker&#39;</span><span class=p>,</span> <span class=s1>&#39;change_pct&#39;</span><span class=p>]])</span>

<span class=c1># Most traded</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Most traded:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>stocks</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;volume&#39;</span><span class=p>)[[</span><span class=s1>&#39;ticker&#39;</span><span class=p>,</span> <span class=s1>&#39;volume&#39;</span><span class=p>]])</span>

<span class=c1># 9. Keep Parameter</span>
<span class=c1># Handle duplicates</span>
<span class=n>df_dup</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>,</span> <span class=s1>&#39;D&#39;</span><span class=p>,</span> <span class=s1>&#39;E&#39;</span><span class=p>],</span>
    <span class=s1>&#39;score&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>10</span><span class=p>]</span>
<span class=p>})</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Original with duplicates:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_dup</span><span class=p>)</span>

<span class=c1># keep=&#39;first&#39; (default)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 2 (keep=&#39;first&#39;):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_dup</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;score&#39;</span><span class=p>,</span> <span class=n>keep</span><span class=o>=</span><span class=s1>&#39;first&#39;</span><span class=p>))</span>

<span class=c1># keep=&#39;last&#39;</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 2 (keep=&#39;last&#39;):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_dup</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;score&#39;</span><span class=p>,</span> <span class=n>keep</span><span class=o>=</span><span class=s1>&#39;last&#39;</span><span class=p>))</span>

<span class=c1># keep=&#39;all&#39; (may return more than n)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 2 (keep=&#39;all&#39;):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df_dup</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;score&#39;</span><span class=p>,</span> <span class=n>keep</span><span class=o>=</span><span class=s1>&#39;all&#39;</span><span class=p>))</span>

<span class=c1># 10. Real-World: Sales Leaderboard</span>
<span class=n>sales_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;salesperson&#39;</span><span class=p>:</span> <span class=p>[</span><span class=sa>f</span><span class=s1>&#39;Person_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>51</span><span class=p>)],</span>
    <span class=s1>&#39;q1_sales&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>10000</span><span class=p>,</span> <span class=mi>50000</span><span class=p>,</span> <span class=mi>50</span><span class=p>),</span>
    <span class=s1>&#39;q2_sales&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>10000</span><span class=p>,</span> <span class=mi>50000</span><span class=p>,</span> <span class=mi>50</span><span class=p>),</span>
    <span class=s1>&#39;region&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>,</span> <span class=s1>&#39;East&#39;</span><span class=p>,</span> <span class=s1>&#39;West&#39;</span><span class=p>],</span> <span class=mi>50</span><span class=p>)</span>
<span class=p>})</span>

<span class=n>sales_data</span><span class=p>[</span><span class=s1>&#39;total_sales&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>sales_data</span><span class=p>[</span><span class=s1>&#39;q1_sales&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>sales_data</span><span class=p>[</span><span class=s1>&#39;q2_sales&#39;</span><span class=p>]</span>

<span class=c1># Overall top 10</span>
<span class=n>leaderboard</span> <span class=o>=</span> <span class=n>sales_data</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=s1>&#39;total_sales&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 10 salespeople:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>leaderboard</span><span class=p>[[</span><span class=s1>&#39;salesperson&#39;</span><span class=p>,</span> <span class=s1>&#39;total_sales&#39;</span><span class=p>,</span> <span class=s1>&#39;region&#39;</span><span class=p>]])</span>

<span class=c1># Top 3 per region</span>
<span class=n>regional_leaders</span> <span class=o>=</span> <span class=n>sales_data</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span>
    <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>nlargest</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;total_sales&#39;</span><span class=p>)</span>
<span class=p>)</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>drop</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Top 3 per region:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>regional_leaders</span><span class=p>[[</span><span class=s1>&#39;region&#39;</span><span class=p>,</span> <span class=s1>&#39;salesperson&#39;</span><span class=p>,</span> <span class=s1>&#39;total_sales&#39;</span><span class=p>]])</span>
</code></pre></div> <p><strong>Performance Comparison:</strong></p> <table> <thead> <tr> <th>Dataset Size</th> <th>Top N</th> <th>nlargest()</th> <th>sort_values() + head()</th> </tr> </thead> <tbody> <tr> <td>10K rows</td> <td>10</td> <td>0.001s</td> <td>0.005s (5x slower)</td> </tr> <tr> <td>100K rows</td> <td>10</td> <td>0.005s</td> <td>0.050s (10x slower)</td> </tr> <tr> <td>1M rows</td> <td>10</td> <td>0.05s</td> <td>0.5s (10x slower)</td> </tr> <tr> <td>1M rows</td> <td>100</td> <td>0.08s</td> <td>0.5s (6x slower)</td> </tr> </tbody> </table> <p><strong>When to Use:</strong></p> <table> <thead> <tr> <th>Scenario</th> <th>Best Method</th> </tr> </thead> <tbody> <tr> <td><strong>Top/bottom N (N &lt;&lt; size)</strong></td> <td>nlargest/nsmallest</td> </tr> <tr> <td><strong>Need all sorted</strong></td> <td>sort_values</td> </tr> <tr> <td><strong>Multiple columns</strong></td> <td>Both work, nlargest faster</td> </tr> <tr> <td><strong>Very small N (&lt;100)</strong></td> <td>nlargest (much faster)</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"nlargest(n, 'col'): top N rows by column"</li> <li>"nsmallest(n, 'col'): bottom N rows"</li> <li>"Faster than sort_values + head for small N"</li> <li>"Multiple columns: <code>nlargest(n, ['col1', 'col2'])</code>"</li> <li>"keep parameter: 'first', 'last', 'all' for ties"</li> <li>"Works on Series and DataFrame"</li> <li>"Use for: top products, customers, leaderboards"</li> <li>"O(n log k) vs O(n log n) for sorting"</li> <li>"GroupBy + nlargest: top N per group"</li> </ul> </div> </details> <hr> <h3 id=explain-pandas-rank-method-microsoft-google-interview-question>Explain Pandas rank() Method - Microsoft, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Ranking</code>, <code>Statistics</code>, <code>Order</code> | <strong>Asked by:</strong> Microsoft, Google, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>rank()</strong> assigns ranks to values in Series/DataFrame. Supports multiple methods for handling ties (average, min, max, first, dense). Essential for leaderboards, percentiles, and relative comparisons.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># Sample data with ties</span>
<span class=n>s</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>300</span><span class=p>,</span> <span class=mi>400</span><span class=p>,</span> <span class=mi>400</span><span class=p>,</span> <span class=mi>400</span><span class=p>])</span>

<span class=c1># 1. Default Ranking (average for ties)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Original values:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>s</span><span class=o>.</span><span class=n>values</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Default rank (average):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>s</span><span class=o>.</span><span class=n>rank</span><span class=p>())</span>

<span class=c1># 2. Different Ranking Methods</span>
<span class=n>methods</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;average&#39;</span><span class=p>,</span> <span class=s1>&#39;min&#39;</span><span class=p>,</span> <span class=s1>&#39;max&#39;</span><span class=p>,</span> <span class=s1>&#39;first&#39;</span><span class=p>,</span> <span class=s1>&#39;dense&#39;</span><span class=p>]</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=n>s</span><span class=p>})</span>
<span class=k>for</span> <span class=n>method</span> <span class=ow>in</span> <span class=n>methods</span><span class=p>:</span>
    <span class=n>df</span><span class=p>[</span><span class=sa>f</span><span class=s1>&#39;rank_</span><span class=si>{</span><span class=n>method</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=n>method</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>All ranking methods:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># 3. Ascending vs Descending</span>
<span class=n>scores</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>85</span><span class=p>,</span> <span class=mi>92</span><span class=p>,</span> <span class=mi>78</span><span class=p>,</span> <span class=mi>92</span><span class=p>,</span> <span class=mi>95</span><span class=p>])</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Scores:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>scores</span><span class=o>.</span><span class=n>values</span><span class=p>)</span>

<span class=c1># ascending=True (default): 1 = smallest</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Rank ascending (1 = lowest):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>scores</span><span class=o>.</span><span class=n>rank</span><span class=p>())</span>

<span class=c1># ascending=False: 1 = largest</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Rank descending (1 = highest):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>scores</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>))</span>

<span class=c1># 4. Percentile Ranks</span>
<span class=c1># pct=True: ranks from 0 to 1</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Percentile ranks:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>scores</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>pct</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>

<span class=c1># 5. Practical: Student Grades</span>
<span class=n>students</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>,</span> <span class=s1>&#39;David&#39;</span><span class=p>,</span> <span class=s1>&#39;Eve&#39;</span><span class=p>],</span>
    <span class=s1>&#39;math&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>85</span><span class=p>,</span> <span class=mi>92</span><span class=p>,</span> <span class=mi>78</span><span class=p>,</span> <span class=mi>92</span><span class=p>,</span> <span class=mi>95</span><span class=p>],</span>
    <span class=s1>&#39;english&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>88</span><span class=p>,</span> <span class=mi>85</span><span class=p>,</span> <span class=mi>90</span><span class=p>,</span> <span class=mi>82</span><span class=p>,</span> <span class=mi>95</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Rank by math (1 = best)</span>
<span class=n>students</span><span class=p>[</span><span class=s1>&#39;math_rank&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>students</span><span class=p>[</span><span class=s1>&#39;math&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>method</span><span class=o>=</span><span class=s1>&#39;min&#39;</span><span class=p>)</span>
<span class=n>students</span><span class=p>[</span><span class=s1>&#39;english_rank&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>students</span><span class=p>[</span><span class=s1>&#39;english&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>method</span><span class=o>=</span><span class=s1>&#39;min&#39;</span><span class=p>)</span>

<span class=c1># Overall rank (sum of ranks, lower is better)</span>
<span class=n>students</span><span class=p>[</span><span class=s1>&#39;overall_rank&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>students</span><span class=p>[</span><span class=s1>&#39;math_rank&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>students</span><span class=p>[</span><span class=s1>&#39;english_rank&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>rank</span><span class=p>()</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Student rankings:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>students</span><span class=p>)</span>

<span class=c1># 6. GroupBy Ranking</span>
<span class=n>sales</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;region&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>,</span> <span class=s1>&#39;East&#39;</span><span class=p>,</span> <span class=s1>&#39;East&#39;</span><span class=p>],</span>
    <span class=s1>&#39;salesperson&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Alice&#39;</span><span class=p>,</span> <span class=s1>&#39;Bob&#39;</span><span class=p>,</span> <span class=s1>&#39;Charlie&#39;</span><span class=p>,</span> <span class=s1>&#39;David&#39;</span><span class=p>,</span> <span class=s1>&#39;Eve&#39;</span><span class=p>,</span> <span class=s1>&#39;Frank&#39;</span><span class=p>],</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1000</span><span class=p>,</span> <span class=mi>1500</span><span class=p>,</span> <span class=mi>800</span><span class=p>,</span> <span class=mi>1200</span><span class=p>,</span> <span class=mi>900</span><span class=p>,</span> <span class=mi>1100</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Rank within each region</span>
<span class=n>sales</span><span class=p>[</span><span class=s1>&#39;rank_in_region&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>sales</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;region&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Ranking within regions:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>sales</span><span class=p>)</span>

<span class=c1># 7. Handling NaN</span>
<span class=n>s_nan</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>100</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>300</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span><span class=p>])</span>

<span class=c1># na_option=&#39;keep&#39; (default): NaN stays NaN</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With NaN (keep):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>s_nan</span><span class=o>.</span><span class=n>rank</span><span class=p>())</span>

<span class=c1># na_option=&#39;top&#39;: NaN gets smallest rank</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With NaN (top):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>s_nan</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>na_option</span><span class=o>=</span><span class=s1>&#39;top&#39;</span><span class=p>))</span>

<span class=c1># na_option=&#39;bottom&#39;: NaN gets largest rank</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With NaN (bottom):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>s_nan</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>na_option</span><span class=o>=</span><span class=s1>&#39;bottom&#39;</span><span class=p>))</span>

<span class=c1># 8. Practical: Stock Performance</span>
<span class=n>stocks</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;ticker&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;AAPL&#39;</span><span class=p>,</span> <span class=s1>&#39;GOOGL&#39;</span><span class=p>,</span> <span class=s1>&#39;MSFT&#39;</span><span class=p>,</span> <span class=s1>&#39;AMZN&#39;</span><span class=p>,</span> <span class=s1>&#39;TSLA&#39;</span><span class=p>],</span>
    <span class=s1>&#39;return_1m&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>5.2</span><span class=p>,</span> <span class=o>-</span><span class=mf>1.5</span><span class=p>,</span> <span class=mf>3.8</span><span class=p>,</span> <span class=mf>2.1</span><span class=p>,</span> <span class=mf>8.5</span><span class=p>],</span>
    <span class=s1>&#39;return_6m&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>12.5</span><span class=p>,</span> <span class=mf>8.2</span><span class=p>,</span> <span class=mf>15.1</span><span class=p>,</span> <span class=mf>10.3</span><span class=p>,</span> <span class=mf>25.2</span><span class=p>],</span>
    <span class=s1>&#39;volatility&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mf>0.25</span><span class=p>,</span> <span class=mf>0.30</span><span class=p>,</span> <span class=mf>0.22</span><span class=p>,</span> <span class=mf>0.28</span><span class=p>,</span> <span class=mf>0.45</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Rank returns (higher is better)</span>
<span class=n>stocks</span><span class=p>[</span><span class=s1>&#39;return_1m_rank&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>stocks</span><span class=p>[</span><span class=s1>&#39;return_1m&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=n>stocks</span><span class=p>[</span><span class=s1>&#39;return_6m_rank&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>stocks</span><span class=p>[</span><span class=s1>&#39;return_6m&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

<span class=c1># Rank volatility (lower is better)</span>
<span class=n>stocks</span><span class=p>[</span><span class=s1>&#39;vol_rank&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>stocks</span><span class=p>[</span><span class=s1>&#39;volatility&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>ascending</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=c1># Combined score (lower is better)</span>
<span class=n>stocks</span><span class=p>[</span><span class=s1>&#39;combined_rank&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span>
    <span class=n>stocks</span><span class=p>[</span><span class=s1>&#39;return_1m_rank&#39;</span><span class=p>]</span> <span class=o>+</span> 
    <span class=n>stocks</span><span class=p>[</span><span class=s1>&#39;return_6m_rank&#39;</span><span class=p>]</span> <span class=o>+</span> 
    <span class=n>stocks</span><span class=p>[</span><span class=s1>&#39;vol_rank&#39;</span><span class=p>]</span>
<span class=p>)</span><span class=o>.</span><span class=n>rank</span><span class=p>()</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Stock rankings:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>stocks</span><span class=p>)</span>

<span class=c1># 9. Quantile-based Ranking</span>
<span class=n>values</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>100</span><span class=p>))</span>

<span class=c1># Percentile ranks</span>
<span class=n>values_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=n>values</span><span class=p>,</span>
    <span class=s1>&#39;percentile&#39;</span><span class=p>:</span> <span class=n>values</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>pct</span><span class=o>=</span><span class=kc>True</span><span class=p>),</span>
    <span class=s1>&#39;quartile&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>values</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>pct</span><span class=o>=</span><span class=kc>True</span><span class=p>),</span> <span class=n>q</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>,</span> <span class=s1>&#39;Q3&#39;</span><span class=p>,</span> <span class=s1>&#39;Q4&#39;</span><span class=p>])</span>
<span class=p>})</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Quantile-based ranking:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>values_df</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span>

<span class=c1># 10. Leaderboard Example</span>
<span class=n>leaderboard</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;player&#39;</span><span class=p>:</span> <span class=p>[</span><span class=sa>f</span><span class=s1>&#39;Player_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>&#39;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>11</span><span class=p>)],</span>
    <span class=s1>&#39;score&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1000</span><span class=p>,</span> <span class=mi>1500</span><span class=p>,</span> <span class=mi>1200</span><span class=p>,</span> <span class=mi>1500</span><span class=p>,</span> <span class=mi>1800</span><span class=p>,</span> <span class=mi>900</span><span class=p>,</span> <span class=mi>1500</span><span class=p>,</span> <span class=mi>1200</span><span class=p>,</span> <span class=mi>1000</span><span class=p>,</span> <span class=mi>2000</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Dense ranking (no gaps)</span>
<span class=n>leaderboard</span><span class=p>[</span><span class=s1>&#39;rank_dense&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>leaderboard</span><span class=p>[</span><span class=s1>&#39;score&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s1>&#39;dense&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

<span class=c1># Min ranking (standard)</span>
<span class=n>leaderboard</span><span class=p>[</span><span class=s1>&#39;rank_standard&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>leaderboard</span><span class=p>[</span><span class=s1>&#39;score&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>rank</span><span class=p>(</span><span class=n>method</span><span class=o>=</span><span class=s1>&#39;min&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

<span class=n>leaderboard</span> <span class=o>=</span> <span class=n>leaderboard</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s1>&#39;score&#39;</span><span class=p>,</span> <span class=n>ascending</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Leaderboard:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>leaderboard</span><span class=p>)</span>

<span class=c1># 11. Performance Comparison</span>
<span class=n>large_series</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>1000000</span><span class=p>))</span>

<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>large_series</span><span class=o>.</span><span class=n>rank</span><span class=p>()</span>
<span class=n>rank_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>large_series</span><span class=o>.</span><span class=n>sort_values</span><span class=p>()</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>drop</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=n>sort_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>rank(): </span><span class=si>{</span><span class=n>rank_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;sort: </span><span class=si>{</span><span class=n>sort_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
</code></pre></div> <p><strong>Ranking Methods:</strong></p> <table> <thead> <tr> <th>Method</th> <th>Description</th> <th>Example [100, 200, 200, 300]</th> </tr> </thead> <tbody> <tr> <td><strong>average</strong></td> <td>Average of ranks</td> <td>[1.0, 2.5, 2.5, 4.0]</td> </tr> <tr> <td><strong>min</strong></td> <td>Minimum rank</td> <td>[1, 2, 2, 4]</td> </tr> <tr> <td><strong>max</strong></td> <td>Maximum rank</td> <td>[1, 3, 3, 4]</td> </tr> <tr> <td><strong>first</strong></td> <td>Order they appear</td> <td>[1, 2, 3, 4]</td> </tr> <tr> <td><strong>dense</strong></td> <td>No gaps</td> <td>[1, 2, 2, 3]</td> </tr> </tbody> </table> <p><strong>Key Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Options</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>method</strong></td> <td>average, min, max, first, dense</td> <td>Tie handling</td> </tr> <tr> <td><strong>ascending</strong></td> <td>True, False</td> <td>Rank direction</td> </tr> <tr> <td><strong>pct</strong></td> <td>True, False</td> <td>Percentile ranks (0-1)</td> </tr> <tr> <td><strong>na_option</strong></td> <td>keep, top, bottom</td> <td>NaN handling</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"rank(): assign ranks to values"</li> <li>"ascending=False: 1 = highest (for scores)"</li> <li>"method='min': standard ranking (gaps for ties)"</li> <li>"method='dense': no gaps (1, 2, 2, 3)"</li> <li>"method='first': order of appearance"</li> <li>"pct=True: percentile ranks (0.0 to 1.0)"</li> <li>"Use with groupby(): rank within groups"</li> <li>"na_option: handle NaN ('keep', 'top', 'bottom')"</li> <li>"Use for: leaderboards, percentiles, relative comparisons"</li> </ul> </div> </details> <hr> <h3 id=explain-pdcut-vs-pdqcut-amazon-google-interview-question_1>Explain pd.cut() vs pd.qcut() - Amazon, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Binning</code>, <code>Discretization</code>, <code>Feature Engineering</code> | <strong>Asked by:</strong> Amazon, Google, Meta, Netflix</p> <details class=success> <summary>View Answer</summary> <p><strong>cut()</strong> bins data into equal-width intervals. <strong>qcut()</strong> bins into equal-sized quantiles. cut() for fixed ranges, qcut() for balanced distribution.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>ages</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>55</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>65</span><span class=p>,</span> <span class=mi>70</span><span class=p>,</span> <span class=mi>75</span><span class=p>,</span> <span class=mi>80</span><span class=p>])</span>

<span class=c1># 1. pd.cut() - Equal-Width Bins</span>
<span class=c1># Bins have same width, different counts</span>
<span class=n>age_bins</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>ages</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;cut() - Equal width:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>age_bins</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Value counts:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>age_bins</span><span class=o>.</span><span class=n>value_counts</span><span class=p>()</span><span class=o>.</span><span class=n>sort_index</span><span class=p>())</span>

<span class=c1># 2. pd.qcut() - Equal-Frequency Bins</span>
<span class=c1># Bins have different widths, same counts</span>
<span class=n>age_quantiles</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>ages</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>qcut() - Equal frequency:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>age_quantiles</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Value counts:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>age_quantiles</span><span class=o>.</span><span class=n>value_counts</span><span class=p>()</span><span class=o>.</span><span class=n>sort_index</span><span class=p>())</span>

<span class=c1># 3. Custom Bin Edges (cut)</span>
<span class=n>custom_bins</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>ages</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>35</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span> 
                     <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Child&#39;</span><span class=p>,</span> <span class=s1>&#39;Young Adult&#39;</span><span class=p>,</span> <span class=s1>&#39;Adult&#39;</span><span class=p>,</span> <span class=s1>&#39;Senior&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Custom bins:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=n>ages</span><span class=p>,</span> <span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=n>custom_bins</span><span class=p>}))</span>

<span class=c1># 4. Percentile-based (qcut)</span>
<span class=c1># Quartiles</span>
<span class=n>quartiles</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>ages</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>,</span> <span class=s1>&#39;Q3&#39;</span><span class=p>,</span> <span class=s1>&#39;Q4&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Quartiles:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=n>ages</span><span class=p>,</span> <span class=s1>&#39;quartile&#39;</span><span class=p>:</span> <span class=n>quartiles</span><span class=p>}))</span>

<span class=c1># 5. Practical: Income Brackets</span>
<span class=n>incomes</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>20000</span><span class=p>,</span> <span class=mi>200000</span><span class=p>,</span> <span class=mi>100</span><span class=p>))</span>

<span class=c1># Equal-width bins</span>
<span class=n>income_cut</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>incomes</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Very Low&#39;</span><span class=p>,</span> <span class=s1>&#39;Low&#39;</span><span class=p>,</span> <span class=s1>&#39;Medium&#39;</span><span class=p>,</span> <span class=s1>&#39;High&#39;</span><span class=p>,</span> <span class=s1>&#39;Very High&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Income bins (equal width):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>income_cut</span><span class=o>.</span><span class=n>value_counts</span><span class=p>())</span>

<span class=c1># Equal-frequency bins (balanced)</span>
<span class=n>income_qcut</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>incomes</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Very Low&#39;</span><span class=p>,</span> <span class=s1>&#39;Low&#39;</span><span class=p>,</span> <span class=s1>&#39;Medium&#39;</span><span class=p>,</span> <span class=s1>&#39;High&#39;</span><span class=p>,</span> <span class=s1>&#39;Very High&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Income bins (equal frequency):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>income_qcut</span><span class=o>.</span><span class=n>value_counts</span><span class=p>())</span>

<span class=c1># 6. Include/Exclude Boundaries</span>
<span class=n>scores</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>75</span><span class=p>,</span> <span class=mi>100</span><span class=p>])</span>

<span class=c1># Right edge included (default)</span>
<span class=n>bins_right</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>scores</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span> <span class=n>right</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Right edge included:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>bins_right</span><span class=p>)</span>

<span class=c1># Left edge included</span>
<span class=n>bins_left</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>scores</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span> <span class=n>right</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Left edge included:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>bins_left</span><span class=p>)</span>

<span class=c1># 7. Retbins - Get Bin Edges</span>
<span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>100</span><span class=p>))</span>

<span class=c1># Get bins used</span>
<span class=n>binned</span><span class=p>,</span> <span class=n>bin_edges</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>retbins</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Bin edges:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>bin_edges</span><span class=p>)</span>

<span class=c1># 8. Practical: Credit Score Categories</span>
<span class=n>credit_scores</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>300</span><span class=p>,</span> <span class=mi>850</span><span class=p>,</span> <span class=mi>1000</span><span class=p>))</span>

<span class=c1># Standard credit score ranges</span>
<span class=n>credit_bins</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span>
    <span class=n>credit_scores</span><span class=p>,</span>
    <span class=n>bins</span><span class=o>=</span><span class=p>[</span><span class=mi>300</span><span class=p>,</span> <span class=mi>580</span><span class=p>,</span> <span class=mi>670</span><span class=p>,</span> <span class=mi>740</span><span class=p>,</span> <span class=mi>800</span><span class=p>,</span> <span class=mi>850</span><span class=p>],</span>
    <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Poor&#39;</span><span class=p>,</span> <span class=s1>&#39;Fair&#39;</span><span class=p>,</span> <span class=s1>&#39;Good&#39;</span><span class=p>,</span> <span class=s1>&#39;Very Good&#39;</span><span class=p>,</span> <span class=s1>&#39;Excellent&#39;</span><span class=p>]</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Credit score distribution:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>credit_bins</span><span class=o>.</span><span class=n>value_counts</span><span class=p>()</span><span class=o>.</span><span class=n>sort_index</span><span class=p>())</span>

<span class=c1># 9. Handling Duplicates in qcut</span>
<span class=c1># qcut can fail with many duplicates</span>
<span class=n>data_dup</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>5</span><span class=p>])</span>

<span class=k>try</span><span class=p>:</span>
    <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>data_dup</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
<span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>qcut error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># Solution: duplicates=&#39;drop&#39;</span>
<span class=n>binned_dup</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>data_dup</span><span class=p>,</span> <span class=n>q</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>duplicates</span><span class=o>=</span><span class=s1>&#39;drop&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With duplicates=&#39;drop&#39;:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>binned_dup</span><span class=o>.</span><span class=n>value_counts</span><span class=p>())</span>

<span class=c1># 10. Machine Learning Feature Engineering</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>101</span><span class=p>),</span>
    <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>18</span><span class=p>,</span> <span class=mi>80</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span>
    <span class=s1>&#39;income&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>20000</span><span class=p>,</span> <span class=mi>150000</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span>
    <span class=s1>&#39;spend&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>5000</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># Create features</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;age_group&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>],</span> <span class=n>bins</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span> <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Young&#39;</span><span class=p>,</span> <span class=s1>&#39;Middle&#39;</span><span class=p>,</span> <span class=s1>&#39;Senior&#39;</span><span class=p>])</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;income_quartile&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;income&#39;</span><span class=p>],</span> <span class=n>q</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>,</span> <span class=s1>&#39;Q3&#39;</span><span class=p>,</span> <span class=s1>&#39;Q4&#39;</span><span class=p>])</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;spend_level&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>qcut</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;spend&#39;</span><span class=p>],</span> <span class=n>q</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Low&#39;</span><span class=p>,</span> <span class=s1>&#39;Medium&#39;</span><span class=p>,</span> <span class=s1>&#39;High&#39;</span><span class=p>])</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Feature engineering:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>))</span>

<span class=c1># Distribution</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Feature distributions:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[[</span><span class=s1>&#39;age_group&#39;</span><span class=p>,</span> <span class=s1>&#39;income_quartile&#39;</span><span class=p>,</span> <span class=s1>&#39;spend_level&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>value_counts</span><span class=p>()))</span>
</code></pre></div> <p><strong>cut() vs qcut():</strong></p> <table> <thead> <tr> <th>Aspect</th> <th>cut()</th> <th>qcut()</th> </tr> </thead> <tbody> <tr> <td><strong>Bins</strong></td> <td>Equal width</td> <td>Equal frequency</td> </tr> <tr> <td><strong>Use Case</strong></td> <td>Fixed ranges</td> <td>Balanced groups</td> </tr> <tr> <td><strong>Distribution</strong></td> <td>Uneven</td> <td>Even</td> </tr> <tr> <td><strong>Example</strong></td> <td>Age groups</td> <td>Quartiles</td> </tr> <tr> <td><strong>Custom Edges</strong></td> <td>Yes</td> <td>No (only q)</td> </tr> </tbody> </table> <p><strong>Common Patterns:</strong></p> <table> <thead> <tr> <th>Task</th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td><strong>Age groups</strong></td> <td><code>cut(ages, [0, 18, 65, 100])</code></td> </tr> <tr> <td><strong>Quartiles</strong></td> <td><code>qcut(data, q=4)</code></td> </tr> <tr> <td><strong>Credit scores</strong></td> <td><code>cut(scores, [300, 580, 670, 740, 800, 850])</code></td> </tr> <tr> <td><strong>Income percentiles</strong></td> <td><code>qcut(income, q=10)</code> (deciles)</td> </tr> <tr> <td><strong>Equal groups for ML</strong></td> <td><code>qcut(feature, q=5)</code></td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"cut(): equal-width bins, fixed ranges"</li> <li>"qcut(): equal-frequency bins, quantiles"</li> <li>"cut() bins can have different counts"</li> <li>"qcut() bins have same counts (balanced)"</li> <li>"cut() for: age groups, custom ranges"</li> <li>"qcut() for: quartiles, percentiles, balanced features"</li> <li>"labels: custom category names"</li> <li>"retbins=True: return bin edges"</li> <li>"qcut with duplicates: use duplicates='drop'"</li> <li>"Use for: feature engineering, binning, discretization"</li> </ul> </div> </details> <hr> <h3 id=explain-pandas-cumsum-cumprod-cummax-cummin-meta-microsoft-interview-question>Explain Pandas cumsum(), cumprod(), cummax(), cummin() - Meta, Microsoft Interview Question</h3> <p><strong>Difficulty:</strong> üü¢ Easy | <strong>Tags:</strong> <code>Cumulative Operations</code>, <code>Time Series</code>, <code>Running Totals</code> | <strong>Asked by:</strong> Meta, Microsoft, Amazon, Google</p> <details class=success> <summary>View Answer</summary> <p><strong>Cumulative functions</strong> compute running totals, products, max, min. Essential for time series analysis, running totals, cumulative statistics, and financial calculations.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>])</span>

<span class=c1># 1. cumsum() - Cumulative Sum</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Original:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>values</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>cumsum():&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>cumsum</span><span class=p>()</span><span class=o>.</span><span class=n>values</span><span class=p>)</span>
<span class=c1># [1, 3, 6, 10, 15]</span>

<span class=c1># 2. cumprod() - Cumulative Product</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>cumprod():&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>cumprod</span><span class=p>()</span><span class=o>.</span><span class=n>values</span><span class=p>)</span>
<span class=c1># [1, 2, 6, 24, 120]</span>

<span class=c1># 3. cummax() - Cumulative Maximum</span>
<span class=n>data_random</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>6</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Original:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>data_random</span><span class=o>.</span><span class=n>values</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>cummax():&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>data_random</span><span class=o>.</span><span class=n>cummax</span><span class=p>()</span><span class=o>.</span><span class=n>values</span><span class=p>)</span>
<span class=c1># [3, 3, 4, 4, 5, 5, 6]</span>

<span class=c1># 4. cummin() - Cumulative Minimum</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>cummin():&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>data_random</span><span class=o>.</span><span class=n>cummin</span><span class=p>()</span><span class=o>.</span><span class=n>values</span><span class=p>)</span>
<span class=c1># [3, 1, 1, 1, 1, 1, 1]</span>

<span class=c1># 5. Practical: Running Total Sales</span>
<span class=n>sales</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>7</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>),</span>
    <span class=s1>&#39;daily_sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>120</span><span class=p>,</span> <span class=mi>180</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>160</span><span class=p>,</span> <span class=mi>190</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>sales</span><span class=p>[</span><span class=s1>&#39;cumulative_sales&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>sales</span><span class=p>[</span><span class=s1>&#39;daily_sales&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cumsum</span><span class=p>()</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Running sales total:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>sales</span><span class=p>)</span>

<span class=c1># 6. Financial: Cumulative Returns</span>
<span class=n>returns</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mf>0.05</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.02</span><span class=p>,</span> <span class=mf>0.03</span><span class=p>,</span> <span class=mf>0.01</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.04</span><span class=p>])</span>

<span class=c1># Cumulative product for compound returns</span>
<span class=n>cumulative_return</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>returns</span><span class=p>)</span><span class=o>.</span><span class=n>cumprod</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Daily returns:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>returns</span><span class=o>.</span><span class=n>values</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Cumulative returns:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>cumulative_return</span><span class=o>.</span><span class=n>values</span><span class=p>)</span>

<span class=c1># 7. Peak Detection (cummax)</span>
<span class=n>stock_prices</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>100</span><span class=p>,</span> <span class=mi>105</span><span class=p>,</span> <span class=mi>103</span><span class=p>,</span> <span class=mi>108</span><span class=p>,</span> <span class=mi>110</span><span class=p>,</span> <span class=mi>107</span><span class=p>,</span> <span class=mi>115</span><span class=p>,</span> <span class=mi>112</span><span class=p>])</span>

<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=n>stock_prices</span><span class=p>,</span>
    <span class=s1>&#39;peak&#39;</span><span class=p>:</span> <span class=n>stock_prices</span><span class=o>.</span><span class=n>cummax</span><span class=p>()</span>
<span class=p>})</span>
<span class=n>df</span><span class=p>[</span><span class=s1>&#39;drawdown&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;price&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;peak&#39;</span><span class=p>])</span> <span class=o>/</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;peak&#39;</span><span class=p>]</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Drawdown analysis:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1># 8. GroupBy Cumulative</span>
<span class=n>orders</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;customer&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>],</span>
    <span class=s1>&#39;amount&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>300</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>orders</span><span class=p>[</span><span class=s1>&#39;cumulative_per_customer&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>orders</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;customer&#39;</span><span class=p>)[</span><span class=s1>&#39;amount&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cumsum</span><span class=p>()</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Cumulative per customer:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>orders</span><span class=p>)</span>

<span class=c1># 9. Time Series: Running Metrics</span>
<span class=n>ts</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>),</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
<span class=p>})</span>

<span class=n>ts</span><span class=p>[</span><span class=s1>&#39;running_total&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>ts</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cumsum</span><span class=p>()</span>
<span class=n>ts</span><span class=p>[</span><span class=s1>&#39;running_avg&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>ts</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>expanding</span><span class=p>()</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
<span class=n>ts</span><span class=p>[</span><span class=s1>&#39;running_max&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>ts</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cummax</span><span class=p>()</span>
<span class=n>ts</span><span class=p>[</span><span class=s1>&#39;running_min&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>ts</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cummin</span><span class=p>()</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Time series running metrics:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>ts</span><span class=p>)</span>

<span class=c1># 10. Practical: Inventory Tracking</span>
<span class=n>inventory</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;transaction&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Sale&#39;</span><span class=p>,</span> <span class=s1>&#39;Purchase&#39;</span><span class=p>,</span> <span class=s1>&#39;Sale&#39;</span><span class=p>,</span> <span class=s1>&#39;Sale&#39;</span><span class=p>,</span> <span class=s1>&#39;Purchase&#39;</span><span class=p>,</span> <span class=s1>&#39;Sale&#39;</span><span class=p>],</span>
    <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=p>[</span><span class=o>-</span><span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=o>-</span><span class=mi>15</span><span class=p>,</span> <span class=o>-</span><span class=mi>20</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=o>-</span><span class=mi>12</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>inventory</span><span class=p>[</span><span class=s1>&#39;stock_level&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>100</span> <span class=o>+</span> <span class=n>inventory</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cumsum</span><span class=p>()</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Inventory levels:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>inventory</span><span class=p>)</span>

<span class=c1># 11. Year-to-Date Calculations</span>
<span class=n>monthly</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;month&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;MS&#39;</span><span class=p>),</span>
    <span class=s1>&#39;revenue&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>50000</span><span class=p>,</span> <span class=mi>100000</span><span class=p>,</span> <span class=mi>12</span><span class=p>)</span>
<span class=p>})</span>

<span class=n>monthly</span><span class=p>[</span><span class=s1>&#39;ytd_revenue&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>monthly</span><span class=p>[</span><span class=s1>&#39;revenue&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cumsum</span><span class=p>()</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Year-to-date revenue:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>monthly</span><span class=p>)</span>

<span class=c1># 12. Performance Comparison</span>
<span class=n>large_series</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=mi>1000000</span><span class=p>))</span>

<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=c1># cumsum (fast, O(n))</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>large_series</span><span class=o>.</span><span class=n>cumsum</span><span class=p>()</span>
<span class=n>cumsum_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=c1># Manual cumsum (slow)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>result</span> <span class=o>=</span> <span class=p>[]</span>
<span class=n>total</span> <span class=o>=</span> <span class=mi>0</span>
<span class=k>for</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>large_series</span><span class=p>:</span>
    <span class=n>total</span> <span class=o>+=</span> <span class=n>val</span>
    <span class=n>result</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>total</span><span class=p>)</span>
<span class=n>manual_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>cumsum(): </span><span class=si>{</span><span class=n>cumsum_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Manual: </span><span class=si>{</span><span class=n>manual_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s (</span><span class=si>{</span><span class=n>manual_time</span><span class=o>/</span><span class=n>cumsum_time</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>x slower)&quot;</span><span class=p>)</span>
</code></pre></div> <p><strong>Cumulative Functions:</strong></p> <table> <thead> <tr> <th>Function</th> <th>Description</th> <th>Example [1,2,3,4]</th> </tr> </thead> <tbody> <tr> <td><strong>cumsum()</strong></td> <td>Running sum</td> <td>[1, 3, 6, 10]</td> </tr> <tr> <td><strong>cumprod()</strong></td> <td>Running product</td> <td>[1, 2, 6, 24]</td> </tr> <tr> <td><strong>cummax()</strong></td> <td>Running maximum</td> <td>[1, 2, 3, 4]</td> </tr> <tr> <td><strong>cummin()</strong></td> <td>Running minimum</td> <td>[1, 1, 1, 1]</td> </tr> </tbody> </table> <p><strong>Common Use Cases:</strong></p> <table> <thead> <tr> <th>Use Case</th> <th>Function</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>Running totals</strong></td> <td>cumsum()</td> <td>Sales YTD</td> </tr> <tr> <td><strong>Compound returns</strong></td> <td>cumprod()</td> <td>Investment growth</td> </tr> <tr> <td><strong>Peak tracking</strong></td> <td>cummax()</td> <td>All-time high</td> </tr> <tr> <td><strong>Drawdown</strong></td> <td>price - cummax()</td> <td>Portfolio decline</td> </tr> <tr> <td><strong>Inventory</strong></td> <td>cumsum()</td> <td>Stock levels</td> </tr> <tr> <td><strong>Streak tracking</strong></td> <td>Custom with cumsum</td> <td>Winning streaks</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"cumsum(): running sum/total"</li> <li>"cumprod(): running product (compound growth)"</li> <li>"cummax(): running maximum (peak)"</li> <li>"cummin(): running minimum (trough)"</li> <li>"Use with groupby(): cumulative per group"</li> <li>"Financial: cumprod() for compound returns"</li> <li>"Drawdown: price - cummax()"</li> <li>"O(n) complexity: efficient"</li> <li>"Common in: time series, finance, inventory"</li> </ul> </div> </details> <hr> <h3 id=explain-pdconcat-axis-parameter-google-amazon-interview-question>Explain pd.concat() axis Parameter - Google, Amazon Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Concatenation</code>, <code>Joining</code>, <code>Data Combination</code> | <strong>Asked by:</strong> Google, Amazon, Meta, Microsoft</p> <details class=success> <summary>View Answer</summary> <p><strong>concat() axis parameter</strong> controls concatenation direction. <strong>axis=0</strong> (default) stacks vertically (rows). <strong>axis=1</strong> stacks horizontally (columns). Essential for combining datasets.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=n>df1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>df2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>],</span>
    <span class=s1>&#39;B&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>12</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>df3</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>13</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=mi>15</span><span class=p>],</span>
    <span class=s1>&#39;D&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>16</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=mi>18</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># 1. axis=0 (Vertical Stacking - Rows)</span>
<span class=n>result_v</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Vertical concatenation (axis=0):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result_v</span><span class=p>)</span>

<span class=c1># Reset index</span>
<span class=n>result_v_reset</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With ignore_index=True:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result_v_reset</span><span class=p>)</span>

<span class=c1># 2. axis=1 (Horizontal Stacking - Columns)</span>
<span class=n>result_h</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df3</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Horizontal concatenation (axis=1):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result_h</span><span class=p>)</span>

<span class=c1># 3. Mismatched Indexes</span>
<span class=n>df_a</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;X&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]},</span> <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>])</span>
<span class=n>df_b</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;Y&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]},</span> <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;b&#39;</span><span class=p>,</span> <span class=s1>&#39;c&#39;</span><span class=p>,</span> <span class=s1>&#39;d&#39;</span><span class=p>])</span>

<span class=c1># axis=1: outer join (default)</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df_a</span><span class=p>,</span> <span class=n>df_b</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Mismatched indexes (axis=1):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>

<span class=c1># axis=1 with inner join</span>
<span class=n>result_inner</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df_a</span><span class=p>,</span> <span class=n>df_b</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>join</span><span class=o>=</span><span class=s1>&#39;inner&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With join=&#39;inner&#39;:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result_inner</span><span class=p>)</span>

<span class=c1># 4. Multiple DataFrames</span>
<span class=n>df_list</span> <span class=o>=</span> <span class=p>[</span>
    <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]}),</span>
    <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]}),</span>
    <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]})</span>
<span class=p>]</span>

<span class=c1># Vertical</span>
<span class=n>combined_v</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span><span class=n>df_list</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Multiple DataFrames (vertical):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>combined_v</span><span class=p>)</span>

<span class=c1># 5. Practical: Combining Regional Data</span>
<span class=n>north</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>],</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>150</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>south</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;product&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=s1>&#39;C&#39;</span><span class=p>],</span>
    <span class=s1>&#39;sales&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>120</span><span class=p>,</span> <span class=mi>180</span><span class=p>,</span> <span class=mi>160</span><span class=p>]</span>
<span class=p>})</span>

<span class=c1># Vertical (add rows)</span>
<span class=n>all_regions_v</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>north</span><span class=p>,</span> <span class=n>south</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>keys</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Regional data (vertical):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>all_regions_v</span><span class=p>)</span>

<span class=c1># Horizontal (add columns)</span>
<span class=n>all_regions_h</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span>
    <span class=p>[</span><span class=n>north</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s1>&#39;product&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>],</span> 
     <span class=n>south</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s1>&#39;product&#39;</span><span class=p>)[</span><span class=s1>&#39;sales&#39;</span><span class=p>]],</span> 
    <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> 
    <span class=n>keys</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;North&#39;</span><span class=p>,</span> <span class=s1>&#39;South&#39;</span><span class=p>]</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Regional data (horizontal):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>all_regions_h</span><span class=p>)</span>

<span class=c1># 6. Keys Parameter</span>
<span class=n>q1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;revenue&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>]})</span>
<span class=n>q2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;revenue&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>150</span><span class=p>,</span> <span class=mi>250</span><span class=p>]})</span>

<span class=n>quarterly</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>q1</span><span class=p>,</span> <span class=n>q2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>keys</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>])</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With keys (MultiIndex):&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>quarterly</span><span class=p>)</span>

<span class=c1># 7. Names Parameter</span>
<span class=n>quarterly_named</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span>
    <span class=p>[</span><span class=n>q1</span><span class=p>,</span> <span class=n>q2</span><span class=p>],</span> 
    <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> 
    <span class=n>keys</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Q1&#39;</span><span class=p>,</span> <span class=s1>&#39;Q2&#39;</span><span class=p>],</span>
    <span class=n>names</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Quarter&#39;</span><span class=p>,</span> <span class=s1>&#39;ID&#39;</span><span class=p>]</span>
<span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>With names:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>quarterly_named</span><span class=p>)</span>

<span class=c1># 8. Practical: Time Series Concatenation</span>
<span class=n>jan</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>),</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>13</span><span class=p>,</span> <span class=mi>14</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>feb</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;date&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=s1>&#39;2024-02-01&#39;</span><span class=p>,</span> <span class=n>periods</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>),</span>
    <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>15</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=mi>17</span><span class=p>,</span> <span class=mi>18</span><span class=p>]</span>
<span class=p>})</span>

<span class=n>full_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>jan</span><span class=p>,</span> <span class=n>feb</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Time series concatenation:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>full_data</span><span class=p>)</span>

<span class=c1># 9. Verify No Data Loss</span>
<span class=k>def</span><span class=w> </span><span class=nf>safe_concat</span><span class=p>(</span><span class=n>dfs</span><span class=p>,</span> <span class=n>axis</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Concat with verification.&quot;&quot;&quot;</span>
    <span class=n>result</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span><span class=n>dfs</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=n>axis</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>axis</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
        <span class=n>expected_rows</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>)</span> <span class=k>for</span> <span class=n>df</span> <span class=ow>in</span> <span class=n>dfs</span><span class=p>)</span>
        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>result</span><span class=p>)</span> <span class=o>==</span> <span class=n>expected_rows</span><span class=p>,</span> <span class=s2>&quot;Row count mismatch!&quot;</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>expected_cols</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>)</span> <span class=k>for</span> <span class=n>df</span> <span class=ow>in</span> <span class=n>dfs</span><span class=p>)</span>
        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>columns</span><span class=p>)</span> <span class=o>==</span> <span class=n>expected_cols</span><span class=p>,</span> <span class=s2>&quot;Column count mismatch!&quot;</span>

    <span class=k>return</span> <span class=n>result</span>

<span class=n>result</span> <span class=o>=</span> <span class=n>safe_concat</span><span class=p>([</span><span class=n>df1</span><span class=p>,</span> <span class=n>df2</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Safe concat: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># 10. Performance Comparison</span>
<span class=n>dfs</span> <span class=o>=</span> <span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1000</span><span class=p>)})</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100</span><span class=p>)]</span>

<span class=kn>import</span><span class=w> </span><span class=nn>time</span>

<span class=c1># concat (fast)</span>
<span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
<span class=n>_</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span><span class=n>dfs</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
<span class=n>concat_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>

<span class=c1># append (deprecated, slow)</span>
<span class=c1># result = dfs[0]</span>
<span class=c1># for df in dfs[1:]:</span>
<span class=c1>#     result = result.append(df)</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>concat time: </span><span class=si>{</span><span class=n>concat_time</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>s&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;(append is deprecated, use concat)&quot;</span><span class=p>)</span>
</code></pre></div> <p><strong>axis Parameter:</strong></p> <table> <thead> <tr> <th>axis</th> <th>Direction</th> <th>Stacking</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>0</strong></td> <td>Vertical</td> <td>Add rows</td> <td>Combine datasets</td> </tr> <tr> <td><strong>1</strong></td> <td>Horizontal</td> <td>Add columns</td> <td>Add features</td> </tr> </tbody> </table> <p><strong>Common Parameters:</strong></p> <table> <thead> <tr> <th>Parameter</th> <th>Purpose</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>axis</strong></td> <td>Direction (0=rows, 1=cols)</td> <td><code>axis=0</code></td> </tr> <tr> <td><strong>ignore_index</strong></td> <td>Reset index</td> <td><code>ignore_index=True</code></td> </tr> <tr> <td><strong>keys</strong></td> <td>Add MultiIndex</td> <td><code>keys=['A', 'B']</code></td> </tr> <tr> <td><strong>join</strong></td> <td>'outer' or 'inner'</td> <td><code>join='inner'</code></td> </tr> <tr> <td><strong>names</strong></td> <td>Name MultiIndex levels</td> <td><code>names=['level1']</code></td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"axis=0: vertical stacking (add rows)"</li> <li>"axis=1: horizontal stacking (add columns)"</li> <li>"ignore_index=True: reset index"</li> <li>"join='outer': keep all (default)"</li> <li>"join='inner': keep common only"</li> <li>"keys: add MultiIndex for source tracking"</li> <li>"Use for: combining datasets, regional data"</li> <li>"axis=0 + ignore_index: clean row numbers"</li> <li>"axis=1: must have compatible indexes"</li> <li>"Prefer concat over append (deprecated)"</li> </ul> </div> </details> <hr> <h3 id=explain-pandas-sparse-data-structures-netflix-google-interview-question>Explain Pandas Sparse Data Structures - Netflix, Google Interview Question</h3> <p><strong>Difficulty:</strong> üü° Medium | <strong>Tags:</strong> <code>Memory Optimization</code>, <code>Sparse Arrays</code>, <code>Performance</code> | <strong>Asked by:</strong> Netflix, Google, Amazon</p> <details class=success> <summary>View Answer</summary> <p><strong>Sparse arrays</strong> store only non-zero/non-default values, saving memory for mostly-empty data. Essential for one-hot encoding, matrices with many zeros, and large categorical features.</p> <p><strong>Complete Examples:</strong></p> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>

<span class=c1># 1. Create Sparse Array</span>
<span class=c1># Most values are 0 (or another fill_value)</span>
<span class=n>dense</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>

<span class=c1># Convert to sparse</span>
<span class=n>sparse</span> <span class=o>=</span> <span class=n>dense</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>SparseDtype</span><span class=p>(</span><span class=s2>&quot;int64&quot;</span><span class=p>,</span> <span class=n>fill_value</span><span class=o>=</span><span class=mi>0</span><span class=p>))</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Dense memory:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>dense</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2> bytes&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Sparse memory:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>sparse</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2> bytes&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Memory savings: </span><span class=si>{</span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>sparse</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>/</span><span class=n>dense</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>

<span class=c1># 2. Sparse DataFrame</span>
<span class=c1># One-hot encoded data (mostly zeros)</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;A&#39;</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Categorical</span><span class=p>([</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=s1>&#39;dog&#39;</span><span class=p>,</span> <span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=s1>&#39;bird&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># Dense one-hot encoding</span>
<span class=n>dense_dummies</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>])</span>

<span class=c1># Sparse one-hot encoding</span>
<span class=n>sparse_dummies</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;A&#39;</span><span class=p>],</span> <span class=n>sparse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>One-hot encoding:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Dense: </span><span class=si>{</span><span class=n>dense_dummies</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2> bytes&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Sparse: </span><span class=si>{</span><span class=n>sparse_dummies</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2> bytes&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Savings: </span><span class=si>{</span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>sparse_dummies</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=o>/</span><span class=n>dense_dummies</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>())</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>

<span class=c1># 3. SparseArray Properties</span>
<span class=n>sparse_arr</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>arrays</span><span class=o>.</span><span class=n>SparseArray</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Sparse array:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Values: </span><span class=si>{</span><span class=n>sparse_arr</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Density: </span><span class=si>{</span><span class=n>sparse_arr</span><span class=o>.</span><span class=n>density</span><span class=si>:</span><span class=s2>.2%</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Fill value: </span><span class=si>{</span><span class=n>sparse_arr</span><span class=o>.</span><span class=n>fill_value</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Non-zero count: </span><span class=si>{</span><span class=n>sparse_arr</span><span class=o>.</span><span class=n>npoints</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># 4. Operations on Sparse Data</span>
<span class=n>s1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>SparseDtype</span><span class=p>(</span><span class=s2>&quot;int64&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
<span class=n>s2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>SparseDtype</span><span class=p>(</span><span class=s2>&quot;int64&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>

<span class=c1># Arithmetic (stays sparse)</span>
<span class=n>result</span> <span class=o>=</span> <span class=n>s1</span> <span class=o>+</span> <span class=n>s2</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Arithmetic on sparse:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Result is sparse: </span><span class=si>{</span><span class=nb>isinstance</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>dtype</span><span class=p>,</span><span class=w> </span><span class=n>pd</span><span class=o>.</span><span class=n>SparseDtype</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># 5. Practical: User-Item Matrix</span>
<span class=c1># Typical recommendation system matrix (very sparse)</span>
<span class=n>users</span> <span class=o>=</span> <span class=mi>10000</span>
<span class=n>items</span> <span class=o>=</span> <span class=mi>1000</span>

<span class=c1># Simulate ratings (only 1% have ratings)</span>
<span class=n>n_ratings</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>users</span> <span class=o>*</span> <span class=n>items</span> <span class=o>*</span> <span class=mf>0.01</span><span class=p>)</span>
<span class=n>user_ids</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>users</span><span class=p>,</span> <span class=n>n_ratings</span><span class=p>)</span>
<span class=n>item_ids</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>items</span><span class=p>,</span> <span class=n>n_ratings</span><span class=p>)</span>
<span class=n>ratings</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=n>n_ratings</span><span class=p>)</span>

<span class=c1># Dense matrix (BAD for sparse data)</span>
<span class=c1># Would need: users * items * 8 bytes = 80 MB</span>

<span class=c1># Sparse representation (GOOD)</span>
<span class=n>sparse_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_ids</span><span class=p>,</span>
    <span class=s1>&#39;item_id&#39;</span><span class=p>:</span> <span class=n>item_ids</span><span class=p>,</span>
    <span class=s1>&#39;rating&#39;</span><span class=p>:</span> <span class=n>ratings</span>
<span class=p>})</span>

<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Sparse ratings:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Memory: </span><span class=si>{</span><span class=n>sparse_df</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1024</span><span class=o>**</span><span class=mi>2</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;vs full matrix: ~</span><span class=si>{</span><span class=n>users</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>items</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>8</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1024</span><span class=o>**</span><span class=mi>2</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> MB&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Savings: ~</span><span class=si>{</span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>sparse_df</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=o>/</span><span class=p>(</span><span class=n>users</span><span class=o>*</span><span class=n>items</span><span class=o>*</span><span class=mi>8</span><span class=p>))</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.1f</span><span class=si>}</span><span class=s2>%&quot;</span><span class=p>)</span>

<span class=c1># 6. Convert Between Dense and Sparse</span>
<span class=n>dense</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span>

<span class=c1># To sparse</span>
<span class=n>sparse</span> <span class=o>=</span> <span class=n>dense</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>SparseDtype</span><span class=p>(</span><span class=s2>&quot;int64&quot;</span><span class=p>,</span> <span class=n>fill_value</span><span class=o>=</span><span class=mi>0</span><span class=p>))</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Converted to sparse:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>sparse</span><span class=p>)</span>

<span class=c1># Back to dense</span>
<span class=n>dense_again</span> <span class=o>=</span> <span class=n>sparse</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s2>&quot;int64&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Back to dense:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>dense_again</span><span class=p>)</span>

<span class=c1># 7. Sparse with Different Fill Values</span>
<span class=c1># If most values are -1</span>
<span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>([</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>])</span>
<span class=n>sparse_neg</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>SparseDtype</span><span class=p>(</span><span class=s2>&quot;int64&quot;</span><span class=p>,</span> <span class=n>fill_value</span><span class=o>=-</span><span class=mi>1</span><span class=p>))</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Sparse with fill_value=-1:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>sparse_neg</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Density: </span><span class=si>{</span><span class=n>sparse_neg</span><span class=o>.</span><span class=n>density</span><span class=si>:</span><span class=s2>.2%</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

<span class=c1># 8. Practical: Feature Engineering</span>
<span class=c1># High-cardinality categorical ‚Üí sparse one-hot</span>
<span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
    <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1000</span><span class=p>),</span>
    <span class=s1>&#39;country&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;US&#39;</span><span class=p>,</span> <span class=s1>&#39;UK&#39;</span><span class=p>,</span> <span class=s1>&#39;CA&#39;</span><span class=p>,</span> <span class=s1>&#39;AU&#39;</span><span class=p>,</span> <span class=s1>&#39;DE&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>1000</span><span class=p>)</span>
<span class=p>})</span>

<span class=c1># Sparse one-hot encoding</span>
<span class=n>country_sparse</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;country&#39;</span><span class=p>],</span> <span class=n>prefix</span><span class=o>=</span><span class=s1>&#39;country&#39;</span><span class=p>,</span> <span class=n>sparse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Sparse feature engineering:&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Shape: </span><span class=si>{</span><span class=n>country_sparse</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Memory: </span><span class=si>{</span><span class=n>country_sparse</span><span class=o>.</span><span class=n>memory_usage</span><span class=p>(</span><span class=n>deep</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>1024</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2> KB&quot;</span><span class=p>)</span>

<span class=c1># 9. When to Use Sparse</span>
<span class=k>def</span><span class=w> </span><span class=nf>analyze_sparsity</span><span class=p>(</span><span class=n>series</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Check if sparse makes sense.&quot;&quot;&quot;</span>
    <span class=n>zero_count</span> <span class=o>=</span> <span class=p>(</span><span class=n>series</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
    <span class=n>total</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>series</span><span class=p>)</span>
    <span class=n>sparsity</span> <span class=o>=</span> <span class=n>zero_count</span> <span class=o>/</span> <span class=n>total</span>

    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Sparsity: </span><span class=si>{</span><span class=n>sparsity</span><span class=si>:</span><span class=s2>.1%</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>sparsity</span> <span class=o>&gt;</span> <span class=mf>0.9</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úì Good candidate for sparse&quot;</span><span class=p>)</span>
    <span class=k>elif</span> <span class=n>sparsity</span> <span class=o>&gt;</span> <span class=mf>0.5</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚ö† Maybe use sparse&quot;</span><span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;‚úó Not sparse enough&quot;</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>sparsity</span>

<span class=n>data1</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1000</span><span class=p>))</span>  <span class=c1># 50% zeros</span>
<span class=n>data2</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=mi>1000</span><span class=p>))</span>  <span class=c1># 90% zeros</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Data 1:&quot;</span><span class=p>)</span>
<span class=n>analyze_sparsity</span><span class=p>(</span><span class=n>data1</span><span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Data 2:&quot;</span><span class=p>)</span>
<span class=n>analyze_sparsity</span><span class=p>(</span><span class=n>data2</span><span class=p>)</span>

<span class=c1># 10. Limitations</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>=== Sparse Limitations ===&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;- Arithmetic can densify results&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;- Some operations require conversion to dense&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;- Not all pandas functions support sparse&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;- Best for: ‚â•90</span><span class=si>% s</span><span class=s2>parsity&quot;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=s2>&quot;- Use cases: one-hot encoding, user-item matrices, NLP features&quot;</span><span class=p>)</span>
</code></pre></div> <p><strong>When to Use Sparse:</strong></p> <table> <thead> <tr> <th>Sparsity</th> <th>Recommendation</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><strong>&gt;95%</strong></td> <td>Definitely use sparse</td> <td>User-item matrix</td> </tr> <tr> <td><strong>90-95%</strong></td> <td>Likely beneficial</td> <td>One-hot encoding</td> </tr> <tr> <td><strong>50-90%</strong></td> <td>Maybe</td> <td>Depends on operations</td> </tr> <tr> <td><strong>&lt;50%</strong></td> <td>Don't use sparse</td> <td>Regular data</td> </tr> </tbody> </table> <p><strong>Memory Comparison:</strong></p> <table> <thead> <tr> <th>Data</th> <th>Dense</th> <th>Sparse</th> <th>Savings</th> </tr> </thead> <tbody> <tr> <td><strong>99% zeros</strong></td> <td>1 GB</td> <td>~10 MB</td> <td>~99%</td> </tr> <tr> <td><strong>95% zeros</strong></td> <td>1 GB</td> <td>~50 MB</td> <td>~95%</td> </tr> <tr> <td><strong>90% zeros</strong></td> <td>1 GB</td> <td>~100 MB</td> <td>~90%</td> </tr> </tbody> </table> <p><strong>Interview Insights:</strong></p> <div class="admonition tip"> <p class=admonition-title>Interviewer's Insight</p> <ul> <li>"Sparse: store only non-zero/non-default values"</li> <li>"Memory savings: proportional to sparsity"</li> <li>"pd.get_dummies(sparse=True): sparse one-hot"</li> <li>"SparseDtype(dtype, fill_value): specify type"</li> <li>"Use when: &gt;90% same value (often zeros)"</li> <li>"density: fraction of non-sparse values"</li> <li>"npoints: count of non-sparse values"</li> <li>"Use cases: one-hot encoding, user-item matrix, NLP"</li> <li>"Limitation: some ops require densification"</li> <li>"Trade-off: memory vs computation speed"</li> </ul> </div> </details> <hr> <h2 id=questions-asked-in-google-interview>Questions asked in Google interview</h2> <ul> <li>How would you optimize a Pandas operation running slowly on large dataset?</li> <li>Explain the difference between merge() and join()</li> <li>Write code to calculate rolling averages with different window sizes</li> <li>How would you handle a DataFrame with 100 million rows?</li> <li>Explain memory optimization techniques</li> <li>Write code to perform complex GroupBy with multiple aggregations</li> <li>Explain the internal data structure of DataFrame</li> <li>How would you implement feature engineering pipelines?</li> <li>Write code to calculate year-over-year growth</li> <li>Explain vectorized operations and their importance</li> <li>How to handle SettingWithCopyWarning?</li> <li>Write code to perform window functions similar to SQL</li> </ul> <h2 id=questions-asked-in-amazon-interview>Questions asked in Amazon interview</h2> <ul> <li>Write code to merge multiple DataFrames with different schemas</li> <li>How would you calculate year-over-year growth?</li> <li>Explain how to handle time series data with irregular intervals</li> <li>Write code to identify and remove duplicate records</li> <li>How would you implement a moving average crossover strategy?</li> <li>Explain the difference between transform() and apply()</li> <li>Write code to pivot data for sales analysis</li> <li>How would you handle categorical variables with high cardinality?</li> <li>Explain how to optimize for memory efficiency</li> <li>Write code to perform cohort analysis</li> </ul> <h2 id=questions-asked-in-meta-interview>Questions asked in Meta interview</h2> <ul> <li>Write code to analyze user engagement data</li> <li>How would you calculate conversion funnels?</li> <li>Explain how to handle large-scale data processing</li> <li>Write code to resample time series data</li> <li>How would you implement A/B testing analysis?</li> <li>Explain method chaining and its benefits</li> <li>Write code to calculate retention metrics</li> <li>How would you handle hierarchical data structures?</li> <li>Explain vectorization benefits over loops</li> <li>Write code to analyze network data</li> </ul> <h2 id=questions-asked-in-microsoft-interview>Questions asked in Microsoft interview</h2> <ul> <li>Explain the SettingWithCopyWarning and how to avoid it</li> <li>Write code to perform window functions similar to SQL</li> <li>How would you handle timezone conversions?</li> <li>Explain the difference between views and copies</li> <li>Write code to implement custom aggregation functions</li> <li>How would you optimize Pandas for production?</li> <li>Explain multi-level indexing use cases</li> <li>Write code to compare two DataFrames</li> <li>How would you handle missing data in time series?</li> <li>Explain eval() and query() methods</li> </ul> <h2 id=questions-asked-in-netflix-interview>Questions asked in Netflix interview</h2> <ul> <li>Write code to analyze viewing patterns and user behavior</li> <li>How would you calculate streaming quality metrics?</li> <li>Explain how to handle messy data from multiple sources</li> <li>Write code to implement collaborative filtering preprocessing</li> <li>How would you analyze content performance across regions?</li> <li>Explain time series decomposition</li> <li>Write code to calculate customer lifetime value</li> <li>How would you handle data for recommendation systems?</li> <li>Explain rolling window calculations for real-time analytics</li> <li>Write code to analyze A/B test results</li> </ul> <h2 id=questions-asked-in-apple-interview>Questions asked in Apple interview</h2> <ul> <li>Write code to perform data validation on imported data</li> <li>How would you implement data quality checks?</li> <li>Explain how to handle multi-format data imports</li> <li>Write code to analyze product performance metrics</li> <li>How would you implement data anonymization?</li> <li>Explain best practices for production Pandas code</li> <li>Write code to create automated data reports</li> <li>How would you handle data versioning?</li> <li>Explain memory management for large DataFrames</li> <li>Write code to implement time-based partitioning</li> </ul> <h2 id=questions-asked-in-flipkart-interview>Questions asked in Flipkart interview</h2> <ul> <li>Write code to analyze e-commerce transaction data</li> <li>How would you calculate GMV metrics?</li> <li>Explain handling high-cardinality categorical data</li> <li>Write code to analyze customer purchase patterns</li> <li>How would you implement product recommendation preprocessing?</li> <li>Explain data aggregation for dashboard analytics</li> </ul> <h2 id=questions-asked-in-linkedin-interview>Questions asked in LinkedIn interview</h2> <ul> <li>Write code to analyze professional network connections</li> <li>How would you calculate engagement metrics for posts?</li> <li>Explain how to handle user activity data</li> <li>Write code to implement skill-based matching</li> <li>How would you analyze job posting performance?</li> <li>Explain data preprocessing for NLP tasks</li> </ul> <hr> <h2 id=additional-resources>Additional Resources</h2> <ul> <li><a href=https://pandas.pydata.org/docs/ >Official Pandas Documentation</a></li> <li><a href=https://medium.com/dunder-data/minimally-sufficient-pandas-a8e67f2a2428>Minimally Sufficient Pandas</a></li> <li><a href=https://tomaugspurger.github.io/modern-1-intro.html>Modern Pandas</a></li> <li><a href=https://jakevdp.github.io/PythonDataScienceHandbook/ >Python Data Science Handbook</a></li> <li><a href=https://store.metasnake.com/effective-pandas-book>Effective Pandas (Book)</a></li> </ul> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2020 - <script>document.write(/\d{4}/.exec(Date())[0])</script> ‚Ä¢ <strong>Kuldeep Singh Sidhu</strong> ‚Ä¢ <u><a href=https://choosealicense.com/licenses/agpl-3.0/ target=‚Äù_blank‚Äù>License</a></u> ‚Ä¢ <u><a href=/privacy>Privacy Policy</a></u> ‚Ä¢ <u><a href=/contact>Contact</a></u> ‚Ä¢ </div> </div> <div class=md-social> <a href=https://github.com/singhsidhukuldeep/ target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M8 0c4.42 0 8 3.58 8 8a8.01 8.01 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27s-1.36.09-2 .27c-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8"/></svg> </a> <a href=https://linkedin.com/in/singhsidhukuldeep target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=https://twitter.com/kuldeep_s_s target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg> </a> <a href=https://stackoverflow.com/u/7182350/ target=_blank rel=noopener title=stackoverflow.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M290.7 311 95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"/></svg> </a> <a href=https://huggingface.co/singhsidhukuldeep target=_blank rel=noopener title=huggingface.co class=md-social__link> <svg width=500 height=463 viewbox="0 0 500 463" fill=none xmlns=http://www.w3.org/2000/svg> <path fill=white d="M496.592 369.699C500.563 381.093 499.61 393.227 494.315 403.778C490.503 411.48 485.05 417.441 478.379 422.769C470.331 429.099 460.324 434.48 448.253 439.65C433.852 445.77 416.274 451.52 408.226 453.63C387.63 458.958 367.829 462.334 347.762 462.493C319.066 462.756 294.34 456.004 276.762 438.753C267.656 439.861 258.443 440.494 249.178 440.494C240.389 440.494 231.706 439.967 223.076 438.912C205.445 456.057 180.825 462.756 152.234 462.493C132.168 462.334 112.366 458.958 91.7177 453.63C83.7229 451.52 66.145 445.77 51.7439 439.65C39.6723 434.48 29.6656 429.099 21.6708 422.769C14.9467 417.441 9.49334 411.48 5.68127 403.778C0.439661 393.227 -0.566304 381.093 3.45755 369.699C-0.248631 360.994 -1.20165 351.024 1.71035 339.998C3.03399 334.987 5.20476 330.344 7.95792 326.229C7.37552 324.067 6.89901 321.851 6.58134 319.424C4.56941 304.97 9.59923 291.781 19.0765 281.547C23.7357 276.43 28.7655 272.895 34.0071 270.627C30.1421 254.273 28.1302 237.445 28.1302 220.247C28.1302 98.5969 127.085 0 249.178 0C291.111 0 330.343 11.6058 363.805 31.8633C369.84 35.5561 375.77 39.5126 381.436 43.7329C384.242 45.8431 387.048 48.006 389.748 50.2744C392.501 52.49 395.201 54.8112 397.796 57.1851C405.632 64.3069 412.991 71.9562 419.715 80.133C421.992 82.8235 424.163 85.6194 426.28 88.4681C430.569 94.1128 434.54 99.9685 438.193 106.035C443.752 115.109 448.623 124.604 452.859 134.469C455.665 141.064 458.101 147.816 460.271 154.727C463.501 165.067 465.99 175.723 467.684 186.696C468.213 190.336 468.69 194.028 469.06 197.721C469.802 205.107 470.225 212.598 470.225 220.247C470.225 237.234 468.213 253.904 464.454 269.994C470.278 272.262 475.784 275.955 480.92 281.547C490.397 291.781 495.427 305.022 493.415 319.477C493.098 321.851 492.621 324.067 492.039 326.229C494.792 330.344 496.963 334.987 498.286 339.998C501.198 351.024 500.245 360.994 496.592 369.699Z"/> <path fill=black d="M433.839 221.75C433.839 120.838 351.531 39.0323 250 39.0323C148.469 39.0323 66.1613 120.838 66.1613 221.75C66.1613 322.662 148.469 404.468 250 404.468C351.531 404.468 433.839 322.662 433.839 221.75ZM45 221.75C45 109.222 136.782 18 250 18C363.218 18 455 109.222 455 221.75C455 334.278 363.218 425.5 250 425.5C136.782 425.5 45 334.278 45 221.75Z"/> <path fill=white d="M250 405.5C352.173 405.5 435 323.232 435 221.75C435 120.268 352.173 38 250 38C147.827 38 65 120.268 65 221.75C65 323.232 147.827 405.5 250 405.5Z"/> <path fill=white d="M202.198 404.174C216.789 383.118 215.755 367.316 195.735 347.627C175.715 327.943 164.062 299.145 164.062 299.145C164.062 299.145 159.709 282.419 149.794 283.958C139.88 285.497 132.6 310.492 153.368 325.783C174.135 341.069 149.232 351.456 141.242 337.099C133.252 322.741 111.435 285.831 100.121 278.772C88.8117 271.713 80.8483 275.668 83.5151 290.218C86.182 304.769 133.48 340.036 128.878 347.668C124.276 355.296 108.058 338.7 108.058 338.7C108.058 338.7 57.3079 293.255 46.2587 305.097C35.2096 316.94 54.641 326.863 82.3328 343.359C110.03 359.85 112.177 364.206 108.248 370.446C104.314 376.685 43.1836 325.971 37.4417 347.47C31.705 368.969 99.8291 375.209 95.6247 390.051C91.4203 404.899 47.6372 361.958 38.6823 378.689C29.7221 395.425 100.465 415.088 101.038 415.234C123.889 421.067 181.924 433.426 202.198 404.174Z"/> <path fill=black d="M90.9935 255C82.4744 255 74.8603 258.477 69.551 264.784C66.2675 268.69 62.8367 274.986 62.5578 284.414C58.985 283.394 55.5489 282.824 52.3391 282.824C44.183 282.824 36.8163 285.93 31.6069 291.573C24.9137 298.815 21.9407 307.715 23.2351 316.62C23.8508 320.861 25.2768 324.663 27.4079 328.182C22.9142 331.795 19.6044 336.826 18.0047 342.876C16.7524 347.619 15.4685 357.497 22.1722 367.673C21.746 368.337 21.3461 369.027 20.9725 369.733C16.9418 377.336 16.684 385.927 20.2411 393.928C25.6346 406.054 39.0368 415.608 65.0625 425.863C81.2536 432.242 96.0661 436.321 96.1976 436.357C117.603 441.874 136.962 444.677 153.721 444.677C184.525 444.677 206.578 435.301 219.27 416.811C239.697 387.036 236.776 359.803 210.346 333.552C195.717 319.026 185.993 297.607 183.967 292.906C179.884 278.986 169.086 263.513 151.138 263.513H151.133C149.622 263.513 148.096 263.633 146.592 263.869C138.73 265.097 131.858 269.595 126.949 276.361C121.65 269.814 116.504 264.606 111.847 261.667C104.827 257.243 97.813 255 90.9935 255ZM90.9935 275.917C93.6771 275.917 96.9553 277.051 100.57 279.331C111.794 286.406 133.452 323.403 141.382 337.793C144.039 342.614 148.581 344.654 152.669 344.654C160.783 344.654 167.118 336.638 153.411 326.451C132.8 311.124 140.03 286.072 149.87 284.529C150.301 284.461 150.727 284.43 151.138 284.43C160.083 284.43 164.03 299.751 164.03 299.751C164.03 299.751 175.595 328.616 195.465 348.346C215.334 368.08 216.36 383.919 201.879 405.024C192.002 419.415 173.096 421.292 153.721 421.292C133.626 421.292 112.99 417.772 101.445 414.796C100.877 414.65 30.7019 396.255 39.5946 379.48C41.089 376.661 43.5516 375.532 46.6509 375.532C59.1744 375.532 81.9535 394.054 91.746 394.054C93.935 394.054 95.5662 392.371 96.1976 390.112C100.555 374.522 32.6646 369.738 38.3633 348.189C39.3683 344.377 42.094 342.829 45.9248 342.834C62.4737 342.834 99.6021 371.756 107.385 371.756C107.979 371.756 108.405 371.584 108.637 371.218C112.536 364.964 110.74 359.872 83.257 343.343C55.7738 326.808 36.1428 317.588 47.114 305.718C48.3768 304.347 50.1659 303.741 52.3391 303.741C69.0248 303.746 108.447 339.398 108.447 339.398C108.447 339.398 119.087 350.395 125.523 350.395C127.001 350.395 128.259 349.815 129.111 348.382C133.673 340.737 86.7366 305.388 84.0898 290.804C82.2955 280.921 85.3474 275.917 90.9935 275.917Z"/> <path fill=white d="M296.9 404.174C282.31 383.118 283.343 367.316 303.363 347.627C323.383 327.943 335.037 299.145 335.037 299.145C335.037 299.145 339.39 282.419 349.304 283.958C359.219 285.497 366.498 310.492 345.731 325.783C324.963 341.069 349.866 351.456 357.856 337.099C365.846 322.741 387.663 285.831 398.978 278.772C410.287 271.713 418.25 275.668 415.583 290.218C412.916 304.769 365.618 340.036 370.22 347.668C374.822 355.296 391.041 338.7 391.041 338.7C391.041 338.7 441.791 293.255 452.84 305.097C463.889 316.94 444.457 326.863 416.766 343.359C389.068 359.85 386.921 364.206 390.85 370.446C394.784 376.685 455.915 325.971 461.657 347.47C467.393 368.969 399.269 375.209 403.474 390.051C407.678 404.899 451.461 361.958 460.416 378.689C469.376 395.425 398.633 415.088 398.06 415.234C375.209 421.067 317.175 433.426 296.9 404.174Z"/> <path fill=black d="M408.105 255C416.624 255 424.238 258.477 429.547 264.784C432.831 268.69 436.262 274.986 436.541 284.414C440.113 283.394 443.549 282.824 446.759 282.824C454.915 282.824 462.282 285.93 467.491 291.573C474.185 298.815 477.158 307.715 475.863 316.62C475.248 320.861 473.822 324.663 471.69 328.182C476.184 331.795 479.494 336.826 481.094 342.876C482.346 347.619 483.63 357.497 476.926 367.673C477.352 368.337 477.752 369.027 478.126 369.733C482.157 377.336 482.414 385.927 478.857 393.928C473.464 406.054 460.062 415.608 434.036 425.863C417.845 432.242 403.032 436.321 402.901 436.357C381.495 441.874 362.136 444.677 345.377 444.677C314.573 444.677 292.52 435.301 279.829 416.811C259.402 387.036 262.322 359.803 288.753 333.552C303.381 319.026 313.105 297.607 315.131 292.906C319.214 278.986 330.012 263.513 347.961 263.513H347.966C349.476 263.513 351.002 263.633 352.507 263.869C360.368 265.097 367.24 269.595 372.15 276.361C377.449 269.814 382.595 264.606 387.252 261.667C394.271 257.243 401.285 255 408.105 255ZM408.105 275.917C405.421 275.917 402.143 277.051 398.528 279.331C387.304 286.406 365.646 323.403 357.716 337.793C355.059 342.614 350.518 344.654 346.429 344.654C338.315 344.654 331.98 336.638 345.687 326.451C366.299 311.124 359.069 286.072 349.229 284.529C348.797 284.461 348.371 284.43 347.961 284.43C339.015 284.43 335.069 299.751 335.069 299.751C335.069 299.751 323.503 328.616 303.634 348.346C283.764 368.08 282.738 383.919 297.219 405.024C307.096 419.415 326.002 421.292 345.377 421.292C365.472 421.292 386.108 417.772 397.653 414.796C398.221 414.65 468.397 396.255 459.504 379.48C458.009 376.661 455.547 375.532 452.447 375.532C439.924 375.532 417.145 394.054 407.352 394.054C405.163 394.054 403.532 392.371 402.901 390.112C398.543 374.522 466.434 369.738 460.735 348.189C459.73 344.377 457.004 342.829 453.174 342.834C436.625 342.834 399.496 371.756 391.714 371.756C391.119 371.756 390.693 371.584 390.461 371.218C386.562 364.964 388.358 359.872 415.841 343.343C443.325 326.808 462.956 317.588 451.984 305.718C450.722 304.347 448.932 303.741 446.759 303.741C430.074 303.746 390.651 339.398 390.651 339.398C390.651 339.398 380.011 350.395 373.576 350.395C372.097 350.395 370.84 349.815 369.987 348.382C365.425 340.737 412.362 305.388 415.009 290.804C416.803 280.921 413.751 275.917 408.105 275.917Z"/> <path fill=#0E1116 d="M319.277 228.901C319.277 205.236 288.585 241.304 250.637 241.465C212.692 241.306 182 205.238 182 228.901C182 244.591 189.507 270.109 209.669 285.591C213.681 271.787 235.726 260.729 238.877 262.317C243.364 264.578 243.112 270.844 250.637 276.365C258.163 270.844 257.911 264.58 262.398 262.317C265.551 260.729 287.594 271.787 291.605 285.591C311.767 270.109 319.275 244.591 319.275 228.903L319.277 228.901Z"/> <path fill=#FF323D d="M262.4 262.315C257.913 264.576 258.165 270.842 250.639 276.363C243.114 270.842 243.366 264.578 238.879 262.315C235.726 260.727 213.683 271.785 209.672 285.589C219.866 293.417 233.297 298.678 250.627 298.806C250.631 298.806 250.635 298.806 250.641 298.806C250.646 298.806 250.65 298.806 250.656 298.806C267.986 298.68 281.417 293.417 291.611 285.589C287.6 271.785 265.555 260.727 262.404 262.315H262.4Z"/> <path fill=black d="M373 196C382.389 196 390 188.389 390 179C390 169.611 382.389 162 373 162C363.611 162 356 169.611 356 179C356 188.389 363.611 196 373 196Z"/> <path fill=black d="M128 196C137.389 196 145 188.389 145 179C145 169.611 137.389 162 128 162C118.611 162 111 169.611 111 179C111 188.389 118.611 196 128 196Z"/> <path fill=#0E1116 d="M313.06 171.596C319.796 173.968 322.476 187.779 329.281 184.171C342.167 177.337 347.06 161.377 340.208 148.524C333.356 135.671 317.354 130.792 304.467 137.626C291.58 144.46 286.688 160.419 293.54 173.272C296.774 179.339 307.039 169.475 313.06 171.596Z"/> <path fill=#0E1116 d="M188.554 171.596C181.818 173.968 179.138 187.779 172.334 184.171C159.447 177.337 154.555 161.377 161.407 148.524C168.259 135.671 184.26 130.792 197.147 137.626C210.034 144.46 214.926 160.419 208.074 173.272C204.84 179.339 194.575 169.475 188.554 171.596Z"/> </svg> </a> <a href=http://kuldeepsinghsidhu.com target=_blank rel=noopener title=kuldeepsinghsidhu.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 16 16"><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0M5.78 8.75a9.64 9.64 0 0 0 1.363 4.177q.383.64.857 1.215c.245-.296.551-.705.857-1.215A9.64 9.64 0 0 0 10.22 8.75Zm4.44-1.5a9.64 9.64 0 0 0-1.363-4.177c-.307-.51-.612-.919-.857-1.215a10 10 0 0 0-.857 1.215A9.64 9.64 0 0 0 5.78 7.25Zm-5.944 1.5H1.543a6.51 6.51 0 0 0 4.666 5.5q-.184-.271-.352-.552c-.715-1.192-1.437-2.874-1.581-4.948m-2.733-1.5h2.733c.144-2.074.866-3.756 1.58-4.948q.18-.295.353-.552a6.51 6.51 0 0 0-4.666 5.5m10.181 1.5c-.144 2.074-.866 3.756-1.58 4.948q-.18.296-.353.552a6.51 6.51 0 0 0 4.666-5.5Zm2.733-1.5a6.51 6.51 0 0 0-4.666-5.5q.184.272.353.552c.714 1.192 1.436 2.874 1.58 4.948Z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "search.highlight", "search.share", "search.suggest", "content.tooltips", "navigation.instant.progress", "navigation.path", "navigation.top", "toc.follow"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.60a45f97.min.js></script> <script src=../../javascripts/mathjax.js></script> <script src=https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../javascripts/xfile.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>